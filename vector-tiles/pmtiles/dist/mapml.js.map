{"version":3,"file":"mapml.js","sources":["mapml.js"],"sourcesContent":["(function () {\n  'use strict';\n\n  var StaticTileLayer = L.GridLayer.extend({\n    initialize: function (options) {\n      L.setOptions(this, options);\n      this.zoomBounds = this._getZoomBounds(\n        options.tileContainer,\n        options.maxZoomBound\n      );\n      L.extend(this.options, this.zoomBounds);\n      this._groups = this._groupTiles(\n        this.options.tileContainer.getElementsByTagName('map-tile')\n      );\n      this._bounds = this._getLayerBounds(this._groups, this.options.projection); //stores meter values of bounds\n      this.layerBounds = this._bounds[Object.keys(this._bounds)[0]];\n      for (let key of Object.keys(this._bounds)) {\n        this.layerBounds.extend(this._bounds[key].min);\n        this.layerBounds.extend(this._bounds[key].max);\n      }\n    },\n\n    onAdd: function (map) {\n      this._map = map;\n      L.GridLayer.prototype.onAdd.call(this, this._map);\n      this._handleMoveEnd();\n    },\n\n    getEvents: function () {\n      let events = L.GridLayer.prototype.getEvents.call(this, this._map);\n      this._parentOnMoveEnd = events.moveend;\n      events.moveend = this._handleMoveEnd;\n      events.move = () => {}; //needed to prevent moveend from running\n      return events;\n    },\n\n    isVisible: function () {\n      let mapZoom = this._map.getZoom();\n      let zoomLevel = mapZoom;\n      zoomLevel =\n        zoomLevel > this.options.maxNativeZoom\n          ? this.options.maxNativeZoom\n          : zoomLevel;\n      zoomLevel =\n        zoomLevel < this.options.minNativeZoom\n          ? this.options.minNativeZoom\n          : zoomLevel;\n      return (\n        mapZoom <= this.zoomBounds.maxZoom &&\n        mapZoom >= this.zoomBounds.minZoom &&\n        this._bounds[zoomLevel] &&\n        this._bounds[zoomLevel].overlaps(\n          M.pixelToPCRSBounds(\n            this._map.getPixelBounds(),\n            this._map.getZoom(),\n            this._map.options.projection\n          )\n        )\n      );\n    },\n\n    //sets the bounds flag of the layer and calls default moveEnd if within bounds\n    //its the zoom level is between the nativeZoom and zoom then it uses the nativeZoom value to get the bound its checking\n    _handleMoveEnd: function (e) {\n      if (!this.isVisible()) return; //onMoveEnd still gets fired even when layer is out of bounds??, most likely need to overrride _onMoveEnd\n      this._parentOnMoveEnd();\n    },\n\n    _isValidTile(coords) {\n      return this._groups[this._tileCoordsToKey(coords)];\n    },\n\n    createTile: function (coords) {\n      let tileGroup = this._groups[this._tileCoordsToKey(coords)] || [],\n        tileElem = document.createElement('map-tile'),\n        tileSize = this.getTileSize();\n      tileElem.setAttribute('col', coords.x);\n      tileElem.setAttribute('row', coords.y);\n      tileElem.setAttribute('zoom', coords.z);\n\n      for (let i = 0; i < tileGroup.length; i++) {\n        let tile = document.createElement('img');\n        tile.width = tileSize.x;\n        tile.height = tileSize.y;\n        tile.alt = '';\n        tile.setAttribute('role', 'presentation');\n        tile.src = tileGroup[i].src;\n        tileElem.appendChild(tile);\n      }\n      return tileElem;\n    },\n\n    _getLayerBounds: function (tileGroups, projection) {\n      let layerBounds = {},\n        tileSize = M[projection].options.crs.tile.bounds.max.x;\n      for (let tile in tileGroups) {\n        let sCoords = tile.split(':'),\n          pixelCoords = {};\n        pixelCoords.x = +sCoords[0] * tileSize;\n        pixelCoords.y = +sCoords[1] * tileSize;\n        pixelCoords.z = +sCoords[2]; //+String same as parseInt(String)\n        if (sCoords[2] in layerBounds) {\n          layerBounds[sCoords[2]].extend(L.point(pixelCoords.x, pixelCoords.y));\n          layerBounds[sCoords[2]].extend(\n            L.point(pixelCoords.x + tileSize, pixelCoords.y + tileSize)\n          );\n        } else {\n          layerBounds[sCoords[2]] = L.bounds(\n            L.point(pixelCoords.x, pixelCoords.y),\n            L.point(pixelCoords.x + tileSize, pixelCoords.y + tileSize)\n          );\n        }\n      }\n      // TODO: optimize by removing 2nd loop, add util function to convert point in pixels to point in pcrs, use that instead then this loop\n      // won't be needed\n      for (let pixelBounds in layerBounds) {\n        let zoom = +pixelBounds;\n        layerBounds[pixelBounds] = M.pixelToPCRSBounds(\n          layerBounds[pixelBounds],\n          zoom,\n          projection\n        );\n      }\n      return layerBounds;\n    },\n\n    _getZoomBounds: function (container, maxZoomBound) {\n      if (!container) return null;\n      // should read zoom information from map-meta (of layer-) instead of the zoom attribute value of map-tile\n      let meta = M._metaContentToObject(\n          this.options._leafletLayer._layerEl\n            .querySelector('map-meta[name=zoom]')\n            .getAttribute('content')\n        ),\n        zoom = {},\n        tiles = container.getElementsByTagName('map-tile');\n      zoom.nativeZoom = +meta.value || 0;\n      zoom.maxNativeZoom = 0;\n      zoom.minNativeZoom = maxZoomBound;\n      for (let i = 0; i < tiles.length; i++) {\n        let lZoom = +tiles[i].getAttribute('zoom');\n        if (!tiles[i].getAttribute('zoom')) lZoom = zoom.nativeZoom;\n        zoom.minNativeZoom = Math.min(zoom.minNativeZoom, lZoom);\n        zoom.maxNativeZoom = Math.max(zoom.maxNativeZoom, lZoom);\n      }\n\n      // currently the min and max zoom bounds of staticTileLayer is set based on map-meta\n      // can be hard coded to only natively zoom out 2 levels, any more and too many tiles are going to be loaded in at one time\n      // it will avoid lagging the users computer, but it will also cause the bug that the initial zoom level of map is inproperly set\n      zoom.minZoom = +meta.min || 0;\n      zoom.maxZoom = +meta.max || maxZoomBound;\n      return zoom;\n    },\n\n    _groupTiles: function (tiles) {\n      let tileMap = {};\n      for (let i = 0; i < tiles.length; i++) {\n        let tile = {};\n        tile.row = +tiles[i].getAttribute('row');\n        tile.col = +tiles[i].getAttribute('col');\n        tile.zoom = +tiles[i].getAttribute('zoom') || this.options.nativeZoom;\n        tile.src = tiles[i].getAttribute('src');\n        let tileCode = tile.col + ':' + tile.row + ':' + tile.zoom;\n        if (tileCode in tileMap) {\n          tileMap[tileCode].push(tile);\n        } else {\n          tileMap[tileCode] = [tile];\n        }\n      }\n      return tileMap;\n    }\n  });\n\n  var staticTileLayer = function (options) {\n    return new StaticTileLayer(options);\n  };\n\n  var LayerControl = L.Control.Layers.extend({\n    /* removes 'base' layers as a concept */\n    options: {\n      autoZIndex: false,\n      sortLayers: true,\n      sortFunction: function (layerA, layerB) {\n        return layerA.options.zIndex < layerB.options.zIndex\n          ? -1\n          : layerA.options.zIndex > layerB.options.zIndex\n          ? 1\n          : 0;\n      }\n    },\n    initialize: function (overlays, options) {\n      L.setOptions(this, options);\n\n      // the _layers array contains objects like {layer: layer, name: \"name\", overlay: true}\n      // the array index is the id of the layer returned by L.stamp(layer) which I guess is a unique hash\n      this._layerControlInputs = [];\n      this._layers = [];\n      this._lastZIndex = 0;\n      this._handlingClick = false;\n\n      for (var i in overlays) {\n        this._addLayer(overlays[i], i, true);\n      }\n    },\n    onAdd: function () {\n      this._initLayout();\n      // Adding event on layer control button\n      L.DomEvent.on(\n        this._container.getElementsByTagName('a')[0],\n        'keydown',\n        this._focusFirstLayer,\n        this._container\n      );\n      L.DomEvent.on(\n        this._container,\n        'contextmenu',\n        this._preventDefaultContextMenu,\n        this\n      );\n      this._update();\n      if (this._layers.length < 1 && !this._map._showControls) {\n        this._container.setAttribute('hidden', '');\n      } else {\n        this._map._showControls = true;\n      }\n      return this._container;\n    },\n    onRemove: function (map) {\n      L.DomEvent.off(\n        this._container.getElementsByTagName('a')[0],\n        'keydown',\n        this._focusFirstLayer,\n        this._container\n      );\n    },\n    addOrUpdateOverlay: function (layer, name) {\n      var alreadyThere = false;\n      for (var i = 0; i < this._layers.length; i++) {\n        if (this._layers[i].layer === layer) {\n          alreadyThere = true;\n          this._layers[i].name = name;\n          // replace the controls with updated controls if necessary.\n          break;\n        }\n      }\n      if (!alreadyThere) {\n        this.addOverlay(layer, name);\n      }\n      if (this._layers.length > 0) {\n        this._container.removeAttribute('hidden');\n        this._map._showControls = true;\n      }\n      return this._map ? this._update() : this;\n    },\n    removeLayer: function (layer) {\n      L.Control.Layers.prototype.removeLayer.call(this, layer);\n      if (this._layers.length === 0) {\n        this._container.setAttribute('hidden', '');\n      }\n    },\n\n    _checkDisabledLayers: function () {},\n\n    // focus the first layer in the layer control when enter is pressed\n    _focusFirstLayer: function (e) {\n      if (\n        e.key === 'Enter' &&\n        this.className ===\n          'leaflet-control-layers leaflet-control leaflet-control-layers-expanded'\n      ) {\n        var elem =\n          this.children[1].children[2].children[0].children[0].children[0]\n            .children[0];\n        if (elem) setTimeout(() => elem.focus(), 0);\n      }\n    },\n\n    // imported from leaflet with slight modifications\n    // for layerControl ordering based on zIndex\n    _update: function () {\n      if (!this._container) {\n        return this;\n      }\n\n      L.DomUtil.empty(this._baseLayersList);\n      L.DomUtil.empty(this._overlaysList);\n\n      this._layerControlInputs = [];\n      var baseLayersPresent,\n        overlaysPresent,\n        i,\n        obj,\n        baseLayersCount = 0;\n\n      // <----------- MODIFICATION from the default _update method\n      // sort the layercontrol layers object based on the zIndex\n      // provided by MapMLLayer\n      if (this.options.sortLayers) {\n        this._layers.sort((a, b) =>\n          this.options.sortFunction(a.layer, b.layer, a.name, b.name)\n        );\n      }\n      // -------------------------------------------------->\n      for (i = 0; i < this._layers.length; i++) {\n        obj = this._layers[i];\n        this._addItem(obj);\n        overlaysPresent = overlaysPresent || obj.overlay;\n        baseLayersPresent = baseLayersPresent || !obj.overlay;\n        baseLayersCount += !obj.overlay ? 1 : 0;\n      }\n\n      // Hide base layers section if there's only one layer.\n      if (this.options.hideSingleBase) {\n        baseLayersPresent = baseLayersPresent && baseLayersCount > 1;\n        this._baseLayersList.style.display = baseLayersPresent ? '' : 'none';\n      }\n\n      this._separator.style.display =\n        overlaysPresent && baseLayersPresent ? '' : 'none';\n\n      return this;\n    },\n\n    _addItem: function (obj) {\n      var layercontrols = obj.layer._layerEl._layerControlHTML;\n      // the input is required by Leaflet...\n      obj.input = layercontrols.querySelector(\n        'input.leaflet-control-layers-selector'\n      );\n\n      this._layerControlInputs.push(obj.input);\n      obj.input.layerId = L.stamp(obj.layer);\n\n      this._overlaysList.appendChild(layercontrols);\n      return layercontrols;\n    },\n\n    //overrides collapse and conditionally collapses the panel\n    collapse: function (e) {\n      // if layer control is not expanded, return\n      if (!this._container.className.includes('expanded')) {\n        return;\n      }\n      // return if layer contextmenu is still open\n      if (\n        !this._map.contextMenu._extentLayerMenu.hidden ||\n        !this._map.contextMenu._layerMenu.hidden\n      ) {\n        return;\n      }\n      if (\n        e.target.tagName === 'SELECT' ||\n        (e.relatedTarget &&\n          e.relatedTarget.parentElement &&\n          (e.relatedTarget.className === 'mapml-contextmenu mapml-layer-menu' ||\n            e.relatedTarget.parentElement.className ===\n              'mapml-contextmenu mapml-layer-menu')) ||\n        (this._map && this._map.contextMenu._layerMenu.style.display === 'block')\n      )\n        return this;\n\n      L.DomUtil.removeClass(this._container, 'leaflet-control-layers-expanded');\n      if (e.originalEvent?.pointerType === 'touch') {\n        this._container._isExpanded = false;\n      }\n      return this;\n    },\n    _preventDefaultContextMenu: function (e) {\n      let latlng = this._map.mouseEventToLatLng(e);\n      let containerPoint = this._map.mouseEventToContainerPoint(e);\n      e.preventDefault();\n      // for touch devices, when the layer control is not expanded,\n      // the layer context menu should not show on map\n      if (!this._container._isExpanded && e.pointerType === 'touch') {\n        this._container._isExpanded = true;\n        return;\n      }\n      this._map.fire('contextmenu', {\n        originalEvent: e,\n        containerPoint: containerPoint,\n        latlng: latlng\n      });\n    }\n  });\n  var layerControl = function (layers, options) {\n    return new LayerControl(layers, options);\n  };\n\n  var FeatureLayer = L.FeatureGroup.extend({\n    /*\n     * M.MapML turns any MapML feature data into a Leaflet layer. Based on L.GeoJSON.\n     *\n     * Used by MapMLLayer to create _mapmlvectors property, used to render features\n     */\n    initialize: function (mapml, options) {\n      /*\n          mapml:\n          1. for query: an array of map-feature elements that it fetches\n          2. for static templated feature: null\n          3. for non-templated feature: layer- (with no src) or mapml file (with src)\n        */\n      // options.extent: when you use a FeatureLayer, you can either get it to calculate the\n      // .layerBounds dynamically (the default), based on adds/removes of features from the layer/\n      // or you can construct it with a bounds (via options.extent),\n      // which will then remain static for the lifetime of the layer\n\n      L.FeatureGroup.prototype.initialize.call(this, null, options);\n      // this.options.static is false ONLY for tiled vector features\n      // this._staticFeature is ONLY true when not used by TemplatedFeaturesLayer\n      // this.options.query true when created by QueryHandler.js\n\n      if (!this.options.tiles) {\n        // not a tiled vector layer\n        this._container = null;\n        if (this.options.query) {\n          this._container = L.DomUtil.create(\n            'div',\n            'leaflet-layer',\n            this.options.pane\n          );\n          // must have leaflet-pane class because of new/changed rule in leaflet.css\n          // info: https://github.com/Leaflet/Leaflet/pull/4597\n          L.DomUtil.addClass(\n            this._container,\n            'leaflet-pane mapml-vector-container'\n          );\n        } else if (this.options._leafletLayer) {\n          this._container = L.DomUtil.create(\n            'div',\n            'leaflet-layer',\n            this.options.pane\n          );\n          L.DomUtil.addClass(\n            this._container,\n            'leaflet-pane mapml-vector-container'\n          );\n          // static mapmlvector should always at the top\n          //        this._container.style.zIndex = 1000;\n        } else {\n          // if the current featureLayer is a sublayer of templatedFeatureLayer,\n          // append <svg> directly to the templated feature container (passed in as options.pane)\n          this._container = this.options.pane;\n          L.DomUtil.addClass(\n            this._container,\n            'leaflet-pane mapml-vector-container'\n          );\n        }\n        L.setOptions(this.options.renderer, { pane: this._container });\n      }\n      if (this.options.query) {\n        this._queryFeatures = mapml.features ? mapml.features : mapml;\n      } else if (!mapml) {\n        // use this.options._leafletLayer to distinguish the featureLayer constructed for initialization and for templated features / tiles\n        if (this.options._leafletLayer) {\n          // this._staticFeature should be set to true to make sure the _getEvents works properly\n          this._features = {};\n          this._staticFeature = true;\n        }\n      }\n    },\n\n    isVisible: function () {\n      let map = this.options.mapEl._map;\n      // if query, isVisible is unconditionally true\n      if (this.options.query) return true;\n      // if the featureLayer is for static features, i.e. it is the mapmlvector layer,\n      // if it is empty, isVisible = false\n      // this._staticFeature: flag to determine if the featureLayer is used by static features only\n      // this._features: check if the current static featureLayer is empty\n      // (Object.keys(this._features).length === 0 => this._features is an empty object)\n      else if (this._staticFeature && Object.keys(this._features).length === 0) {\n        return false;\n      } else {\n        let mapZoom = map.getZoom(),\n          zoomBounds = this.zoomBounds || this.options.zoomBounds,\n          layerBounds = this.layerBounds || this.options.layerBounds,\n          withinZoom = zoomBounds\n            ? mapZoom <= zoomBounds.maxZoom && mapZoom >= zoomBounds.minZoom\n            : false;\n        return (\n          withinZoom &&\n          this._layers &&\n          layerBounds &&\n          layerBounds.overlaps(\n            M.pixelToPCRSBounds(\n              map.getPixelBounds(),\n              mapZoom,\n              map.options.projection\n            )\n          )\n        );\n      }\n    },\n\n    onAdd: function (map) {\n      this._map = map;\n      L.FeatureGroup.prototype.onAdd.call(this, map);\n      if (this._staticFeature) {\n        this._validateRendering();\n      }\n      if (this._queryFeatures)\n        map.on('featurepagination', this.showPaginationFeature, this);\n    },\n    addLayer: function (layerToAdd) {\n      L.FeatureGroup.prototype.addLayer.call(this, layerToAdd);\n      // static FeatureLayer (e.g. MapMLLayer._mapmlvectors) NEVER has a\n      // .layerBounds property, so if there is this.options.layerBounds, don't\n      // go copying it to this.layerBounds.  Same for zoomBounds.\n      // bug alert: it's necessary to create a new bounds object to initialize\n      // this.layerBounds, to avoid changing the layerBounds of the first geometry\n      // added to this layer\n      if (!this.options.layerBounds) {\n        this.layerBounds = this.layerBounds\n          ? this.layerBounds.extend(layerToAdd.layerBounds)\n          : L.bounds(layerToAdd.layerBounds.min, layerToAdd.layerBounds.max);\n\n        if (this.zoomBounds) {\n          if (layerToAdd.zoomBounds.minZoom < this.zoomBounds.minZoom)\n            this.zoomBounds.minZoom = layerToAdd.zoomBounds.minZoom;\n          if (layerToAdd.zoomBounds.maxZoom > this.zoomBounds.maxZoom)\n            this.zoomBounds.maxZoom = layerToAdd.zoomBounds.maxZoom;\n          if (layerToAdd.zoomBounds.minNativeZoom < this.zoomBounds.minNativeZoom)\n            this.zoomBounds.minNativeZoom = layerToAdd.zoomBounds.minNativeZoom;\n          if (layerToAdd.zoomBounds.maxNativeZoom > this.zoomBounds.maxNativeZoom)\n            this.zoomBounds.maxNativeZoom = layerToAdd.zoomBounds.maxNativeZoom;\n        } else {\n          this.zoomBounds = layerToAdd.zoomBounds;\n        }\n      }\n      if (this._staticFeature) {\n        // TODO: validate the use the feature.zoom which is new (was in createGeometry)\n        let featureZoom = layerToAdd.options.mapmlFeature.zoom;\n        if (featureZoom in this._features) {\n          this._features[featureZoom].push(layerToAdd);\n        } else {\n          this._features[featureZoom] = [layerToAdd];\n        }\n        // hide/display features based on the their zoom limits\n        this._validateRendering();\n      }\n      return this;\n    },\n    addRendering: function (featureToAdd) {\n      L.FeatureGroup.prototype.addLayer.call(this, featureToAdd);\n    },\n    onRemove: function (map) {\n      if (this._queryFeatures) {\n        map.off('featurepagination', this.showPaginationFeature, this);\n        delete this._queryFeatures;\n        L.DomUtil.remove(this._container);\n      }\n      L.FeatureGroup.prototype.onRemove.call(this, map);\n      this._map.featureIndex.cleanIndex();\n    },\n\n    removeLayer: function (featureToRemove) {\n      L.FeatureGroup.prototype.removeLayer.call(this, featureToRemove);\n      if (!this.options.layerBounds) {\n        delete this.layerBounds;\n        // this ensures that the <layer->.extent gets recalculated if needed\n        delete this.options._leafletLayer.bounds;\n        delete this.zoomBounds;\n        // this ensures that the <layer->.extent gets recalculated if needed\n        delete this.options._leafletLayer.zoomBounds;\n        delete this._layers[featureToRemove._leaflet_id];\n        this._removeFromFeaturesList(featureToRemove);\n        // iterate through all remaining layers\n        let layerBounds, zoomBounds;\n        let layerIds = Object.keys(this._layers);\n        // re-calculate the layerBounds and zoomBounds for the whole layer when\n        // a feature is permanently removed from the overall layer\n        // bug alert: it's necessary to create a new bounds object to initialize\n        // this.layerBounds, to avoid changing the layerBounds of the first geometry\n        // added to this layer\n        for (let id of layerIds) {\n          let layer = this._layers[id];\n          if (layerBounds) {\n            layerBounds.extend(layer.layerBounds);\n          } else {\n            layerBounds = L.bounds(layer.layerBounds.min, layer.layerBounds.max);\n          }\n          if (zoomBounds) {\n            if (layer.zoomBounds.minZoom < zoomBounds.minZoom)\n              zoomBounds.minZoom = layer.zoomBounds.minZoom;\n            if (layer.zoomBounds.maxZoom > zoomBounds.maxZoom)\n              zoomBounds.maxZoom = layer.zoomBounds.maxZoom;\n            if (layer.zoomBounds.minNativeZoom < zoomBounds.minNativeZoom)\n              zoomBounds.minNativeZoom = layer.zoomBounds.minNativeZoom;\n            if (layer.zoomBounds.maxNativeZoom > zoomBounds.maxNativeZoom)\n              zoomBounds.maxNativeZoom = layer.zoomBounds.maxNativeZoom;\n          } else {\n            zoomBounds = {};\n            zoomBounds.minZoom = layer.zoomBounds.minZoom;\n            zoomBounds.maxZoom = layer.zoomBounds.maxZoom;\n            zoomBounds.minNativeZoom = layer.zoomBounds.minNativeZoom;\n            zoomBounds.maxNativeZoom = layer.zoomBounds.maxNativeZoom;\n          }\n        }\n        // If the last feature is removed, we should remove the .layerBounds and\n        // .zoomBounds properties, so that the FeatureLayer may be ignored\n        if (layerBounds) {\n          this.layerBounds = layerBounds;\n        } else {\n          delete this.layerBounds;\n        }\n        if (zoomBounds) {\n          this.zoomBounds = zoomBounds;\n        } else {\n          delete this.zoomBounds;\n          delete this.options.zoomBounds;\n        }\n      }\n      return this;\n    },\n    /**\n     * Remove the geomtry rendering (an svg g/ M.Geomtry) from the L.FeatureGroup\n     * _layers array, so that it's not visible on the map, but still contributes\n     * to the bounds and zoom limits of the M.FeatureLayer.\n     *\n     * @param {type} featureToRemove\n     * @returns {undefined}\n     */\n    removeRendering: function (featureToRemove) {\n      L.FeatureGroup.prototype.removeLayer.call(this, featureToRemove);\n    },\n    _removeFromFeaturesList: function (feature) {\n      for (let zoom in this._features)\n        for (let i = 0; i < this._features[zoom].length; ++i) {\n          let feature = this._features[zoom][i];\n          if (feature._leaflet_id === feature._leaflet_id) {\n            this._features[zoom].splice(i, 1);\n            break;\n          }\n        }\n    },\n    getEvents: function () {\n      if (this._staticFeature) {\n        return {\n          moveend: this._handleMoveEnd,\n          zoomend: this._handleZoomEnd\n        };\n      }\n      return {};\n    },\n\n    // for query\n    showPaginationFeature: function (e) {\n      if (this.options.query && this._queryFeatures[e.i]) {\n        let feature = this._queryFeatures[e.i];\n        feature._linkEl.shadowRoot.replaceChildren();\n        this.clearLayers();\n        // append all map-meta from mapml document\n        if (feature.meta) {\n          for (let i = 0; i < feature.meta.length; i++) {\n            feature._linkEl.shadowRoot.appendChild(feature.meta[i]);\n          }\n        }\n        feature._linkEl.shadowRoot.appendChild(feature);\n        feature.addFeature(this);\n        e.popup._navigationBar.querySelector('p').innerText =\n          e.i + 1 + '/' + this.options._leafletLayer._totalFeatureCount;\n        e.popup._content\n          .querySelector('iframe')\n          .setAttribute('sandbox', 'allow-same-origin allow-forms');\n        e.popup._content.querySelector('iframe').srcdoc =\n          feature.querySelector('map-properties').innerHTML;\n        // \"zoom to here\" link need to be re-set for every pagination\n        this._map.fire('attachZoomLink', { i: e.i, currFeature: feature });\n        this._map.once(\n          'popupclose',\n          function (e) {\n            this.shadowRoot.innerHTML = '';\n          },\n          feature._linkEl\n        );\n      }\n    },\n\n    _handleMoveEnd: function () {\n      this._removeCSS();\n    },\n\n    _handleZoomEnd: function (e) {\n      // handle zoom end gets called twice for every zoom, this condition makes it go through once only.\n      if (this.zoomBounds) {\n        this._validateRendering();\n      }\n    },\n    /*\n     * _validateRendering prunes the features currently in the _features hashmap (created\n     * by us).  _features categorizes features by zoom, and is used to remove or add\n     * features from the map based on the map-feature min/max getters.  It also\n     * maintains the _map.featureIndex property, which is used to control the tab\n     * order for interactive (static) features currently rendered on the map.\n     * @private\n     *  */\n    _validateRendering: function () {\n      // since features are removed and re-added by zoom level, need to clean the feature index before re-adding\n      if (this._map) this._map.featureIndex.cleanIndex();\n      let map = this._map || this.options._leafletLayer._map;\n      // it's important that we not try to validate rendering if the FeatureLayer\n      // isn't actually  being rendered (i.e. on the map.  the _map property can't\n      // be used because once it's assigned  (by onAdd, above) it's never unassigned.\n      if (!map.hasLayer(this)) return;\n      if (this._features) {\n        for (let zoom in this._features) {\n          for (let k = 0; k < this._features[zoom].length; k++) {\n            let geometry = this._features[zoom][k],\n              renderable = geometry._checkRender(\n                map.getZoom(),\n                this.zoomBounds.minZoom,\n                this.zoomBounds.maxZoom\n              );\n            if (!renderable) {\n              // insert a placeholder in the dom rendering for the geometry\n              // so that it retains its layering order when it is next rendered\n              let placeholder = document.createElement('span');\n              placeholder.id = geometry._leaflet_id;\n              // geometry.defaultOptions.group is the rendered svg g element in sd\n              geometry.defaultOptions.group.insertAdjacentElement(\n                'beforebegin',\n                placeholder\n              );\n              // removing the rendering without removing the feature from the feature list\n              this.removeRendering(geometry);\n            } else if (\n              // checking for _map so we do not enter this code block during the connectedCallBack of the map-feature\n              !map.hasLayer(geometry) &&\n              !geometry._map\n            ) {\n              this.addRendering(geometry);\n              // update the layerbounds\n              let placeholder =\n                geometry.defaultOptions.group.parentNode.querySelector(\n                  `span[id=\"${geometry._leaflet_id}\"]`\n                );\n              placeholder.replaceWith(geometry.defaultOptions.group);\n            }\n          }\n        }\n      }\n    },\n\n    _setZoomTransform: function (center, clampZoom) {\n      var scale = this._map.getZoomScale(this._map.getZoom(), clampZoom),\n        translate = center\n          .multiplyBy(scale)\n          .subtract(this._map._getNewPixelOrigin(center, this._map.getZoom()))\n          .round();\n\n      if (any3d) {\n        L.setTransform(this._layers[clampZoom], translate, scale);\n      } else {\n        L.setPosition(this._layers[clampZoom], translate);\n      }\n    },\n\n    /**\n     * Render a <map-feature> as a Leaflet layer that can be added to a map or\n     * LayerGroup as required.  Kind of a \"factory\" method.\n     *\n     * Uses this.options, so if you need to, you can construct an M.featureLayer\n     * with options set as required\n     *\n     * @param feature - a <map-feature> element\n     * @param {String} fallbackCS - \"gcrs\" | \"pcrs\"\n     * @param {String} tileZoom - the zoom of the map at which the coordinates will exist\n     *\n     * @returns M.Geometry, which is an L.FeatureGroup\n     * @public\n     */\n    createGeometry: function (feature, fallbackCS, tileZoom) {\n      // was let options = this.options, but that was causing unwanted side-effects\n      // because we were adding .layerBounds and .zoomBounds to it before passing\n      // to _createGeometry, which meant that FeatureLayer was sprouting\n      // options.layerBounds and .zoomBounds when it should not have those props\n      let options = Object.assign({}, this.options);\n\n      if (options.filter && !options.filter(feature)) {\n        return;\n      }\n\n      if (feature.classList.length) {\n        options.className = feature.classList.value;\n      }\n      // tileZoom is only used when the map-feature is discarded i.e. for rendering\n      // vector tiles' feature geometries in bulk (in this case only the geomtry\n      // is rendered on a tile-shaped FeatureLayer\n      let zoom = feature.zoom ?? tileZoom,\n        title = feature.querySelector('map-featurecaption');\n      title = title ? title.innerHTML : 'Feature';\n\n      if (feature.querySelector('map-properties')) {\n        options.properties = document.createElement('div');\n        options.properties.classList.add('mapml-popup-content');\n        options.properties.insertAdjacentHTML(\n          'afterbegin',\n          feature.querySelector('map-properties').innerHTML\n        );\n      }\n      let cs =\n        feature.getElementsByTagName('map-geometry')[0]?.getAttribute('cs') ||\n        fallbackCS;\n      // options.layerBounds and options.zoomBounds are set by TemplatedTileLayer._createFeatures\n      // each geometry needs bounds so that it can be a good community member of this._layers\n      if (this._staticFeature || this.options.query) {\n        options.layerBounds = M.extentToBounds(feature.extent, 'PCRS');\n        options.zoomBounds = feature.extent.zoom;\n      }\n      let geometry = this._geometryToLayer(feature, options, cs, +zoom, title);\n      if (geometry && Object.keys(geometry._layers).length !== 0) {\n        // if the layer is being used as a query handler output, it will have\n        // a color option set.  Otherwise, copy classes from the feature\n        if (!geometry.options.color && feature.hasAttribute('class')) {\n          geometry.options.className = feature.getAttribute('class');\n        }\n        geometry.defaultOptions = geometry.options;\n        this.resetStyle(geometry);\n\n        if (options.onEachFeature) {\n          geometry.bindTooltip(title, { interactive: true, sticky: true });\n        }\n        if (feature.tagName.toUpperCase() === 'MAP-FEATURE') {\n          feature._groupEl = geometry.options.group;\n        }\n        return geometry;\n      }\n    },\n\n    resetStyle: function (layer) {\n      var style = this.options.style;\n      if (style) {\n        // reset any custom styles\n        L.Util.extend(layer.options, layer.defaultOptions);\n        this._setLayerStyle(layer, style);\n      }\n    },\n\n    setStyle: function (style) {\n      this.eachLayer(function (layer) {\n        this._setLayerStyle(layer, style);\n      }, this);\n    },\n\n    _setLayerStyle: function (layer, style) {\n      if (typeof style === 'function') {\n        style = style(layer.feature);\n      }\n      if (layer.setStyle) {\n        layer.setStyle(style);\n      }\n    },\n    _removeCSS: function () {\n      let toDelete = this._container.querySelectorAll(\n        'link[rel=stylesheet],style'\n      );\n      for (let i = 0; i < toDelete.length; i++) {\n        this._container.removeChild(toDelete[i]);\n      }\n    },\n    _geometryToLayer: function (feature, vectorOptions, cs, zoom, title) {\n      let geometry = feature.getElementsByTagName('map-geometry')[0],\n        group = [],\n        svgGroup = L.SVG.create('g'),\n        copyOptions = Object.assign({}, vectorOptions);\n      svgGroup._featureEl = feature; // rendered <g> has a reference to map-feature\n      if (geometry) {\n        for (let geo of geometry.querySelectorAll(\n          'map-polygon, map-linestring, map-multilinestring, map-point, map-multipoint'\n        )) {\n          group.push(\n            M.path(\n              geo,\n              Object.assign(copyOptions, {\n                nativeCS: cs,\n                nativeZoom: zoom,\n                projection: this.options.projection,\n                featureID: feature.id,\n                group: svgGroup,\n                wrappers: this._getGeometryParents(geo.parentElement),\n                featureLayer: this,\n                _leafletLayer: this.options._leafletLayer\n              })\n            )\n          );\n        }\n        let groupOptions = {\n            group: svgGroup,\n            mapmlFeature: feature,\n            featureID: feature.id,\n            accessibleTitle: title,\n            onEachFeature: vectorOptions.onEachFeature,\n            properties: vectorOptions.properties,\n            _leafletLayer: this.options._leafletLayer,\n            layerBounds: vectorOptions.layerBounds,\n            zoomBounds: vectorOptions.zoomBounds\n          },\n          collections =\n            geometry.querySelector('map-multipolygon') ||\n            geometry.querySelector('map-geometrycollection');\n        if (collections)\n          groupOptions.wrappers = this._getGeometryParents(\n            collections.parentElement\n          );\n        return M.geometry(group, groupOptions);\n      }\n    },\n\n    _getGeometryParents: function (subType, elems = []) {\n      if (subType && subType.tagName.toUpperCase() !== 'MAP-GEOMETRY') {\n        if (\n          subType.tagName.toUpperCase() === 'MAP-MULTIPOLYGON' ||\n          subType.tagName.toUpperCase() === 'MAP-GEOMETRYCOLLECTION'\n        )\n          return this._getGeometryParents(subType.parentElement, elems);\n        return this._getGeometryParents(\n          subType.parentElement,\n          elems.concat([subType])\n        );\n      } else {\n        return elems;\n      }\n    }\n  });\n  var featureLayer = function (mapml, options) {\n    return new FeatureLayer(mapml, options);\n  };\n\n  var TemplatedTileLayer = L.TileLayer.extend({\n    // a TemplateTileLayer is similar to a L.TileLayer except its templates are\n    // defined by the <map-extent><template/></map-extent>\n    // content found in the MapML document.  As such, the client map does not\n    // 'revisit' the server for more MapML content, it simply fills the map extent\n    // with tiles for which it generates requests on demand (as the user pans/zooms/resizes\n    // the map)\n    initialize: function (template, options) {\n      // _setUpTileTemplateVars needs options.crs, not available unless we set\n      // options first...\n      options.tms = template.tms;\n      // it's critical to have this.options.minZoom, minNativeZoom, maxZoom, maxNativeZoom\n      // because they are used by Leaflet Map and GridLayer, but we\n      // don't need two copies of that info on our options object, so set the\n      // .zoomBounds property (which is used externally), then delete the option\n      // before unpacking the zoomBound object's properties onto this.options.minZ... etc.\n      this.zoomBounds = Object.assign({}, options.zoomBounds);\n      // unpack object to this.options.minZ... etc where minZ... are the props\n      // of the this.zoomBounds object:\n      L.extend(options, this.zoomBounds);\n      L.setOptions(this, options);\n      // _setup call here relies on this.options.minZ.. etc\n      this._setUpTileTemplateVars(template);\n      this._linkEl = options.linkEl;\n      this.extentBounds = this.options.extentBounds;\n      // get rid of duplicate information as it is confusing\n      delete this.options.zoomBounds;\n      delete this.options.extentBounds;\n\n      this._template = template;\n      this._initContainer();\n      // call the parent constructor with the template tref value, per the\n      // Leaflet tutorial: http://leafletjs.com/examples/extending/extending-1-classes.html#methods-of-the-parent-class\n      L.TileLayer.prototype.initialize.call(\n        this,\n        template.template,\n        L.extend(options, { pane: this.options.pane })\n      );\n    },\n    onAdd: function (map) {\n      this.options.pane.appendChild(this._container);\n      L.TileLayer.prototype.onAdd.call(this, map);\n      this._handleMoveEnd();\n    },\n\n    onRemove: function () {\n      L.DomUtil.remove(this._container);\n      // should clean up the container\n      for (let child of this._container.children) {\n        L.DomUtil.remove(child);\n      }\n    },\n\n    getEvents: function () {\n      let events = L.TileLayer.prototype.getEvents.call(this, this._map);\n      this._parentOnMoveEnd = events.moveend;\n      events.moveend = this._handleMoveEnd;\n      return events;\n    },\n\n    isVisible: function () {\n      let map = this._linkEl.getMapEl()._map;\n      let mapZoom = map.getZoom();\n      let mapBounds = M.pixelToPCRSBounds(\n        map.getPixelBounds(),\n        mapZoom,\n        map.options.projection\n      );\n      return (\n        mapZoom <= this.zoomBounds.maxZoom &&\n        mapZoom >= this.zoomBounds.minZoom &&\n        this.extentBounds.overlaps(mapBounds)\n      );\n    },\n\n    _initContainer: function () {\n      if (this._container) {\n        return;\n      }\n\n      this._container = L.DomUtil.create(\n        'div',\n        'leaflet-layer',\n        this.options.pane\n      );\n      L.DomUtil.addClass(this._container, 'mapml-templated-tile-container');\n      this._updateZIndex();\n    },\n\n    _handleMoveEnd: function (e) {\n      if (!this.isVisible()) return;\n      this._parentOnMoveEnd();\n    },\n    createTile: function (coords) {\n      let tileGroup = document.createElement('DIV'),\n        tileSize = this.getTileSize();\n      L.DomUtil.addClass(tileGroup, 'mapml-tile-group');\n      L.DomUtil.addClass(tileGroup, 'leaflet-tile');\n\n      this._template.linkEl.dispatchEvent(\n        new CustomEvent('tileloadstart', {\n          detail: {\n            x: coords.x,\n            y: coords.y,\n            zoom: coords.z,\n            appendTile: (elem) => {\n              tileGroup.appendChild(elem);\n            }\n          }\n        })\n      );\n\n      if (this._template.type.startsWith('image/')) {\n        let tile = L.TileLayer.prototype.createTile.call(\n          this,\n          coords,\n          function () {}\n        );\n        tile.width = tileSize.x;\n        tile.height = tileSize.y;\n        tileGroup.appendChild(tile);\n      } else if (!this._url.includes(M.BLANK_TT_TREF)) {\n        // tiles of type=\"text/mapml\" will have to fetch content while creating\n        // the tile here, unless there can be a callback associated to the element\n        // that will render the content in the alread-placed tile\n        // var tile = L.DomUtil.create('canvas', 'leaflet-tile');\n        this._fetchTile(coords, tileGroup);\n      }\n      return tileGroup;\n    },\n    _mapmlTileReady: function (tile) {\n      L.DomUtil.addClass(tile, 'leaflet-tile-loaded');\n    },\n    // instead of being child of a pane, the TemplatedTileLayers are 'owned' by the group,\n    // and so are DOM children of the group, not the pane element (the MapMLLayer is\n    // a child of the overlay pane and always has a set of sub-layers)\n    getPane: function () {\n      return this.options.pane;\n    },\n    _fetchTile: function (coords, tile) {\n      let url = this.getTileUrl(coords);\n      if (url) {\n        fetch(url, { redirect: 'follow' })\n          .then(function (response) {\n            if (response.status >= 200 && response.status < 300) {\n              return Promise.resolve(response);\n            } else {\n              console.log(\n                'Looks like there was a problem. Status Code: ' + response.status\n              );\n              return Promise.reject(response);\n            }\n          })\n          .then(function (response) {\n            return response.text();\n          })\n          .then((text) => {\n            var parser = new DOMParser();\n            return parser.parseFromString(text, 'application/xml');\n          })\n          .then((mapml) => {\n            this._createFeatures(mapml, coords, tile);\n            this._mapmlTileReady(tile);\n          })\n          .catch((err) => {\n            console.log('Error Creating Tile');\n          });\n      }\n    },\n\n    // TO DO: get rid of this function altogether; see TO DO below re: map-link\n    // shadow root\n    // _parseStylesheetAsHTML parses map-link and map-style from mapml and inserts them to the container as HTML\n    _parseStylesheetAsHTML: function (mapml, base, container) {\n      if (\n        !(container instanceof Element) ||\n        !mapml ||\n        !mapml.querySelector('map-link[rel=stylesheet],map-style')\n      )\n        return;\n\n      if (base instanceof Element) {\n        base = base.getAttribute('href')\n          ? base.getAttribute('href')\n          : document.URL;\n      } else if (!base || base === '' || base instanceof Object) {\n        return;\n      }\n\n      var ss = [];\n      var stylesheets = mapml.querySelectorAll(\n        'map-link[rel=stylesheet],map-style'\n      );\n      for (var i = 0; i < stylesheets.length; i++) {\n        if (stylesheets[i].nodeName.toUpperCase() === 'MAP-LINK') {\n          var href = stylesheets[i].hasAttribute('href')\n            ? new URL(stylesheets[i].getAttribute('href'), base).href\n            : null;\n          if (href) {\n            if (!container.querySelector(\"link[href='\" + href + \"']\")) {\n              var linkElm = document.createElement('link');\n              copyAttributes(stylesheets[i], linkElm);\n              linkElm.setAttribute('href', href);\n              ss.push(linkElm);\n            }\n          }\n        } else {\n          // <map-style>\n          var styleElm = document.createElement('style');\n          copyAttributes(stylesheets[i], styleElm);\n          styleElm.textContent = stylesheets[i].textContent;\n          ss.push(styleElm);\n        }\n      }\n      // insert <link> or <style> elements after the begining  of the container\n      // element, in document order as copied from original mapml document\n      // note the code below assumes hrefs have been resolved and elements\n      // re-parsed from xml and serialized as html elements ready for insertion\n      for (var s = ss.length - 1; s >= 0; s--) {\n        container.insertAdjacentElement('afterbegin', ss[s]);\n      }\n      function copyAttributes(source, target) {\n        return Array.from(source.attributes).forEach((attribute) => {\n          if (attribute.nodeName !== 'href')\n            target.setAttribute(attribute.nodeName, attribute.nodeValue);\n        });\n      }\n    },\n\n    _createFeatures: function (markup, coords, tile) {\n      // TO DO: create a shadow root for the <map-link> that hosts this layer,\n      // populate it with map-tile, map-link and map-style elements that are\n      // fetched.\n      let stylesheets = markup.querySelector(\n        'map-link[rel=stylesheet],map-style'\n      );\n      if (stylesheets) {\n        let base =\n          markup.querySelector('map-base') &&\n          markup.querySelector('map-base').hasAttribute('href')\n            ? new URL(markup.querySelector('map-base').getAttribute('href')).href\n            : markup.URL;\n        this._parseStylesheetAsHTML(markup, base, tile);\n      }\n\n      let svg = L.SVG.create('svg'),\n        g = L.SVG.create('g'),\n        tileSize = this._map.options.crs.options.crs.tile.bounds.max.x,\n        xOffset = coords.x * tileSize,\n        yOffset = coords.y * tileSize;\n\n      let tileFeatures = M.featureLayer(null, {\n        projection: this._map.options.projection,\n        tiles: true,\n        layerBounds: this.extentBounds,\n        zoomBounds: this.zoomBounds,\n        interactive: false,\n        mapEl: this._linkEl.getMapEl()\n      });\n      let fallback = M.getNativeVariables(markup);\n      let features = markup.querySelectorAll('map-feature:has(> map-geometry)');\n      for (let i = 0; i < features.length; i++) {\n        let feature = tileFeatures.createGeometry(\n          features[i],\n          fallback.cs,\n          coords.z\n        );\n        for (let featureID in feature._layers) {\n          let layer = feature._layers[featureID];\n          M.FeatureRenderer.prototype._initPath(layer, false);\n          layer._project(this._map, L.point([xOffset, yOffset]), coords.z);\n          M.FeatureRenderer.prototype._addPath(layer, g, false);\n          M.FeatureRenderer.prototype._updateFeature(layer);\n        }\n      }\n      svg.setAttribute('width', tileSize.toString());\n      svg.setAttribute('height', tileSize.toString());\n      svg.appendChild(g);\n      tile.appendChild(svg);\n    },\n\n    getTileUrl: function (coords) {\n      if (\n        coords.z >= this._template.tilematrix.bounds.length ||\n        !this._template.tilematrix.bounds[coords.z].contains(coords)\n      ) {\n        return '';\n      }\n      var obj = {},\n        linkEl = this._template.linkEl,\n        zoomInput = linkEl.zoomInput;\n      obj[this._template.tilematrix.col.name] = coords.x;\n      obj[this._template.tilematrix.row.name] = coords.y;\n      if (\n        zoomInput &&\n        linkEl.hasAttribute('tref') &&\n        linkEl\n          .getAttribute('tref')\n          .includes(`{${zoomInput.getAttribute('name')}}`)\n      ) {\n        obj[this._template.zoom.name] = this._getZoomForUrl();\n      }\n      obj[this._template.pcrs.easting.left] = this._tileMatrixToPCRSPosition(\n        coords,\n        'top-left'\n      ).x;\n      obj[this._template.pcrs.easting.right] = this._tileMatrixToPCRSPosition(\n        coords,\n        'top-right'\n      ).x;\n      obj[this._template.pcrs.northing.top] = this._tileMatrixToPCRSPosition(\n        coords,\n        'top-left'\n      ).y;\n      obj[this._template.pcrs.northing.bottom] = this._tileMatrixToPCRSPosition(\n        coords,\n        'bottom-left'\n      ).y;\n      for (var v in this._template.tile) {\n        if (\n          ['row', 'col', 'zoom', 'left', 'right', 'top', 'bottom'].indexOf(v) < 0\n        ) {\n          obj[v] = this._template.tile[v];\n        }\n      }\n      if (this._map && !this._map.options.crs.infinite) {\n        let invertedY = this._globalTileRange.max.y - coords.y;\n        if (this.options.tms) {\n          obj[this._template.tilematrix.row.name] = invertedY;\n        }\n        //obj[`-${this._template.tilematrix.row.name}`] = invertedY; //leaflet has this but I dont see a use in storing row and -row as it doesnt follow that pattern\n      }\n      obj.r =\n        this.options.detectRetina && L.Browser.retina && this.options.maxZoom > 0\n          ? '@2x'\n          : '';\n      return L.Util.template(this._url, obj);\n    },\n    _tileMatrixToPCRSPosition: function (coords, pos) {\n      // this is a tile:\n      //\n      //   top-left         top-center           top-right\n      //      +------------------+------------------+\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      + center-left    center               + center-right\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      +------------------+------------------+\n      //   bottom-left     bottom-center      bottom-right\n\n      var map = this._map,\n        crs = map.options.crs,\n        tileSize = this.getTileSize(),\n        nwPoint = coords.scaleBy(tileSize),\n        sePoint = nwPoint.add(tileSize),\n        centrePoint = nwPoint.add(Math.floor(tileSize / 2)),\n        nw = crs.transformation.untransform(nwPoint, crs.scale(coords.z)),\n        se = crs.transformation.untransform(sePoint, crs.scale(coords.z)),\n        cen = crs.transformation.untransform(centrePoint, crs.scale(coords.z)),\n        result = null;\n\n      switch (pos) {\n        case 'top-left':\n          result = nw;\n          break;\n        case 'bottom-left':\n          result = new L.Point(nw.x, se.y);\n          break;\n        case 'center-left':\n          result = new L.Point(nw.x, cen.y);\n          break;\n        case 'top-right':\n          result = new L.Point(se.x, nw.y);\n          break;\n        case 'bottom-right':\n          result = se;\n          break;\n        case 'center-right':\n          result = new L.Point(se.x, cen.y);\n          break;\n        case 'top-center':\n          result = new L.Point(cen.x, nw.y);\n          break;\n        case 'bottom-center':\n          result = new L.Point(cen.x, se.y);\n          break;\n        case 'center':\n          result = cen;\n          break;\n      }\n      return result;\n    },\n    _setUpTileTemplateVars: function (template) {\n      // process the inputs associated to template and create an object named\n      // tile with member properties as follows:\n      // {row: 'rowvarname',\n      //  col: 'colvarname',\n      //  left: 'leftvarname',\n      //  right: 'rightvarname',\n      //  top: 'topvarname',\n      //  bottom: 'bottomvarname'}\n      template.tile = {};\n      var inputs = template.values,\n        crs = this.options.crs.options,\n        east,\n        north,\n        row,\n        col;\n\n      for (var i = 0; i < template.values.length; i++) {\n        var type = inputs[i].getAttribute('type'),\n          units = inputs[i].getAttribute('units'),\n          axis = inputs[i].getAttribute('axis'),\n          name = inputs[i].getAttribute('name'),\n          position = inputs[i].getAttribute('position'),\n          select = inputs[i].tagName.toLowerCase() === 'map-select',\n          value = inputs[i].getAttribute('value'),\n          min = inputs[i].getAttribute('min'),\n          max = inputs[i].getAttribute('max');\n        if (type === 'location' && units === 'tilematrix') {\n          switch (axis) {\n            case 'column':\n              col = {\n                name: name,\n                min: crs.crs.tilematrix.horizontal.min,\n                max: crs.crs.tilematrix.horizontal.max(crs.resolutions.length - 1)\n              };\n              if (!isNaN(Number.parseFloat(min))) {\n                col.min = Number.parseFloat(min);\n              }\n              if (!isNaN(Number.parseFloat(max))) {\n                col.max = Number.parseFloat(max);\n              }\n              break;\n            case 'row':\n              row = {\n                name: name,\n                min: crs.crs.tilematrix.vertical.min,\n                max: crs.crs.tilematrix.vertical.max(crs.resolutions.length - 1)\n              };\n              if (!isNaN(Number.parseFloat(min))) {\n                row.min = Number.parseFloat(min);\n              }\n              if (!isNaN(Number.parseFloat(max))) {\n                row.max = Number.parseFloat(max);\n              }\n              break;\n            case 'longitude':\n            case 'easting':\n              if (!east) {\n                east = {\n                  min: crs.crs.pcrs.horizontal.min,\n                  max: crs.crs.pcrs.horizontal.max\n                };\n              }\n              if (!isNaN(Number.parseFloat(min))) {\n                east.min = Number.parseFloat(min);\n              }\n              if (!isNaN(Number.parseFloat(max))) {\n                east.max = Number.parseFloat(max);\n              }\n              if (position) {\n                if (position.match(/.*?-left/i)) {\n                  east.left = name;\n                } else if (position.match(/.*?-right/i)) {\n                  east.right = name;\n                }\n              }\n              break;\n            case 'latitude':\n            case 'northing':\n              if (!north) {\n                north = {\n                  min: crs.crs.pcrs.vertical.min,\n                  max: crs.crs.pcrs.vertical.max\n                };\n              }\n              if (!isNaN(Number.parseFloat(min))) {\n                north.min = Number.parseFloat(min);\n              }\n              if (!isNaN(Number.parseFloat(max))) {\n                north.max = Number.parseFloat(max);\n              }\n              if (position) {\n                if (position.match(/top-.*?/i)) {\n                  north.top = name;\n                } else if (position.match(/bottom-.*?/i)) {\n                  north.bottom = name;\n                }\n              }\n              break;\n            // unsuportted axis value\n          }\n        } else if (select) {\n          /*jshint -W104 */\n          const parsedselect = inputs[i].htmlselect;\n          template.tile[name] = function () {\n            return parsedselect.value;\n          };\n        } else if (type === 'hidden') {\n          // needs to be a const otherwise it gets overwritten\n          /*jshint -W104 */\n          const input = inputs[i];\n          template.tile[name] = function () {\n            return input.getAttribute('value');\n          };\n        }\n      }\n      var transformation = this.options.crs.transformation,\n        tileSize = this.options.crs.options.crs.tile.bounds.max.x,\n        scale = L.bind(this.options.crs.scale, this.options.crs),\n        pcrs2tilematrix = function (c, zoom) {\n          return transformation\n            .transform(c, scale(zoom))\n            .divideBy(tileSize)\n            .floor();\n        };\n      if (east && north) {\n        template.pcrs = {};\n        template.pcrs.bounds = L.bounds(\n          [east.min, north.min],\n          [east.max, north.max]\n        );\n        template.pcrs.easting = east;\n        template.pcrs.northing = north;\n      } else if (col && row && !isNaN(template.zoom.initialValue)) {\n        // convert the tile bounds at this zoom to a pcrs bounds, then\n        // go through the zoom min/max and create a tile-based bounds\n        // at each zoom that applies to the col/row values that constrain what tiles\n        // will be requested so that we don't generate too many 404s\n        if (!template.pcrs) {\n          template.pcrs = {};\n          template.pcrs.easting = '';\n          template.pcrs.northing = '';\n        }\n\n        template.pcrs.bounds = M.boundsToPCRSBounds(\n          L.bounds(L.point([col.min, row.min]), L.point([col.max, row.max])),\n          template.zoom.initialValue,\n          this.options.crs,\n          M.axisToCS('column')\n        );\n\n        template.tilematrix = {};\n        template.tilematrix.col = col;\n        template.tilematrix.row = row;\n      }\n\n      if (!template.tilematrix) {\n        template.tilematrix = {};\n        template.tilematrix.col = {};\n        template.tilematrix.row = {};\n      }\n      template.tilematrix.bounds = [];\n      var pcrsBounds = template.pcrs.bounds;\n      // the template should _always_ have a zoom, because we force it to\n      // by first processing the extent to determine the zoom and if none, adding\n      // one and second by copying that zoom into the set of template variable inputs\n      // even if it is not referenced by one of the template's variable references\n      var zmin = this.options.minNativeZoom,\n        zmax = this.options.maxNativeZoom;\n      for (var z = 0; z <= zmax; z++) {\n        template.tilematrix.bounds[z] =\n          z >= zmin\n            ? L.bounds(\n                pcrs2tilematrix(pcrsBounds.min, z),\n                pcrs2tilematrix(pcrsBounds.max, z)\n              )\n            : L.bounds(L.point([-1, -1]), L.point([-1, -1]));\n      }\n    },\n    _clampZoom: function (zoom) {\n      let clamp = L.GridLayer.prototype._clampZoom.call(this, zoom);\n      if (this._template.step > this.options.maxNativeZoom)\n        this._template.step = this.options.maxNativeZoom;\n\n      if (zoom !== clamp) {\n        zoom = clamp;\n      } else {\n        if (zoom % this._template.step !== 0) {\n          zoom = Math.floor(zoom / this._template.step) * this._template.step;\n        }\n      }\n      return zoom;\n    }\n  });\n  var templatedTileLayer = function (template, options) {\n    return new TemplatedTileLayer(template, options);\n  };\n\n  var ExtentLayer = L.LayerGroup.extend({\n    initialize: function (options) {\n      // TODO: should invoke prototype.initialize to trigger the leaflet initialization for proper setup\n      //       otherwise the initialize we provide will override the init that leaflet provides\n      //       but we still need to create the container and the pane by ourselves\n      L.LayerGroup.prototype.initialize.call(this, null, options);\n      this._container = L.DomUtil.create('div', 'leaflet-layer');\n      this._extentEl = this.options.extentEl;\n      this.changeOpacity(this.options.opacity);\n      // TODO: need renaming ex. mapml-extentLayer-container\n      L.DomUtil.addClass(this._container, 'mapml-extentlayer-container');\n    },\n    getEvents: function () {\n      return {\n        zoomstart: this._onZoomStart\n      };\n    },\n    _onZoomStart: function () {\n      this.closePopup();\n    },\n    getContainer: function () {\n      return this._container;\n    },\n    onAdd: function (map) {\n      L.LayerGroup.prototype.onAdd.call(this, map);\n      let pane = this.options.extentEl.parentLayer._layer._container;\n      pane.appendChild(this._container);\n    },\n    redraw: function () {\n      this.eachLayer(function (layer) {\n        layer.redraw();\n      });\n    },\n    //addTo: function(map) {\n    //for(let i = 0; i < this._templates.length; i++){\n    //    this._templates[0].layer.addTo(map);\n    //}\n    //},\n    setZIndex: function (zIndex) {\n      this.options.zIndex = zIndex;\n      this._updateZIndex();\n\n      return this;\n    },\n    _updateZIndex: function () {\n      if (\n        this._container &&\n        this.options.zIndex !== undefined &&\n        this.options.zIndex !== null\n      ) {\n        this._container.style.zIndex = this.options.zIndex;\n      }\n    },\n    onRemove: function () {\n      L.LayerGroup.prototype.onRemove.call(this, this._map);\n      L.DomUtil.remove(this._container);\n    },\n\n    _previousFeature: function (e) {\n      if (this._count + -1 >= 0) {\n        this._count--;\n        this._map.fire('featurepagination', {\n          i: this._count,\n          popup: this\n        });\n      }\n    },\n\n    _nextFeature: function (e) {\n      if (this._count + 1 < this._source._totalFeatureCount) {\n        this._count++;\n        this._map.fire('featurepagination', {\n          i: this._count,\n          popup: this\n        });\n      }\n    },\n\n    changeOpacity: function (opacity) {\n      this._container.style.opacity = opacity;\n      this._extentEl._opacity = opacity;\n      if (this._extentEl._opacitySlider)\n        this._extentEl._opacitySlider.value = opacity;\n    },\n    appendStyleLink: function (mapLink) {\n      if (!mapLink.link) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapLink.link\n      );\n    },\n    _getStylePositionAndNode: function () {\n      return this._container.lastChild &&\n        (this._container.lastChild.nodeName.toUpperCase() === 'SVG' ||\n          this._container.lastChild.classList.contains('mapml-vector-container'))\n        ? { position: 'beforebegin', node: this._container.lastChild }\n        : this._container.lastChild\n        ? { position: 'afterend', node: this._container.lastChild }\n        : { position: 'afterbegin', node: this._container };\n    },\n    appendStyleElement: function (mapStyle) {\n      if (!mapStyle.styleElement) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapStyle.styleElement\n      );\n    }\n  });\n  var extentLayer = function (options) {\n    return new ExtentLayer(options);\n  };\n\n  var TemplatedFeaturesLayer = L.Layer.extend({\n    // this and M.ImageLayer could be merged or inherit from a common parent\n    initialize: function (template, options) {\n      this._template = template;\n      this._container = L.DomUtil.create('div', 'leaflet-layer');\n      L.DomUtil.addClass(this._container, 'mapml-features-container');\n      this.zoomBounds = options.zoomBounds;\n      this.extentBounds = options.extentBounds;\n      // get rid of duplicate info, it can be confusing\n      delete options.zoomBounds;\n      delete options.extentBounds;\n      this._linkEl = options.linkEl;\n      L.setOptions(\n        this,\n        L.extend(options, this._setUpFeaturesTemplateVars(template))\n      );\n    },\n\n    isVisible: function () {\n      let map = this._linkEl.getMapEl()._map;\n      let mapZoom = map.getZoom();\n      let mapBounds = M.pixelToPCRSBounds(\n        map.getPixelBounds(),\n        mapZoom,\n        map.options.projection\n      );\n      return (\n        mapZoom <= this.zoomBounds.maxZoom &&\n        mapZoom >= this.zoomBounds.minZoom &&\n        this.extentBounds.overlaps(mapBounds)\n      );\n    },\n\n    getEvents: function () {\n      var events = {\n        moveend: this._onMoveEnd\n      };\n      return events;\n    },\n    onAdd: function (map) {\n      this._map = map;\n      // this causes the layer (this._features) to actually render...\n      this.options.pane.appendChild(this._container);\n      var opacity = this.options.opacity || 1,\n        container = this._container;\n      if (!this._features) {\n        this._features = M.featureLayer(null, {\n          // pass the vector layer a renderer of its own, otherwise leaflet\n          // puts everything into the overlayPane\n          renderer: M.featureRenderer(),\n          // pass the vector layer the container for the parent into which\n          // it will append its own container for rendering into\n          pane: container,\n          // the bounds will be static, fixed, constant for the lifetime of the layer\n          layerBounds: this.extentBounds,\n          zoomBounds: this.zoomBounds,\n          opacity: opacity,\n          projection: map.options.projection,\n          mapEl: this._linkEl.getMapEl(),\n          onEachFeature: function (properties, geometry) {\n            // need to parse as HTML to preserve semantics and styles\n            var c = document.createElement('div');\n            c.classList.add('mapml-popup-content');\n            c.insertAdjacentHTML('afterbegin', properties.innerHTML);\n            geometry.bindPopup(c, { autoClose: false, minWidth: 108 });\n          }\n        });\n      } else {\n        this._features.eachLayer((layer) => layer.addTo(map));\n      }\n      this._onMoveEnd();\n    },\n    onRemove: function () {\n      if (this._features) this._features.eachLayer((layer) => layer.remove());\n      L.DomUtil.remove(this._container);\n    },\n    appendStyleLink: function (mapLink) {\n      if (!mapLink.link) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapLink.link\n      );\n    },\n    _getStylePositionAndNode: function () {\n      return this._container.lastChild &&\n        (this._container.lastChild.nodeName.toUpperCase() === 'SVG' ||\n          this._container.lastChild.classList.contains('mapml-vector-container'))\n        ? { position: 'beforebegin', node: this._container.lastChild }\n        : this._container.lastChild\n        ? { position: 'afterend', node: this._container.lastChild }\n        : { position: 'afterbegin', node: this._container };\n    },\n    appendStyleElement: function (mapStyle) {\n      if (!mapStyle.styleElement) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapStyle.styleElement\n      );\n    },\n    redraw: function () {\n      this._onMoveEnd();\n    },\n\n    _removeCSS: function () {\n      let toDelete = this._container.querySelectorAll(\n        'link[rel=stylesheet],style'\n      );\n      for (let i = 0; i < toDelete.length; i++) {\n        let parent = toDelete[i].parentNode;\n        parent.removeChild(toDelete[i]);\n      }\n    },\n\n    _onMoveEnd: function () {\n      let history = this._map.options.mapEl._history;\n      let current = history[history.length - 1];\n      let previous = history[history.length - 2] ?? current;\n      let step = this._template.step;\n      let mapZoom = this._map.getZoom();\n      let steppedZoom = mapZoom;\n      //If zooming out from one step interval into a lower one or panning, set the stepped zoom\n      if (\n        (step !== '1' &&\n          (mapZoom + 1) % step === 0 &&\n          current.zoom === previous.zoom - 1) ||\n        current.zoom === previous.zoom ||\n        Math.floor(mapZoom / step) * step !==\n          Math.floor(previous.zoom / step) * step\n      ) {\n        steppedZoom = Math.floor(mapZoom / step) * step;\n      }\n      //No request needed if in a step interval (unless panning)\n      else if (mapZoom % this._template.step !== 0) return;\n\n      let scaleBounds = this._map.getPixelBounds(\n        this._map.getCenter(),\n        steppedZoom\n      );\n\n      // should set this.isVisible properly BEFORE return, otherwise will cause layer-.validateDisabled not work properly\n      let url = this._getfeaturesUrl(steppedZoom, scaleBounds);\n      // No request needed if the current template url is the same as the url to request\n      if (url === this._url) return;\n\n      // do cleaning up for new request\n      this._features.clearLayers();\n      // shadow may has not yet attached to <map-extent> for the first-time rendering\n      if (this._linkEl.shadowRoot) {\n        this._linkEl.shadowRoot.innerHTML = '';\n      }\n      this._removeCSS();\n      //Leave the layers cleared if the layer is not visible\n      if (!this.isVisible() && steppedZoom === mapZoom) {\n        this._url = '';\n        return;\n      }\n\n      // TODO add preference with a bit less weight than that for text/mapml; 0.8 for application/geo+json; 0.6\n      var mapml,\n        headers = new Headers({\n          Accept: 'text/mapml;q=0.9,application/geo+json;q=0.8'\n        }),\n        parser = new DOMParser(),\n        featureLayer = this._features,\n        linkEl = this._linkEl,\n        map = this._map,\n        context = this,\n        MAX_PAGES = 10,\n        // TODO: Fetching logic should migrate to map-link\n        _pullFeatureFeed = function (url, limit) {\n          return fetch(url, { redirect: 'follow', headers: headers })\n            .then(function (response) {\n              return response.text();\n            })\n            .then(function (text) {\n              //TODO wrap this puppy in a try/catch/finally to parse application/geo+json if necessary\n              mapml = parser.parseFromString(text, 'application/xml');\n              var base = new URL(\n                mapml.querySelector('map-base')\n                  ? mapml.querySelector('map-base').getAttribute('href')\n                  : url\n              ).href;\n              url = mapml.querySelector('map-link[rel=next]')\n                ? mapml.querySelector('map-link[rel=next]').getAttribute('href')\n                : null;\n              url = url ? new URL(url, base).href : null;\n              let frag = document.createDocumentFragment();\n              let elements = mapml.querySelectorAll('map-head > *, map-body > *');\n              for (let i = 0; i < elements.length; i++) {\n                frag.appendChild(elements[i]);\n              }\n              linkEl.shadowRoot.appendChild(frag);\n              let features = linkEl.shadowRoot.querySelectorAll('map-feature');\n              let featuresReady = [];\n              for (let i = 0; i < features.length; i++) {\n                featuresReady.push(features[i].whenReady());\n              }\n              Promise.allSettled(featuresReady).then(() => {\n                for (let i = 0; i < features.length; i++) {\n                  features[i].addFeature(featureLayer);\n                }\n              });\n              if (url && --limit) {\n                return _pullFeatureFeed(url, limit);\n              }\n            });\n        };\n      this._url = url;\n      _pullFeatureFeed(url, MAX_PAGES)\n        .then(function () {\n          map.addLayer(featureLayer);\n          //Fires event for feature index overlay\n          map.fire('templatedfeatureslayeradd');\n          M.TemplatedFeaturesLayer.prototype._updateTabIndex(context);\n        })\n        .catch(function (error) {\n          console.log(error);\n        });\n    },\n    setZIndex: function (zIndex) {\n      this.options.zIndex = zIndex;\n      this._updateZIndex();\n      return this;\n    },\n    _updateTabIndex: function (context) {\n      let c = context || this;\n      for (let layerNum in c._features._layers) {\n        let layer = c._features._layers[layerNum];\n        if (layer._path) {\n          if (layer._path.getAttribute('d') !== 'M0 0') {\n            layer._path.setAttribute('tabindex', 0);\n          } else {\n            layer._path.removeAttribute('tabindex');\n          }\n          if (layer._path.childElementCount === 0) {\n            let title = document.createElement('title');\n            title.innerText = 'Feature';\n            layer._path.appendChild(title);\n          }\n        }\n      }\n    },\n    _updateZIndex: function () {\n      if (\n        this._container &&\n        this.options.zIndex !== undefined &&\n        this.options.zIndex !== null\n      ) {\n        this._container.style.zIndex = this.options.zIndex;\n      }\n    },\n    _getfeaturesUrl: function (zoom, bounds) {\n      if (zoom === undefined) zoom = this._map.getZoom();\n      if (bounds === undefined) bounds = this._map.getPixelBounds();\n      var obj = {};\n      if (this.options.feature.zoom) {\n        obj[this.options.feature.zoom] = zoom;\n      }\n      if (this.options.feature.width) {\n        obj[this.options.feature.width] = this._map.getSize().x;\n      }\n      if (this.options.feature.height) {\n        obj[this.options.feature.height] = this._map.getSize().y;\n      }\n      if (this.options.feature.bottom) {\n        obj[this.options.feature.bottom] = this._TCRSToPCRS(bounds.max, zoom).y;\n      }\n      if (this.options.feature.left) {\n        obj[this.options.feature.left] = this._TCRSToPCRS(bounds.min, zoom).x;\n      }\n      if (this.options.feature.top) {\n        obj[this.options.feature.top] = this._TCRSToPCRS(bounds.min, zoom).y;\n      }\n      if (this.options.feature.right) {\n        obj[this.options.feature.right] = this._TCRSToPCRS(bounds.max, zoom).x;\n      }\n      // hidden and other variables that may be associated\n      for (var v in this.options.feature) {\n        if (\n          ['width', 'height', 'left', 'right', 'top', 'bottom', 'zoom'].indexOf(\n            v\n          ) < 0\n        ) {\n          obj[v] = this.options.feature[v];\n        }\n      }\n      return L.Util.template(this._template.template, obj);\n    },\n    _TCRSToPCRS: function (coords, zoom) {\n      // TCRS pixel point to Projected CRS point (in meters, presumably)\n      var map = this._map,\n        crs = map.options.crs,\n        loc = crs.transformation.untransform(coords, crs.scale(zoom));\n      return loc;\n    },\n    _setUpFeaturesTemplateVars: function (template) {\n      // process the inputs and create an object named \"extent\"\n      // with member properties as follows:\n      // {width: {name: 'widthvarname'}, // value supplied by map if necessary\n      //  height: {name: 'heightvarname'}, // value supplied by map if necessary\n      //  left: {name: 'leftvarname', axis: 'leftaxisname'}, // axis name drives (coordinate system of) the value supplied by the map\n      //  right: {name: 'rightvarname', axis: 'rightaxisname'}, // axis name (coordinate system of) drives the value supplied by the map\n      //  top: {name: 'topvarname', axis: 'topaxisname'}, // axis name drives (coordinate system of) the value supplied by the map\n      //  bottom: {name: 'bottomvarname', axis: 'bottomaxisname'} // axis name drives (coordinate system of) the value supplied by the map\n      //  zoom: {name: 'zoomvarname'}\n      //  hidden: [{name: name, value: value}]}\n\n      var featuresVarNames = { feature: {} },\n        inputs = template.values;\n      featuresVarNames.feature.hidden = [];\n      for (var i = 0; i < inputs.length; i++) {\n        // this can be removed when the spec removes the deprecated inputs...\n        var type = inputs[i].getAttribute('type'),\n          units = inputs[i].getAttribute('units'),\n          axis = inputs[i].getAttribute('axis'),\n          name = inputs[i].getAttribute('name'),\n          position = inputs[i].getAttribute('position'),\n          value = inputs[i].getAttribute('value'),\n          select = inputs[i].tagName.toLowerCase() === 'map-select';\n        if (type === 'width') {\n          featuresVarNames.feature.width = name;\n        } else if (type === 'height') {\n          featuresVarNames.feature.height = name;\n        } else if (type === 'zoom') {\n          featuresVarNames.feature.zoom = name;\n        } else if (\n          type === 'location' &&\n          (units === 'pcrs' || units === 'gcrs')\n        ) {\n          //<input name=\"...\" units=\"pcrs\" type=\"location\" position=\"top|bottom-left|right\" axis=\"northing|easting\">\n          switch (axis) {\n            case 'x':\n            case 'longitude':\n            case 'easting':\n              if (position) {\n                if (position.match(/.*?-left/i)) {\n                  featuresVarNames.feature.left = name;\n                } else if (position.match(/.*?-right/i)) {\n                  featuresVarNames.feature.right = name;\n                }\n              }\n              break;\n            case 'y':\n            case 'latitude':\n            case 'northing':\n              if (position) {\n                if (position.match(/top-.*?/i)) {\n                  featuresVarNames.feature.top = name;\n                } else if (position.match(/bottom-.*?/i)) {\n                  featuresVarNames.feature.bottom = name;\n                }\n              }\n              break;\n          }\n        } else if (select) {\n          /*jshint -W104 */\n          const parsedselect = inputs[i].htmlselect;\n          featuresVarNames.feature[name] = function () {\n            return parsedselect.value;\n          };\n          // projection is deprecated, make it hidden\n        } else {\n          /*jshint -W104 */\n          const input = inputs[i];\n          featuresVarNames.feature[name] = function () {\n            return input.getAttribute('value');\n          };\n        }\n      }\n      return featuresVarNames;\n    }\n  });\n  var templatedFeaturesLayer = function (template, options) {\n    return new TemplatedFeaturesLayer(template, options);\n  };\n\n  var TemplatedImageLayer = L.Layer.extend({\n    initialize: function (template, options) {\n      this._template = template;\n      this._container = L.DomUtil.create('div', 'leaflet-layer');\n      L.DomUtil.addClass(this._container, 'mapml-image-container');\n      this._linkEl = options.linkEl;\n      this.zoomBounds = options.zoomBounds;\n      this.extentBounds = options.extentBounds;\n      // get rid of unused duplicate information that can be confusing\n      delete options.zoomBounds;\n      delete options.extentBounds;\n      L.setOptions(\n        this,\n        L.extend(options, this._setUpExtentTemplateVars(template))\n      );\n    },\n    getEvents: function () {\n      var events = {\n        moveend: this._onMoveEnd,\n        zoomstart: this._clearLayer\n      };\n      return events;\n    },\n    onAdd: function (map) {\n      this._map = map;\n      // TODO: set this._map by ourselves\n      this.options.pane.appendChild(this._container);\n      this.setZIndex(this.options.zIndex);\n      this._onAdd();\n    },\n    redraw: function () {\n      this._onMoveEnd();\n    },\n    isVisible: function () {\n      let map = this._linkEl.getMapEl()._map;\n      let mapZoom = map.getZoom();\n      let mapBounds = M.pixelToPCRSBounds(\n        map.getPixelBounds(),\n        mapZoom,\n        map.options.projection\n      );\n      return (\n        mapZoom <= this.zoomBounds.maxZoom &&\n        mapZoom >= this.zoomBounds.minZoom &&\n        this.extentBounds.overlaps(mapBounds)\n      );\n    },\n    _clearLayer: function () {\n      let containerImages = this._container.querySelectorAll('img');\n      for (let i = 0; i < containerImages.length; i++) {\n        this._container.removeChild(containerImages[i]);\n      }\n    },\n\n    _addImage: function (bounds, zoom, loc) {\n      let map = this._map;\n      let overlayToRemove = this._imageOverlay;\n      let src = this.getImageUrl(bounds, zoom);\n      let size = map.getSize();\n      this._imageOverlay = M.imageLayer(src, loc, size, 0, this._container);\n      this._imageOverlay._step = this._template.step;\n      this._imageOverlay.addTo(map);\n      if (overlayToRemove) {\n        this._imageOverlay._overlayToRemove = overlayToRemove._url;\n        this._imageOverlay.on('load error', function () {\n          map.removeLayer(overlayToRemove);\n        });\n      }\n    },\n\n    _scaleImage: function (bounds, zoom) {\n      let obj = this;\n      setTimeout(function () {\n        if (!obj._map) return;\n        let step = obj._template.step;\n        let steppedZoom = Math.floor(zoom / step) * step;\n        let scale = obj._map.getZoomScale(zoom, steppedZoom);\n        let translate = bounds.min\n          .multiplyBy(scale)\n          .subtract(obj._map._getNewPixelOrigin(obj._map.getCenter(), zoom))\n          .round();\n        L.DomUtil.setTransform(obj._imageOverlay._image, translate, scale);\n      });\n    },\n\n    _onAdd: function () {\n      let zoom = this._map.getZoom();\n      let steppedZoom = zoom;\n      let step = this._template.step;\n\n      if (zoom % step !== 0) steppedZoom = Math.floor(zoom / step) * step;\n      let bounds = this._map.getPixelBounds(this._map.getCenter(), steppedZoom);\n      this._pixelOrigins = {};\n      this._pixelOrigins[steppedZoom] = bounds.min;\n      // if the map is panned before the new image layer is added,\n      // the location that the layer should be added to is no longer (0,0) but need to be calculated\n      let loc = this._map\n        .getPixelBounds()\n        .min.subtract(this._map.getPixelOrigin());\n      this._addImage(bounds, steppedZoom, loc);\n      if (zoom !== steppedZoom) {\n        this._scaleImage(bounds, zoom);\n      }\n    },\n\n    _onMoveEnd: function (e) {\n      let mapZoom = this._map.getZoom();\n      let history = this._map.options.mapEl._history;\n      let current = history[history.length - 1];\n      let previous = history[history.length - 2];\n      if (!previous) previous = current;\n      let step = this._template.step;\n      let steppedZoom = Math.floor(mapZoom / step) * step;\n      let bounds = this._map.getPixelBounds(this._map.getCenter(), steppedZoom);\n      //Zooming from one step increment into a lower one\n      if (\n        step !== '1' &&\n        (mapZoom + 1) % step === 0 &&\n        current.zoom === previous.zoom - 1\n      ) {\n        this._addImage(bounds, steppedZoom, L.point(0, 0));\n        this._scaleImage(bounds, mapZoom);\n        //Zooming or panning within a step increment\n      } else if (e && mapZoom % step !== 0) {\n        this._imageOverlay._overlayToRemove = this._imageOverlay._url;\n        if (current.zoom !== previous.zoom) {\n          //Zoomed from within one step increment into another\n          this._addImage(bounds, steppedZoom, L.point(0, 0));\n          this._pixelOrigins[steppedZoom] = bounds.min;\n          this._scaleImage(bounds, mapZoom);\n        } else {\n          // Panning within a step increment\n          let pixelOrigin = this._pixelOrigins[steppedZoom];\n          let loc = bounds.min.subtract(pixelOrigin);\n          if (this.getImageUrl(bounds, steppedZoom) === this._imageOverlay._url)\n            return;\n          this._addImage(bounds, steppedZoom, loc);\n          this._scaleImage(bounds, mapZoom);\n        }\n        // Zooming from one step decrement into a higher one\n        // OR panning when mapZoom % step === 0\n      } else {\n        if (!this.isVisible) {\n          this._clearLayer();\n          return;\n        }\n        var map = this._map,\n          loc = map.getPixelBounds().min.subtract(map.getPixelOrigin());\n        this._addImage(map.getPixelBounds(), mapZoom, loc);\n        this._pixelOrigins[mapZoom] = map.getPixelOrigin();\n      }\n    },\n    setZIndex: function (zIndex) {\n      this.options.zIndex = zIndex;\n      this._updateZIndex();\n\n      return this;\n    },\n    _updateZIndex: function () {\n      if (\n        this._container &&\n        this.options.zIndex !== undefined &&\n        this.options.zIndex !== null\n      ) {\n        this._container.style.zIndex = this.options.zIndex;\n      }\n    },\n    onRemove: function (map) {\n      L.DomUtil.remove(this._container);\n      this._clearLayer();\n    },\n    getImageUrl: function (pixelBounds, zoom) {\n      var obj = {};\n      obj[this.options.extent.width] = this._map.getSize().x;\n      obj[this.options.extent.height] = this._map.getSize().y;\n      obj[this.options.extent.bottom] = this._TCRSToPCRS(pixelBounds.max, zoom).y;\n      obj[this.options.extent.left] = this._TCRSToPCRS(pixelBounds.min, zoom).x;\n      obj[this.options.extent.top] = this._TCRSToPCRS(pixelBounds.min, zoom).y;\n      obj[this.options.extent.right] = this._TCRSToPCRS(pixelBounds.max, zoom).x;\n      // hidden and other variables that may be associated\n      for (var v in this.options.extent) {\n        if (\n          ['width', 'height', 'left', 'right', 'top', 'bottom'].indexOf(v) < 0\n        ) {\n          obj[v] = this.options.extent[v];\n        }\n      }\n      return L.Util.template(this._template.template, obj);\n    },\n    _TCRSToPCRS: function (coords, zoom) {\n      // TCRS pixel point to Projected CRS point (in meters, presumably)\n      var map = this._map,\n        crs = map.options.crs,\n        loc = crs.transformation.untransform(coords, crs.scale(zoom));\n      return loc;\n    },\n    _setUpExtentTemplateVars: function (template) {\n      // process the inputs associated to template and create an object named\n      // extent with member properties as follows:\n      // {width: 'widthvarname',\n      //  height: 'heightvarname',\n      //  left: 'leftvarname',\n      //  right: 'rightvarname',\n      //  top: 'topvarname',\n      //  bottom: 'bottomvarname'}\n\n      var extentVarNames = { extent: {} },\n        inputs = template.values;\n\n      for (var i = 0; i < template.values.length; i++) {\n        var type = inputs[i].getAttribute('type'),\n          units = inputs[i].getAttribute('units'),\n          axis = inputs[i].getAttribute('axis'),\n          name = inputs[i].getAttribute('name'),\n          position = inputs[i].getAttribute('position'),\n          select = inputs[i].tagName.toLowerCase() === 'map-select';\n        if (type === 'width') {\n          extentVarNames.extent.width = name;\n        } else if (type === 'height') {\n          extentVarNames.extent.height = name;\n        } else if (\n          type === 'location' &&\n          (units === 'pcrs' || units === 'gcrs')\n        ) {\n          //<input name=\"...\" units=\"pcrs\" type=\"location\" position=\"top|bottom-left|right\" axis=\"northing|easting|latitude|longitude\">\n          switch (axis) {\n            case 'longitude':\n            case 'easting':\n              if (position) {\n                if (position.match(/.*?-left/i)) {\n                  extentVarNames.extent.left = name;\n                } else if (position.match(/.*?-right/i)) {\n                  extentVarNames.extent.right = name;\n                }\n              }\n              break;\n            case 'latitude':\n            case 'northing':\n              if (position) {\n                if (position.match(/top-.*?/i)) {\n                  extentVarNames.extent.top = name;\n                } else if (position.match(/bottom-.*?/i)) {\n                  extentVarNames.extent.bottom = name;\n                }\n              }\n              break;\n          }\n        } else if (select) {\n          /*jshint -W104 */\n          const parsedselect = inputs[i].htmlselect;\n          extentVarNames.extent[name] = function () {\n            return parsedselect.value;\n          };\n        } else {\n          /*jshint -W104 */\n          const input = inputs[i];\n          extentVarNames.extent[name] = function () {\n            return input.getAttribute('value');\n          };\n        }\n      }\n      return extentVarNames;\n    }\n  });\n  var templatedImageLayer = function (template, options) {\n    return new TemplatedImageLayer(template, options);\n  };\n\n  var __create = Object.create;\n  var __defProp = Object.defineProperty;\n  var __getOwnPropDesc = Object.getOwnPropertyDescriptor;\n  var __getOwnPropNames = Object.getOwnPropertyNames;\n  var __getProtoOf = Object.getPrototypeOf;\n  var __hasOwnProp = Object.prototype.hasOwnProperty;\n  var __pow = Math.pow;\n  var __commonJS = (cb, mod) => function __require() {\n    return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;\n  };\n  var __copyProps = (to, from, except, desc) => {\n    if (from && typeof from === \"object\" || typeof from === \"function\") {\n      for (let key of __getOwnPropNames(from))\n        if (!__hasOwnProp.call(to, key) && key !== except)\n          __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n    }\n    return to;\n  };\n  var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(\n    isNodeMode || !mod || !mod.__esModule ? __defProp(target, \"default\", { value: mod, enumerable: true }) : target,\n    mod\n  ));\n  var __async = (__this, __arguments, generator) => {\n    return new Promise((resolve, reject) => {\n      var fulfilled = (value) => {\n        try {\n          step2(generator.next(value));\n        } catch (e) {\n          reject(e);\n        }\n      };\n      var rejected = (value) => {\n        try {\n          step2(generator.throw(value));\n        } catch (e) {\n          reject(e);\n        }\n      };\n      var step2 = (x2) => x2.done ? resolve(x2.value) : Promise.resolve(x2.value).then(fulfilled, rejected);\n      step2((generator = generator.apply(__this, __arguments)).next());\n    });\n  };\n\n  // node_modules/@mapbox/point-geometry/index.js\n  var require_point_geometry = __commonJS({\n    \"node_modules/@mapbox/point-geometry/index.js\"(exports, module) {\n      module.exports = Point9;\n      function Point9(x2, y) {\n        this.x = x2;\n        this.y = y;\n      }\n      Point9.prototype = {\n        clone: function() {\n          return new Point9(this.x, this.y);\n        },\n        add: function(p) {\n          return this.clone()._add(p);\n        },\n        sub: function(p) {\n          return this.clone()._sub(p);\n        },\n        multByPoint: function(p) {\n          return this.clone()._multByPoint(p);\n        },\n        divByPoint: function(p) {\n          return this.clone()._divByPoint(p);\n        },\n        mult: function(k) {\n          return this.clone()._mult(k);\n        },\n        div: function(k) {\n          return this.clone()._div(k);\n        },\n        rotate: function(a) {\n          return this.clone()._rotate(a);\n        },\n        rotateAround: function(a, p) {\n          return this.clone()._rotateAround(a, p);\n        },\n        matMult: function(m) {\n          return this.clone()._matMult(m);\n        },\n        unit: function() {\n          return this.clone()._unit();\n        },\n        perp: function() {\n          return this.clone()._perp();\n        },\n        round: function() {\n          return this.clone()._round();\n        },\n        mag: function() {\n          return Math.sqrt(this.x * this.x + this.y * this.y);\n        },\n        equals: function(other) {\n          return this.x === other.x && this.y === other.y;\n        },\n        dist: function(p) {\n          return Math.sqrt(this.distSqr(p));\n        },\n        distSqr: function(p) {\n          var dx = p.x - this.x, dy = p.y - this.y;\n          return dx * dx + dy * dy;\n        },\n        angle: function() {\n          return Math.atan2(this.y, this.x);\n        },\n        angleTo: function(b) {\n          return Math.atan2(this.y - b.y, this.x - b.x);\n        },\n        angleWith: function(b) {\n          return this.angleWithSep(b.x, b.y);\n        },\n        angleWithSep: function(x2, y) {\n          return Math.atan2(\n            this.x * y - this.y * x2,\n            this.x * x2 + this.y * y\n          );\n        },\n        _matMult: function(m) {\n          var x2 = m[0] * this.x + m[1] * this.y, y = m[2] * this.x + m[3] * this.y;\n          this.x = x2;\n          this.y = y;\n          return this;\n        },\n        _add: function(p) {\n          this.x += p.x;\n          this.y += p.y;\n          return this;\n        },\n        _sub: function(p) {\n          this.x -= p.x;\n          this.y -= p.y;\n          return this;\n        },\n        _mult: function(k) {\n          this.x *= k;\n          this.y *= k;\n          return this;\n        },\n        _div: function(k) {\n          this.x /= k;\n          this.y /= k;\n          return this;\n        },\n        _multByPoint: function(p) {\n          this.x *= p.x;\n          this.y *= p.y;\n          return this;\n        },\n        _divByPoint: function(p) {\n          this.x /= p.x;\n          this.y /= p.y;\n          return this;\n        },\n        _unit: function() {\n          this._div(this.mag());\n          return this;\n        },\n        _perp: function() {\n          var y = this.y;\n          this.y = this.x;\n          this.x = -y;\n          return this;\n        },\n        _rotate: function(angle) {\n          var cos = Math.cos(angle), sin = Math.sin(angle), x2 = cos * this.x - sin * this.y, y = sin * this.x + cos * this.y;\n          this.x = x2;\n          this.y = y;\n          return this;\n        },\n        _rotateAround: function(angle, p) {\n          var cos = Math.cos(angle), sin = Math.sin(angle), x2 = p.x + cos * (this.x - p.x) - sin * (this.y - p.y), y = p.y + sin * (this.x - p.x) + cos * (this.y - p.y);\n          this.x = x2;\n          this.y = y;\n          return this;\n        },\n        _round: function() {\n          this.x = Math.round(this.x);\n          this.y = Math.round(this.y);\n          return this;\n        }\n      };\n      Point9.convert = function(a) {\n        if (a instanceof Point9) {\n          return a;\n        }\n        if (Array.isArray(a)) {\n          return new Point9(a[0], a[1]);\n        }\n        return a;\n      };\n    }\n  });\n\n  // node_modules/@mapbox/vector-tile/lib/vectortilefeature.js\n  var require_vectortilefeature = __commonJS({\n    \"node_modules/@mapbox/vector-tile/lib/vectortilefeature.js\"(exports, module) {\n      var Point9 = require_point_geometry();\n      module.exports = VectorTileFeature;\n      function VectorTileFeature(pbf, end, extent, keys, values) {\n        this.properties = {};\n        this.extent = extent;\n        this.type = 0;\n        this._pbf = pbf;\n        this._geometry = -1;\n        this._keys = keys;\n        this._values = values;\n        pbf.readFields(readFeature, this, end);\n      }\n      function readFeature(tag, feature, pbf) {\n        if (tag == 1)\n          feature.id = pbf.readVarint();\n        else if (tag == 2)\n          readTag(pbf, feature);\n        else if (tag == 3)\n          feature.type = pbf.readVarint();\n        else if (tag == 4)\n          feature._geometry = pbf.pos;\n      }\n      function readTag(pbf, feature) {\n        var end = pbf.readVarint() + pbf.pos;\n        while (pbf.pos < end) {\n          var key = feature._keys[pbf.readVarint()], value = feature._values[pbf.readVarint()];\n          feature.properties[key] = value;\n        }\n      }\n      VectorTileFeature.types = [\"Unknown\", \"Point\", \"LineString\", \"Polygon\"];\n      VectorTileFeature.prototype.loadGeometry = function() {\n        var pbf = this._pbf;\n        pbf.pos = this._geometry;\n        var end = pbf.readVarint() + pbf.pos, cmd = 1, length = 0, x2 = 0, y = 0, lines = [], line;\n        while (pbf.pos < end) {\n          if (length <= 0) {\n            var cmdLen = pbf.readVarint();\n            cmd = cmdLen & 7;\n            length = cmdLen >> 3;\n          }\n          length--;\n          if (cmd === 1 || cmd === 2) {\n            x2 += pbf.readSVarint();\n            y += pbf.readSVarint();\n            if (cmd === 1) {\n              if (line)\n                lines.push(line);\n              line = [];\n            }\n            line.push(new Point9(x2, y));\n          } else if (cmd === 7) {\n            if (line) {\n              line.push(line[0].clone());\n            }\n          } else {\n            throw new Error(\"unknown command \" + cmd);\n          }\n        }\n        if (line)\n          lines.push(line);\n        return lines;\n      };\n      VectorTileFeature.prototype.bbox = function() {\n        var pbf = this._pbf;\n        pbf.pos = this._geometry;\n        var end = pbf.readVarint() + pbf.pos, cmd = 1, length = 0, x2 = 0, y = 0, x1 = Infinity, x22 = -Infinity, y1 = Infinity, y2 = -Infinity;\n        while (pbf.pos < end) {\n          if (length <= 0) {\n            var cmdLen = pbf.readVarint();\n            cmd = cmdLen & 7;\n            length = cmdLen >> 3;\n          }\n          length--;\n          if (cmd === 1 || cmd === 2) {\n            x2 += pbf.readSVarint();\n            y += pbf.readSVarint();\n            if (x2 < x1)\n              x1 = x2;\n            if (x2 > x22)\n              x22 = x2;\n            if (y < y1)\n              y1 = y;\n            if (y > y2)\n              y2 = y;\n          } else if (cmd !== 7) {\n            throw new Error(\"unknown command \" + cmd);\n          }\n        }\n        return [x1, y1, x22, y2];\n      };\n      VectorTileFeature.prototype.toGeoJSON = function(x2, y, z) {\n        var size = this.extent * Math.pow(2, z), x0 = this.extent * x2, y0 = this.extent * y, coords = this.loadGeometry(), type = VectorTileFeature.types[this.type], i2, j;\n        function project3(line) {\n          for (var j2 = 0; j2 < line.length; j2++) {\n            var p = line[j2], y2 = 180 - (p.y + y0) * 360 / size;\n            line[j2] = [\n              (p.x + x0) * 360 / size - 180,\n              360 / Math.PI * Math.atan(Math.exp(y2 * Math.PI / 180)) - 90\n            ];\n          }\n        }\n        switch (this.type) {\n          case 1:\n            var points = [];\n            for (i2 = 0; i2 < coords.length; i2++) {\n              points[i2] = coords[i2][0];\n            }\n            coords = points;\n            project3(coords);\n            break;\n          case 2:\n            for (i2 = 0; i2 < coords.length; i2++) {\n              project3(coords[i2]);\n            }\n            break;\n          case 3:\n            coords = classifyRings(coords);\n            for (i2 = 0; i2 < coords.length; i2++) {\n              for (j = 0; j < coords[i2].length; j++) {\n                project3(coords[i2][j]);\n              }\n            }\n            break;\n        }\n        if (coords.length === 1) {\n          coords = coords[0];\n        } else {\n          type = \"Multi\" + type;\n        }\n        var result = {\n          type: \"Feature\",\n          geometry: {\n            type,\n            coordinates: coords\n          },\n          properties: this.properties\n        };\n        if (\"id\" in this) {\n          result.id = this.id;\n        }\n        return result;\n      };\n      function classifyRings(rings) {\n        var len = rings.length;\n        if (len <= 1)\n          return [rings];\n        var polygons = [], polygon, ccw;\n        for (var i2 = 0; i2 < len; i2++) {\n          var area = signedArea(rings[i2]);\n          if (area === 0)\n            continue;\n          if (ccw === void 0)\n            ccw = area < 0;\n          if (ccw === area < 0) {\n            if (polygon)\n              polygons.push(polygon);\n            polygon = [rings[i2]];\n          } else {\n            polygon.push(rings[i2]);\n          }\n        }\n        if (polygon)\n          polygons.push(polygon);\n        return polygons;\n      }\n      function signedArea(ring) {\n        var sum = 0;\n        for (var i2 = 0, len = ring.length, j = len - 1, p1, p2; i2 < len; j = i2++) {\n          p1 = ring[i2];\n          p2 = ring[j];\n          sum += (p2.x - p1.x) * (p1.y + p2.y);\n        }\n        return sum;\n      }\n    }\n  });\n\n  // node_modules/@mapbox/vector-tile/lib/vectortilelayer.js\n  var require_vectortilelayer = __commonJS({\n    \"node_modules/@mapbox/vector-tile/lib/vectortilelayer.js\"(exports, module) {\n      var VectorTileFeature = require_vectortilefeature();\n      module.exports = VectorTileLayer;\n      function VectorTileLayer(pbf, end) {\n        this.version = 1;\n        this.name = null;\n        this.extent = 4096;\n        this.length = 0;\n        this._pbf = pbf;\n        this._keys = [];\n        this._values = [];\n        this._features = [];\n        pbf.readFields(readLayer, this, end);\n        this.length = this._features.length;\n      }\n      function readLayer(tag, layer, pbf) {\n        if (tag === 15)\n          layer.version = pbf.readVarint();\n        else if (tag === 1)\n          layer.name = pbf.readString();\n        else if (tag === 5)\n          layer.extent = pbf.readVarint();\n        else if (tag === 2)\n          layer._features.push(pbf.pos);\n        else if (tag === 3)\n          layer._keys.push(pbf.readString());\n        else if (tag === 4)\n          layer._values.push(readValueMessage(pbf));\n      }\n      function readValueMessage(pbf) {\n        var value = null, end = pbf.readVarint() + pbf.pos;\n        while (pbf.pos < end) {\n          var tag = pbf.readVarint() >> 3;\n          value = tag === 1 ? pbf.readString() : tag === 2 ? pbf.readFloat() : tag === 3 ? pbf.readDouble() : tag === 4 ? pbf.readVarint64() : tag === 5 ? pbf.readVarint() : tag === 6 ? pbf.readSVarint() : tag === 7 ? pbf.readBoolean() : null;\n        }\n        return value;\n      }\n      VectorTileLayer.prototype.feature = function(i2) {\n        if (i2 < 0 || i2 >= this._features.length)\n          throw new Error(\"feature index out of bounds\");\n        this._pbf.pos = this._features[i2];\n        var end = this._pbf.readVarint() + this._pbf.pos;\n        return new VectorTileFeature(this._pbf, end, this.extent, this._keys, this._values);\n      };\n    }\n  });\n\n  // node_modules/@mapbox/vector-tile/lib/vectortile.js\n  var require_vectortile = __commonJS({\n    \"node_modules/@mapbox/vector-tile/lib/vectortile.js\"(exports, module) {\n      var VectorTileLayer = require_vectortilelayer();\n      module.exports = VectorTile2;\n      function VectorTile2(pbf, end) {\n        this.layers = pbf.readFields(readTile, {}, end);\n      }\n      function readTile(tag, layers, pbf) {\n        if (tag === 3) {\n          var layer = new VectorTileLayer(pbf, pbf.readVarint() + pbf.pos);\n          if (layer.length)\n            layers[layer.name] = layer;\n        }\n      }\n    }\n  });\n\n  // node_modules/@mapbox/vector-tile/index.js\n  var require_vector_tile = __commonJS({\n    \"node_modules/@mapbox/vector-tile/index.js\"(exports, module) {\n      module.exports.VectorTile = require_vectortile();\n      module.exports.VectorTileFeature = require_vectortilefeature();\n      module.exports.VectorTileLayer = require_vectortilelayer();\n    }\n  });\n\n  // node_modules/ieee754/index.js\n  var require_ieee754 = __commonJS({\n    \"node_modules/ieee754/index.js\"(exports) {\n      exports.read = function(buffer, offset, isLE, mLen, nBytes) {\n        var e, m;\n        var eLen = nBytes * 8 - mLen - 1;\n        var eMax = (1 << eLen) - 1;\n        var eBias = eMax >> 1;\n        var nBits = -7;\n        var i2 = isLE ? nBytes - 1 : 0;\n        var d = isLE ? -1 : 1;\n        var s = buffer[offset + i2];\n        i2 += d;\n        e = s & (1 << -nBits) - 1;\n        s >>= -nBits;\n        nBits += eLen;\n        for (; nBits > 0; e = e * 256 + buffer[offset + i2], i2 += d, nBits -= 8) {\n        }\n        m = e & (1 << -nBits) - 1;\n        e >>= -nBits;\n        nBits += mLen;\n        for (; nBits > 0; m = m * 256 + buffer[offset + i2], i2 += d, nBits -= 8) {\n        }\n        if (e === 0) {\n          e = 1 - eBias;\n        } else if (e === eMax) {\n          return m ? NaN : (s ? -1 : 1) * Infinity;\n        } else {\n          m = m + Math.pow(2, mLen);\n          e = e - eBias;\n        }\n        return (s ? -1 : 1) * m * Math.pow(2, e - mLen);\n      };\n      exports.write = function(buffer, value, offset, isLE, mLen, nBytes) {\n        var e, m, c;\n        var eLen = nBytes * 8 - mLen - 1;\n        var eMax = (1 << eLen) - 1;\n        var eBias = eMax >> 1;\n        var rt = mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0;\n        var i2 = isLE ? 0 : nBytes - 1;\n        var d = isLE ? 1 : -1;\n        var s = value < 0 || value === 0 && 1 / value < 0 ? 1 : 0;\n        value = Math.abs(value);\n        if (isNaN(value) || value === Infinity) {\n          m = isNaN(value) ? 1 : 0;\n          e = eMax;\n        } else {\n          e = Math.floor(Math.log(value) / Math.LN2);\n          if (value * (c = Math.pow(2, -e)) < 1) {\n            e--;\n            c *= 2;\n          }\n          if (e + eBias >= 1) {\n            value += rt / c;\n          } else {\n            value += rt * Math.pow(2, 1 - eBias);\n          }\n          if (value * c >= 2) {\n            e++;\n            c /= 2;\n          }\n          if (e + eBias >= eMax) {\n            m = 0;\n            e = eMax;\n          } else if (e + eBias >= 1) {\n            m = (value * c - 1) * Math.pow(2, mLen);\n            e = e + eBias;\n          } else {\n            m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen);\n            e = 0;\n          }\n        }\n        for (; mLen >= 8; buffer[offset + i2] = m & 255, i2 += d, m /= 256, mLen -= 8) {\n        }\n        e = e << mLen | m;\n        eLen += mLen;\n        for (; eLen > 0; buffer[offset + i2] = e & 255, i2 += d, e /= 256, eLen -= 8) {\n        }\n        buffer[offset + i2 - d] |= s * 128;\n      };\n    }\n  });\n\n  // node_modules/pbf/index.js\n  var require_pbf = __commonJS({\n    \"node_modules/pbf/index.js\"(exports, module) {\n      module.exports = Pbf;\n      var ieee754 = require_ieee754();\n      function Pbf(buf) {\n        this.buf = ArrayBuffer.isView && ArrayBuffer.isView(buf) ? buf : new Uint8Array(buf || 0);\n        this.pos = 0;\n        this.type = 0;\n        this.length = this.buf.length;\n      }\n      Pbf.Varint = 0;\n      Pbf.Fixed64 = 1;\n      Pbf.Bytes = 2;\n      Pbf.Fixed32 = 5;\n      var SHIFT_LEFT_32 = (1 << 16) * (1 << 16);\n      var SHIFT_RIGHT_32 = 1 / SHIFT_LEFT_32;\n      var TEXT_DECODER_MIN_LENGTH = 12;\n      var utf8TextDecoder = typeof TextDecoder === \"undefined\" ? null : new TextDecoder(\"utf8\");\n      Pbf.prototype = {\n        destroy: function() {\n          this.buf = null;\n        },\n        readFields: function(readField, result, end) {\n          end = end || this.length;\n          while (this.pos < end) {\n            var val = this.readVarint(), tag = val >> 3, startPos = this.pos;\n            this.type = val & 7;\n            readField(tag, result, this);\n            if (this.pos === startPos)\n              this.skip(val);\n          }\n          return result;\n        },\n        readMessage: function(readField, result) {\n          return this.readFields(readField, result, this.readVarint() + this.pos);\n        },\n        readFixed32: function() {\n          var val = readUInt32(this.buf, this.pos);\n          this.pos += 4;\n          return val;\n        },\n        readSFixed32: function() {\n          var val = readInt32(this.buf, this.pos);\n          this.pos += 4;\n          return val;\n        },\n        readFixed64: function() {\n          var val = readUInt32(this.buf, this.pos) + readUInt32(this.buf, this.pos + 4) * SHIFT_LEFT_32;\n          this.pos += 8;\n          return val;\n        },\n        readSFixed64: function() {\n          var val = readUInt32(this.buf, this.pos) + readInt32(this.buf, this.pos + 4) * SHIFT_LEFT_32;\n          this.pos += 8;\n          return val;\n        },\n        readFloat: function() {\n          var val = ieee754.read(this.buf, this.pos, true, 23, 4);\n          this.pos += 4;\n          return val;\n        },\n        readDouble: function() {\n          var val = ieee754.read(this.buf, this.pos, true, 52, 8);\n          this.pos += 8;\n          return val;\n        },\n        readVarint: function(isSigned) {\n          var buf = this.buf, val, b;\n          b = buf[this.pos++];\n          val = b & 127;\n          if (b < 128)\n            return val;\n          b = buf[this.pos++];\n          val |= (b & 127) << 7;\n          if (b < 128)\n            return val;\n          b = buf[this.pos++];\n          val |= (b & 127) << 14;\n          if (b < 128)\n            return val;\n          b = buf[this.pos++];\n          val |= (b & 127) << 21;\n          if (b < 128)\n            return val;\n          b = buf[this.pos];\n          val |= (b & 15) << 28;\n          return readVarintRemainder2(val, isSigned, this);\n        },\n        readVarint64: function() {\n          return this.readVarint(true);\n        },\n        readSVarint: function() {\n          var num = this.readVarint();\n          return num % 2 === 1 ? (num + 1) / -2 : num / 2;\n        },\n        readBoolean: function() {\n          return Boolean(this.readVarint());\n        },\n        readString: function() {\n          var end = this.readVarint() + this.pos;\n          var pos = this.pos;\n          this.pos = end;\n          if (end - pos >= TEXT_DECODER_MIN_LENGTH && utf8TextDecoder) {\n            return readUtf8TextDecoder(this.buf, pos, end);\n          }\n          return readUtf8(this.buf, pos, end);\n        },\n        readBytes: function() {\n          var end = this.readVarint() + this.pos, buffer = this.buf.subarray(this.pos, end);\n          this.pos = end;\n          return buffer;\n        },\n        readPackedVarint: function(arr2, isSigned) {\n          if (this.type !== Pbf.Bytes)\n            return arr2.push(this.readVarint(isSigned));\n          var end = readPackedEnd(this);\n          arr2 = arr2 || [];\n          while (this.pos < end)\n            arr2.push(this.readVarint(isSigned));\n          return arr2;\n        },\n        readPackedSVarint: function(arr2) {\n          if (this.type !== Pbf.Bytes)\n            return arr2.push(this.readSVarint());\n          var end = readPackedEnd(this);\n          arr2 = arr2 || [];\n          while (this.pos < end)\n            arr2.push(this.readSVarint());\n          return arr2;\n        },\n        readPackedBoolean: function(arr2) {\n          if (this.type !== Pbf.Bytes)\n            return arr2.push(this.readBoolean());\n          var end = readPackedEnd(this);\n          arr2 = arr2 || [];\n          while (this.pos < end)\n            arr2.push(this.readBoolean());\n          return arr2;\n        },\n        readPackedFloat: function(arr2) {\n          if (this.type !== Pbf.Bytes)\n            return arr2.push(this.readFloat());\n          var end = readPackedEnd(this);\n          arr2 = arr2 || [];\n          while (this.pos < end)\n            arr2.push(this.readFloat());\n          return arr2;\n        },\n        readPackedDouble: function(arr2) {\n          if (this.type !== Pbf.Bytes)\n            return arr2.push(this.readDouble());\n          var end = readPackedEnd(this);\n          arr2 = arr2 || [];\n          while (this.pos < end)\n            arr2.push(this.readDouble());\n          return arr2;\n        },\n        readPackedFixed32: function(arr2) {\n          if (this.type !== Pbf.Bytes)\n            return arr2.push(this.readFixed32());\n          var end = readPackedEnd(this);\n          arr2 = arr2 || [];\n          while (this.pos < end)\n            arr2.push(this.readFixed32());\n          return arr2;\n        },\n        readPackedSFixed32: function(arr2) {\n          if (this.type !== Pbf.Bytes)\n            return arr2.push(this.readSFixed32());\n          var end = readPackedEnd(this);\n          arr2 = arr2 || [];\n          while (this.pos < end)\n            arr2.push(this.readSFixed32());\n          return arr2;\n        },\n        readPackedFixed64: function(arr2) {\n          if (this.type !== Pbf.Bytes)\n            return arr2.push(this.readFixed64());\n          var end = readPackedEnd(this);\n          arr2 = arr2 || [];\n          while (this.pos < end)\n            arr2.push(this.readFixed64());\n          return arr2;\n        },\n        readPackedSFixed64: function(arr2) {\n          if (this.type !== Pbf.Bytes)\n            return arr2.push(this.readSFixed64());\n          var end = readPackedEnd(this);\n          arr2 = arr2 || [];\n          while (this.pos < end)\n            arr2.push(this.readSFixed64());\n          return arr2;\n        },\n        skip: function(val) {\n          var type = val & 7;\n          if (type === Pbf.Varint)\n            while (this.buf[this.pos++] > 127) {\n            }\n          else if (type === Pbf.Bytes)\n            this.pos = this.readVarint() + this.pos;\n          else if (type === Pbf.Fixed32)\n            this.pos += 4;\n          else if (type === Pbf.Fixed64)\n            this.pos += 8;\n          else\n            throw new Error(\"Unimplemented type: \" + type);\n        },\n        writeTag: function(tag, type) {\n          this.writeVarint(tag << 3 | type);\n        },\n        realloc: function(min) {\n          var length = this.length || 16;\n          while (length < this.pos + min)\n            length *= 2;\n          if (length !== this.length) {\n            var buf = new Uint8Array(length);\n            buf.set(this.buf);\n            this.buf = buf;\n            this.length = length;\n          }\n        },\n        finish: function() {\n          this.length = this.pos;\n          this.pos = 0;\n          return this.buf.subarray(0, this.length);\n        },\n        writeFixed32: function(val) {\n          this.realloc(4);\n          writeInt32(this.buf, val, this.pos);\n          this.pos += 4;\n        },\n        writeSFixed32: function(val) {\n          this.realloc(4);\n          writeInt32(this.buf, val, this.pos);\n          this.pos += 4;\n        },\n        writeFixed64: function(val) {\n          this.realloc(8);\n          writeInt32(this.buf, val & -1, this.pos);\n          writeInt32(this.buf, Math.floor(val * SHIFT_RIGHT_32), this.pos + 4);\n          this.pos += 8;\n        },\n        writeSFixed64: function(val) {\n          this.realloc(8);\n          writeInt32(this.buf, val & -1, this.pos);\n          writeInt32(this.buf, Math.floor(val * SHIFT_RIGHT_32), this.pos + 4);\n          this.pos += 8;\n        },\n        writeVarint: function(val) {\n          val = +val || 0;\n          if (val > 268435455 || val < 0) {\n            writeBigVarint(val, this);\n            return;\n          }\n          this.realloc(4);\n          this.buf[this.pos++] = val & 127 | (val > 127 ? 128 : 0);\n          if (val <= 127)\n            return;\n          this.buf[this.pos++] = (val >>>= 7) & 127 | (val > 127 ? 128 : 0);\n          if (val <= 127)\n            return;\n          this.buf[this.pos++] = (val >>>= 7) & 127 | (val > 127 ? 128 : 0);\n          if (val <= 127)\n            return;\n          this.buf[this.pos++] = val >>> 7 & 127;\n        },\n        writeSVarint: function(val) {\n          this.writeVarint(val < 0 ? -val * 2 - 1 : val * 2);\n        },\n        writeBoolean: function(val) {\n          this.writeVarint(Boolean(val));\n        },\n        writeString: function(str) {\n          str = String(str);\n          this.realloc(str.length * 4);\n          this.pos++;\n          var startPos = this.pos;\n          this.pos = writeUtf8(this.buf, str, this.pos);\n          var len = this.pos - startPos;\n          if (len >= 128)\n            makeRoomForExtraLength(startPos, len, this);\n          this.pos = startPos - 1;\n          this.writeVarint(len);\n          this.pos += len;\n        },\n        writeFloat: function(val) {\n          this.realloc(4);\n          ieee754.write(this.buf, val, this.pos, true, 23, 4);\n          this.pos += 4;\n        },\n        writeDouble: function(val) {\n          this.realloc(8);\n          ieee754.write(this.buf, val, this.pos, true, 52, 8);\n          this.pos += 8;\n        },\n        writeBytes: function(buffer) {\n          var len = buffer.length;\n          this.writeVarint(len);\n          this.realloc(len);\n          for (var i2 = 0; i2 < len; i2++)\n            this.buf[this.pos++] = buffer[i2];\n        },\n        writeRawMessage: function(fn, obj) {\n          this.pos++;\n          var startPos = this.pos;\n          fn(obj, this);\n          var len = this.pos - startPos;\n          if (len >= 128)\n            makeRoomForExtraLength(startPos, len, this);\n          this.pos = startPos - 1;\n          this.writeVarint(len);\n          this.pos += len;\n        },\n        writeMessage: function(tag, fn, obj) {\n          this.writeTag(tag, Pbf.Bytes);\n          this.writeRawMessage(fn, obj);\n        },\n        writePackedVarint: function(tag, arr2) {\n          if (arr2.length)\n            this.writeMessage(tag, writePackedVarint, arr2);\n        },\n        writePackedSVarint: function(tag, arr2) {\n          if (arr2.length)\n            this.writeMessage(tag, writePackedSVarint, arr2);\n        },\n        writePackedBoolean: function(tag, arr2) {\n          if (arr2.length)\n            this.writeMessage(tag, writePackedBoolean, arr2);\n        },\n        writePackedFloat: function(tag, arr2) {\n          if (arr2.length)\n            this.writeMessage(tag, writePackedFloat, arr2);\n        },\n        writePackedDouble: function(tag, arr2) {\n          if (arr2.length)\n            this.writeMessage(tag, writePackedDouble, arr2);\n        },\n        writePackedFixed32: function(tag, arr2) {\n          if (arr2.length)\n            this.writeMessage(tag, writePackedFixed32, arr2);\n        },\n        writePackedSFixed32: function(tag, arr2) {\n          if (arr2.length)\n            this.writeMessage(tag, writePackedSFixed32, arr2);\n        },\n        writePackedFixed64: function(tag, arr2) {\n          if (arr2.length)\n            this.writeMessage(tag, writePackedFixed64, arr2);\n        },\n        writePackedSFixed64: function(tag, arr2) {\n          if (arr2.length)\n            this.writeMessage(tag, writePackedSFixed64, arr2);\n        },\n        writeBytesField: function(tag, buffer) {\n          this.writeTag(tag, Pbf.Bytes);\n          this.writeBytes(buffer);\n        },\n        writeFixed32Field: function(tag, val) {\n          this.writeTag(tag, Pbf.Fixed32);\n          this.writeFixed32(val);\n        },\n        writeSFixed32Field: function(tag, val) {\n          this.writeTag(tag, Pbf.Fixed32);\n          this.writeSFixed32(val);\n        },\n        writeFixed64Field: function(tag, val) {\n          this.writeTag(tag, Pbf.Fixed64);\n          this.writeFixed64(val);\n        },\n        writeSFixed64Field: function(tag, val) {\n          this.writeTag(tag, Pbf.Fixed64);\n          this.writeSFixed64(val);\n        },\n        writeVarintField: function(tag, val) {\n          this.writeTag(tag, Pbf.Varint);\n          this.writeVarint(val);\n        },\n        writeSVarintField: function(tag, val) {\n          this.writeTag(tag, Pbf.Varint);\n          this.writeSVarint(val);\n        },\n        writeStringField: function(tag, str) {\n          this.writeTag(tag, Pbf.Bytes);\n          this.writeString(str);\n        },\n        writeFloatField: function(tag, val) {\n          this.writeTag(tag, Pbf.Fixed32);\n          this.writeFloat(val);\n        },\n        writeDoubleField: function(tag, val) {\n          this.writeTag(tag, Pbf.Fixed64);\n          this.writeDouble(val);\n        },\n        writeBooleanField: function(tag, val) {\n          this.writeVarintField(tag, Boolean(val));\n        }\n      };\n      function readVarintRemainder2(l, s, p) {\n        var buf = p.buf, h, b;\n        b = buf[p.pos++];\n        h = (b & 112) >> 4;\n        if (b < 128)\n          return toNum2(l, h, s);\n        b = buf[p.pos++];\n        h |= (b & 127) << 3;\n        if (b < 128)\n          return toNum2(l, h, s);\n        b = buf[p.pos++];\n        h |= (b & 127) << 10;\n        if (b < 128)\n          return toNum2(l, h, s);\n        b = buf[p.pos++];\n        h |= (b & 127) << 17;\n        if (b < 128)\n          return toNum2(l, h, s);\n        b = buf[p.pos++];\n        h |= (b & 127) << 24;\n        if (b < 128)\n          return toNum2(l, h, s);\n        b = buf[p.pos++];\n        h |= (b & 1) << 31;\n        if (b < 128)\n          return toNum2(l, h, s);\n        throw new Error(\"Expected varint not more than 10 bytes\");\n      }\n      function readPackedEnd(pbf) {\n        return pbf.type === Pbf.Bytes ? pbf.readVarint() + pbf.pos : pbf.pos + 1;\n      }\n      function toNum2(low, high, isSigned) {\n        if (isSigned) {\n          return high * 4294967296 + (low >>> 0);\n        }\n        return (high >>> 0) * 4294967296 + (low >>> 0);\n      }\n      function writeBigVarint(val, pbf) {\n        var low, high;\n        if (val >= 0) {\n          low = val % 4294967296 | 0;\n          high = val / 4294967296 | 0;\n        } else {\n          low = ~(-val % 4294967296);\n          high = ~(-val / 4294967296);\n          if (low ^ 4294967295) {\n            low = low + 1 | 0;\n          } else {\n            low = 0;\n            high = high + 1 | 0;\n          }\n        }\n        if (val >= 18446744073709552e3 || val < -18446744073709552e3) {\n          throw new Error(\"Given varint doesn't fit into 10 bytes\");\n        }\n        pbf.realloc(10);\n        writeBigVarintLow(low, high, pbf);\n        writeBigVarintHigh(high, pbf);\n      }\n      function writeBigVarintLow(low, high, pbf) {\n        pbf.buf[pbf.pos++] = low & 127 | 128;\n        low >>>= 7;\n        pbf.buf[pbf.pos++] = low & 127 | 128;\n        low >>>= 7;\n        pbf.buf[pbf.pos++] = low & 127 | 128;\n        low >>>= 7;\n        pbf.buf[pbf.pos++] = low & 127 | 128;\n        low >>>= 7;\n        pbf.buf[pbf.pos] = low & 127;\n      }\n      function writeBigVarintHigh(high, pbf) {\n        var lsb = (high & 7) << 4;\n        pbf.buf[pbf.pos++] |= lsb | ((high >>>= 3) ? 128 : 0);\n        if (!high)\n          return;\n        pbf.buf[pbf.pos++] = high & 127 | ((high >>>= 7) ? 128 : 0);\n        if (!high)\n          return;\n        pbf.buf[pbf.pos++] = high & 127 | ((high >>>= 7) ? 128 : 0);\n        if (!high)\n          return;\n        pbf.buf[pbf.pos++] = high & 127 | ((high >>>= 7) ? 128 : 0);\n        if (!high)\n          return;\n        pbf.buf[pbf.pos++] = high & 127 | ((high >>>= 7) ? 128 : 0);\n        if (!high)\n          return;\n        pbf.buf[pbf.pos++] = high & 127;\n      }\n      function makeRoomForExtraLength(startPos, len, pbf) {\n        var extraLen = len <= 16383 ? 1 : len <= 2097151 ? 2 : len <= 268435455 ? 3 : Math.floor(Math.log(len) / (Math.LN2 * 7));\n        pbf.realloc(extraLen);\n        for (var i2 = pbf.pos - 1; i2 >= startPos; i2--)\n          pbf.buf[i2 + extraLen] = pbf.buf[i2];\n      }\n      function writePackedVarint(arr2, pbf) {\n        for (var i2 = 0; i2 < arr2.length; i2++)\n          pbf.writeVarint(arr2[i2]);\n      }\n      function writePackedSVarint(arr2, pbf) {\n        for (var i2 = 0; i2 < arr2.length; i2++)\n          pbf.writeSVarint(arr2[i2]);\n      }\n      function writePackedFloat(arr2, pbf) {\n        for (var i2 = 0; i2 < arr2.length; i2++)\n          pbf.writeFloat(arr2[i2]);\n      }\n      function writePackedDouble(arr2, pbf) {\n        for (var i2 = 0; i2 < arr2.length; i2++)\n          pbf.writeDouble(arr2[i2]);\n      }\n      function writePackedBoolean(arr2, pbf) {\n        for (var i2 = 0; i2 < arr2.length; i2++)\n          pbf.writeBoolean(arr2[i2]);\n      }\n      function writePackedFixed32(arr2, pbf) {\n        for (var i2 = 0; i2 < arr2.length; i2++)\n          pbf.writeFixed32(arr2[i2]);\n      }\n      function writePackedSFixed32(arr2, pbf) {\n        for (var i2 = 0; i2 < arr2.length; i2++)\n          pbf.writeSFixed32(arr2[i2]);\n      }\n      function writePackedFixed64(arr2, pbf) {\n        for (var i2 = 0; i2 < arr2.length; i2++)\n          pbf.writeFixed64(arr2[i2]);\n      }\n      function writePackedSFixed64(arr2, pbf) {\n        for (var i2 = 0; i2 < arr2.length; i2++)\n          pbf.writeSFixed64(arr2[i2]);\n      }\n      function readUInt32(buf, pos) {\n        return (buf[pos] | buf[pos + 1] << 8 | buf[pos + 2] << 16) + buf[pos + 3] * 16777216;\n      }\n      function writeInt32(buf, val, pos) {\n        buf[pos] = val;\n        buf[pos + 1] = val >>> 8;\n        buf[pos + 2] = val >>> 16;\n        buf[pos + 3] = val >>> 24;\n      }\n      function readInt32(buf, pos) {\n        return (buf[pos] | buf[pos + 1] << 8 | buf[pos + 2] << 16) + (buf[pos + 3] << 24);\n      }\n      function readUtf8(buf, pos, end) {\n        var str = \"\";\n        var i2 = pos;\n        while (i2 < end) {\n          var b0 = buf[i2];\n          var c = null;\n          var bytesPerSequence = b0 > 239 ? 4 : b0 > 223 ? 3 : b0 > 191 ? 2 : 1;\n          if (i2 + bytesPerSequence > end)\n            break;\n          var b1, b2, b3;\n          if (bytesPerSequence === 1) {\n            if (b0 < 128) {\n              c = b0;\n            }\n          } else if (bytesPerSequence === 2) {\n            b1 = buf[i2 + 1];\n            if ((b1 & 192) === 128) {\n              c = (b0 & 31) << 6 | b1 & 63;\n              if (c <= 127) {\n                c = null;\n              }\n            }\n          } else if (bytesPerSequence === 3) {\n            b1 = buf[i2 + 1];\n            b2 = buf[i2 + 2];\n            if ((b1 & 192) === 128 && (b2 & 192) === 128) {\n              c = (b0 & 15) << 12 | (b1 & 63) << 6 | b2 & 63;\n              if (c <= 2047 || c >= 55296 && c <= 57343) {\n                c = null;\n              }\n            }\n          } else if (bytesPerSequence === 4) {\n            b1 = buf[i2 + 1];\n            b2 = buf[i2 + 2];\n            b3 = buf[i2 + 3];\n            if ((b1 & 192) === 128 && (b2 & 192) === 128 && (b3 & 192) === 128) {\n              c = (b0 & 15) << 18 | (b1 & 63) << 12 | (b2 & 63) << 6 | b3 & 63;\n              if (c <= 65535 || c >= 1114112) {\n                c = null;\n              }\n            }\n          }\n          if (c === null) {\n            c = 65533;\n            bytesPerSequence = 1;\n          } else if (c > 65535) {\n            c -= 65536;\n            str += String.fromCharCode(c >>> 10 & 1023 | 55296);\n            c = 56320 | c & 1023;\n          }\n          str += String.fromCharCode(c);\n          i2 += bytesPerSequence;\n        }\n        return str;\n      }\n      function readUtf8TextDecoder(buf, pos, end) {\n        return utf8TextDecoder.decode(buf.subarray(pos, end));\n      }\n      function writeUtf8(buf, str, pos) {\n        for (var i2 = 0, c, lead; i2 < str.length; i2++) {\n          c = str.charCodeAt(i2);\n          if (c > 55295 && c < 57344) {\n            if (lead) {\n              if (c < 56320) {\n                buf[pos++] = 239;\n                buf[pos++] = 191;\n                buf[pos++] = 189;\n                lead = c;\n                continue;\n              } else {\n                c = lead - 55296 << 10 | c - 56320 | 65536;\n                lead = null;\n              }\n            } else {\n              if (c > 56319 || i2 + 1 === str.length) {\n                buf[pos++] = 239;\n                buf[pos++] = 191;\n                buf[pos++] = 189;\n              } else {\n                lead = c;\n              }\n              continue;\n            }\n          } else if (lead) {\n            buf[pos++] = 239;\n            buf[pos++] = 191;\n            buf[pos++] = 189;\n            lead = null;\n          }\n          if (c < 128) {\n            buf[pos++] = c;\n          } else {\n            if (c < 2048) {\n              buf[pos++] = c >> 6 | 192;\n            } else {\n              if (c < 65536) {\n                buf[pos++] = c >> 12 | 224;\n              } else {\n                buf[pos++] = c >> 18 | 240;\n                buf[pos++] = c >> 12 & 63 | 128;\n              }\n              buf[pos++] = c >> 6 & 63 | 128;\n            }\n            buf[pos++] = c & 63 | 128;\n          }\n        }\n        return pos;\n      }\n    }\n  });\n\n  // node_modules/rbush/rbush.min.js\n  var require_rbush_min = __commonJS({\n    \"node_modules/rbush/rbush.min.js\"(exports, module) {\n      !function(t, i2) {\n        \"object\" == typeof exports && \"undefined\" != typeof module ? module.exports = i2() : \"function\" == typeof define && define.amd ? define(i2) : (t = t || self).RBush = i2();\n      }(exports, function() {\n        function t(t2, r3, e2, a2, h2) {\n          !function t3(n2, r4, e3, a3, h3) {\n            for (; a3 > e3; ) {\n              if (a3 - e3 > 600) {\n                var o2 = a3 - e3 + 1, s2 = r4 - e3 + 1, l2 = Math.log(o2), f2 = 0.5 * Math.exp(2 * l2 / 3), u2 = 0.5 * Math.sqrt(l2 * f2 * (o2 - f2) / o2) * (s2 - o2 / 2 < 0 ? -1 : 1), m2 = Math.max(e3, Math.floor(r4 - s2 * f2 / o2 + u2)), c2 = Math.min(a3, Math.floor(r4 + (o2 - s2) * f2 / o2 + u2));\n                t3(n2, r4, m2, c2, h3);\n              }\n              var p2 = n2[r4], d2 = e3, x2 = a3;\n              for (i2(n2, e3, r4), h3(n2[a3], p2) > 0 && i2(n2, e3, a3); d2 < x2; ) {\n                for (i2(n2, d2, x2), d2++, x2--; h3(n2[d2], p2) < 0; )\n                  d2++;\n                for (; h3(n2[x2], p2) > 0; )\n                  x2--;\n              }\n              0 === h3(n2[e3], p2) ? i2(n2, e3, x2) : i2(n2, ++x2, a3), x2 <= r4 && (e3 = x2 + 1), r4 <= x2 && (a3 = x2 - 1);\n            }\n          }(t2, r3, e2 || 0, a2 || t2.length - 1, h2 || n);\n        }\n        function i2(t2, i3, n2) {\n          var r3 = t2[i3];\n          t2[i3] = t2[n2], t2[n2] = r3;\n        }\n        function n(t2, i3) {\n          return t2 < i3 ? -1 : t2 > i3 ? 1 : 0;\n        }\n        var r2 = function(t2) {\n          void 0 === t2 && (t2 = 9), this._maxEntries = Math.max(4, t2), this._minEntries = Math.max(2, Math.ceil(0.4 * this._maxEntries)), this.clear();\n        };\n        function e(t2, i3, n2) {\n          if (!n2)\n            return i3.indexOf(t2);\n          for (var r3 = 0; r3 < i3.length; r3++)\n            if (n2(t2, i3[r3]))\n              return r3;\n          return -1;\n        }\n        function a(t2, i3) {\n          h(t2, 0, t2.children.length, i3, t2);\n        }\n        function h(t2, i3, n2, r3, e2) {\n          e2 || (e2 = p(null)), e2.minX = 1 / 0, e2.minY = 1 / 0, e2.maxX = -1 / 0, e2.maxY = -1 / 0;\n          for (var a2 = i3; a2 < n2; a2++) {\n            var h2 = t2.children[a2];\n            o(e2, t2.leaf ? r3(h2) : h2);\n          }\n          return e2;\n        }\n        function o(t2, i3) {\n          return t2.minX = Math.min(t2.minX, i3.minX), t2.minY = Math.min(t2.minY, i3.minY), t2.maxX = Math.max(t2.maxX, i3.maxX), t2.maxY = Math.max(t2.maxY, i3.maxY), t2;\n        }\n        function s(t2, i3) {\n          return t2.minX - i3.minX;\n        }\n        function l(t2, i3) {\n          return t2.minY - i3.minY;\n        }\n        function f(t2) {\n          return (t2.maxX - t2.minX) * (t2.maxY - t2.minY);\n        }\n        function u(t2) {\n          return t2.maxX - t2.minX + (t2.maxY - t2.minY);\n        }\n        function m(t2, i3) {\n          return t2.minX <= i3.minX && t2.minY <= i3.minY && i3.maxX <= t2.maxX && i3.maxY <= t2.maxY;\n        }\n        function c(t2, i3) {\n          return i3.minX <= t2.maxX && i3.minY <= t2.maxY && i3.maxX >= t2.minX && i3.maxY >= t2.minY;\n        }\n        function p(t2) {\n          return { children: t2, height: 1, leaf: true, minX: 1 / 0, minY: 1 / 0, maxX: -1 / 0, maxY: -1 / 0 };\n        }\n        function d(i3, n2, r3, e2, a2) {\n          for (var h2 = [n2, r3]; h2.length; )\n            if (!((r3 = h2.pop()) - (n2 = h2.pop()) <= e2)) {\n              var o2 = n2 + Math.ceil((r3 - n2) / e2 / 2) * e2;\n              t(i3, o2, n2, r3, a2), h2.push(n2, o2, o2, r3);\n            }\n        }\n        return r2.prototype.all = function() {\n          return this._all(this.data, []);\n        }, r2.prototype.search = function(t2) {\n          var i3 = this.data, n2 = [];\n          if (!c(t2, i3))\n            return n2;\n          for (var r3 = this.toBBox, e2 = []; i3; ) {\n            for (var a2 = 0; a2 < i3.children.length; a2++) {\n              var h2 = i3.children[a2], o2 = i3.leaf ? r3(h2) : h2;\n              c(t2, o2) && (i3.leaf ? n2.push(h2) : m(t2, o2) ? this._all(h2, n2) : e2.push(h2));\n            }\n            i3 = e2.pop();\n          }\n          return n2;\n        }, r2.prototype.collides = function(t2) {\n          var i3 = this.data;\n          if (!c(t2, i3))\n            return false;\n          for (var n2 = []; i3; ) {\n            for (var r3 = 0; r3 < i3.children.length; r3++) {\n              var e2 = i3.children[r3], a2 = i3.leaf ? this.toBBox(e2) : e2;\n              if (c(t2, a2)) {\n                if (i3.leaf || m(t2, a2))\n                  return true;\n                n2.push(e2);\n              }\n            }\n            i3 = n2.pop();\n          }\n          return false;\n        }, r2.prototype.load = function(t2) {\n          if (!t2 || !t2.length)\n            return this;\n          if (t2.length < this._minEntries) {\n            for (var i3 = 0; i3 < t2.length; i3++)\n              this.insert(t2[i3]);\n            return this;\n          }\n          var n2 = this._build(t2.slice(), 0, t2.length - 1, 0);\n          if (this.data.children.length)\n            if (this.data.height === n2.height)\n              this._splitRoot(this.data, n2);\n            else {\n              if (this.data.height < n2.height) {\n                var r3 = this.data;\n                this.data = n2, n2 = r3;\n              }\n              this._insert(n2, this.data.height - n2.height - 1, true);\n            }\n          else\n            this.data = n2;\n          return this;\n        }, r2.prototype.insert = function(t2) {\n          return t2 && this._insert(t2, this.data.height - 1), this;\n        }, r2.prototype.clear = function() {\n          return this.data = p([]), this;\n        }, r2.prototype.remove = function(t2, i3) {\n          if (!t2)\n            return this;\n          for (var n2, r3, a2, h2 = this.data, o2 = this.toBBox(t2), s2 = [], l2 = []; h2 || s2.length; ) {\n            if (h2 || (h2 = s2.pop(), r3 = s2[s2.length - 1], n2 = l2.pop(), a2 = true), h2.leaf) {\n              var f2 = e(t2, h2.children, i3);\n              if (-1 !== f2)\n                return h2.children.splice(f2, 1), s2.push(h2), this._condense(s2), this;\n            }\n            a2 || h2.leaf || !m(h2, o2) ? r3 ? (n2++, h2 = r3.children[n2], a2 = false) : h2 = null : (s2.push(h2), l2.push(n2), n2 = 0, r3 = h2, h2 = h2.children[0]);\n          }\n          return this;\n        }, r2.prototype.toBBox = function(t2) {\n          return t2;\n        }, r2.prototype.compareMinX = function(t2, i3) {\n          return t2.minX - i3.minX;\n        }, r2.prototype.compareMinY = function(t2, i3) {\n          return t2.minY - i3.minY;\n        }, r2.prototype.toJSON = function() {\n          return this.data;\n        }, r2.prototype.fromJSON = function(t2) {\n          return this.data = t2, this;\n        }, r2.prototype._all = function(t2, i3) {\n          for (var n2 = []; t2; )\n            t2.leaf ? i3.push.apply(i3, t2.children) : n2.push.apply(n2, t2.children), t2 = n2.pop();\n          return i3;\n        }, r2.prototype._build = function(t2, i3, n2, r3) {\n          var e2, h2 = n2 - i3 + 1, o2 = this._maxEntries;\n          if (h2 <= o2)\n            return a(e2 = p(t2.slice(i3, n2 + 1)), this.toBBox), e2;\n          r3 || (r3 = Math.ceil(Math.log(h2) / Math.log(o2)), o2 = Math.ceil(h2 / Math.pow(o2, r3 - 1))), (e2 = p([])).leaf = false, e2.height = r3;\n          var s2 = Math.ceil(h2 / o2), l2 = s2 * Math.ceil(Math.sqrt(o2));\n          d(t2, i3, n2, l2, this.compareMinX);\n          for (var f2 = i3; f2 <= n2; f2 += l2) {\n            var u2 = Math.min(f2 + l2 - 1, n2);\n            d(t2, f2, u2, s2, this.compareMinY);\n            for (var m2 = f2; m2 <= u2; m2 += s2) {\n              var c2 = Math.min(m2 + s2 - 1, u2);\n              e2.children.push(this._build(t2, m2, c2, r3 - 1));\n            }\n          }\n          return a(e2, this.toBBox), e2;\n        }, r2.prototype._chooseSubtree = function(t2, i3, n2, r3) {\n          for (; r3.push(i3), !i3.leaf && r3.length - 1 !== n2; ) {\n            for (var e2 = 1 / 0, a2 = 1 / 0, h2 = void 0, o2 = 0; o2 < i3.children.length; o2++) {\n              var s2 = i3.children[o2], l2 = f(s2), u2 = (m2 = t2, c2 = s2, (Math.max(c2.maxX, m2.maxX) - Math.min(c2.minX, m2.minX)) * (Math.max(c2.maxY, m2.maxY) - Math.min(c2.minY, m2.minY)) - l2);\n              u2 < a2 ? (a2 = u2, e2 = l2 < e2 ? l2 : e2, h2 = s2) : u2 === a2 && l2 < e2 && (e2 = l2, h2 = s2);\n            }\n            i3 = h2 || i3.children[0];\n          }\n          var m2, c2;\n          return i3;\n        }, r2.prototype._insert = function(t2, i3, n2) {\n          var r3 = n2 ? t2 : this.toBBox(t2), e2 = [], a2 = this._chooseSubtree(r3, this.data, i3, e2);\n          for (a2.children.push(t2), o(a2, r3); i3 >= 0 && e2[i3].children.length > this._maxEntries; )\n            this._split(e2, i3), i3--;\n          this._adjustParentBBoxes(r3, e2, i3);\n        }, r2.prototype._split = function(t2, i3) {\n          var n2 = t2[i3], r3 = n2.children.length, e2 = this._minEntries;\n          this._chooseSplitAxis(n2, e2, r3);\n          var h2 = this._chooseSplitIndex(n2, e2, r3), o2 = p(n2.children.splice(h2, n2.children.length - h2));\n          o2.height = n2.height, o2.leaf = n2.leaf, a(n2, this.toBBox), a(o2, this.toBBox), i3 ? t2[i3 - 1].children.push(o2) : this._splitRoot(n2, o2);\n        }, r2.prototype._splitRoot = function(t2, i3) {\n          this.data = p([t2, i3]), this.data.height = t2.height + 1, this.data.leaf = false, a(this.data, this.toBBox);\n        }, r2.prototype._chooseSplitIndex = function(t2, i3, n2) {\n          for (var r3, e2, a2, o2, s2, l2, u2, m2 = 1 / 0, c2 = 1 / 0, p2 = i3; p2 <= n2 - i3; p2++) {\n            var d2 = h(t2, 0, p2, this.toBBox), x2 = h(t2, p2, n2, this.toBBox), v = (e2 = d2, a2 = x2, o2 = void 0, s2 = void 0, l2 = void 0, u2 = void 0, o2 = Math.max(e2.minX, a2.minX), s2 = Math.max(e2.minY, a2.minY), l2 = Math.min(e2.maxX, a2.maxX), u2 = Math.min(e2.maxY, a2.maxY), Math.max(0, l2 - o2) * Math.max(0, u2 - s2)), M = f(d2) + f(x2);\n            v < m2 ? (m2 = v, r3 = p2, c2 = M < c2 ? M : c2) : v === m2 && M < c2 && (c2 = M, r3 = p2);\n          }\n          return r3 || n2 - i3;\n        }, r2.prototype._chooseSplitAxis = function(t2, i3, n2) {\n          var r3 = t2.leaf ? this.compareMinX : s, e2 = t2.leaf ? this.compareMinY : l;\n          this._allDistMargin(t2, i3, n2, r3) < this._allDistMargin(t2, i3, n2, e2) && t2.children.sort(r3);\n        }, r2.prototype._allDistMargin = function(t2, i3, n2, r3) {\n          t2.children.sort(r3);\n          for (var e2 = this.toBBox, a2 = h(t2, 0, i3, e2), s2 = h(t2, n2 - i3, n2, e2), l2 = u(a2) + u(s2), f2 = i3; f2 < n2 - i3; f2++) {\n            var m2 = t2.children[f2];\n            o(a2, t2.leaf ? e2(m2) : m2), l2 += u(a2);\n          }\n          for (var c2 = n2 - i3 - 1; c2 >= i3; c2--) {\n            var p2 = t2.children[c2];\n            o(s2, t2.leaf ? e2(p2) : p2), l2 += u(s2);\n          }\n          return l2;\n        }, r2.prototype._adjustParentBBoxes = function(t2, i3, n2) {\n          for (var r3 = n2; r3 >= 0; r3--)\n            o(i3[r3], t2);\n        }, r2.prototype._condense = function(t2) {\n          for (var i3 = t2.length - 1, n2 = void 0; i3 >= 0; i3--)\n            0 === t2[i3].children.length ? i3 > 0 ? (n2 = t2[i3 - 1].children).splice(n2.indexOf(t2[i3]), 1) : this.clear() : a(t2[i3], this.toBBox);\n        }, r2;\n      });\n    }\n  });\n\n  // src/frontends/static.ts\n  var import_point_geometry7 = __toESM(require_point_geometry(), 1);\n\n  // node_modules/color2k/dist/index.exports.import.es.mjs\n  function guard(low, high, value) {\n    return Math.min(Math.max(low, value), high);\n  }\n  var ColorError = class extends Error {\n    constructor(color) {\n      super(`Failed to parse color: \"${color}\"`);\n    }\n  };\n  var ColorError$1 = ColorError;\n  function parseToRgba(color) {\n    if (typeof color !== \"string\")\n      throw new ColorError$1(color);\n    if (color.trim().toLowerCase() === \"transparent\")\n      return [0, 0, 0, 0];\n    let normalizedColor = color.trim();\n    normalizedColor = namedColorRegex.test(color) ? nameToHex(color) : color;\n    const reducedHexMatch = reducedHexRegex.exec(normalizedColor);\n    if (reducedHexMatch) {\n      const arr2 = Array.from(reducedHexMatch).slice(1);\n      return [...arr2.slice(0, 3).map((x2) => parseInt(r(x2, 2), 16)), parseInt(r(arr2[3] || \"f\", 2), 16) / 255];\n    }\n    const hexMatch = hexRegex.exec(normalizedColor);\n    if (hexMatch) {\n      const arr2 = Array.from(hexMatch).slice(1);\n      return [...arr2.slice(0, 3).map((x2) => parseInt(x2, 16)), parseInt(arr2[3] || \"ff\", 16) / 255];\n    }\n    const rgbaMatch = rgbaRegex.exec(normalizedColor);\n    if (rgbaMatch) {\n      const arr2 = Array.from(rgbaMatch).slice(1);\n      return [...arr2.slice(0, 3).map((x2) => parseInt(x2, 10)), parseFloat(arr2[3] || \"1\")];\n    }\n    const hslaMatch = hslaRegex.exec(normalizedColor);\n    if (hslaMatch) {\n      const [h, s, l, a] = Array.from(hslaMatch).slice(1).map(parseFloat);\n      if (guard(0, 100, s) !== s)\n        throw new ColorError$1(color);\n      if (guard(0, 100, l) !== l)\n        throw new ColorError$1(color);\n      return [...hslToRgb(h, s, l), Number.isNaN(a) ? 1 : a];\n    }\n    throw new ColorError$1(color);\n  }\n  function hash(str) {\n    let hash2 = 5381;\n    let i2 = str.length;\n    while (i2) {\n      hash2 = hash2 * 33 ^ str.charCodeAt(--i2);\n    }\n    return (hash2 >>> 0) % 2341;\n  }\n  var colorToInt = (x2) => parseInt(x2.replace(/_/g, \"\"), 36);\n  var compressedColorMap = \"1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm\".split(\" \").reduce((acc, next) => {\n    const key = colorToInt(next.substring(0, 3));\n    const hex = colorToInt(next.substring(3)).toString(16);\n    let prefix = \"\";\n    for (let i2 = 0; i2 < 6 - hex.length; i2++) {\n      prefix += \"0\";\n    }\n    acc[key] = `${prefix}${hex}`;\n    return acc;\n  }, {});\n  function nameToHex(color) {\n    const normalizedColorName = color.toLowerCase().trim();\n    const result = compressedColorMap[hash(normalizedColorName)];\n    if (!result)\n      throw new ColorError$1(color);\n    return `#${result}`;\n  }\n  var r = (str, amount) => Array.from(Array(amount)).map(() => str).join(\"\");\n  var reducedHexRegex = new RegExp(`^#${r(\"([a-f0-9])\", 3)}([a-f0-9])?$`, \"i\");\n  var hexRegex = new RegExp(`^#${r(\"([a-f0-9]{2})\", 3)}([a-f0-9]{2})?$`, \"i\");\n  var rgbaRegex = new RegExp(`^rgba?\\\\(\\\\s*(\\\\d+)\\\\s*${r(\",\\\\s*(\\\\d+)\\\\s*\", 2)}(?:,\\\\s*([\\\\d.]+))?\\\\s*\\\\)$`, \"i\");\n  var hslaRegex = /^hsla?\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)%\\s*,\\s*([\\d.]+)%(?:\\s*,\\s*([\\d.]+))?\\s*\\)$/i;\n  var namedColorRegex = /^[a-z]+$/i;\n  var roundColor = (color) => {\n    return Math.round(color * 255);\n  };\n  var hslToRgb = (hue, saturation, lightness) => {\n    let l = lightness / 100;\n    if (saturation === 0) {\n      return [l, l, l].map(roundColor);\n    }\n    const huePrime = (hue % 360 + 360) % 360 / 60;\n    const chroma = (1 - Math.abs(2 * l - 1)) * (saturation / 100);\n    const secondComponent = chroma * (1 - Math.abs(huePrime % 2 - 1));\n    let red = 0;\n    let green = 0;\n    let blue = 0;\n    if (huePrime >= 0 && huePrime < 1) {\n      red = chroma;\n      green = secondComponent;\n    } else if (huePrime >= 1 && huePrime < 2) {\n      red = secondComponent;\n      green = chroma;\n    } else if (huePrime >= 2 && huePrime < 3) {\n      green = chroma;\n      blue = secondComponent;\n    } else if (huePrime >= 3 && huePrime < 4) {\n      green = secondComponent;\n      blue = chroma;\n    } else if (huePrime >= 4 && huePrime < 5) {\n      red = secondComponent;\n      blue = chroma;\n    } else if (huePrime >= 5 && huePrime < 6) {\n      red = chroma;\n      blue = secondComponent;\n    }\n    const lightnessModification = l - chroma / 2;\n    const finalRed = red + lightnessModification;\n    const finalGreen = green + lightnessModification;\n    const finalBlue = blue + lightnessModification;\n    return [finalRed, finalGreen, finalBlue].map(roundColor);\n  };\n  function rgba(red, green, blue, alpha) {\n    return `rgba(${guard(0, 255, red).toFixed()}, ${guard(0, 255, green).toFixed()}, ${guard(0, 255, blue).toFixed()}, ${parseFloat(guard(0, 1, alpha).toFixed(3))})`;\n  }\n  function mix(color1, color2, weight) {\n    const normalize = (n, index) => index === 3 ? n : n / 255;\n    const [r1, g1, b1, a1] = parseToRgba(color1).map(normalize);\n    const [r2, g2, b2, a2] = parseToRgba(color2).map(normalize);\n    const alphaDelta = a2 - a1;\n    const normalizedWeight = weight * 2 - 1;\n    const combinedWeight = normalizedWeight * alphaDelta === -1 ? normalizedWeight : normalizedWeight + alphaDelta / (1 + normalizedWeight * alphaDelta);\n    const weight2 = (combinedWeight + 1) / 2;\n    const weight1 = 1 - weight2;\n    const r3 = (r1 * weight1 + r2 * weight2) * 255;\n    const g = (g1 * weight1 + g2 * weight2) * 255;\n    const b = (b1 * weight1 + b2 * weight2) * 255;\n    const a = a2 * weight + a1 * (1 - weight);\n    return rgba(r3, g, b, a);\n  }\n\n  // src/symbolizer.ts\n  var import_point_geometry3 = __toESM(require_point_geometry(), 1);\n\n  // src/attribute.ts\n  var StringAttr = class {\n    constructor(c, defaultValue) {\n      this.str = c != null ? c : defaultValue;\n      this.perFeature = typeof this.str === \"function\" && this.str.length === 2;\n    }\n    get(z, f) {\n      if (typeof this.str === \"function\") {\n        return this.str(z, f);\n      }\n      return this.str;\n    }\n  };\n  var NumberAttr = class {\n    constructor(c, defaultValue = 1) {\n      this.value = c != null ? c : defaultValue;\n      this.perFeature = typeof this.value === \"function\" && this.value.length === 2;\n    }\n    get(z, f) {\n      if (typeof this.value === \"function\") {\n        return this.value(z, f);\n      }\n      return this.value;\n    }\n  };\n  var TextAttr = class {\n    constructor(options) {\n      var _a2;\n      this.labelProps = (_a2 = options == null ? void 0 : options.labelProps) != null ? _a2 : [\"name\"];\n      this.textTransform = options == null ? void 0 : options.textTransform;\n    }\n    get(z, f) {\n      let retval;\n      let labelProps;\n      if (typeof this.labelProps === \"function\") {\n        labelProps = this.labelProps(z, f);\n      } else {\n        labelProps = this.labelProps;\n      }\n      for (const property of labelProps) {\n        if (Object.prototype.hasOwnProperty.call(f.props, property) && typeof f.props[property] === \"string\") {\n          retval = f.props[property];\n          break;\n        }\n      }\n      let transform;\n      if (typeof this.textTransform === \"function\") {\n        transform = this.textTransform(z, f);\n      } else {\n        transform = this.textTransform;\n      }\n      if (retval && transform === \"uppercase\")\n        retval = retval.toUpperCase();\n      else if (retval && transform === \"lowercase\")\n        retval = retval.toLowerCase();\n      else if (retval && transform === \"capitalize\") {\n        const wordsArray = retval.toLowerCase().split(\" \");\n        const capsArray = wordsArray.map((word) => {\n          return word[0].toUpperCase() + word.slice(1);\n        });\n        retval = capsArray.join(\" \");\n      }\n      return retval;\n    }\n  };\n  var FontAttr = class {\n    constructor(options) {\n      var _a2, _b2;\n      if (options == null ? void 0 : options.font) {\n        this.font = options.font;\n      } else {\n        this.family = (_a2 = options == null ? void 0 : options.fontFamily) != null ? _a2 : \"sans-serif\";\n        this.size = (_b2 = options == null ? void 0 : options.fontSize) != null ? _b2 : 12;\n        this.weight = options == null ? void 0 : options.fontWeight;\n        this.style = options == null ? void 0 : options.fontStyle;\n      }\n    }\n    get(z, f) {\n      if (this.font) {\n        if (typeof this.font === \"function\") {\n          return this.font(z, f);\n        }\n        return this.font;\n      }\n      let style = \"\";\n      if (this.style) {\n        if (typeof this.style === \"function\") {\n          style = `${this.style(z, f)} `;\n        } else {\n          style = `${this.style} `;\n        }\n      }\n      let weight = \"\";\n      if (this.weight) {\n        if (typeof this.weight === \"function\") {\n          weight = `${this.weight(z, f)} `;\n        } else {\n          weight = `${this.weight} `;\n        }\n      }\n      let size;\n      if (typeof this.size === \"function\") {\n        size = this.size(z, f);\n      } else {\n        size = this.size;\n      }\n      let family;\n      if (typeof this.family === \"function\") {\n        family = this.family(z, f);\n      } else {\n        family = this.family;\n      }\n      return `${style}${weight}${size}px ${family}`;\n    }\n  };\n  var ArrayAttr = class {\n    constructor(c, defaultValue = []) {\n      this.value = c != null ? c : defaultValue;\n      this.perFeature = typeof this.value === \"function\" && this.value.length === 2;\n    }\n    get(z, f) {\n      if (typeof this.value === \"function\") {\n        return this.value(z, f);\n      }\n      return this.value;\n    }\n  };\n\n  // src/line.ts\n  var import_point_geometry = __toESM(require_point_geometry(), 1);\n  var linelabel = (pts, maxAngleDelta, targetLen) => {\n    const chunks = [];\n    let a;\n    let b;\n    let c;\n    let i2 = 0;\n    let n = 0;\n    let d = 0;\n    let abmag = 0;\n    let bcmag = 0;\n    let abx = 0;\n    let aby = 0;\n    let bcx = 0;\n    let bcy = 0;\n    let dt = 0;\n    let iStart = 0;\n    let dStart = 0;\n    if (pts.length < 2)\n      return [];\n    if (pts.length === 2) {\n      d = Math.sqrt(__pow(pts[1].x - pts[0].x, 2) + __pow(pts[1].y - pts[0].y, 2));\n      return [\n        {\n          length: d,\n          beginIndex: 0,\n          beginDistance: 0,\n          endIndex: 2,\n          endDistance: d\n        }\n      ];\n    }\n    abmag = Math.sqrt(__pow(pts[1].x - pts[0].x, 2) + __pow(pts[1].y - pts[0].y, 2));\n    for (i2 = 1, n = pts.length - 1; i2 < n; i2++) {\n      a = pts[i2 - 1];\n      b = pts[i2];\n      c = pts[i2 + 1];\n      abx = b.x - a.x;\n      aby = b.y - a.y;\n      bcx = c.x - b.x;\n      bcy = c.y - b.y;\n      bcmag = Math.sqrt(bcx * bcx + bcy * bcy);\n      d += abmag;\n      dt = Math.acos((abx * bcx + aby * bcy) / (abmag * bcmag));\n      if (dt > maxAngleDelta || d - dStart > targetLen) {\n        chunks.push({\n          length: d - dStart,\n          beginDistance: dStart,\n          beginIndex: iStart,\n          endIndex: i2 + 1,\n          endDistance: d\n        });\n        iStart = i2;\n        dStart = d;\n      }\n      abmag = bcmag;\n    }\n    if (i2 - iStart > 0) {\n      chunks.push({\n        length: d - dStart + bcmag,\n        beginIndex: iStart,\n        beginDistance: dStart,\n        endIndex: i2 + 1,\n        endDistance: d + bcmag\n      });\n    }\n    return chunks;\n  };\n  function simpleLabel(mls, minimum, repeatDistance, cellSize) {\n    const candidates = [];\n    for (const ls of mls) {\n      const segments = linelabel(ls, Math.PI / 45, minimum);\n      for (const segment of segments) {\n        if (segment.length >= minimum + cellSize) {\n          const start = new import_point_geometry.default(\n            ls[segment.beginIndex].x,\n            ls[segment.beginIndex].y\n          );\n          const end = ls[segment.endIndex - 1];\n          const normalized = new import_point_geometry.default(\n            (end.x - start.x) / segment.length,\n            (end.y - start.y) / segment.length\n          );\n          for (let i2 = cellSize; i2 < segment.length - minimum; i2 += repeatDistance) {\n            candidates.push({\n              start: start.add(normalized.mult(i2)),\n              end: start.add(normalized.mult(i2 + minimum))\n            });\n          }\n        }\n      }\n    }\n    return candidates;\n  }\n  function lineCells(a, b, length, spacing) {\n    const dx = b.x - a.x;\n    const dy = b.y - a.y;\n    const dist = Math.sqrt(__pow(b.x - a.x, 2) + __pow(b.y - a.y, 2));\n    const retval = [];\n    for (let i2 = 0; i2 < length + spacing; i2 += 2 * spacing) {\n      const factor = i2 * 1 / dist;\n      retval.push({ x: a.x + factor * dx, y: a.y + factor * dy });\n    }\n    return retval;\n  }\n\n  // src/text.ts\n  function linebreak(str, maxUnits) {\n    if (str.length <= maxUnits)\n      return [str];\n    const endIndex = maxUnits - 1;\n    const spaceBefore = str.lastIndexOf(\" \", endIndex);\n    const spaceAfter = str.indexOf(\" \", endIndex);\n    if (spaceBefore === -1 && spaceAfter === -1) {\n      return [str];\n    }\n    let first;\n    let after;\n    if (spaceAfter === -1 || spaceBefore >= 0 && endIndex - spaceBefore < spaceAfter - endIndex) {\n      first = str.substring(0, spaceBefore);\n      after = str.substring(spaceBefore + 1, str.length);\n    } else {\n      first = str.substring(0, spaceAfter);\n      after = str.substring(spaceAfter + 1, str.length);\n    }\n    return [first, ...linebreak(after, maxUnits)];\n  }\n\n  // src/tilecache.ts\n  var import_point_geometry2 = __toESM(require_point_geometry(), 1);\n  var import_vector_tile = __toESM(require_vector_tile(), 1);\n  var import_pbf = __toESM(require_pbf(), 1);\n\n  // node_modules/pmtiles/dist/index.js\n  var __pow2 = Math.pow;\n  var __async2 = (__this, __arguments, generator) => {\n    return new Promise((resolve, reject) => {\n      var fulfilled = (value) => {\n        try {\n          step2(generator.next(value));\n        } catch (e) {\n          reject(e);\n        }\n      };\n      var rejected = (value) => {\n        try {\n          step2(generator.throw(value));\n        } catch (e) {\n          reject(e);\n        }\n      };\n      var step2 = (x2) => x2.done ? resolve(x2.value) : Promise.resolve(x2.value).then(fulfilled, rejected);\n      step2((generator = generator.apply(__this, __arguments)).next());\n    });\n  };\n  var u8 = Uint8Array;\n  var u16 = Uint16Array;\n  var i32 = Int32Array;\n  var fleb = new u8([\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    1,\n    1,\n    1,\n    1,\n    2,\n    2,\n    2,\n    2,\n    3,\n    3,\n    3,\n    3,\n    4,\n    4,\n    4,\n    4,\n    5,\n    5,\n    5,\n    5,\n    0,\n    0,\n    0,\n    0\n  ]);\n  var fdeb = new u8([\n    0,\n    0,\n    0,\n    0,\n    1,\n    1,\n    2,\n    2,\n    3,\n    3,\n    4,\n    4,\n    5,\n    5,\n    6,\n    6,\n    7,\n    7,\n    8,\n    8,\n    9,\n    9,\n    10,\n    10,\n    11,\n    11,\n    12,\n    12,\n    13,\n    13,\n    0,\n    0\n  ]);\n  var clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n  var freb = function(eb, start) {\n    var b = new u16(31);\n    for (var i2 = 0; i2 < 31; ++i2) {\n      b[i2] = start += 1 << eb[i2 - 1];\n    }\n    var r2 = new i32(b[30]);\n    for (var i2 = 1; i2 < 30; ++i2) {\n      for (var j = b[i2]; j < b[i2 + 1]; ++j) {\n        r2[j] = j - b[i2] << 5 | i2;\n      }\n    }\n    return { b, r: r2 };\n  };\n  var _a = freb(fleb, 2);\n  var fl = _a.b;\n  var revfl = _a.r;\n  fl[28] = 258, revfl[258] = 28;\n  var _b = freb(fdeb, 0);\n  var fd = _b.b;\n  var rev = new u16(32768);\n  for (i = 0; i < 32768; ++i) {\n    x = (i & 43690) >> 1 | (i & 21845) << 1;\n    x = (x & 52428) >> 2 | (x & 13107) << 2;\n    x = (x & 61680) >> 4 | (x & 3855) << 4;\n    rev[i] = ((x & 65280) >> 8 | (x & 255) << 8) >> 1;\n  }\n  var x;\n  var i;\n  var hMap = function(cd, mb, r2) {\n    var s = cd.length;\n    var i2 = 0;\n    var l = new u16(mb);\n    for (; i2 < s; ++i2) {\n      if (cd[i2])\n        ++l[cd[i2] - 1];\n    }\n    var le = new u16(mb);\n    for (i2 = 1; i2 < mb; ++i2) {\n      le[i2] = le[i2 - 1] + l[i2 - 1] << 1;\n    }\n    var co;\n    if (r2) {\n      co = new u16(1 << mb);\n      var rvb = 15 - mb;\n      for (i2 = 0; i2 < s; ++i2) {\n        if (cd[i2]) {\n          var sv = i2 << 4 | cd[i2];\n          var r_1 = mb - cd[i2];\n          var v = le[cd[i2] - 1]++ << r_1;\n          for (var m = v | (1 << r_1) - 1; v <= m; ++v) {\n            co[rev[v] >> rvb] = sv;\n          }\n        }\n      }\n    } else {\n      co = new u16(s);\n      for (i2 = 0; i2 < s; ++i2) {\n        if (cd[i2]) {\n          co[i2] = rev[le[cd[i2] - 1]++] >> 15 - cd[i2];\n        }\n      }\n    }\n    return co;\n  };\n  var flt = new u8(288);\n  for (i = 0; i < 144; ++i)\n    flt[i] = 8;\n  var i;\n  for (i = 144; i < 256; ++i)\n    flt[i] = 9;\n  var i;\n  for (i = 256; i < 280; ++i)\n    flt[i] = 7;\n  var i;\n  for (i = 280; i < 288; ++i)\n    flt[i] = 8;\n  var i;\n  var fdt = new u8(32);\n  for (i = 0; i < 32; ++i)\n    fdt[i] = 5;\n  var i;\n  var flrm = /* @__PURE__ */ hMap(flt, 9, 1);\n  var fdrm = /* @__PURE__ */ hMap(fdt, 5, 1);\n  var max = function(a) {\n    var m = a[0];\n    for (var i2 = 1; i2 < a.length; ++i2) {\n      if (a[i2] > m)\n        m = a[i2];\n    }\n    return m;\n  };\n  var bits = function(d, p, m) {\n    var o = p / 8 | 0;\n    return (d[o] | d[o + 1] << 8) >> (p & 7) & m;\n  };\n  var bits16 = function(d, p) {\n    var o = p / 8 | 0;\n    return (d[o] | d[o + 1] << 8 | d[o + 2] << 16) >> (p & 7);\n  };\n  var shft = function(p) {\n    return (p + 7) / 8 | 0;\n  };\n  var slc = function(v, s, e) {\n    if (s == null || s < 0)\n      s = 0;\n    if (e == null || e > v.length)\n      e = v.length;\n    var n = new u8(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n  };\n  var ec = [\n    \"unexpected EOF\",\n    \"invalid block type\",\n    \"invalid length/literal\",\n    \"invalid distance\",\n    \"stream finished\",\n    \"no stream handler\",\n    ,\n    \"no callback\",\n    \"invalid UTF-8 data\",\n    \"extra field too long\",\n    \"date not in range 1980-2099\",\n    \"filename too long\",\n    \"stream finishing\",\n    \"invalid zip data\"\n  ];\n  var err = function(ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n      Error.captureStackTrace(e, err);\n    if (!nt)\n      throw e;\n    return e;\n  };\n  var inflt = function(dat, st, buf, dict) {\n    var sl = dat.length, dl = dict ? dict.length : 0;\n    if (!sl || st.f && !st.l)\n      return buf || new u8(0);\n    var noBuf = !buf || st.i != 2;\n    var noSt = st.i;\n    if (!buf)\n      buf = new u8(sl * 3);\n    var cbuf = function(l2) {\n      var bl = buf.length;\n      if (l2 > bl) {\n        var nbuf = new u8(Math.max(bl * 2, l2));\n        nbuf.set(buf);\n        buf = nbuf;\n      }\n    };\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    var tbts = sl * 8;\n    do {\n      if (!lm) {\n        final = bits(dat, pos, 1);\n        var type = bits(dat, pos + 1, 3);\n        pos += 3;\n        if (!type) {\n          var s = shft(pos) + 4, l = dat[s - 4] | dat[s - 3] << 8, t = s + l;\n          if (t > sl) {\n            if (noSt)\n              err(0);\n            break;\n          }\n          if (noBuf)\n            cbuf(bt + l);\n          buf.set(dat.subarray(s, t), bt);\n          st.b = bt += l, st.p = pos = t * 8, st.f = final;\n          continue;\n        } else if (type == 1)\n          lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n        else if (type == 2) {\n          var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n          var tl = hLit + bits(dat, pos + 5, 31) + 1;\n          pos += 14;\n          var ldt = new u8(tl);\n          var clt = new u8(19);\n          for (var i2 = 0; i2 < hcLen; ++i2) {\n            clt[clim[i2]] = bits(dat, pos + i2 * 3, 7);\n          }\n          pos += hcLen * 3;\n          var clb = max(clt), clbmsk = (1 << clb) - 1;\n          var clm = hMap(clt, clb, 1);\n          for (var i2 = 0; i2 < tl; ) {\n            var r2 = clm[bits(dat, pos, clbmsk)];\n            pos += r2 & 15;\n            var s = r2 >> 4;\n            if (s < 16) {\n              ldt[i2++] = s;\n            } else {\n              var c = 0, n = 0;\n              if (s == 16)\n                n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i2 - 1];\n              else if (s == 17)\n                n = 3 + bits(dat, pos, 7), pos += 3;\n              else if (s == 18)\n                n = 11 + bits(dat, pos, 127), pos += 7;\n              while (n--)\n                ldt[i2++] = c;\n            }\n          }\n          var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n          lbt = max(lt);\n          dbt = max(dt);\n          lm = hMap(lt, lbt, 1);\n          dm = hMap(dt, dbt, 1);\n        } else\n          err(1);\n        if (pos > tbts) {\n          if (noSt)\n            err(0);\n          break;\n        }\n      }\n      if (noBuf)\n        cbuf(bt + 131072);\n      var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n      var lpos = pos;\n      for (; ; lpos = pos) {\n        var c = lm[bits16(dat, pos) & lms], sym = c >> 4;\n        pos += c & 15;\n        if (pos > tbts) {\n          if (noSt)\n            err(0);\n          break;\n        }\n        if (!c)\n          err(2);\n        if (sym < 256)\n          buf[bt++] = sym;\n        else if (sym == 256) {\n          lpos = pos, lm = null;\n          break;\n        } else {\n          var add = sym - 254;\n          if (sym > 264) {\n            var i2 = sym - 257, b = fleb[i2];\n            add = bits(dat, pos, (1 << b) - 1) + fl[i2];\n            pos += b;\n          }\n          var d = dm[bits16(dat, pos) & dms], dsym = d >> 4;\n          if (!d)\n            err(3);\n          pos += d & 15;\n          var dt = fd[dsym];\n          if (dsym > 3) {\n            var b = fdeb[dsym];\n            dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n          }\n          if (pos > tbts) {\n            if (noSt)\n              err(0);\n            break;\n          }\n          if (noBuf)\n            cbuf(bt + 131072);\n          var end = bt + add;\n          if (bt < dt) {\n            var shift2 = dl - dt, dend = Math.min(dt, end);\n            if (shift2 + bt < 0)\n              err(3);\n            for (; bt < dend; ++bt)\n              buf[bt] = dict[shift2 + bt];\n          }\n          for (; bt < end; bt += 4) {\n            buf[bt] = buf[bt - dt];\n            buf[bt + 1] = buf[bt + 1 - dt];\n            buf[bt + 2] = buf[bt + 2 - dt];\n            buf[bt + 3] = buf[bt + 3 - dt];\n          }\n          bt = end;\n        }\n      }\n      st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n      if (lm)\n        final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n  };\n  var et = /* @__PURE__ */ new u8(0);\n  var gzs = function(d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n      err(6, \"invalid gzip data\");\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n      st += (d[10] | d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n      ;\n    return st + (flg & 2);\n  };\n  var gzl = function(d) {\n    var l = d.length;\n    return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16 | d[l - 1] << 24) >>> 0;\n  };\n  var zls = function(d, dict) {\n    if ((d[0] & 15) != 8 || d[0] >> 4 > 7 || (d[0] << 8 | d[1]) % 31)\n      err(6, \"invalid zlib data\");\n    if ((d[1] >> 5 & 1) == +!dict)\n      err(6, \"invalid zlib data: \" + (d[1] & 32 ? \"need\" : \"unexpected\") + \" dictionary\");\n    return (d[1] >> 3 & 4) + 2;\n  };\n  function inflateSync(data, opts) {\n    return inflt(data, { i: 2 }, opts && opts.out, opts && opts.dictionary);\n  }\n  function gunzipSync(data, opts) {\n    var st = gzs(data);\n    if (st + 8 > data.length)\n      err(6, \"invalid gzip data\");\n    return inflt(data.subarray(st, -8), { i: 2 }, opts && opts.out || new u8(gzl(data)), opts && opts.dictionary);\n  }\n  function unzlibSync(data, opts) {\n    return inflt(data.subarray(zls(data, opts && opts.dictionary), -4), { i: 2 }, opts && opts.out, opts && opts.dictionary);\n  }\n  function decompressSync(data, opts) {\n    return data[0] == 31 && data[1] == 139 && data[2] == 8 ? gunzipSync(data, opts) : (data[0] & 15) != 8 || data[0] >> 4 > 7 || (data[0] << 8 | data[1]) % 31 ? inflateSync(data, opts) : unzlibSync(data, opts);\n  }\n  var td = typeof TextDecoder != \"undefined\" && /* @__PURE__ */ new TextDecoder();\n  var tds = 0;\n  try {\n    td.decode(et, { stream: true });\n    tds = 1;\n  } catch (e) {\n  }\n  var shift = (n, shift2) => {\n    return n * __pow2(2, shift2);\n  };\n  var unshift = (n, shift2) => {\n    return Math.floor(n / __pow2(2, shift2));\n  };\n  var getUint24 = (view, pos) => {\n    return shift(view.getUint16(pos + 1, true), 8) + view.getUint8(pos);\n  };\n  var getUint48 = (view, pos) => {\n    return shift(view.getUint32(pos + 2, true), 16) + view.getUint16(pos, true);\n  };\n  var compare = (tz, tx, ty, view, i2) => {\n    if (tz !== view.getUint8(i2))\n      return tz - view.getUint8(i2);\n    const x2 = getUint24(view, i2 + 1);\n    if (tx !== x2)\n      return tx - x2;\n    const y = getUint24(view, i2 + 4);\n    if (ty !== y)\n      return ty - y;\n    return 0;\n  };\n  var queryLeafdir = (view, z, x2, y) => {\n    const offsetLen = queryView(view, z | 128, x2, y);\n    if (offsetLen) {\n      return {\n        z,\n        x: x2,\n        y,\n        offset: offsetLen[0],\n        length: offsetLen[1],\n        isDir: true\n      };\n    }\n    return null;\n  };\n  var queryTile = (view, z, x2, y) => {\n    const offsetLen = queryView(view, z, x2, y);\n    if (offsetLen) {\n      return {\n        z,\n        x: x2,\n        y,\n        offset: offsetLen[0],\n        length: offsetLen[1],\n        isDir: false\n      };\n    }\n    return null;\n  };\n  var queryView = (view, z, x2, y) => {\n    let m = 0;\n    let n = view.byteLength / 17 - 1;\n    while (m <= n) {\n      const k = n + m >> 1;\n      const cmp = compare(z, x2, y, view, k * 17);\n      if (cmp > 0) {\n        m = k + 1;\n      } else if (cmp < 0) {\n        n = k - 1;\n      } else {\n        return [getUint48(view, k * 17 + 7), view.getUint32(k * 17 + 13, true)];\n      }\n    }\n    return null;\n  };\n  var entrySort = (a, b) => {\n    if (a.isDir && !b.isDir) {\n      return 1;\n    }\n    if (!a.isDir && b.isDir) {\n      return -1;\n    }\n    if (a.z !== b.z) {\n      return a.z - b.z;\n    }\n    if (a.x !== b.x) {\n      return a.x - b.x;\n    }\n    return a.y - b.y;\n  };\n  var parseEntry = (dataview, i2) => {\n    const zRaw = dataview.getUint8(i2 * 17);\n    const z = zRaw & 127;\n    return {\n      z,\n      x: getUint24(dataview, i2 * 17 + 1),\n      y: getUint24(dataview, i2 * 17 + 4),\n      offset: getUint48(dataview, i2 * 17 + 7),\n      length: dataview.getUint32(i2 * 17 + 13, true),\n      isDir: zRaw >> 7 === 1\n    };\n  };\n  var sortDir = (a) => {\n    const entries = [];\n    const view = new DataView(a);\n    for (let i2 = 0; i2 < view.byteLength / 17; i2++) {\n      entries.push(parseEntry(view, i2));\n    }\n    return createDirectory(entries);\n  };\n  var createDirectory = (entries) => {\n    entries.sort(entrySort);\n    const buffer = new ArrayBuffer(17 * entries.length);\n    const arr2 = new Uint8Array(buffer);\n    for (let i2 = 0; i2 < entries.length; i2++) {\n      const entry = entries[i2];\n      let z = entry.z;\n      if (entry.isDir)\n        z = z | 128;\n      arr2[i2 * 17] = z;\n      arr2[i2 * 17 + 1] = entry.x & 255;\n      arr2[i2 * 17 + 2] = entry.x >> 8 & 255;\n      arr2[i2 * 17 + 3] = entry.x >> 16 & 255;\n      arr2[i2 * 17 + 4] = entry.y & 255;\n      arr2[i2 * 17 + 5] = entry.y >> 8 & 255;\n      arr2[i2 * 17 + 6] = entry.y >> 16 & 255;\n      arr2[i2 * 17 + 7] = entry.offset & 255;\n      arr2[i2 * 17 + 8] = unshift(entry.offset, 8) & 255;\n      arr2[i2 * 17 + 9] = unshift(entry.offset, 16) & 255;\n      arr2[i2 * 17 + 10] = unshift(entry.offset, 24) & 255;\n      arr2[i2 * 17 + 11] = unshift(entry.offset, 32) & 255;\n      arr2[i2 * 17 + 12] = unshift(entry.offset, 48) & 255;\n      arr2[i2 * 17 + 13] = entry.length & 255;\n      arr2[i2 * 17 + 14] = entry.length >> 8 & 255;\n      arr2[i2 * 17 + 15] = entry.length >> 16 & 255;\n      arr2[i2 * 17 + 16] = entry.length >> 24 & 255;\n    }\n    return buffer;\n  };\n  var deriveLeaf = (view, tile) => {\n    if (view.byteLength < 17)\n      return null;\n    const numEntries = view.byteLength / 17;\n    const entry = parseEntry(view, numEntries - 1);\n    if (entry.isDir) {\n      const leafLevel = entry.z;\n      const levelDiff = tile.z - leafLevel;\n      const leafX = Math.trunc(tile.x / (1 << levelDiff));\n      const leafY = Math.trunc(tile.y / (1 << levelDiff));\n      return { z: leafLevel, x: leafX, y: leafY };\n    }\n    return null;\n  };\n  function getHeader(source) {\n    return __async2(this, null, function* () {\n      const resp = yield source.getBytes(0, 512e3);\n      const dataview = new DataView(resp.data);\n      const jsonSize = dataview.getUint32(4, true);\n      const rootEntries = dataview.getUint16(8, true);\n      const dec = new TextDecoder(\"utf-8\");\n      const jsonMetadata = JSON.parse(\n        dec.decode(new DataView(resp.data, 10, jsonSize))\n      );\n      let tileCompression = 0;\n      if (jsonMetadata.compression === \"gzip\") {\n        tileCompression = 2;\n      }\n      let minzoom = 0;\n      if (\"minzoom\" in jsonMetadata) {\n        minzoom = +jsonMetadata.minzoom;\n      }\n      let maxzoom = 0;\n      if (\"maxzoom\" in jsonMetadata) {\n        maxzoom = +jsonMetadata.maxzoom;\n      }\n      let centerLon = 0;\n      let centerLat = 0;\n      let centerZoom = 0;\n      let minLon = -180;\n      let minLat = -85;\n      let maxLon = 180;\n      let maxLat = 85;\n      if (jsonMetadata.bounds) {\n        const split = jsonMetadata.bounds.split(\",\");\n        minLon = +split[0];\n        minLat = +split[1];\n        maxLon = +split[2];\n        maxLat = +split[3];\n      }\n      if (jsonMetadata.center) {\n        const split = jsonMetadata.center.split(\",\");\n        centerLon = +split[0];\n        centerLat = +split[1];\n        centerZoom = +split[2];\n      }\n      const header = {\n        specVersion: dataview.getUint16(2, true),\n        rootDirectoryOffset: 10 + jsonSize,\n        rootDirectoryLength: rootEntries * 17,\n        jsonMetadataOffset: 10,\n        jsonMetadataLength: jsonSize,\n        leafDirectoryOffset: 0,\n        leafDirectoryLength: void 0,\n        tileDataOffset: 0,\n        tileDataLength: void 0,\n        numAddressedTiles: 0,\n        numTileEntries: 0,\n        numTileContents: 0,\n        clustered: false,\n        internalCompression: 1,\n        tileCompression,\n        tileType: 1,\n        minZoom: minzoom,\n        maxZoom: maxzoom,\n        minLon,\n        minLat,\n        maxLon,\n        maxLat,\n        centerZoom,\n        centerLon,\n        centerLat,\n        etag: resp.etag\n      };\n      return header;\n    });\n  }\n  function getZxy(header, source, cache, z, x2, y, signal) {\n    return __async2(this, null, function* () {\n      let rootDir = yield cache.getArrayBuffer(\n        source,\n        header.rootDirectoryOffset,\n        header.rootDirectoryLength,\n        header\n      );\n      if (header.specVersion === 1) {\n        rootDir = sortDir(rootDir);\n      }\n      const entry = queryTile(new DataView(rootDir), z, x2, y);\n      if (entry) {\n        const resp = yield source.getBytes(entry.offset, entry.length, signal);\n        let tileData = resp.data;\n        const view = new DataView(tileData);\n        if (view.getUint8(0) === 31 && view.getUint8(1) === 139) {\n          tileData = decompressSync(new Uint8Array(tileData));\n        }\n        return {\n          data: tileData\n        };\n      }\n      const leafcoords = deriveLeaf(new DataView(rootDir), { z, x: x2, y });\n      if (leafcoords) {\n        const leafdirEntry = queryLeafdir(\n          new DataView(rootDir),\n          leafcoords.z,\n          leafcoords.x,\n          leafcoords.y\n        );\n        if (leafdirEntry) {\n          let leafDir = yield cache.getArrayBuffer(\n            source,\n            leafdirEntry.offset,\n            leafdirEntry.length,\n            header\n          );\n          if (header.specVersion === 1) {\n            leafDir = sortDir(leafDir);\n          }\n          const tileEntry = queryTile(new DataView(leafDir), z, x2, y);\n          if (tileEntry) {\n            const resp = yield source.getBytes(\n              tileEntry.offset,\n              tileEntry.length,\n              signal\n            );\n            let tileData = resp.data;\n            const view = new DataView(tileData);\n            if (view.getUint8(0) === 31 && view.getUint8(1) === 139) {\n              tileData = decompressSync(new Uint8Array(tileData));\n            }\n            return {\n              data: tileData\n            };\n          }\n        }\n      }\n      return void 0;\n    });\n  }\n  var v2_default = {\n    getHeader,\n    getZxy\n  };\n  function toNum(low, high) {\n    return (high >>> 0) * 4294967296 + (low >>> 0);\n  }\n  function readVarintRemainder(l, p) {\n    const buf = p.buf;\n    let b = buf[p.pos++];\n    let h = (b & 112) >> 4;\n    if (b < 128)\n      return toNum(l, h);\n    b = buf[p.pos++];\n    h |= (b & 127) << 3;\n    if (b < 128)\n      return toNum(l, h);\n    b = buf[p.pos++];\n    h |= (b & 127) << 10;\n    if (b < 128)\n      return toNum(l, h);\n    b = buf[p.pos++];\n    h |= (b & 127) << 17;\n    if (b < 128)\n      return toNum(l, h);\n    b = buf[p.pos++];\n    h |= (b & 127) << 24;\n    if (b < 128)\n      return toNum(l, h);\n    b = buf[p.pos++];\n    h |= (b & 1) << 31;\n    if (b < 128)\n      return toNum(l, h);\n    throw new Error(\"Expected varint not more than 10 bytes\");\n  }\n  function readVarint(p) {\n    const buf = p.buf;\n    let b = buf[p.pos++];\n    let val = b & 127;\n    if (b < 128)\n      return val;\n    b = buf[p.pos++];\n    val |= (b & 127) << 7;\n    if (b < 128)\n      return val;\n    b = buf[p.pos++];\n    val |= (b & 127) << 14;\n    if (b < 128)\n      return val;\n    b = buf[p.pos++];\n    val |= (b & 127) << 21;\n    if (b < 128)\n      return val;\n    b = buf[p.pos];\n    val |= (b & 15) << 28;\n    return readVarintRemainder(val, p);\n  }\n  function rotate(n, xy, rx, ry) {\n    if (ry === 0) {\n      if (rx === 1) {\n        xy[0] = n - 1 - xy[0];\n        xy[1] = n - 1 - xy[1];\n      }\n      const t = xy[0];\n      xy[0] = xy[1];\n      xy[1] = t;\n    }\n  }\n  var tzValues = [\n    0,\n    1,\n    5,\n    21,\n    85,\n    341,\n    1365,\n    5461,\n    21845,\n    87381,\n    349525,\n    1398101,\n    5592405,\n    22369621,\n    89478485,\n    357913941,\n    1431655765,\n    5726623061,\n    22906492245,\n    91625968981,\n    366503875925,\n    1466015503701,\n    5864062014805,\n    23456248059221,\n    93824992236885,\n    375299968947541,\n    1501199875790165\n  ];\n  function zxyToTileId(z, x2, y) {\n    if (z > 26) {\n      throw Error(\"Tile zoom level exceeds max safe number limit (26)\");\n    }\n    if (x2 > __pow2(2, z) - 1 || y > __pow2(2, z) - 1) {\n      throw Error(\"tile x/y outside zoom level bounds\");\n    }\n    const acc = tzValues[z];\n    const n = __pow2(2, z);\n    let rx = 0;\n    let ry = 0;\n    let d = 0;\n    const xy = [x2, y];\n    let s = n / 2;\n    while (s > 0) {\n      rx = (xy[0] & s) > 0 ? 1 : 0;\n      ry = (xy[1] & s) > 0 ? 1 : 0;\n      d += s * s * (3 * rx ^ ry);\n      rotate(s, xy, rx, ry);\n      s = s / 2;\n    }\n    return acc + d;\n  }\n  function defaultDecompress(buf, compression) {\n    return __async2(this, null, function* () {\n      if (compression === 1 || compression === 0) {\n        return buf;\n      }\n      if (compression === 2) {\n        if (typeof globalThis.DecompressionStream === \"undefined\") {\n          return decompressSync(new Uint8Array(buf));\n        }\n        const stream = new Response(buf).body;\n        if (!stream) {\n          throw Error(\"Failed to read response stream\");\n        }\n        const result = stream.pipeThrough(\n          new globalThis.DecompressionStream(\"gzip\")\n        );\n        return new Response(result).arrayBuffer();\n      }\n      throw Error(\"Compression method not supported\");\n    });\n  }\n  var HEADER_SIZE_BYTES = 127;\n  function findTile(entries, tileId) {\n    let m = 0;\n    let n = entries.length - 1;\n    while (m <= n) {\n      const k = n + m >> 1;\n      const cmp = tileId - entries[k].tileId;\n      if (cmp > 0) {\n        m = k + 1;\n      } else if (cmp < 0) {\n        n = k - 1;\n      } else {\n        return entries[k];\n      }\n    }\n    if (n >= 0) {\n      if (entries[n].runLength === 0) {\n        return entries[n];\n      }\n      if (tileId - entries[n].tileId < entries[n].runLength) {\n        return entries[n];\n      }\n    }\n    return null;\n  }\n  var FetchSource = class {\n    constructor(url, customHeaders = new Headers()) {\n      this.url = url;\n      this.customHeaders = customHeaders;\n      this.mustReload = false;\n    }\n    getKey() {\n      return this.url;\n    }\n    setHeaders(customHeaders) {\n      this.customHeaders = customHeaders;\n    }\n    getBytes(offset, length, passedSignal, etag) {\n      return __async2(this, null, function* () {\n        let controller;\n        let signal;\n        if (passedSignal) {\n          signal = passedSignal;\n        } else {\n          controller = new AbortController();\n          signal = controller.signal;\n        }\n        const requestHeaders = new Headers(this.customHeaders);\n        requestHeaders.set(\"range\", `bytes=${offset}-${offset + length - 1}`);\n        let cache;\n        if (this.mustReload) {\n          cache = \"reload\";\n        }\n        let resp = yield fetch(this.url, {\n          signal,\n          cache,\n          headers: requestHeaders\n        });\n        if (offset === 0 && resp.status === 416) {\n          const contentRange = resp.headers.get(\"Content-Range\");\n          if (!contentRange || !contentRange.startsWith(\"bytes */\")) {\n            throw Error(\"Missing content-length on 416 response\");\n          }\n          const actualLength = +contentRange.substr(8);\n          resp = yield fetch(this.url, {\n            signal,\n            cache: \"reload\",\n            headers: { range: `bytes=0-${actualLength - 1}` }\n          });\n        }\n        let newEtag = resp.headers.get(\"Etag\");\n        if (newEtag == null ? void 0 : newEtag.startsWith(\"W/\")) {\n          newEtag = null;\n        }\n        if (resp.status === 416 || etag && newEtag && newEtag !== etag) {\n          this.mustReload = true;\n          throw new EtagMismatch(etag);\n        }\n        if (resp.status >= 300) {\n          throw Error(`Bad response code: ${resp.status}`);\n        }\n        const contentLength = resp.headers.get(\"Content-Length\");\n        if (resp.status === 200 && (!contentLength || +contentLength > length)) {\n          if (controller)\n            controller.abort();\n          throw Error(\n            \"Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.\"\n          );\n        }\n        const a = yield resp.arrayBuffer();\n        return {\n          data: a,\n          etag: newEtag || void 0,\n          cacheControl: resp.headers.get(\"Cache-Control\") || void 0,\n          expires: resp.headers.get(\"Expires\") || void 0\n        };\n      });\n    }\n  };\n  function getUint64(v, offset) {\n    const wh = v.getUint32(offset + 4, true);\n    const wl = v.getUint32(offset + 0, true);\n    return wh * __pow2(2, 32) + wl;\n  }\n  function bytesToHeader(bytes, etag) {\n    const v = new DataView(bytes);\n    const specVersion = v.getUint8(7);\n    if (specVersion > 3) {\n      throw Error(\n        `Archive is spec version ${specVersion} but this library supports up to spec version 3`\n      );\n    }\n    return {\n      specVersion,\n      rootDirectoryOffset: getUint64(v, 8),\n      rootDirectoryLength: getUint64(v, 16),\n      jsonMetadataOffset: getUint64(v, 24),\n      jsonMetadataLength: getUint64(v, 32),\n      leafDirectoryOffset: getUint64(v, 40),\n      leafDirectoryLength: getUint64(v, 48),\n      tileDataOffset: getUint64(v, 56),\n      tileDataLength: getUint64(v, 64),\n      numAddressedTiles: getUint64(v, 72),\n      numTileEntries: getUint64(v, 80),\n      numTileContents: getUint64(v, 88),\n      clustered: v.getUint8(96) === 1,\n      internalCompression: v.getUint8(97),\n      tileCompression: v.getUint8(98),\n      tileType: v.getUint8(99),\n      minZoom: v.getUint8(100),\n      maxZoom: v.getUint8(101),\n      minLon: v.getInt32(102, true) / 1e7,\n      minLat: v.getInt32(106, true) / 1e7,\n      maxLon: v.getInt32(110, true) / 1e7,\n      maxLat: v.getInt32(114, true) / 1e7,\n      centerZoom: v.getUint8(118),\n      centerLon: v.getInt32(119, true) / 1e7,\n      centerLat: v.getInt32(123, true) / 1e7,\n      etag\n    };\n  }\n  function deserializeIndex(buffer) {\n    const p = { buf: new Uint8Array(buffer), pos: 0 };\n    const numEntries = readVarint(p);\n    const entries = [];\n    let lastId = 0;\n    for (let i2 = 0; i2 < numEntries; i2++) {\n      const v = readVarint(p);\n      entries.push({ tileId: lastId + v, offset: 0, length: 0, runLength: 1 });\n      lastId += v;\n    }\n    for (let i2 = 0; i2 < numEntries; i2++) {\n      entries[i2].runLength = readVarint(p);\n    }\n    for (let i2 = 0; i2 < numEntries; i2++) {\n      entries[i2].length = readVarint(p);\n    }\n    for (let i2 = 0; i2 < numEntries; i2++) {\n      const v = readVarint(p);\n      if (v === 0 && i2 > 0) {\n        entries[i2].offset = entries[i2 - 1].offset + entries[i2 - 1].length;\n      } else {\n        entries[i2].offset = v - 1;\n      }\n    }\n    return entries;\n  }\n  function detectVersion(a) {\n    const v = new DataView(a);\n    if (v.getUint16(2, true) === 2) {\n      console.warn(\n        \"PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade\"\n      );\n      return 2;\n    }\n    if (v.getUint16(2, true) === 1) {\n      console.warn(\n        \"PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade\"\n      );\n      return 1;\n    }\n    return 3;\n  }\n  var EtagMismatch = class extends Error {\n  };\n  function getHeaderAndRoot(source, decompress) {\n    return __async2(this, null, function* () {\n      const resp = yield source.getBytes(0, 16384);\n      const v = new DataView(resp.data);\n      if (v.getUint16(0, true) !== 19792) {\n        throw new Error(\"Wrong magic number for PMTiles archive\");\n      }\n      if (detectVersion(resp.data) < 3) {\n        return [yield v2_default.getHeader(source)];\n      }\n      const headerData = resp.data.slice(0, HEADER_SIZE_BYTES);\n      const header = bytesToHeader(headerData, resp.etag);\n      const rootDirData = resp.data.slice(\n        header.rootDirectoryOffset,\n        header.rootDirectoryOffset + header.rootDirectoryLength\n      );\n      const dirKey = `${source.getKey()}|${header.etag || \"\"}|${header.rootDirectoryOffset}|${header.rootDirectoryLength}`;\n      const rootDir = deserializeIndex(\n        yield decompress(rootDirData, header.internalCompression)\n      );\n      return [header, [dirKey, rootDir.length, rootDir]];\n    });\n  }\n  function getDirectory(source, decompress, offset, length, header) {\n    return __async2(this, null, function* () {\n      const resp = yield source.getBytes(offset, length, void 0, header.etag);\n      const data = yield decompress(resp.data, header.internalCompression);\n      const directory = deserializeIndex(data);\n      if (directory.length === 0) {\n        throw new Error(\"Empty directory is invalid\");\n      }\n      return directory;\n    });\n  }\n  var SharedPromiseCache = class {\n    constructor(maxCacheEntries = 100, prefetch = true, decompress = defaultDecompress) {\n      this.cache = /* @__PURE__ */ new Map();\n      this.invalidations = /* @__PURE__ */ new Map();\n      this.maxCacheEntries = maxCacheEntries;\n      this.counter = 1;\n      this.decompress = decompress;\n    }\n    getHeader(source) {\n      return __async2(this, null, function* () {\n        const cacheKey = source.getKey();\n        const cacheValue = this.cache.get(cacheKey);\n        if (cacheValue) {\n          cacheValue.lastUsed = this.counter++;\n          const data = yield cacheValue.data;\n          return data;\n        }\n        const p = new Promise((resolve, reject) => {\n          getHeaderAndRoot(source, this.decompress).then((res) => {\n            if (res[1]) {\n              this.cache.set(res[1][0], {\n                lastUsed: this.counter++,\n                data: Promise.resolve(res[1][2])\n              });\n            }\n            resolve(res[0]);\n            this.prune();\n          }).catch((e) => {\n            reject(e);\n          });\n        });\n        this.cache.set(cacheKey, { lastUsed: this.counter++, data: p });\n        return p;\n      });\n    }\n    getDirectory(source, offset, length, header) {\n      return __async2(this, null, function* () {\n        const cacheKey = `${source.getKey()}|${header.etag || \"\"}|${offset}|${length}`;\n        const cacheValue = this.cache.get(cacheKey);\n        if (cacheValue) {\n          cacheValue.lastUsed = this.counter++;\n          const data = yield cacheValue.data;\n          return data;\n        }\n        const p = new Promise((resolve, reject) => {\n          getDirectory(source, this.decompress, offset, length, header).then((directory) => {\n            resolve(directory);\n            this.prune();\n          }).catch((e) => {\n            reject(e);\n          });\n        });\n        this.cache.set(cacheKey, { lastUsed: this.counter++, data: p });\n        return p;\n      });\n    }\n    getArrayBuffer(source, offset, length, header) {\n      return __async2(this, null, function* () {\n        const cacheKey = `${source.getKey()}|${header.etag || \"\"}|${offset}|${length}`;\n        const cacheValue = this.cache.get(cacheKey);\n        if (cacheValue) {\n          cacheValue.lastUsed = this.counter++;\n          const data = yield cacheValue.data;\n          return data;\n        }\n        const p = new Promise((resolve, reject) => {\n          source.getBytes(offset, length, void 0, header.etag).then((resp) => {\n            resolve(resp.data);\n            if (this.cache.has(cacheKey)) ;\n            this.prune();\n          }).catch((e) => {\n            reject(e);\n          });\n        });\n        this.cache.set(cacheKey, { lastUsed: this.counter++, data: p });\n        return p;\n      });\n    }\n    prune() {\n      if (this.cache.size >= this.maxCacheEntries) {\n        let minUsed = Infinity;\n        let minKey = void 0;\n        this.cache.forEach((cacheValue, key) => {\n          if (cacheValue.lastUsed < minUsed) {\n            minUsed = cacheValue.lastUsed;\n            minKey = key;\n          }\n        });\n        if (minKey) {\n          this.cache.delete(minKey);\n        }\n      }\n    }\n    invalidate(source) {\n      return __async2(this, null, function* () {\n        const key = source.getKey();\n        if (this.invalidations.get(key)) {\n          return yield this.invalidations.get(key);\n        }\n        this.cache.delete(source.getKey());\n        const p = new Promise((resolve, reject) => {\n          this.getHeader(source).then((h) => {\n            resolve();\n            this.invalidations.delete(key);\n          }).catch((e) => {\n            reject(e);\n          });\n        });\n        this.invalidations.set(key, p);\n      });\n    }\n  };\n  var PMTiles = class {\n    constructor(source, cache, decompress) {\n      if (typeof source === \"string\") {\n        this.source = new FetchSource(source);\n      } else {\n        this.source = source;\n      }\n      if (decompress) {\n        this.decompress = decompress;\n      } else {\n        this.decompress = defaultDecompress;\n      }\n      if (cache) {\n        this.cache = cache;\n      } else {\n        this.cache = new SharedPromiseCache();\n      }\n    }\n    getHeader() {\n      return __async2(this, null, function* () {\n        return yield this.cache.getHeader(this.source);\n      });\n    }\n    getZxyAttempt(z, x2, y, signal) {\n      return __async2(this, null, function* () {\n        const tileId = zxyToTileId(z, x2, y);\n        const header = yield this.cache.getHeader(this.source);\n        if (header.specVersion < 3) {\n          return v2_default.getZxy(header, this.source, this.cache, z, x2, y, signal);\n        }\n        if (z < header.minZoom || z > header.maxZoom) {\n          return void 0;\n        }\n        let dO = header.rootDirectoryOffset;\n        let dL = header.rootDirectoryLength;\n        for (let depth = 0; depth <= 3; depth++) {\n          const directory = yield this.cache.getDirectory(\n            this.source,\n            dO,\n            dL,\n            header\n          );\n          const entry = findTile(directory, tileId);\n          if (entry) {\n            if (entry.runLength > 0) {\n              const resp = yield this.source.getBytes(\n                header.tileDataOffset + entry.offset,\n                entry.length,\n                signal,\n                header.etag\n              );\n              return {\n                data: yield this.decompress(resp.data, header.tileCompression),\n                cacheControl: resp.cacheControl,\n                expires: resp.expires\n              };\n            }\n            dO = header.leafDirectoryOffset + entry.offset;\n            dL = entry.length;\n          } else {\n            return void 0;\n          }\n        }\n        throw Error(\"Maximum directory depth exceeded\");\n      });\n    }\n    getZxy(z, x2, y, signal) {\n      return __async2(this, null, function* () {\n        try {\n          return yield this.getZxyAttempt(z, x2, y, signal);\n        } catch (e) {\n          if (e instanceof EtagMismatch) {\n            this.cache.invalidate(this.source);\n            return yield this.getZxyAttempt(z, x2, y, signal);\n          }\n          throw e;\n        }\n      });\n    }\n    getMetadataAttempt() {\n      return __async2(this, null, function* () {\n        const header = yield this.cache.getHeader(this.source);\n        const resp = yield this.source.getBytes(\n          header.jsonMetadataOffset,\n          header.jsonMetadataLength,\n          void 0,\n          header.etag\n        );\n        const decompressed = yield this.decompress(\n          resp.data,\n          header.internalCompression\n        );\n        const dec = new TextDecoder(\"utf-8\");\n        return JSON.parse(dec.decode(decompressed));\n      });\n    }\n    getMetadata() {\n      return __async2(this, null, function* () {\n        try {\n          return yield this.getMetadataAttempt();\n        } catch (e) {\n          if (e instanceof EtagMismatch) {\n            this.cache.invalidate(this.source);\n            return yield this.getMetadataAttempt();\n          }\n          throw e;\n        }\n      });\n    }\n  };\n  function toIndex(c) {\n    return `${c.x}:${c.y}:${c.z}`;\n  }\n  var loadGeomAndBbox = (pbf, geometry, scale) => {\n    pbf.pos = geometry;\n    const end = pbf.readVarint() + pbf.pos;\n    let cmd = 1;\n    let length = 0;\n    let x2 = 0;\n    let y = 0;\n    let x1 = Infinity;\n    let x22 = -Infinity;\n    let y1 = Infinity;\n    let y2 = -Infinity;\n    const lines = [];\n    let line = [];\n    while (pbf.pos < end) {\n      if (length <= 0) {\n        const cmdLen = pbf.readVarint();\n        cmd = cmdLen & 7;\n        length = cmdLen >> 3;\n      }\n      length--;\n      if (cmd === 1 || cmd === 2) {\n        x2 += pbf.readSVarint() * scale;\n        y += pbf.readSVarint() * scale;\n        if (x2 < x1)\n          x1 = x2;\n        if (x2 > x22)\n          x22 = x2;\n        if (y < y1)\n          y1 = y;\n        if (y > y2)\n          y2 = y;\n        if (cmd === 1) {\n          if (line.length > 0)\n            lines.push(line);\n          line = [];\n        }\n        line.push(new import_point_geometry2.default(x2, y));\n      } else if (cmd === 7) {\n        if (line)\n          line.push(line[0].clone());\n      } else\n        throw new Error(`unknown command ${cmd}`);\n    }\n    if (line)\n      lines.push(line);\n    return { geom: lines, bbox: { minX: x1, minY: y1, maxX: x22, maxY: y2 } };\n  };\n  function parseTile(buffer, tileSize) {\n    const v = new import_vector_tile.VectorTile(new import_pbf.default(buffer));\n    const result = /* @__PURE__ */ new Map();\n    for (const [key, value] of Object.entries(v.layers)) {\n      const features = [];\n      const layer = value;\n      for (let i2 = 0; i2 < layer.length; i2++) {\n        const loaded = loadGeomAndBbox(\n          layer.feature(i2)._pbf,\n          layer.feature(i2)._geometry,\n          tileSize / layer.extent\n        );\n        let numVertices = 0;\n        for (const part of loaded.geom)\n          numVertices += part.length;\n        features.push({\n          id: layer.feature(i2).id,\n          geomType: layer.feature(i2).type,\n          geom: loaded.geom,\n          numVertices,\n          bbox: loaded.bbox,\n          props: layer.feature(i2).properties\n        });\n      }\n      result.set(key, features);\n    }\n    return result;\n  }\n  var PmtilesSource = class {\n    constructor(url, shouldCancelZooms) {\n      if (typeof url === \"string\") {\n        this.p = new PMTiles(url);\n      } else {\n        this.p = url;\n      }\n      this.zoomaborts = [];\n      this.shouldCancelZooms = shouldCancelZooms;\n    }\n    get(c, tileSize) {\n      return __async(this, null, function* () {\n        if (this.shouldCancelZooms) {\n          this.zoomaborts = this.zoomaborts.filter((za) => {\n            if (za.z !== c.z) {\n              za.controller.abort();\n              return false;\n            }\n            return true;\n          });\n        }\n        const controller = new AbortController();\n        this.zoomaborts.push({ z: c.z, controller });\n        const signal = controller.signal;\n        const result = yield this.p.getZxy(c.z, c.x, c.y, signal);\n        if (result) {\n          return parseTile(result.data, tileSize);\n        }\n        return /* @__PURE__ */ new Map();\n      });\n    }\n  };\n  var ZxySource = class {\n    constructor(url, shouldCancelZooms) {\n      this.url = url;\n      this.zoomaborts = [];\n      this.shouldCancelZooms = shouldCancelZooms;\n    }\n    get(c, tileSize) {\n      return __async(this, null, function* () {\n        if (this.shouldCancelZooms) {\n          this.zoomaborts = this.zoomaborts.filter((za) => {\n            if (za.z !== c.z) {\n              za.controller.abort();\n              return false;\n            }\n            return true;\n          });\n        }\n        const url = this.url.replace(\"{z}\", c.z.toString()).replace(\"{x}\", c.x.toString()).replace(\"{y}\", c.y.toString());\n        const controller = new AbortController();\n        this.zoomaborts.push({ z: c.z, controller });\n        const signal = controller.signal;\n        return new Promise((resolve, reject) => {\n          fetch(url, { signal }).then((resp) => {\n            return resp.arrayBuffer();\n          }).then((buffer) => {\n            const result = parseTile(buffer, tileSize);\n            resolve(result);\n          }).catch((e) => {\n            reject(e);\n          });\n        });\n      });\n    }\n  };\n  var R = 6378137;\n  var MAX_LATITUDE = 85.0511287798;\n  var MAXCOORD = R * Math.PI;\n  var project = (latlng) => {\n    const d = Math.PI / 180;\n    const constrainedLat = Math.max(\n      Math.min(MAX_LATITUDE, latlng[0]),\n      -MAX_LATITUDE\n    );\n    const sin = Math.sin(constrainedLat * d);\n    return new import_point_geometry2.default(\n      R * latlng[1] * d,\n      R * Math.log((1 + sin) / (1 - sin)) / 2\n    );\n  };\n  function sqr(x2) {\n    return x2 * x2;\n  }\n  function dist2(v, w) {\n    return sqr(v.x - w.x) + sqr(v.y - w.y);\n  }\n  function distToSegmentSquared(p, v, w) {\n    const l2 = dist2(v, w);\n    if (l2 === 0)\n      return dist2(p, v);\n    let t = ((p.x - v.x) * (w.x - v.x) + (p.y - v.y) * (w.y - v.y)) / l2;\n    t = Math.max(0, Math.min(1, t));\n    return dist2(p, new import_point_geometry2.default(v.x + t * (w.x - v.x), v.y + t * (w.y - v.y)));\n  }\n  function isInRing(point, ring) {\n    let inside = false;\n    for (let i2 = 0, j = ring.length - 1; i2 < ring.length; j = i2++) {\n      const xi = ring[i2].x;\n      const yi = ring[i2].y;\n      const xj = ring[j].x;\n      const yj = ring[j].y;\n      const intersect = yi > point.y !== yj > point.y && point.x < (xj - xi) * (point.y - yi) / (yj - yi) + xi;\n      if (intersect)\n        inside = !inside;\n    }\n    return inside;\n  }\n  function isCcw(ring) {\n    let area = 0;\n    for (let i2 = 0; i2 < ring.length; i2++) {\n      const j = (i2 + 1) % ring.length;\n      area += ring[i2].x * ring[j].y;\n      area -= ring[j].x * ring[i2].y;\n    }\n    return area < 0;\n  }\n  function pointInPolygon(point, geom) {\n    let isInCurrentExterior = false;\n    for (const ring of geom) {\n      if (isCcw(ring)) {\n        if (isInRing(point, ring))\n          isInCurrentExterior = false;\n      } else {\n        if (isInCurrentExterior)\n          return true;\n        if (isInRing(point, ring))\n          isInCurrentExterior = true;\n      }\n    }\n    return isInCurrentExterior;\n  }\n  function pointMinDistToPoints(point, geom) {\n    let min = Infinity;\n    for (const l of geom) {\n      const dist = Math.sqrt(dist2(point, l[0]));\n      if (dist < min)\n        min = dist;\n    }\n    return min;\n  }\n  function pointMinDistToLines(point, geom) {\n    let min = Infinity;\n    for (const l of geom) {\n      for (let i2 = 0; i2 < l.length - 1; i2++) {\n        const dist = Math.sqrt(distToSegmentSquared(point, l[i2], l[i2 + 1]));\n        if (dist < min)\n          min = dist;\n      }\n    }\n    return min;\n  }\n  var TileCache = class {\n    constructor(source, tileSize) {\n      this.source = source;\n      this.cache = /* @__PURE__ */ new Map();\n      this.inflight = /* @__PURE__ */ new Map();\n      this.tileSize = tileSize;\n    }\n    get(c) {\n      return __async(this, null, function* () {\n        const idx = toIndex(c);\n        return new Promise((resolve, reject) => {\n          const entry = this.cache.get(idx);\n          if (entry) {\n            entry.used = performance.now();\n            resolve(entry.data);\n          } else {\n            const ifentry = this.inflight.get(idx);\n            if (ifentry) {\n              ifentry.push({ resolve, reject });\n            } else {\n              this.inflight.set(idx, []);\n              this.source.get(c, this.tileSize).then((tile) => {\n                this.cache.set(idx, { used: performance.now(), data: tile });\n                const ifentry2 = this.inflight.get(idx);\n                if (ifentry2) {\n                  for (const f of ifentry2) {\n                    f.resolve(tile);\n                  }\n                }\n                this.inflight.delete(idx);\n                resolve(tile);\n                if (this.cache.size >= 64) {\n                  let minUsed = Infinity;\n                  let minKey = void 0;\n                  this.cache.forEach((value, key) => {\n                    if (value.used < minUsed) {\n                      minUsed = value.used;\n                      minKey = key;\n                    }\n                  });\n                  if (minKey)\n                    this.cache.delete(minKey);\n                }\n              }).catch((e) => {\n                const ifentry2 = this.inflight.get(idx);\n                if (ifentry2) {\n                  for (const f of ifentry2) {\n                    f.reject(e);\n                  }\n                }\n                this.inflight.delete(idx);\n                reject(e);\n              });\n            }\n          }\n        });\n      });\n    }\n    queryFeatures(lng, lat, zoom, brushSize) {\n      const projected = project([lat, lng]);\n      const normalized = new import_point_geometry2.default(\n        (projected.x + MAXCOORD) / (MAXCOORD * 2),\n        1 - (projected.y + MAXCOORD) / (MAXCOORD * 2)\n      );\n      if (normalized.x > 1)\n        normalized.x = normalized.x - Math.floor(normalized.x);\n      const onZoom = normalized.mult(1 << zoom);\n      const tileX = Math.floor(onZoom.x);\n      const tileY = Math.floor(onZoom.y);\n      const idx = toIndex({ z: zoom, x: tileX, y: tileY });\n      const retval = [];\n      const entry = this.cache.get(idx);\n      if (entry) {\n        const center = new import_point_geometry2.default(\n          (onZoom.x - tileX) * this.tileSize,\n          (onZoom.y - tileY) * this.tileSize\n        );\n        for (const [layerName, layerArr] of entry.data.entries()) {\n          for (const feature of layerArr) {\n            if (feature.geomType === 1 /* Point */) {\n              if (pointMinDistToPoints(center, feature.geom) < brushSize) {\n                retval.push({ feature, layerName });\n              }\n            } else if (feature.geomType === 2 /* Line */) {\n              if (pointMinDistToLines(center, feature.geom) < brushSize) {\n                retval.push({ feature, layerName });\n              }\n            } else {\n              if (pointInPolygon(center, feature.geom)) {\n                retval.push({ feature, layerName });\n              }\n            }\n          }\n        }\n      }\n      return retval;\n    }\n  };\n  var PolygonSymbolizer = class {\n    constructor(options) {\n      var _a2;\n      this.pattern = options.pattern;\n      this.fill = new StringAttr(options.fill, \"black\");\n      this.opacity = new NumberAttr(options.opacity, 1);\n      this.stroke = new StringAttr(options.stroke, \"black\");\n      this.width = new NumberAttr(options.width, 0);\n      this.perFeature = (_a2 = this.fill.perFeature || this.opacity.perFeature || this.stroke.perFeature || this.width.perFeature || options.perFeature) != null ? _a2 : false;\n      this.doStroke = false;\n    }\n    before(ctx, z) {\n      if (!this.perFeature) {\n        ctx.globalAlpha = this.opacity.get(z);\n        ctx.fillStyle = this.fill.get(z);\n        ctx.strokeStyle = this.stroke.get(z);\n        const width = this.width.get(z);\n        if (width > 0)\n          this.doStroke = true;\n        ctx.lineWidth = width;\n      }\n      if (this.pattern) {\n        const patten = ctx.createPattern(this.pattern, \"repeat\");\n        if (patten)\n          ctx.fillStyle = patten;\n      }\n    }\n    draw(ctx, geom, z, f) {\n      let doStroke = false;\n      if (this.perFeature) {\n        ctx.globalAlpha = this.opacity.get(z, f);\n        ctx.fillStyle = this.fill.get(z, f);\n        const width = this.width.get(z, f);\n        if (width) {\n          doStroke = true;\n          ctx.strokeStyle = this.stroke.get(z, f);\n          ctx.lineWidth = width;\n        }\n      }\n      const drawPath = () => {\n        ctx.fill();\n        if (doStroke || this.doStroke) {\n          ctx.stroke();\n        }\n      };\n      ctx.beginPath();\n      for (const poly of geom) {\n        for (let p = 0; p < poly.length; p++) {\n          const pt = poly[p];\n          if (p === 0)\n            ctx.moveTo(pt.x, pt.y);\n          else\n            ctx.lineTo(pt.x, pt.y);\n        }\n      }\n      drawPath();\n    }\n  };\n  function getStopIndex(input, stops) {\n    let idx = 0;\n    while (stops[idx + 1][0] < input)\n      idx++;\n    return idx;\n  }\n  function interpolate(factor, start, end) {\n    return factor * (end - start) + start;\n  }\n  function computeInterpolationFactor(z, idx, base, stops) {\n    const difference = stops[idx + 1][0] - stops[idx][0];\n    const progress = z - stops[idx][0];\n    if (difference === 0)\n      return 0;\n    if (base === 1)\n      return progress / difference;\n    return (__pow(base, progress) - 1) / (__pow(base, difference) - 1);\n  }\n  function exp(base, stops) {\n    return (z) => {\n      if (stops.length < 1)\n        return 0;\n      if (z <= stops[0][0])\n        return stops[0][1];\n      if (z >= stops[stops.length - 1][0])\n        return stops[stops.length - 1][1];\n      const idx = getStopIndex(z, stops);\n      const factor = computeInterpolationFactor(z, idx, base, stops);\n      return interpolate(factor, stops[idx][1], stops[idx + 1][1]);\n    };\n  }\n  function linear(stops) {\n    return exp(1, stops);\n  }\n  var LineSymbolizer = class {\n    constructor(options) {\n      var _a2;\n      this.color = new StringAttr(options.color, \"black\");\n      this.width = new NumberAttr(options.width);\n      this.opacity = new NumberAttr(options.opacity);\n      this.dash = options.dash ? new ArrayAttr(options.dash) : null;\n      this.dashColor = new StringAttr(options.dashColor, \"black\");\n      this.dashWidth = new NumberAttr(options.dashWidth, 1);\n      this.lineCap = new StringAttr(options.lineCap, \"butt\");\n      this.lineJoin = new StringAttr(options.lineJoin, \"miter\");\n      this.skip = false;\n      this.perFeature = !!(((_a2 = this.dash) == null ? void 0 : _a2.perFeature) || this.color.perFeature || this.opacity.perFeature || this.width.perFeature || this.lineCap.perFeature || this.lineJoin.perFeature || options.perFeature);\n    }\n    before(ctx, z) {\n      if (!this.perFeature) {\n        ctx.strokeStyle = this.color.get(z);\n        ctx.lineWidth = this.width.get(z);\n        ctx.globalAlpha = this.opacity.get(z);\n        ctx.lineCap = this.lineCap.get(z);\n        ctx.lineJoin = this.lineJoin.get(z);\n      }\n    }\n    draw(ctx, geom, z, f) {\n      if (this.skip)\n        return;\n      const strokePath = () => {\n        if (this.perFeature) {\n          ctx.globalAlpha = this.opacity.get(z, f);\n          ctx.lineCap = this.lineCap.get(z, f);\n          ctx.lineJoin = this.lineJoin.get(z, f);\n        }\n        if (this.dash) {\n          ctx.save();\n          if (this.perFeature) {\n            ctx.lineWidth = this.dashWidth.get(z, f);\n            ctx.strokeStyle = this.dashColor.get(z, f);\n            ctx.setLineDash(this.dash.get(z, f));\n          } else {\n            ctx.setLineDash(this.dash.get(z));\n          }\n          ctx.stroke();\n          ctx.restore();\n        } else {\n          ctx.save();\n          if (this.perFeature) {\n            ctx.lineWidth = this.width.get(z, f);\n            ctx.strokeStyle = this.color.get(z, f);\n          }\n          ctx.stroke();\n          ctx.restore();\n        }\n      };\n      ctx.beginPath();\n      for (const ls of geom) {\n        for (let p = 0; p < ls.length; p++) {\n          const pt = ls[p];\n          if (p === 0)\n            ctx.moveTo(pt.x, pt.y);\n          else\n            ctx.lineTo(pt.x, pt.y);\n        }\n      }\n      strokePath();\n    }\n  };\n  var CircleSymbolizer = class {\n    constructor(options) {\n      this.radius = new NumberAttr(options.radius, 3);\n      this.fill = new StringAttr(options.fill, \"black\");\n      this.stroke = new StringAttr(options.stroke, \"white\");\n      this.width = new NumberAttr(options.width, 0);\n      this.opacity = new NumberAttr(options.opacity);\n    }\n    draw(ctx, geom, z, f) {\n      ctx.globalAlpha = this.opacity.get(z, f);\n      const radius = this.radius.get(z, f);\n      const width = this.width.get(z, f);\n      if (width > 0) {\n        ctx.strokeStyle = this.stroke.get(z, f);\n        ctx.lineWidth = width;\n        ctx.beginPath();\n        ctx.arc(geom[0][0].x, geom[0][0].y, radius + width / 2, 0, 2 * Math.PI);\n        ctx.stroke();\n      }\n      ctx.fillStyle = this.fill.get(z, f);\n      ctx.beginPath();\n      ctx.arc(geom[0][0].x, geom[0][0].y, radius, 0, 2 * Math.PI);\n      ctx.fill();\n    }\n    place(layout, geom, feature) {\n      const pt = geom[0];\n      const a = new import_point_geometry3.default(geom[0][0].x, geom[0][0].y);\n      const radius = this.radius.get(layout.zoom, feature);\n      const bbox = {\n        minX: a.x - radius,\n        minY: a.y - radius,\n        maxX: a.x + radius,\n        maxY: a.y + radius\n      };\n      const draw = (ctx) => {\n        this.draw(ctx, [[new import_point_geometry3.default(0, 0)]], layout.zoom, feature);\n      };\n      return [{ anchor: a, bboxes: [bbox], draw }];\n    }\n  };\n  var mergeBbox = (b1, b2) => {\n    return {\n      minX: Math.min(b1.minX, b2.minX),\n      minY: Math.min(b1.minY, b2.minY),\n      maxX: Math.max(b1.maxX, b2.maxX),\n      maxY: Math.max(b1.maxY, b2.maxY)\n    };\n  };\n  var GroupSymbolizer = class {\n    constructor(list) {\n      this.list = list;\n    }\n    place(layout, geom, feature) {\n      const first = this.list[0];\n      if (!first)\n        return void 0;\n      let labels = first.place(layout, geom, feature);\n      if (!labels)\n        return void 0;\n      let label = labels[0];\n      const anchor = label.anchor;\n      let bbox = label.bboxes[0];\n      const draws = [label.draw];\n      for (let i2 = 1; i2 < this.list.length; i2++) {\n        labels = this.list[i2].place(layout, geom, feature);\n        if (!labels)\n          return void 0;\n        label = labels[0];\n        bbox = mergeBbox(bbox, label.bboxes[0]);\n        draws.push(label.draw);\n      }\n      const draw = (ctx) => {\n        for (const d of draws) {\n          d(ctx);\n        }\n      };\n      return [{ anchor, bboxes: [bbox], draw }];\n    }\n  };\n  var CenteredSymbolizer = class {\n    constructor(symbolizer) {\n      this.symbolizer = symbolizer;\n    }\n    place(layout, geom, feature) {\n      const a = geom[0][0];\n      const placed = this.symbolizer.place(layout, [[new import_point_geometry3.default(0, 0)]], feature);\n      if (!placed || placed.length === 0)\n        return void 0;\n      const firstLabel = placed[0];\n      const bbox = firstLabel.bboxes[0];\n      const width = bbox.maxX - bbox.minX;\n      const height = bbox.maxY - bbox.minY;\n      const centered = {\n        minX: a.x - width / 2,\n        maxX: a.x + width / 2,\n        minY: a.y - height / 2,\n        maxY: a.y + height / 2\n      };\n      const draw = (ctx) => {\n        ctx.translate(-width / 2, height / 2 - bbox.maxY);\n        firstLabel.draw(ctx, { justify: 2 /* Center */ });\n      };\n      return [{ anchor: a, bboxes: [centered], draw }];\n    }\n  };\n  var TextSymbolizer = class {\n    constructor(options) {\n      this.font = new FontAttr(options);\n      this.text = new TextAttr(options);\n      this.fill = new StringAttr(options.fill, \"black\");\n      this.stroke = new StringAttr(options.stroke, \"black\");\n      this.width = new NumberAttr(options.width, 0);\n      this.lineHeight = new NumberAttr(options.lineHeight, 1);\n      this.letterSpacing = new NumberAttr(options.letterSpacing, 0);\n      this.maxLineCodeUnits = new NumberAttr(options.maxLineChars, 15);\n      this.justify = options.justify;\n    }\n    place(layout, geom, feature) {\n      const property = this.text.get(layout.zoom, feature);\n      if (!property)\n        return void 0;\n      const font = this.font.get(layout.zoom, feature);\n      layout.scratch.font = font;\n      const letterSpacing = this.letterSpacing.get(layout.zoom, feature);\n      const lines = linebreak(\n        property,\n        this.maxLineCodeUnits.get(layout.zoom, feature)\n      );\n      let longestLine = \"\";\n      let longestLineLen = 0;\n      for (const line of lines) {\n        if (line.length > longestLineLen) {\n          longestLineLen = line.length;\n          longestLine = line;\n        }\n      }\n      const metrics = layout.scratch.measureText(longestLine);\n      const width = metrics.width + letterSpacing * (longestLineLen - 1);\n      const ascent = metrics.actualBoundingBoxAscent;\n      const descent = metrics.actualBoundingBoxDescent;\n      const lineHeight = (ascent + descent) * this.lineHeight.get(layout.zoom, feature);\n      const a = new import_point_geometry3.default(geom[0][0].x, geom[0][0].y);\n      const bbox = {\n        minX: a.x,\n        minY: a.y - ascent,\n        maxX: a.x + width,\n        maxY: a.y + descent + (lines.length - 1) * lineHeight\n      };\n      const draw = (ctx, extra) => {\n        ctx.globalAlpha = 1;\n        ctx.font = font;\n        ctx.fillStyle = this.fill.get(layout.zoom, feature);\n        const textStrokeWidth = this.width.get(layout.zoom, feature);\n        let y = 0;\n        for (const line of lines) {\n          let startX = 0;\n          if (this.justify === 2 /* Center */ || extra && extra.justify === 2 /* Center */) {\n            startX = (width - ctx.measureText(line).width) / 2;\n          } else if (this.justify === 3 /* Right */ || extra && extra.justify === 3 /* Right */) {\n            startX = width - ctx.measureText(line).width;\n          }\n          if (textStrokeWidth) {\n            ctx.lineWidth = textStrokeWidth * 2;\n            ctx.strokeStyle = this.stroke.get(layout.zoom, feature);\n            if (letterSpacing > 0) {\n              let xPos = startX;\n              for (const letter of line) {\n                ctx.strokeText(letter, xPos, y);\n                xPos += ctx.measureText(letter).width + letterSpacing;\n              }\n            } else {\n              ctx.strokeText(line, startX, y);\n            }\n          }\n          if (letterSpacing > 0) {\n            let xPos = startX;\n            for (const letter of line) {\n              ctx.fillText(letter, xPos, y);\n              xPos += ctx.measureText(letter).width + letterSpacing;\n            }\n          } else {\n            ctx.fillText(line, startX, y);\n          }\n          y += lineHeight;\n        }\n      };\n      return [{ anchor: a, bboxes: [bbox], draw }];\n    }\n  };\n  var CenteredTextSymbolizer = class {\n    constructor(options) {\n      this.centered = new CenteredSymbolizer(new TextSymbolizer(options));\n    }\n    place(layout, geom, feature) {\n      return this.centered.place(layout, geom, feature);\n    }\n  };\n  var OffsetSymbolizer = class {\n    constructor(symbolizer, options) {\n      var _a2, _b2, _c;\n      this.symbolizer = symbolizer;\n      this.offsetX = new NumberAttr(options.offsetX, 0);\n      this.offsetY = new NumberAttr(options.offsetY, 0);\n      this.justify = (_a2 = options.justify) != null ? _a2 : void 0;\n      this.placements = (_b2 = options.placements) != null ? _b2 : [\n        2 /* Ne */,\n        6 /* Sw */,\n        8 /* Nw */,\n        4 /* Se */,\n        1 /* N */,\n        3 /* E */,\n        5 /* S */,\n        7 /* W */\n      ];\n      this.ddValues = (_c = options.ddValues) != null ? _c : () => {\n        return {};\n      };\n    }\n    place(layout, geom, feature) {\n      if (feature.geomType !== 1 /* Point */)\n        return void 0;\n      const anchor = geom[0][0];\n      const placed = this.symbolizer.place(layout, [[new import_point_geometry3.default(0, 0)]], feature);\n      if (!placed || placed.length === 0)\n        return void 0;\n      const firstLabel = placed[0];\n      const fb = firstLabel.bboxes[0];\n      let offsetXvalue = this.offsetX;\n      let offsetYvalue = this.offsetY;\n      let justifyValue = this.justify;\n      let placements = this.placements;\n      const {\n        offsetX: ddOffsetX,\n        offsetY: ddOffsetY,\n        justify: ddJustify,\n        placements: ddPlacements\n      } = this.ddValues(layout.zoom, feature) || {};\n      if (ddOffsetX)\n        offsetXvalue = new NumberAttr(ddOffsetX, 0);\n      if (ddOffsetY)\n        offsetYvalue = new NumberAttr(ddOffsetY, 0);\n      if (ddJustify)\n        justifyValue = ddJustify;\n      if (ddPlacements)\n        placements = ddPlacements;\n      const offsetX = offsetXvalue.get(layout.zoom, feature);\n      const offsetY = offsetYvalue.get(layout.zoom, feature);\n      const getBbox = (a, o) => {\n        return {\n          minX: a.x + o.x + fb.minX,\n          minY: a.y + o.y + fb.minY,\n          maxX: a.x + o.x + fb.maxX,\n          maxY: a.y + o.y + fb.maxY\n        };\n      };\n      let origin = new import_point_geometry3.default(offsetX, offsetY);\n      let justify;\n      const draw = (ctx) => {\n        ctx.translate(origin.x, origin.y);\n        firstLabel.draw(ctx, { justify });\n      };\n      const placeLabelInPoint = (a, o) => {\n        const bbox = getBbox(a, o);\n        if (!layout.index.bboxCollides(bbox, layout.order))\n          return [{ anchor, bboxes: [bbox], draw }];\n      };\n      for (const placement of placements) {\n        const xAxisOffset = this.computeXaxisOffset(offsetX, fb, placement);\n        const yAxisOffset = this.computeYaxisOffset(offsetY, fb, placement);\n        justify = this.computeJustify(justifyValue, placement);\n        origin = new import_point_geometry3.default(xAxisOffset, yAxisOffset);\n        return placeLabelInPoint(anchor, origin);\n      }\n      return void 0;\n    }\n    computeXaxisOffset(offsetX, fb, placement) {\n      const labelWidth = fb.maxX;\n      const labelHalfWidth = labelWidth / 2;\n      if ([1 /* N */, 5 /* S */].includes(placement))\n        return offsetX - labelHalfWidth;\n      if ([8 /* Nw */, 7 /* W */, 6 /* Sw */].includes(\n        placement\n      ))\n        return offsetX - labelWidth;\n      return offsetX;\n    }\n    computeYaxisOffset(offsetY, fb, placement) {\n      const labelHalfHeight = Math.abs(fb.minY);\n      const labelBottom = fb.maxY;\n      const labelCenterHeight = (fb.minY + fb.maxY) / 2;\n      if ([3 /* E */, 7 /* W */].includes(placement))\n        return offsetY - labelCenterHeight;\n      if ([8 /* Nw */, 2 /* Ne */, 1 /* N */].includes(\n        placement\n      ))\n        return offsetY - labelBottom;\n      if ([6 /* Sw */, 4 /* Se */, 5 /* S */].includes(\n        placement\n      ))\n        return offsetY + labelHalfHeight;\n      return offsetY;\n    }\n    computeJustify(fixedJustify, placement) {\n      if (fixedJustify)\n        return fixedJustify;\n      if ([1 /* N */, 5 /* S */].includes(placement))\n        return 2 /* Center */;\n      if ([2 /* Ne */, 3 /* E */, 4 /* Se */].includes(\n        placement\n      ))\n        return 1 /* Left */;\n      return 3 /* Right */;\n    }\n  };\n  var OffsetTextSymbolizer = class {\n    constructor(options) {\n      this.symbolizer = new OffsetSymbolizer(\n        new TextSymbolizer(options),\n        options\n      );\n    }\n    place(layout, geom, feature) {\n      return this.symbolizer.place(layout, geom, feature);\n    }\n  };\n  var LineLabelSymbolizer = class {\n    constructor(options) {\n      var _a2;\n      this.font = new FontAttr(options);\n      this.text = new TextAttr(options);\n      this.fill = new StringAttr(options.fill, \"black\");\n      this.stroke = new StringAttr(options.stroke, \"black\");\n      this.width = new NumberAttr(options.width, 0);\n      this.offset = new NumberAttr(options.offset, 0);\n      this.position = (_a2 = options.position) != null ? _a2 : 1 /* Above */;\n      this.maxLabelCodeUnits = new NumberAttr(options.maxLabelChars, 40);\n      this.repeatDistance = new NumberAttr(options.repeatDistance, 250);\n    }\n    place(layout, geom, feature) {\n      const name = this.text.get(layout.zoom, feature);\n      if (!name)\n        return void 0;\n      if (name.length > this.maxLabelCodeUnits.get(layout.zoom, feature))\n        return void 0;\n      const minLabelableDim = 20;\n      const fbbox = feature.bbox;\n      if (fbbox.maxY - fbbox.minY < minLabelableDim && fbbox.maxX - fbbox.minX < minLabelableDim)\n        return void 0;\n      const font = this.font.get(layout.zoom, feature);\n      layout.scratch.font = font;\n      const metrics = layout.scratch.measureText(name);\n      const width = metrics.width;\n      const height = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n      let repeatDistance = this.repeatDistance.get(layout.zoom, feature);\n      if (layout.overzoom > 4)\n        repeatDistance *= 1 << layout.overzoom - 4;\n      const cellSize = height * 2;\n      const labelCandidates = simpleLabel(geom, width, repeatDistance, cellSize);\n      if (labelCandidates.length === 0)\n        return void 0;\n      const labels = [];\n      for (const candidate of labelCandidates) {\n        const dx = candidate.end.x - candidate.start.x;\n        const dy = candidate.end.y - candidate.start.y;\n        const cells = lineCells(\n          candidate.start,\n          candidate.end,\n          width,\n          cellSize / 2\n        );\n        const bboxes = cells.map((c) => {\n          return {\n            minX: c.x - cellSize / 2,\n            minY: c.y - cellSize / 2,\n            maxX: c.x + cellSize / 2,\n            maxY: c.y + cellSize / 2\n          };\n        });\n        const draw = (ctx) => {\n          ctx.globalAlpha = 1;\n          ctx.rotate(Math.atan2(dy, dx));\n          if (dx < 0) {\n            ctx.scale(-1, -1);\n            ctx.translate(-width, 0);\n          }\n          let heightPlacement = 0;\n          if (this.position === 3 /* Below */)\n            heightPlacement += height;\n          else if (this.position === 2 /* Center */)\n            heightPlacement += height / 2;\n          ctx.translate(\n            0,\n            heightPlacement - this.offset.get(layout.zoom, feature)\n          );\n          ctx.font = font;\n          const lineWidth = this.width.get(layout.zoom, feature);\n          if (lineWidth) {\n            ctx.lineWidth = lineWidth;\n            ctx.strokeStyle = this.stroke.get(layout.zoom, feature);\n            ctx.strokeText(name, 0, 0);\n          }\n          ctx.fillStyle = this.fill.get(layout.zoom, feature);\n          ctx.fillText(name, 0, 0);\n        };\n        labels.push({\n          anchor: candidate.start,\n          bboxes,\n          draw,\n          deduplicationKey: name,\n          deduplicationDistance: repeatDistance\n        });\n      }\n      return labels;\n    }\n  };\n\n  // src/default_style/style.ts\n  var getString = (props, key) => {\n    const val = props[key];\n    if (typeof val === \"string\")\n      return val;\n    return \"\";\n  };\n  var getNumber = (props, key) => {\n    const val = props[key];\n    if (typeof val === \"number\")\n      return val;\n    return 0;\n  };\n  var paintRules = (t) => {\n    return [\n      {\n        dataLayer: \"earth\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.earth\n        })\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: (z, f) => {\n            return mix(t.park_a, t.park_b, Math.min(Math.max(z / 12, 12), 0));\n          }\n        }),\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"allotments\", \"village_green\", \"playground\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.park_b,\n          opacity: 0.7\n        }),\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\n            \"national_park\",\n            \"park\",\n            \"cemetery\",\n            \"protected_area\",\n            \"nature_reserve\",\n            \"forest\",\n            \"golf_course\"\n          ].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.hospital\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"hospital\";\n        }\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.industrial\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"industrial\";\n        }\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.school\n        }),\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"school\", \"university\", \"college\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.beach\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"beach\";\n        }\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.zoo\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"zoo\";\n        }\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.zoo\n        }),\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"military\", \"naval_base\", \"airfield\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"natural\",\n        symbolizer: new PolygonSymbolizer({\n          fill: (z, f) => {\n            return mix(t.wood_a, t.wood_b, Math.min(Math.max(z / 12, 12), 0));\n          }\n        }),\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"wood\", \"nature_reserve\", \"forest\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"natural\",\n        symbolizer: new PolygonSymbolizer({\n          fill: (z, f) => {\n            return mix(t.scrub_a, t.scrub_b, Math.min(Math.max(z / 12, 12), 0));\n          }\n        }),\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"scrub\", \"grassland\", \"grass\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"natural\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.scrub_b\n        }),\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"scrub\", \"grassland\", \"grass\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"natural\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.glacier\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"glacier\";\n        }\n      },\n      {\n        dataLayer: \"natural\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.sand\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"sand\";\n        }\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.aerodrome\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"aerodrome\";\n        }\n      },\n      {\n        dataLayer: \"water\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.water\n        })\n      },\n      {\n        dataLayer: \"transit\",\n        symbolizer: new LineSymbolizer({\n          color: t.runway,\n          width: (z, f) => {\n            return exp(1.6, [\n              [11, 0],\n              [13, 4],\n              [19, 30]\n            ])(z);\n          }\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind_detail\"] === \"runway\";\n        }\n      },\n      {\n        dataLayer: \"transit\",\n        symbolizer: new LineSymbolizer({\n          color: t.runway,\n          width: (z, f) => {\n            return exp(1.6, [\n              [14, 0],\n              [14.5, 1],\n              [16, 6]\n            ])(z);\n          }\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind_detail\"] === \"taxiway\";\n        }\n      },\n      {\n        dataLayer: \"transit\",\n        symbolizer: new LineSymbolizer({\n          color: t.pier,\n          width: (z, f) => {\n            return exp(1.6, [\n              [13, 0],\n              [13.5, 0, 5],\n              [21, 16]\n            ])(z);\n          }\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"pier\";\n        }\n      },\n      {\n        dataLayer: \"physical_line\",\n        minzoom: 14,\n        symbolizer: new LineSymbolizer({\n          color: t.water,\n          width: (z, f) => {\n            return exp(1.6, [\n              [9, 0],\n              [9.5, 1],\n              [18, 12]\n            ])(z);\n          }\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"river\";\n        }\n      },\n      {\n        dataLayer: \"physical_line\",\n        minzoom: 14,\n        symbolizer: new LineSymbolizer({\n          color: t.water,\n          width: 0.5\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"stream\";\n        }\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.pedestrian\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"pedestrian\";\n        }\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.pier\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"pier\";\n        }\n      },\n      {\n        dataLayer: \"buildings\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.buildings,\n          opacity: 0.5\n        })\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineSymbolizer({\n          color: t.major,\n          width: (z, f) => {\n            return exp(1.6, [\n              [14, 0],\n              [20, 7]\n            ])(z);\n          }\n        }),\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"other\", \"path\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineSymbolizer({\n          color: t.major,\n          width: (z, f) => {\n            return exp(1.6, [\n              [13, 0],\n              [18, 8]\n            ])(z);\n          }\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"minor_road\";\n        }\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineSymbolizer({\n          color: t.major,\n          width: (z, f) => {\n            return exp(1.6, [\n              [7, 0],\n              [12, 1.2],\n              [15, 3],\n              [18, 13]\n            ])(z);\n          }\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"medium_road\";\n        }\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineSymbolizer({\n          color: t.major,\n          width: (z, f) => {\n            return exp(1.6, [\n              [6, 0],\n              [12, 1.6],\n              [15, 3],\n              [18, 13]\n            ])(z);\n          }\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"major_road\";\n        }\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineSymbolizer({\n          color: t.major,\n          width: (z, f) => {\n            return exp(1.6, [\n              [3, 0],\n              [6, 1.1],\n              [12, 1.6],\n              [15, 5],\n              [18, 15]\n            ])(z);\n          }\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"highway\";\n        }\n      },\n      {\n        dataLayer: \"boundaries\",\n        symbolizer: new LineSymbolizer({\n          dash: [3, 2],\n          color: t.boundaries,\n          width: 1\n        }),\n        filter: (z, f) => {\n          const minAdminLevel = f.props[\"pmap:min_admin_level\"];\n          return typeof minAdminLevel === \"number\" && minAdminLevel <= 2;\n        }\n      },\n      {\n        dataLayer: \"transit\",\n        symbolizer: new LineSymbolizer({\n          dash: [0.3, 0.75],\n          color: t.railway,\n          dashWidth: (z, f) => {\n            return exp(1.6, [\n              [4, 0],\n              [7, 0.15],\n              [19, 9]\n            ])(z);\n          },\n          opacity: 0.5\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"rail\";\n        }\n      },\n      {\n        dataLayer: \"boundaries\",\n        symbolizer: new LineSymbolizer({\n          dash: [3, 2],\n          color: t.boundaries,\n          width: 0.5\n        }),\n        filter: (z, f) => {\n          const minAdminLevel = f.props[\"pmap:min_admin_level\"];\n          return typeof minAdminLevel === \"number\" && minAdminLevel > 2;\n        }\n      }\n    ];\n  };\n  var labelRules = (t) => {\n    const nametags = [\"name\"];\n    return [\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineLabelSymbolizer({\n          labelProps: nametags,\n          fill: t.roads_label_minor,\n          font: \"400 12px sans-serif\",\n          width: 2,\n          stroke: t.roads_label_minor_halo\n        }),\n        minzoom: 16,\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"minor_road\", \"other\", \"path\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineLabelSymbolizer({\n          labelProps: nametags,\n          fill: t.roads_label_major,\n          font: \"400 12px sans-serif\",\n          width: 2,\n          stroke: t.roads_label_major_halo\n        }),\n        minzoom: 12,\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"highway\", \"major_road\", \"medium_road\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineLabelSymbolizer({\n          labelProps: nametags,\n          fill: t.roads_label_major,\n          font: \"400 12px sans-serif\",\n          width: 2,\n          stroke: t.roads_label_major_halo\n        }),\n        minzoom: 12,\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"highway\", \"major_road\", \"medium_road\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"physical_point\",\n        symbolizer: new CenteredTextSymbolizer({\n          labelProps: nametags,\n          fill: t.ocean_label,\n          lineHeight: 1.5,\n          letterSpacing: 1,\n          font: (z, f) => {\n            const size = linear([\n              [3, 10],\n              [10, 12]\n            ])(z);\n            return `400 ${size}px sans-serif`;\n          },\n          textTransform: \"uppercase\"\n        }),\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"ocean\", \"bay\", \"strait\", \"fjord\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"physical_point\",\n        symbolizer: new CenteredTextSymbolizer({\n          labelProps: nametags,\n          fill: t.ocean_label,\n          lineHeight: 1.5,\n          letterSpacing: 1,\n          font: (z, f) => {\n            const size = linear([\n              [3, 0],\n              [6, 12],\n              [10, 12]\n            ])(z);\n            return `400 ${size}px sans-serif`;\n          }\n        }),\n        filter: (z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"sea\", \"lake\", \"water\"].includes(kind);\n        }\n      },\n      {\n        dataLayer: \"places\",\n        symbolizer: new CenteredTextSymbolizer({\n          labelProps: (z, f) => {\n            if (z < 6) {\n              return [\"name:short\"];\n            }\n            return nametags;\n          },\n          fill: t.state_label,\n          stroke: t.state_label_halo,\n          width: 1,\n          lineHeight: 1.5,\n          font: (z, f) => {\n            if (z < 6)\n              return \"400 16px sans-serif\";\n            return \"400 12px sans-serif\";\n          },\n          textTransform: \"uppercase\"\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"region\";\n        }\n      },\n      {\n        dataLayer: \"places\",\n        symbolizer: new CenteredTextSymbolizer({\n          labelProps: nametags,\n          fill: t.country_label,\n          lineHeight: 1.5,\n          font: (z, f) => {\n            if (z < 6)\n              return \"600 12px sans-serif\";\n            return \"600 12px sans-serif\";\n          },\n          textTransform: \"uppercase\"\n        }),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"country\";\n        }\n      },\n      {\n        dataLayer: \"places\",\n        minzoom: 9,\n        symbolizer: new CenteredTextSymbolizer({\n          labelProps: nametags,\n          fill: t.city_label,\n          lineHeight: 1.5,\n          font: (z, f) => {\n            if (!f)\n              return \"400 12px sans-serif\";\n            const minZoom = f.props[\"pmap:min_zoom\"];\n            let weight = 400;\n            if (minZoom && minZoom <= 5) {\n              weight = 600;\n            }\n            let size = 12;\n            const popRank = f.props[\"pmap:population_rank\"];\n            if (popRank && popRank > 9) {\n              size = 16;\n            }\n            return `${weight} ${size}px sans-serif`;\n          }\n        }),\n        sort: (a, b) => {\n          const aRank = getNumber(a, \"pmap:population_rank\");\n          const bRank = getNumber(b, \"pmap:population_rank\");\n          return aRank - bRank;\n        },\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"locality\";\n        }\n      },\n      {\n        dataLayer: \"places\",\n        maxzoom: 8,\n        symbolizer: new GroupSymbolizer([\n          new CircleSymbolizer({\n            radius: 2,\n            fill: t.city_circle,\n            stroke: t.city_circle_stroke,\n            width: 1.5\n          }),\n          new OffsetTextSymbolizer({\n            labelProps: nametags,\n            fill: t.city_label,\n            stroke: t.city_label_halo,\n            width: 1,\n            offsetX: 6,\n            offsetY: 4.5,\n            font: (z, f) => {\n              return \"400 12px sans-serif\";\n            }\n          })\n        ]),\n        filter: (z, f) => {\n          return f.props[\"pmap:kind\"] === \"locality\";\n        }\n      }\n    ];\n  };\n\n  // src/default_style/themes.ts\n  var LIGHT = {\n    background: \"#cccccc\",\n    earth: \"#e0e0e0\",\n    park_a: \"#cfddd5\",\n    park_b: \"#9cd3b4\",\n    hospital: \"#e4dad9\",\n    industrial: \"#d1dde1\",\n    school: \"#e4ded7\",\n    wood_a: \"#d0ded0\",\n    wood_b: \"#a0d9a0\",\n    pedestrian: \"#e3e0d4\",\n    scrub_a: \"#cedcd7\",\n    scrub_b: \"#99d2bb\",\n    glacier: \"#e7e7e7\",\n    sand: \"#e2e0d7\",\n    beach: \"#e8e4d0\",\n    aerodrome: \"#dadbdf\",\n    runway: \"#e9e9ed\",\n    water: \"#80deea\",\n    pier: \"#e0e0e0\",\n    zoo: \"#c6dcdc\",\n    military: \"#dcdcdc\",\n    tunnel_other_casing: \"#e0e0e0\",\n    tunnel_minor_casing: \"#e0e0e0\",\n    tunnel_link_casing: \"#e0e0e0\",\n    tunnel_medium_casing: \"#e0e0e0\",\n    tunnel_major_casing: \"#e0e0e0\",\n    tunnel_highway_casing: \"#e0e0e0\",\n    tunnel_other: \"#d5d5d5\",\n    tunnel_minor: \"#d5d5d5\",\n    tunnel_link: \"#d5d5d5\",\n    tunnel_medium: \"#d5d5d5\",\n    tunnel_major: \"#d5d5d5\",\n    tunnel_highway: \"#d5d5d5\",\n    transit_pier: \"#e0e0e0\",\n    buildings: \"#cccccc\",\n    minor_service_casing: \"#e0e0e0\",\n    minor_casing: \"#e0e0e0\",\n    link_casing: \"#e0e0e0\",\n    medium_casing: \"#e0e0e0\",\n    major_casing_late: \"#e0e0e0\",\n    highway_casing_late: \"#e0e0e0\",\n    other: \"#ebebeb\",\n    minor_service: \"#ebebeb\",\n    minor_a: \"#ebebeb\",\n    minor_b: \"#ffffff\",\n    link: \"#ffffff\",\n    medium: \"#f5f5f5\",\n    major_casing_early: \"#e0e0e0\",\n    major: \"#ffffff\",\n    highway_casing_early: \"#e0e0e0\",\n    highway: \"#ffffff\",\n    railway: \"#a7b1b3\",\n    boundaries: \"#adadad\",\n    waterway_label: \"#ffffff\",\n    bridges_other_casing: \"#e0e0e0\",\n    bridges_minor_casing: \"#e0e0e0\",\n    bridges_link_casing: \"#e0e0e0\",\n    bridges_medium_casing: \"#e0e0e0\",\n    bridges_major_casing: \"#e0e0e0\",\n    bridges_highway_casing: \"#e0e0e0\",\n    bridges_other: \"#ebebeb\",\n    bridges_minor: \"#ffffff\",\n    bridges_link: \"#ffffff\",\n    bridges_medium: \"#f0eded\",\n    bridges_major: \"#f5f5f5\",\n    bridges_highway: \"#ffffff\",\n    roads_label_minor: \"#91888b\",\n    roads_label_minor_halo: \"#ffffff\",\n    roads_label_major: \"#938a8d\",\n    roads_label_major_halo: \"#ffffff\",\n    ocean_label: \"#ffffff\",\n    peak_label: \"#7e9aa0\",\n    subplace_label: \"#8f8f8f\",\n    subplace_label_halo: \"#e0e0e0\",\n    city_circle: \"#ffffff\",\n    city_circle_stroke: \"#a3a3a3\",\n    city_label: \"#5c5c5c\",\n    city_label_halo: \"#e0e0e0\",\n    state_label: \"#b3b3b3\",\n    state_label_halo: \"#e0e0e0\",\n    country_label: \"#a3a3a3\"\n  };\n  var DARK = {\n    background: \"#34373d\",\n    earth: \"#1f1f1f\",\n    park_a: \"#232325\",\n    park_b: \"#232325\",\n    hospital: \"#252424\",\n    industrial: \"#222222\",\n    school: \"#262323\",\n    wood_a: \"#202121\",\n    wood_b: \"#202121\",\n    pedestrian: \"#1e1e1e\",\n    scrub_a: \"#222323\",\n    scrub_b: \"#222323\",\n    glacier: \"#1c1c1c\",\n    sand: \"#212123\",\n    beach: \"#28282a\",\n    aerodrome: \"#1e1e1e\",\n    runway: \"#333333\",\n    water: \"#34373d\",\n    pier: \"#222222\",\n    zoo: \"#222323\",\n    military: \"#242323\",\n    tunnel_other_casing: \"#141414\",\n    tunnel_minor_casing: \"#141414\",\n    tunnel_link_casing: \"#141414\",\n    tunnel_medium_casing: \"#141414\",\n    tunnel_major_casing: \"#141414\",\n    tunnel_highway_casing: \"#141414\",\n    tunnel_other: \"#292929\",\n    tunnel_minor: \"#292929\",\n    tunnel_link: \"#292929\",\n    tunnel_medium: \"#292929\",\n    tunnel_major: \"#292929\",\n    tunnel_highway: \"#292929\",\n    transit_pier: \"#333333\",\n    buildings: \"#111111\",\n    minor_service_casing: \"#1f1f1f\",\n    minor_casing: \"#1f1f1f\",\n    link_casing: \"#1f1f1f\",\n    medium_casing: \"#1f1f1f\",\n    major_casing_late: \"#1f1f1f\",\n    highway_casing_late: \"#1f1f1f\",\n    other: \"#333333\",\n    minor_service: \"#333333\",\n    minor_a: \"#3d3d3d\",\n    minor_b: \"#333333\",\n    link: \"#3d3d3d\",\n    medium: \"#3d3d3d\",\n    major_casing_early: \"#1f1f1f\",\n    major: \"#3d3d3d\",\n    highway_casing_early: \"#1f1f1f\",\n    highway: \"#474747\",\n    railway: \"#000000\",\n    boundaries: \"#5b6374\",\n    waterway_label: \"#717784\",\n    bridges_other_casing: \"#2b2b2b\",\n    bridges_minor_casing: \"#1f1f1f\",\n    bridges_link_casing: \"#1f1f1f\",\n    bridges_medium_casing: \"#1f1f1f\",\n    bridges_major_casing: \"#1f1f1f\",\n    bridges_highway_casing: \"#1f1f1f\",\n    bridges_other: \"#333333\",\n    bridges_minor: \"#333333\",\n    bridges_link: \"#3d3d3d\",\n    bridges_medium: \"#3d3d3d\",\n    bridges_major: \"#3d3d3d\",\n    bridges_highway: \"#474747\",\n    roads_label_minor: \"#525252\",\n    roads_label_minor_halo: \"#1f1f1f\",\n    roads_label_major: \"#666666\",\n    roads_label_major_halo: \"#1f1f1f\",\n    ocean_label: \"#717784\",\n    peak_label: \"#898080\",\n    subplace_label: \"#525252\",\n    subplace_label_halo: \"#1f1f1f\",\n    city_circle: \"#000000\",\n    city_circle_stroke: \"#7a7a7a\",\n    city_label: \"#7a7a7a\",\n    city_label_halo: \"#212121\",\n    state_label: \"#3d3d3d\",\n    state_label_halo: \"#1f1f1f\",\n    country_label: \"#5c5c5c\"\n  };\n  var WHITE = {\n    background: \"#ffffff\",\n    earth: \"#ffffff\",\n    park_a: \"#fcfcfc\",\n    park_b: \"#fcfcfc\",\n    hospital: \"#f8f8f8\",\n    industrial: \"#fcfcfc\",\n    school: \"#f8f8f8\",\n    wood_a: \"#fafafa\",\n    wood_b: \"#fafafa\",\n    pedestrian: \"#fdfdfd\",\n    scrub_a: \"#fafafa\",\n    scrub_b: \"#fafafa\",\n    glacier: \"#fcfcfc\",\n    sand: \"#fafafa\",\n    beach: \"#f6f6f6\",\n    aerodrome: \"#fdfdfd\",\n    runway: \"#efefef\",\n    water: \"#dcdcdc\",\n    pier: \"#f5f5f5\",\n    zoo: \"#f7f7f7\",\n    military: \"#fcfcfc\",\n    tunnel_other_casing: \"#d6d6d6\",\n    tunnel_minor_casing: \"#fcfcfc\",\n    tunnel_link_casing: \"#fcfcfc\",\n    tunnel_medium_casing: \"#fcfcfc\",\n    tunnel_major_casing: \"#fcfcfc\",\n    tunnel_highway_casing: \"#fcfcfc\",\n    tunnel_other: \"#d6d6d6\",\n    tunnel_minor: \"#d6d6d6\",\n    tunnel_link: \"#d6d6d6\",\n    tunnel_medium: \"#d6d6d6\",\n    tunnel_major: \"#d6d6d6\",\n    tunnel_highway: \"#d6d6d6\",\n    transit_pier: \"#efefef\",\n    buildings: \"#efefef\",\n    minor_service_casing: \"#ffffff\",\n    minor_casing: \"#ffffff\",\n    link_casing: \"#ffffff\",\n    medium_casing: \"#ffffff\",\n    major_casing_late: \"#ffffff\",\n    highway_casing_late: \"#ffffff\",\n    other: \"#f5f5f5\",\n    minor_service: \"#f5f5f5\",\n    minor_a: \"#ebebeb\",\n    minor_b: \"#f5f5f5\",\n    link: \"#ebebeb\",\n    medium: \"#ebebeb\",\n    major_casing_early: \"#ffffff\",\n    major: \"#ebebeb\",\n    highway_casing_early: \"#ffffff\",\n    highway: \"#ebebeb\",\n    railway: \"#d6d6d6\",\n    boundaries: \"#adadad\",\n    waterway_label: \"#adadad\",\n    bridges_other_casing: \"#ffffff\",\n    bridges_minor_casing: \"#ffffff\",\n    bridges_link_casing: \"#ffffff\",\n    bridges_medium_casing: \"#ffffff\",\n    bridges_major_casing: \"#ffffff\",\n    bridges_highway_casing: \"#ffffff\",\n    bridges_other: \"#f5f5f5\",\n    bridges_minor: \"#f5f5f5\",\n    bridges_link: \"#ebebeb\",\n    bridges_medium: \"#ebebeb\",\n    bridges_major: \"#ebebeb\",\n    bridges_highway: \"#ebebeb\",\n    roads_label_minor: \"#adadad\",\n    roads_label_minor_halo: \"#ffffff\",\n    roads_label_major: \"#999999\",\n    roads_label_major_halo: \"#ffffff\",\n    ocean_label: \"#adadad\",\n    peak_label: \"#adadad\",\n    subplace_label: \"#8f8f8f\",\n    subplace_label_halo: \"#ffffff\",\n    city_circle: \"#ffffff\",\n    city_circle_stroke: \"#adadad\",\n    city_label: \"#5c5c5c\",\n    city_label_halo: \"#ffffff\",\n    state_label: \"#b3b3b3\",\n    state_label_halo: \"#ffffff\",\n    country_label: \"#b8b8b8\"\n  };\n  var GRAYSCALE = {\n    background: \"#a3a3a3\",\n    earth: \"#cccccc\",\n    park_a: \"#c2c2c2\",\n    park_b: \"#c2c2c2\",\n    hospital: \"#d0d0d0\",\n    industrial: \"#c6c6c6\",\n    school: \"#d0d0d0\",\n    wood_a: \"#c2c2c2\",\n    wood_b: \"#c2c2c2\",\n    pedestrian: \"#c4c4c4\",\n    scrub_a: \"#c2c2c2\",\n    scrub_b: \"#c2c2c2\",\n    glacier: \"#d2d2d2\",\n    sand: \"#d2d2d2\",\n    beach: \"#d2d2d2\",\n    aerodrome: \"#c9c9c9\",\n    runway: \"#f5f5f5\",\n    water: \"#a3a3a3\",\n    pier: \"#b8b8b8\",\n    zoo: \"#c7c7c7\",\n    military: \"#bfbfbf\",\n    tunnel_other_casing: \"#b8b8b8\",\n    tunnel_minor_casing: \"#b8b8b8\",\n    tunnel_link_casing: \"#b8b8b8\",\n    tunnel_medium_casing: \"#b8b8b8\",\n    tunnel_major_casing: \"#b8b8b8\",\n    tunnel_highway_casing: \"#b8b8b8\",\n    tunnel_other: \"#d6d6d6\",\n    tunnel_minor: \"#d6d6d6\",\n    tunnel_link: \"#d6d6d6\",\n    tunnel_medium: \"#d6d6d6\",\n    tunnel_major: \"#d6d6d6\",\n    tunnel_highway: \"#d6d6d6\",\n    transit_pier: \"#b8b8b8\",\n    buildings: \"#e0e0e0\",\n    minor_service_casing: \"#cccccc\",\n    minor_casing: \"#cccccc\",\n    link_casing: \"#cccccc\",\n    medium_casing: \"#cccccc\",\n    major_casing_late: \"#cccccc\",\n    highway_casing_late: \"#cccccc\",\n    other: \"#e0e0e0\",\n    minor_service: \"#e0e0e0\",\n    minor_a: \"#ebebeb\",\n    minor_b: \"#e0e0e0\",\n    link: \"#ebebeb\",\n    medium: \"#ebebeb\",\n    major_casing_early: \"#cccccc\",\n    major: \"#ebebeb\",\n    highway_casing_early: \"#cccccc\",\n    highway: \"#ebebeb\",\n    railway: \"#f5f5f5\",\n    boundaries: \"#5c5c5c\",\n    waterway_label: \"#7a7a7a\",\n    bridges_other_casing: \"#cccccc\",\n    bridges_minor_casing: \"#cccccc\",\n    bridges_link_casing: \"#cccccc\",\n    bridges_medium_casing: \"#cccccc\",\n    bridges_major_casing: \"#cccccc\",\n    bridges_highway_casing: \"#cccccc\",\n    bridges_other: \"#e0e0e0\",\n    bridges_minor: \"#e0e0e0\",\n    bridges_link: \"#ebebeb\",\n    bridges_medium: \"#ebebeb\",\n    bridges_major: \"#ebebeb\",\n    bridges_highway: \"#ebebeb\",\n    roads_label_minor: \"#999999\",\n    roads_label_minor_halo: \"#e0e0e0\",\n    roads_label_major: \"#8f8f8f\",\n    roads_label_major_halo: \"#ebebeb\",\n    ocean_label: \"#7a7a7a\",\n    peak_label: \"#5c5c5c\",\n    subplace_label: \"#7a7a7a\",\n    subplace_label_halo: \"#cccccc\",\n    city_circle: \"#c2c2c2\",\n    city_circle_stroke: \"#7a7a7a\",\n    city_label: \"#474747\",\n    city_label_halo: \"#cccccc\",\n    state_label: \"#999999\",\n    state_label_halo: \"#cccccc\",\n    country_label: \"#858585\"\n  };\n  var BLACK = {\n    background: \"#2b2b2b\",\n    earth: \"#141414\",\n    park_a: \"#181818\",\n    park_b: \"#181818\",\n    hospital: \"#1d1d1d\",\n    industrial: \"#101010\",\n    school: \"#111111\",\n    wood_a: \"#1a1a1a\",\n    wood_b: \"#1a1a1a\",\n    pedestrian: \"#191919\",\n    scrub_a: \"#1c1c1c\",\n    scrub_b: \"#1c1c1c\",\n    glacier: \"#191919\",\n    sand: \"#161616\",\n    beach: \"#1f1f1f\",\n    aerodrome: \"#191919\",\n    runway: \"#323232\",\n    water: \"#333333\",\n    pier: \"#0a0a0a\",\n    zoo: \"#191919\",\n    military: \"#121212\",\n    tunnel_other_casing: \"#101010\",\n    tunnel_minor_casing: \"#101010\",\n    tunnel_link_casing: \"#101010\",\n    tunnel_medium_casing: \"#101010\",\n    tunnel_major_casing: \"#101010\",\n    tunnel_highway_casing: \"#101010\",\n    tunnel_other: \"#292929\",\n    tunnel_minor: \"#292929\",\n    tunnel_link: \"#292929\",\n    tunnel_medium: \"#292929\",\n    tunnel_major: \"#292929\",\n    tunnel_highway: \"#292929\",\n    transit_pier: \"#0a0a0a\",\n    buildings: \"#0a0a0a\",\n    minor_service_casing: \"#141414\",\n    minor_casing: \"#141414\",\n    link_casing: \"#141414\",\n    medium_casing: \"#141414\",\n    major_casing_late: \"#141414\",\n    highway_casing_late: \"#141414\",\n    other: \"#1f1f1f\",\n    minor_service: \"#1f1f1f\",\n    minor_a: \"#292929\",\n    minor_b: \"#1f1f1f\",\n    link: \"#1f1f1f\",\n    medium: \"#292929\",\n    major_casing_early: \"#141414\",\n    major: \"#292929\",\n    highway_casing_early: \"#141414\",\n    highway: \"#292929\",\n    railway: \"#292929\",\n    boundaries: \"#707070\",\n    waterway_label: \"#707070\",\n    bridges_other_casing: \"#141414\",\n    bridges_minor_casing: \"#141414\",\n    bridges_link_casing: \"#141414\",\n    bridges_medium_casing: \"#141414\",\n    bridges_major_casing: \"#141414\",\n    bridges_highway_casing: \"#141414\",\n    bridges_other: \"#1f1f1f\",\n    bridges_minor: \"#1f1f1f\",\n    bridges_link: \"#292929\",\n    bridges_medium: \"#292929\",\n    bridges_major: \"#292929\",\n    bridges_highway: \"#292929\",\n    roads_label_minor: \"#525252\",\n    roads_label_minor_halo: \"#141414\",\n    roads_label_major: \"#5c5c5c\",\n    roads_label_major_halo: \"#141414\",\n    ocean_label: \"#707070\",\n    peak_label: \"#707070\",\n    subplace_label: \"#5c5c5c\",\n    subplace_label_halo: \"#141414\",\n    city_circle: \"#000000\",\n    city_circle_stroke: \"#666666\",\n    city_label: \"#999999\",\n    city_label_halo: \"#141414\",\n    state_label: \"#3d3d3d\",\n    state_label_halo: \"#141414\",\n    country_label: \"#707070\"\n  };\n  var themes = {\n    light: LIGHT,\n    dark: DARK,\n    white: WHITE,\n    grayscale: GRAYSCALE,\n    black: BLACK\n  };\n  var themes_default = themes;\n\n  // src/labeler.ts\n  var import_point_geometry5 = __toESM(require_point_geometry(), 1);\n  var import_rbush = __toESM(require_rbush_min(), 1);\n\n  // src/view.ts\n  var import_point_geometry4 = __toESM(require_point_geometry(), 1);\n  var transformGeom = (geom, scale, translate) => {\n    const retval = [];\n    for (const arr2 of geom) {\n      const loop = [];\n      for (const coord of arr2) {\n        loop.push(coord.clone().mult(scale).add(translate));\n      }\n      retval.push(loop);\n    }\n    return retval;\n  };\n  var wrap = (val, z) => {\n    const dim = 1 << z;\n    if (val < 0)\n      return dim + val;\n    if (val >= dim)\n      return val % dim;\n    return val;\n  };\n  var View = class {\n    constructor(tileCache, maxDataLevel, levelDiff) {\n      this.tileCache = tileCache;\n      this.maxDataLevel = maxDataLevel;\n      this.levelDiff = levelDiff;\n    }\n    dataTilesForBounds(displayZoom, bounds) {\n      const fractional = __pow(2, displayZoom) / __pow(2, Math.ceil(displayZoom));\n      const needed = [];\n      let scale = 1;\n      const dim = this.tileCache.tileSize;\n      if (displayZoom < this.levelDiff) {\n        scale = 1 / (1 << this.levelDiff - displayZoom) * fractional;\n        needed.push({\n          dataTile: { z: 0, x: 0, y: 0 },\n          origin: new import_point_geometry4.default(0, 0),\n          scale,\n          dim: dim * scale\n        });\n      } else if (displayZoom <= this.levelDiff + this.maxDataLevel) {\n        const f = 1 << this.levelDiff;\n        const basetileSize = 256 * fractional;\n        const dataZoom = Math.ceil(displayZoom) - this.levelDiff;\n        const mintileX = Math.floor(bounds.minX / f / basetileSize);\n        const mintileY = Math.floor(bounds.minY / f / basetileSize);\n        const maxtileX = Math.floor(bounds.maxX / f / basetileSize);\n        const maxtileY = Math.floor(bounds.maxY / f / basetileSize);\n        for (let tx = mintileX; tx <= maxtileX; tx++) {\n          for (let ty = mintileY; ty <= maxtileY; ty++) {\n            const origin = new import_point_geometry4.default(\n              tx * f * basetileSize,\n              ty * f * basetileSize\n            );\n            needed.push({\n              dataTile: {\n                z: dataZoom,\n                x: wrap(tx, dataZoom),\n                y: wrap(ty, dataZoom)\n              },\n              origin,\n              scale: fractional,\n              dim: dim * fractional\n            });\n          }\n        }\n      } else {\n        const f = 1 << this.levelDiff;\n        scale = (1 << Math.ceil(displayZoom) - this.maxDataLevel - this.levelDiff) * fractional;\n        const mintileX = Math.floor(bounds.minX / f / 256 / scale);\n        const mintileY = Math.floor(bounds.minY / f / 256 / scale);\n        const maxtileX = Math.floor(bounds.maxX / f / 256 / scale);\n        const maxtileY = Math.floor(bounds.maxY / f / 256 / scale);\n        for (let tx = mintileX; tx <= maxtileX; tx++) {\n          for (let ty = mintileY; ty <= maxtileY; ty++) {\n            const origin = new import_point_geometry4.default(tx * f * 256 * scale, ty * f * 256 * scale);\n            needed.push({\n              dataTile: {\n                z: this.maxDataLevel,\n                x: wrap(tx, this.maxDataLevel),\n                y: wrap(ty, this.maxDataLevel)\n              },\n              origin,\n              scale,\n              dim: dim * scale\n            });\n          }\n        }\n      }\n      return needed;\n    }\n    dataTileForDisplayTile(displayTile) {\n      let dataTile;\n      let scale = 1;\n      let dim = this.tileCache.tileSize;\n      let origin;\n      if (displayTile.z < this.levelDiff) {\n        dataTile = { z: 0, x: 0, y: 0 };\n        scale = 1 / (1 << this.levelDiff - displayTile.z);\n        origin = new import_point_geometry4.default(0, 0);\n        dim = dim * scale;\n      } else if (displayTile.z <= this.levelDiff + this.maxDataLevel) {\n        const f = 1 << this.levelDiff;\n        dataTile = {\n          z: displayTile.z - this.levelDiff,\n          x: Math.floor(displayTile.x / f),\n          y: Math.floor(displayTile.y / f)\n        };\n        origin = new import_point_geometry4.default(dataTile.x * f * 256, dataTile.y * f * 256);\n      } else {\n        scale = 1 << displayTile.z - this.maxDataLevel - this.levelDiff;\n        const f = 1 << this.levelDiff;\n        dataTile = {\n          z: this.maxDataLevel,\n          x: Math.floor(displayTile.x / f / scale),\n          y: Math.floor(displayTile.y / f / scale)\n        };\n        origin = new import_point_geometry4.default(\n          dataTile.x * f * scale * 256,\n          dataTile.y * f * scale * 256\n        );\n        dim = dim * scale;\n      }\n      return { dataTile, scale, origin, dim };\n    }\n    getBbox(displayZoom, bounds) {\n      return __async(this, null, function* () {\n        const needed = this.dataTilesForBounds(displayZoom, bounds);\n        const result = yield Promise.all(\n          needed.map((tt) => this.tileCache.get(tt.dataTile))\n        );\n        return result.map((data, i2) => {\n          const tt = needed[i2];\n          return {\n            data,\n            z: displayZoom,\n            dataTile: tt.dataTile,\n            scale: tt.scale,\n            dim: tt.dim,\n            origin: tt.origin\n          };\n        });\n      });\n    }\n    getDisplayTile(displayTile) {\n      return __async(this, null, function* () {\n        const tt = this.dataTileForDisplayTile(displayTile);\n        const data = yield this.tileCache.get(tt.dataTile);\n        return {\n          data,\n          z: displayTile.z,\n          dataTile: tt.dataTile,\n          scale: tt.scale,\n          origin: tt.origin,\n          dim: tt.dim\n        };\n      });\n    }\n    queryFeatures(lng, lat, displayZoom, brushSize) {\n      const roundedZoom = Math.round(displayZoom);\n      const dataZoom = Math.min(roundedZoom - this.levelDiff, this.maxDataLevel);\n      const brushSizeAtZoom = brushSize / (1 << roundedZoom - dataZoom);\n      return this.tileCache.queryFeatures(lng, lat, dataZoom, brushSizeAtZoom);\n    }\n  };\n  var sourcesToViews = (options) => {\n    const sourceToViews = (o) => {\n      const levelDiff = o.levelDiff === void 0 ? 1 : o.levelDiff;\n      const maxDataZoom = o.maxDataZoom || 15;\n      let source;\n      if (typeof o.url === \"string\") {\n        if (new URL(o.url, \"http://example.com\").pathname.endsWith(\".pmtiles\")) {\n          source = new PmtilesSource(o.url, true);\n        } else {\n          source = new ZxySource(o.url, true);\n        }\n      } else if (o.url) {\n        source = new PmtilesSource(o.url, true);\n      } else {\n        throw new Error(`Invalid source ${o.url}`);\n      }\n      const cache = new TileCache(source, 256 * 1 << levelDiff);\n      return new View(cache, maxDataZoom, levelDiff);\n    };\n    const sources = /* @__PURE__ */ new Map();\n    if (options.sources) {\n      for (const key in options.sources) {\n        sources.set(key, sourceToViews(options.sources[key]));\n      }\n    } else {\n      sources.set(\"\", sourceToViews(options));\n    }\n    return sources;\n  };\n\n  // src/labeler.ts\n  var covering = (displayZoom, tileWidth, bbox) => {\n    const res = 256;\n    const f = tileWidth / res;\n    const minx = Math.floor(bbox.minX / res);\n    const miny = Math.floor(bbox.minY / res);\n    const maxx = Math.floor(bbox.maxX / res);\n    const maxy = Math.floor(bbox.maxY / res);\n    const leveldiff = Math.log2(f);\n    const retval = [];\n    for (let x2 = minx; x2 <= maxx; x2++) {\n      const wrappedX = x2 % (1 << displayZoom);\n      for (let y = miny; y <= maxy; y++) {\n        retval.push({\n          display: toIndex({ z: displayZoom, x: wrappedX, y }),\n          key: toIndex({\n            z: displayZoom - leveldiff,\n            x: Math.floor(wrappedX / f),\n            y: Math.floor(y / f)\n          })\n        });\n      }\n    }\n    return retval;\n  };\n  var Index = class {\n    constructor(dim, maxLabeledTiles) {\n      this.tree = new import_rbush.default();\n      this.current = /* @__PURE__ */ new Map();\n      this.dim = dim;\n      this.maxLabeledTiles = maxLabeledTiles;\n    }\n    hasPrefix(tileKey) {\n      for (const key of this.current.keys()) {\n        if (key.startsWith(tileKey))\n          return true;\n      }\n      return false;\n    }\n    has(tileKey) {\n      return this.current.has(tileKey);\n    }\n    size() {\n      return this.current.size;\n    }\n    keys() {\n      return this.current.keys();\n    }\n    searchBbox(bbox, order) {\n      const labels = /* @__PURE__ */ new Set();\n      for (const match of this.tree.search(bbox)) {\n        if (match.indexedLabel.order <= order) {\n          labels.add(match.indexedLabel);\n        }\n      }\n      return labels;\n    }\n    searchLabel(label, order) {\n      const labels = /* @__PURE__ */ new Set();\n      for (const bbox of label.bboxes) {\n        for (const match of this.tree.search(bbox)) {\n          if (match.indexedLabel.order <= order) {\n            labels.add(match.indexedLabel);\n          }\n        }\n      }\n      return labels;\n    }\n    bboxCollides(bbox, order) {\n      for (const match of this.tree.search(bbox)) {\n        if (match.indexedLabel.order <= order)\n          return true;\n      }\n      return false;\n    }\n    labelCollides(label, order) {\n      for (const bbox of label.bboxes) {\n        for (const match of this.tree.search(bbox)) {\n          if (match.indexedLabel.order <= order)\n            return true;\n        }\n      }\n      return false;\n    }\n    deduplicationCollides(label) {\n      if (!label.deduplicationKey || !label.deduplicationDistance)\n        return false;\n      const dist = label.deduplicationDistance;\n      const testBbox = {\n        minX: label.anchor.x - dist,\n        minY: label.anchor.y - dist,\n        maxX: label.anchor.x + dist,\n        maxY: label.anchor.y + dist\n      };\n      for (const collision of this.tree.search(testBbox)) {\n        if (collision.indexedLabel.deduplicationKey === label.deduplicationKey) {\n          if (collision.indexedLabel.anchor.dist(label.anchor) < dist) {\n            return true;\n          }\n        }\n      }\n      return false;\n    }\n    makeEntry(tileKey) {\n      if (this.current.get(tileKey)) {\n        console.log(\"consistency error 1\");\n      }\n      const newSet = /* @__PURE__ */ new Set();\n      this.current.set(tileKey, newSet);\n    }\n    insert(label, order, tileKey) {\n      const indexedLabel = {\n        anchor: label.anchor,\n        bboxes: label.bboxes,\n        draw: label.draw,\n        order,\n        tileKey,\n        deduplicationKey: label.deduplicationKey,\n        deduplicationDistance: label.deduplicationDistance\n      };\n      let entry = this.current.get(tileKey);\n      if (!entry) {\n        const newSet = /* @__PURE__ */ new Set();\n        this.current.set(tileKey, newSet);\n        entry = newSet;\n      }\n      entry.add(indexedLabel);\n      let wrapsLeft = false;\n      let wrapsRight = false;\n      for (const bbox of label.bboxes) {\n        this.tree.insert({\n          minX: bbox.minX,\n          minY: bbox.minY,\n          maxX: bbox.maxX,\n          maxY: bbox.maxY,\n          indexedLabel\n        });\n        if (bbox.minX < 0)\n          wrapsLeft = true;\n        if (bbox.maxX > this.dim)\n          wrapsRight = true;\n      }\n      if (wrapsLeft || wrapsRight) {\n        const shift2 = wrapsLeft ? this.dim : -this.dim;\n        const newBboxes = [];\n        for (const bbox of label.bboxes) {\n          newBboxes.push({\n            minX: bbox.minX + shift2,\n            minY: bbox.minY,\n            maxX: bbox.maxX + shift2,\n            maxY: bbox.maxY\n          });\n        }\n        const duplicateLabel = {\n          anchor: new import_point_geometry5.default(label.anchor.x + shift2, label.anchor.y),\n          bboxes: newBboxes,\n          draw: label.draw,\n          order,\n          tileKey\n        };\n        const entry2 = this.current.get(tileKey);\n        if (entry2)\n          entry2.add(duplicateLabel);\n        for (const bbox of newBboxes) {\n          this.tree.insert({\n            minX: bbox.minX,\n            minY: bbox.minY,\n            maxX: bbox.maxX,\n            maxY: bbox.maxY,\n            indexedLabel: duplicateLabel\n          });\n        }\n      }\n    }\n    pruneOrNoop(keyAdded) {\n      const added = keyAdded.split(\":\");\n      let maxKey = void 0;\n      let maxDist = 0;\n      let keysForDs = 0;\n      for (const existingKey of this.current.keys()) {\n        const existing = existingKey.split(\":\");\n        if (existing[3] === added[3]) {\n          keysForDs++;\n          const dist = Math.sqrt(\n            __pow(+existing[0] - +added[0], 2) + __pow(+existing[1] - +added[1], 2)\n          );\n          if (dist > maxDist) {\n            maxDist = dist;\n            maxKey = existingKey;\n          }\n        }\n        if (maxKey && keysForDs > this.maxLabeledTiles) {\n          this.pruneKey(maxKey);\n        }\n      }\n    }\n    pruneKey(keyToRemove) {\n      const indexedLabels = this.current.get(keyToRemove);\n      if (!indexedLabels)\n        return;\n      const entriesToDelete = [];\n      for (const entry of this.tree.all()) {\n        if (indexedLabels.has(entry.indexedLabel)) {\n          entriesToDelete.push(entry);\n        }\n      }\n      for (const entry of entriesToDelete) {\n        this.tree.remove(entry);\n      }\n      this.current.delete(keyToRemove);\n    }\n    removeLabel(labelToRemove) {\n      const entriesToDelete = [];\n      for (const entry of this.tree.all()) {\n        if (labelToRemove === entry.indexedLabel) {\n          entriesToDelete.push(entry);\n        }\n      }\n      for (const entry of entriesToDelete) {\n        this.tree.remove(entry);\n      }\n      const c = this.current.get(labelToRemove.tileKey);\n      if (c)\n        c.delete(labelToRemove);\n    }\n  };\n  var Labeler = class {\n    constructor(z, scratch, labelRules2, maxLabeledTiles, callback) {\n      this.index = new Index(256 * 1 << z, maxLabeledTiles);\n      this.z = z;\n      this.scratch = scratch;\n      this.labelRules = labelRules2;\n      this.callback = callback;\n    }\n    layout(preparedTilemap) {\n      const start = performance.now();\n      const keysAdding = /* @__PURE__ */ new Set();\n      for (const [k, preparedTiles] of preparedTilemap) {\n        for (const preparedTile of preparedTiles) {\n          const key = `${toIndex(preparedTile.dataTile)}:${k}`;\n          if (!this.index.has(key)) {\n            this.index.makeEntry(key);\n            keysAdding.add(key);\n          }\n        }\n      }\n      const tilesInvalidated = /* @__PURE__ */ new Set();\n      for (const [order, rule] of this.labelRules.entries()) {\n        if (rule.visible === false)\n          continue;\n        if (rule.minzoom && this.z < rule.minzoom)\n          continue;\n        if (rule.maxzoom && this.z > rule.maxzoom)\n          continue;\n        const dsName = rule.dataSource || \"\";\n        const preparedTiles = preparedTilemap.get(dsName);\n        if (!preparedTiles)\n          continue;\n        for (const preparedTile of preparedTiles) {\n          const key = `${toIndex(preparedTile.dataTile)}:${dsName}`;\n          if (!keysAdding.has(key))\n            continue;\n          const layer = preparedTile.data.get(rule.dataLayer);\n          if (layer === void 0)\n            continue;\n          const feats = layer;\n          if (rule.sort)\n            feats.sort((a, b) => {\n              if (rule.sort) {\n                return rule.sort(a.props, b.props);\n              }\n              return 0;\n            });\n          const layout = {\n            index: this.index,\n            zoom: this.z,\n            scratch: this.scratch,\n            order,\n            overzoom: this.z - preparedTile.dataTile.z\n          };\n          for (const feature of feats) {\n            if (rule.filter && !rule.filter(this.z, feature))\n              continue;\n            const transformed = transformGeom(\n              feature.geom,\n              preparedTile.scale,\n              preparedTile.origin\n            );\n            const labels = rule.symbolizer.place(layout, transformed, feature);\n            if (!labels)\n              continue;\n            for (const label of labels) {\n              let labelAdded = false;\n              if (label.deduplicationKey && this.index.deduplicationCollides(label)) {\n                continue;\n              }\n              if (this.index.labelCollides(label, Infinity)) {\n                if (!this.index.labelCollides(label, order)) {\n                  const conflicts = this.index.searchLabel(label, Infinity);\n                  for (const conflict of conflicts) {\n                    this.index.removeLabel(conflict);\n                    for (const bbox of conflict.bboxes) {\n                      this.findInvalidatedTiles(\n                        tilesInvalidated,\n                        preparedTile.dim,\n                        bbox,\n                        key\n                      );\n                    }\n                  }\n                  this.index.insert(label, order, key);\n                  labelAdded = true;\n                }\n              } else {\n                this.index.insert(label, order, key);\n                labelAdded = true;\n              }\n              if (labelAdded) {\n                for (const bbox of label.bboxes) {\n                  if (bbox.maxX > preparedTile.origin.x + preparedTile.dim || bbox.minX < preparedTile.origin.x || bbox.minY < preparedTile.origin.y || bbox.maxY > preparedTile.origin.y + preparedTile.dim) {\n                    this.findInvalidatedTiles(\n                      tilesInvalidated,\n                      preparedTile.dim,\n                      bbox,\n                      key\n                    );\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n      for (const key of keysAdding) {\n        this.index.pruneOrNoop(key);\n      }\n      if (tilesInvalidated.size > 0 && this.callback) {\n        this.callback(tilesInvalidated);\n      }\n      return performance.now() - start;\n    }\n    findInvalidatedTiles(tilesInvalidated, dim, bbox, key) {\n      const touched = covering(this.z, dim, bbox);\n      for (const s of touched) {\n        if (s.key !== key && this.index.hasPrefix(s.key)) {\n          tilesInvalidated.add(s.display);\n        }\n      }\n    }\n    add(preparedTilemap) {\n      let allAdded = true;\n      for (const [k, preparedTiles] of preparedTilemap) {\n        for (const preparedTile of preparedTiles) {\n          if (!this.index.has(`${toIndex(preparedTile.dataTile)}:${k}`))\n            allAdded = false;\n        }\n      }\n      if (allAdded) {\n        return 0;\n      }\n      const timing = this.layout(preparedTilemap);\n      return timing;\n    }\n  };\n  var Labelers = class {\n    constructor(scratch, labelRules2, maxLabeledTiles, callback) {\n      this.labelers = /* @__PURE__ */ new Map();\n      this.scratch = scratch;\n      this.labelRules = labelRules2;\n      this.maxLabeledTiles = maxLabeledTiles;\n      this.callback = callback;\n    }\n    add(z, preparedTilemap) {\n      let labeler = this.labelers.get(z);\n      if (labeler) {\n        return labeler.add(preparedTilemap);\n      }\n      labeler = new Labeler(\n        z,\n        this.scratch,\n        this.labelRules,\n        this.maxLabeledTiles,\n        this.callback\n      );\n      this.labelers.set(z, labeler);\n      return labeler.add(preparedTilemap);\n    }\n    getIndex(z) {\n      const labeler = this.labelers.get(z);\n      if (labeler)\n        return labeler.index;\n    }\n  };\n\n  // src/painter.ts\n  var import_point_geometry6 = __toESM(require_point_geometry(), 1);\n  function paint(ctx, z, preparedTilemap, labelData, rules, bbox, origin, clip, debug) {\n    const start = performance.now();\n    ctx.save();\n    ctx.miterLimit = 2;\n    for (const rule of rules) {\n      if (rule.minzoom && z < rule.minzoom)\n        continue;\n      if (rule.maxzoom && z > rule.maxzoom)\n        continue;\n      const preparedTiles = preparedTilemap.get(rule.dataSource || \"\");\n      if (!preparedTiles)\n        continue;\n      for (const preparedTile of preparedTiles) {\n        const layer = preparedTile.data.get(rule.dataLayer);\n        if (layer === void 0)\n          continue;\n        if (rule.symbolizer.before)\n          rule.symbolizer.before(ctx, preparedTile.z);\n        const po = preparedTile.origin;\n        const dim = preparedTile.dim;\n        const ps = preparedTile.scale;\n        ctx.save();\n        if (clip) {\n          ctx.beginPath();\n          const minX = Math.max(po.x - origin.x, bbox.minX - origin.x);\n          const minY = Math.max(po.y - origin.y, bbox.minY - origin.y);\n          const maxX = Math.min(po.x - origin.x + dim, bbox.maxX - origin.x);\n          const maxY = Math.min(po.y - origin.y + dim, bbox.maxY - origin.y);\n          ctx.rect(minX, minY, maxX - minX, maxY - minY);\n          ctx.clip();\n        }\n        ctx.translate(po.x - origin.x, po.y - origin.y);\n        for (const feature of layer) {\n          let geom = feature.geom;\n          const fbox = feature.bbox;\n          if (fbox.maxX * ps + po.x < bbox.minX || fbox.minX * ps + po.x > bbox.maxX || fbox.minY * ps + po.y > bbox.maxY || fbox.maxY * ps + po.y < bbox.minY) {\n            continue;\n          }\n          if (rule.filter && !rule.filter(preparedTile.z, feature))\n            continue;\n          if (ps !== 1) {\n            geom = transformGeom(geom, ps, new import_point_geometry6.default(0, 0));\n          }\n          rule.symbolizer.draw(ctx, geom, preparedTile.z, feature);\n        }\n        ctx.restore();\n      }\n    }\n    if (clip) {\n      ctx.beginPath();\n      ctx.rect(\n        bbox.minX - origin.x,\n        bbox.minY - origin.y,\n        bbox.maxX - bbox.minX,\n        bbox.maxY - bbox.minY\n      );\n      ctx.clip();\n    }\n    if (labelData) {\n      const matches = labelData.searchBbox(bbox, Infinity);\n      for (const label of matches) {\n        ctx.save();\n        ctx.translate(label.anchor.x - origin.x, label.anchor.y - origin.y);\n        label.draw(ctx);\n        ctx.restore();\n        if (debug) {\n          ctx.lineWidth = 0.5;\n          ctx.strokeStyle = debug;\n          ctx.fillStyle = debug;\n          ctx.globalAlpha = 1;\n          ctx.fillRect(\n            label.anchor.x - origin.x - 2,\n            label.anchor.y - origin.y - 2,\n            4,\n            4\n          );\n          for (const bbox2 of label.bboxes) {\n            ctx.strokeRect(\n              bbox2.minX - origin.x,\n              bbox2.minY - origin.y,\n              bbox2.maxX - bbox2.minX,\n              bbox2.maxY - bbox2.minY\n            );\n          }\n        }\n      }\n    }\n    ctx.restore();\n    return performance.now() - start;\n  }\n\n  // src/frontends/leaflet.ts\n  var import_point_geometry8 = __toESM(require_point_geometry(), 1);\n  var timer = (duration) => {\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        resolve();\n      }, duration);\n    });\n  };\n  var reflect = (promise) => {\n    return promise.then(\n      (v) => {\n        return { status: \"fulfilled\", value: v };\n      },\n      (error) => {\n        return { status: \"rejected\", reason: error };\n      }\n    );\n  };\n  var leafletLayer = (options = {}) => {\n    class LeafletLayer extends L.GridLayer {\n      constructor(options2 = {}) {\n        if (options2.noWrap && !options2.bounds)\n          options2.bounds = [\n            [-90, -180],\n            [90, 180]\n          ];\n        if (options2.attribution == null)\n          options2.attribution = '<a href=\"https://protomaps.com\">Protomaps</a> \\xA9 <a href=\"https://openstreetmap.org/copyright\">OpenStreetMap</a>';\n        super(options2);\n        if (options2.theme) {\n          const theme = themes_default[options2.theme];\n          this.paintRules = paintRules(theme);\n          this.labelRules = labelRules(theme);\n          this.backgroundColor = theme.background;\n        } else {\n          this.paintRules = options2.paintRules || [];\n          this.labelRules = options2.labelRules || [];\n          this.backgroundColor = options2.backgroundColor;\n        }\n        this.lastRequestedZ = void 0;\n        this.tasks = options2.tasks || [];\n        this.views = sourcesToViews(options2);\n        this.debug = options2.debug;\n        const scratch = document.createElement(\"canvas\").getContext(\"2d\");\n        this.scratch = scratch;\n        this.onTilesInvalidated = (tiles) => {\n          for (const t of tiles) {\n            this.rerenderTile(t);\n          }\n        };\n        this.labelers = new Labelers(\n          this.scratch,\n          this.labelRules,\n          16,\n          this.onTilesInvalidated\n        );\n        this.tileSize = 256 * window.devicePixelRatio;\n        this.tileDelay = options2.tileDelay || 3;\n        this.lang = options2.lang;\n      }\n      renderTile(coords, element, key, done = () => {\n      }) {\n        return __async(this, null, function* () {\n          this.lastRequestedZ = coords.z;\n          const promises = [];\n          for (const [k, v] of this.views) {\n            const promise = v.getDisplayTile(coords);\n            promises.push({ key: k, promise });\n          }\n          const tileResponses = yield Promise.all(\n            promises.map((o) => {\n              return o.promise.then(\n                (v) => {\n                  return { status: \"fulfilled\", value: v, key: o.key };\n                },\n                (error) => {\n                  return { status: \"rejected\", reason: error, key: o.key };\n                }\n              );\n            })\n          );\n          const preparedTilemap = /* @__PURE__ */ new Map();\n          for (const tileResponse of tileResponses) {\n            if (tileResponse.status === \"fulfilled\") {\n              preparedTilemap.set(tileResponse.key, [tileResponse.value]);\n            } else {\n              if (tileResponse.reason.name === \"AbortError\") ; else {\n                console.error(tileResponse.reason);\n              }\n            }\n          }\n          if (element.key !== key)\n            return;\n          if (this.lastRequestedZ !== coords.z)\n            return;\n          yield Promise.all(this.tasks.map(reflect));\n          if (element.key !== key)\n            return;\n          if (this.lastRequestedZ !== coords.z)\n            return;\n          const layoutTime = this.labelers.add(coords.z, preparedTilemap);\n          if (element.key !== key)\n            return;\n          if (this.lastRequestedZ !== coords.z)\n            return;\n          const labelData = this.labelers.getIndex(coords.z);\n          if (!this._map)\n            return;\n          const center = this._map.getCenter().wrap();\n          const pixelBounds = this._getTiledPixelBounds(center);\n          const tileRange = this._pxBoundsToTileRange(pixelBounds);\n          const tileCenter = tileRange.getCenter();\n          const priority = coords.distanceTo(tileCenter) * this.tileDelay;\n          yield timer(priority);\n          if (element.key !== key)\n            return;\n          if (this.lastRequestedZ !== coords.z)\n            return;\n          const buf = 16;\n          const bbox = {\n            minX: 256 * coords.x - buf,\n            minY: 256 * coords.y - buf,\n            maxX: 256 * (coords.x + 1) + buf,\n            maxY: 256 * (coords.y + 1) + buf\n          };\n          const origin = new import_point_geometry8.default(256 * coords.x, 256 * coords.y);\n          element.width = this.tileSize;\n          element.height = this.tileSize;\n          const ctx = element.getContext(\"2d\");\n          if (!ctx) {\n            console.error(\"Failed to get Canvas context\");\n            return;\n          }\n          ctx.setTransform(this.tileSize / 256, 0, 0, this.tileSize / 256, 0, 0);\n          ctx.clearRect(0, 0, 256, 256);\n          if (this.backgroundColor) {\n            ctx.save();\n            ctx.fillStyle = this.backgroundColor;\n            ctx.fillRect(0, 0, 256, 256);\n            ctx.restore();\n          }\n          let paintingTime = 0;\n          const paintRules2 = this.paintRules;\n          paintingTime = paint(\n            ctx,\n            coords.z,\n            preparedTilemap,\n            this.xray ? null : labelData,\n            paintRules2,\n            bbox,\n            origin,\n            false,\n            this.debug\n          );\n          if (this.debug) {\n            ctx.save();\n            ctx.fillStyle = this.debug;\n            ctx.font = \"600 12px sans-serif\";\n            ctx.fillText(`${coords.z} ${coords.x} ${coords.y}`, 4, 14);\n            ctx.font = \"12px sans-serif\";\n            let ypos = 28;\n            for (const [k, v] of preparedTilemap) {\n              const dt = v[0].dataTile;\n              ctx.fillText(`${k + (k ? \" \" : \"\") + dt.z} ${dt.x} ${dt.y}`, 4, ypos);\n              ypos += 14;\n            }\n            ctx.font = \"600 10px sans-serif\";\n            if (paintingTime > 8) {\n              ctx.fillText(`${paintingTime.toFixed()} ms paint`, 4, ypos);\n              ypos += 14;\n            }\n            if (layoutTime > 8) {\n              ctx.fillText(`${layoutTime.toFixed()} ms layout`, 4, ypos);\n            }\n            ctx.strokeStyle = this.debug;\n            ctx.lineWidth = 0.5;\n            ctx.beginPath();\n            ctx.moveTo(0, 0);\n            ctx.lineTo(0, 256);\n            ctx.stroke();\n            ctx.lineWidth = 0.5;\n            ctx.beginPath();\n            ctx.moveTo(0, 0);\n            ctx.lineTo(256, 0);\n            ctx.stroke();\n            ctx.restore();\n          }\n          done();\n        });\n      }\n      rerenderTile(key) {\n        for (const unwrappedK in this._tiles) {\n          const wrappedCoord = this._wrapCoords(\n            this._keyToTileCoords(unwrappedK)\n          );\n          if (key === this._tileCoordsToKey(wrappedCoord)) {\n            this.renderTile(wrappedCoord, this._tiles[unwrappedK].el, key);\n          }\n        }\n      }\n      queryTileFeaturesDebug(lng, lat, brushSize = 16) {\n        const featuresBySourceName = /* @__PURE__ */ new Map();\n        for (const [sourceName, view] of this.views) {\n          featuresBySourceName.set(\n            sourceName,\n            view.queryFeatures(lng, lat, this._map.getZoom(), brushSize)\n          );\n        }\n        return featuresBySourceName;\n      }\n      clearLayout() {\n        this.labelers = new Labelers(\n          this.scratch,\n          this.labelRules,\n          16,\n          this.onTilesInvalidated\n        );\n      }\n      rerenderTiles() {\n        for (const unwrappedK in this._tiles) {\n          const wrappedCoord = this._wrapCoords(\n            this._keyToTileCoords(unwrappedK)\n          );\n          const key = this._tileCoordsToKey(wrappedCoord);\n          this.renderTile(wrappedCoord, this._tiles[unwrappedK].el, key);\n        }\n      }\n      createTile(coords, showTile) {\n        const element = L.DomUtil.create(\"canvas\", \"leaflet-tile\");\n        element.lang = this.lang;\n        const key = this._tileCoordsToKey(coords);\n        element.key = key;\n        this.renderTile(coords, element, key, () => {\n          showTile(void 0, element);\n        });\n        return element;\n      }\n      _removeTile(key) {\n        const tile = this._tiles[key];\n        if (!tile) {\n          return;\n        }\n        tile.el.removed = true;\n        tile.el.key = void 0;\n        L.DomUtil.removeClass(tile.el, \"leaflet-tile-loaded\");\n        tile.el.width = tile.el.height = 0;\n        L.DomUtil.remove(tile.el);\n        delete this._tiles[key];\n        this.fire(\"tileunload\", {\n          tile: tile.el,\n          coords: this._keyToTileCoords(key)\n        });\n      }\n    }\n    return new LeafletLayer(options);\n  };\n  /*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\n\n  var TemplatedPMTilesLayer = L.Layer.extend({\n    initialize: function (template, options) {\n      this._template = template;\n      /* structure of this._template:\n        {\n          template: decodeURI(new URL(template, this.getBase())),\n          linkEl: (map-link),\n          rel: (map-link@rel),\n          type: (map-link@type),\n          values: [map-input],\n          inputsReady: Promise.allSettled(inputsReady),\n          zoom: (map-input@type=zoom),\n          projection: (map-extent@units),\n          tms: true/false,\n          step: step\n        }\n      */\n      this._container = L.DomUtil.create('div', 'leaflet-layer');\n      L.DomUtil.addClass(this._container, 'mapml-pmtiles-container');\n      this.zoomBounds = options.zoomBounds;\n      this.extentBounds = options.extentBounds;\n      // get rid of duplicate info, it can be confusing\n      delete options.zoomBounds;\n      delete options.extentBounds;\n      this._linkEl = options.linkEl;\n      L.setOptions(this, options);\n      //    L.setOptions(\n      //      this,\n      //      L.extend(options, this._setUpTemplateVars(template))\n      //    );\n    },\n    onAdd: function (map) {\n      this._map = map;\n      this.options.pane.appendChild(this._container);\n      this.setZIndex(this.options.zIndex);\n      let pmtilesOptions = {\n        url: this._template.template,\n        pane: this._container\n      };\n      if (this.options.PAINT_RULES) {\n        pmtilesOptions.paintRules = this.options.PAINT_RULES;\n        pmtilesOptions.labelRules = this.options.LABEL_RULES;\n      } else if (this.options.THEME) {\n        pmtilesOptions.theme = this.options.THEME;\n      }\n      this._pmtilesLayer = M.pmtilesLayer(pmtilesOptions).addTo(map);\n    },\n    onRemove: function (map) {\n      this._pmtilesLayer.remove();\n      L.DomUtil.remove(this._container);\n    },\n    isVisible: function () {\n      let map = this._linkEl.getMapEl()._map;\n      let mapZoom = map.getZoom();\n      let mapBounds = M.pixelToPCRSBounds(\n        map.getPixelBounds(),\n        mapZoom,\n        map.options.projection\n      );\n      return (\n        mapZoom <= this.zoomBounds.maxZoom &&\n        mapZoom >= this.zoomBounds.minZoom &&\n        this.extentBounds.overlaps(mapBounds)\n      );\n    },\n    setZIndex: function (zIndex) {\n      this.options.zIndex = zIndex;\n      if (\n        this._container &&\n        this.options.zIndex !== undefined &&\n        this.options.zIndex !== null\n      ) {\n        this._container.style.zIndex = this.options.zIndex;\n      }\n      return this;\n    }\n  });\n  var templatedPMTilesLayer = function (template, options) {\n    return new TemplatedPMTilesLayer(template, options);\n  };\n\n  var ImageLayer = L.ImageOverlay.extend({\n    initialize: function (url, location, size, angle, container, options) {\n      // (String, Point, Point, Number, Element, Object)\n      this._container = container;\n      this._url = url;\n      // instead of calculating where the image goes, put it at 0,0\n      //this._location = L.point(location);\n      // the location for WMS requests will be the upper left hand\n      // corner of the map.  When the map is initialized, that is 0,0,\n      // but as the user pans, of course the\n      this._location = location;\n      this._size = L.point(size);\n      this._angle = angle;\n\n      L.setOptions(this, options);\n    },\n    getEvents: function () {\n      var events = {\n        viewreset: this._reset\n      };\n\n      if (this._zoomAnimated && this._step <= 1) {\n        events.zoomanim = this._animateZoom;\n      }\n\n      return events;\n    },\n    onAdd: function (map) {\n      this.on({\n        load: this._onImageLoad\n      });\n\n      if (!this._image) {\n        this._initImage();\n      }\n\n      if (this.options.interactive) {\n        L.DomUtil.addClass(this._image, 'leaflet-interactive');\n        this.addInteractiveTarget(this._image);\n      }\n\n      this._container.appendChild(this._image);\n      this._reset();\n    },\n    onRemove: function () {\n      L.DomUtil.remove(this._image);\n      if (this.options.interactive) {\n        this.removeInteractiveTarget(this._image);\n      }\n    },\n    _onImageLoad: function () {\n      if (!this._image) {\n        return;\n      }\n      this._image.loaded = +new Date();\n      this._updateOpacity();\n    },\n    _animateZoom: function (e) {\n      var scale = this._map.getZoomScale(e.zoom),\n        translate = this._map\n          .getPixelOrigin()\n          .add(this._location)\n          .multiplyBy(scale)\n          .subtract(this._map._getNewPixelOrigin(e.center, e.zoom))\n          .round();\n\n      if (L.Browser.any3d) {\n        L.DomUtil.setTransform(this._image, translate, scale);\n      } else {\n        L.DomUtil.setPosition(this._image, translate);\n      }\n    },\n    _reset: function (e) {\n      var image = this._image,\n        location = this._location,\n        size = this._size;\n      // TBD use the angle to establish the image rotation in CSS\n\n      if (\n        e &&\n        this._step > 1 &&\n        (this._overlayToRemove === undefined ||\n          this._url === this._overlayToRemove)\n      ) {\n        return;\n      }\n      L.DomUtil.setPosition(image, location);\n\n      image.style.width = size.x + 'px';\n      image.style.height = size.y + 'px';\n    },\n    _updateOpacity: function () {\n      if (!this._map) {\n        return;\n      }\n\n      //L.DomUtil.setOpacity(this._image, this.options.opacity);\n\n      var now = +new Date(),\n        nextFrame = false;\n\n      var image = this._image;\n\n      var fade = Math.min(1, (now - image.loaded) / 200);\n\n      L.DomUtil.setOpacity(image, fade);\n      if (fade < 1) {\n        nextFrame = true;\n      }\n      if (nextFrame) {\n        L.Util.cancelAnimFrame(this._fadeFrame);\n        this._fadeFrame = L.Util.requestAnimFrame(this._updateOpacity, this);\n      }\n      L.DomUtil.addClass(image, 'leaflet-image-loaded');\n    }\n  });\n  var imageLayer = function (\n    url,\n    location,\n    size,\n    angle,\n    container,\n    options\n  ) {\n    return new ImageLayer(url, location, size, angle, container, options);\n  };\n\n  var MapMLLayer = L.LayerGroup.extend({\n    options: {\n      zIndex: 0,\n      opacity: '1.0'\n    },\n    // initialize is executed before the layer is added to a map\n    initialize: function (href, layerEl, options) {\n      // in the custom element, the attribute is actually 'src'\n      // the _href version is the URL received from layer-@src\n      L.LayerGroup.prototype.initialize.call(this, null, options);\n      if (href) {\n        this._href = href;\n      }\n      this._layerEl = layerEl;\n      this._content = layerEl.src ? layerEl.shadowRoot : layerEl;\n      L.setOptions(this, options);\n      this._container = L.DomUtil.create('div', 'leaflet-layer');\n      this.changeOpacity(this.options.opacity);\n      L.DomUtil.addClass(this._container, 'mapml-layer');\n\n      // this layer 'owns' a mapmlTileLayer, which is a subclass of L.GridLayer\n      // it 'passes' what tiles to load via the content of this._mapmlTileContainer\n      this._mapmlTileContainer = L.DomUtil.create(\n        'div',\n        'mapml-tile-container',\n        this._container\n      );\n      // hit the service to determine what its extent might be\n      // OR use the extent of the content provided\n\n      this._initialize(this._content);\n    },\n    setZIndex: function (zIndex) {\n      this.options.zIndex = zIndex;\n      this._updateZIndex();\n\n      return this;\n    },\n    getHref: function () {\n      return this._href ?? '';\n    },\n    _updateZIndex: function () {\n      if (\n        this._container &&\n        this.options.zIndex !== undefined &&\n        this.options.zIndex !== null\n      ) {\n        this._container.style.zIndex = this.options.zIndex;\n      }\n    },\n    changeOpacity: function (opacity) {\n      this._container.style.opacity = opacity;\n      this._layerEl._opacity = opacity;\n      if (this._layerEl._opacitySlider)\n        this._layerEl._opacitySlider.value = opacity;\n    },\n    titleIsReadOnly() {\n      return !!this._titleIsReadOnly;\n    },\n    setName(newName) {\n      // a layer's accessible name is set by the <map-title>, if present\n      // if it's not available the <layer- label=\"accessible-name\"> attribute\n      // can be used\n      if (!this.titleIsReadOnly()) {\n        this._title = newName;\n        this._layerEl._layerControlHTML.querySelector(\n          '.mapml-layer-item-name'\n        ).innerHTML = newName;\n      }\n    },\n    getName() {\n      return this._title;\n    },\n\n    onAdd: function (map) {\n      L.LayerGroup.prototype.onAdd.call(this, map);\n      this.getPane().appendChild(this._container);\n\n      //only add the layer if there are tiles to be rendered\n      if (this._staticTileLayer) {\n        this.addLayer(this._staticTileLayer);\n      }\n      this.setZIndex(this.options.zIndex);\n      map.on('popupopen', this._attachSkipButtons, this);\n    },\n\n    _calculateBounds: function () {\n      delete this.bounds;\n      delete this.zoomBounds;\n      let bounds, zoomBounds;\n      let layerTypes = ['_staticTileLayer', '_mapmlvectors', '_extentLayer'];\n      bounds =\n        this._layerEl.src &&\n        this._layerEl.shadowRoot.querySelector(\n          ':host > map-meta[name=extent][content]'\n        )\n          ? M.getBoundsFromMeta(this._layerEl.shadowRoot)\n          : this._layerEl.querySelector(':scope > map-meta[name=extent][content]')\n          ? M.getBoundsFromMeta(this._layerEl)\n          : undefined;\n      zoomBounds =\n        this._layerEl.src &&\n        this._layerEl.shadowRoot.querySelector(\n          ':host > map-meta[name=zoom][content]'\n        )\n          ? M.getZoomBoundsFromMeta(this._layerEl.shadowRoot)\n          : this._layerEl.querySelector(':scope > map-meta[name=zoom][content]')\n          ? M.getZoomBoundsFromMeta(this._layerEl)\n          : undefined;\n      const mapExtents = this._layerEl.src\n        ? this._layerEl.shadowRoot.querySelectorAll('map-extent')\n        : this._layerEl.querySelectorAll('map-extent');\n      layerTypes.forEach((type) => {\n        let zoomMax, zoomMin, minNativeZoom, maxNativeZoom;\n        if (zoomBounds) {\n          zoomMax = zoomBounds.maxZoom;\n          zoomMin = zoomBounds.minZoom;\n          maxNativeZoom = zoomBounds.maxNativeZoom\n            ? zoomBounds.maxNativeZoom\n            : -Infinity;\n          minNativeZoom = zoomBounds.minNativeZoom\n            ? zoomBounds.minNativeZoom\n            : Infinity;\n        }\n        if (type === '_extentLayer' && mapExtents.length) {\n          for (let i = 0; i < mapExtents.length; i++) {\n            if (mapExtents[i]._extentLayer.bounds) {\n              let mapExtentLayer = mapExtents[i]._extentLayer;\n              if (!bounds) {\n                bounds = L.bounds(\n                  mapExtentLayer.bounds.min,\n                  mapExtentLayer.bounds.max\n                );\n              } else {\n                bounds.extend(mapExtentLayer.bounds);\n              }\n              if (mapExtentLayer.zoomBounds) {\n                if (!zoomBounds) {\n                  zoomBounds = mapExtentLayer.zoomBounds;\n                } else {\n                  // Extend layer zoombounds\n                  zoomMax = Math.max(zoomMax, mapExtentLayer.zoomBounds.maxZoom);\n                  zoomMin = Math.min(zoomMin, mapExtentLayer.zoomBounds.minZoom);\n                  maxNativeZoom = Math.max(\n                    maxNativeZoom,\n                    mapExtentLayer.zoomBounds.maxNativeZoom\n                  );\n                  minNativeZoom = Math.min(\n                    minNativeZoom,\n                    mapExtentLayer.zoomBounds.minNativeZoom\n                  );\n                  zoomBounds.minZoom = zoomMin;\n                  zoomBounds.maxZoom = zoomMax;\n                  zoomBounds.minNativeZoom = minNativeZoom;\n                  zoomBounds.maxNativeZoom = maxNativeZoom;\n                }\n              }\n            }\n          }\n        } else if (\n          type === '_mapmlvectors' ||\n          (type === '_staticTileLayer' && this._staticTileLayer)\n        ) {\n          if (this[type].layerBounds) {\n            if (!bounds) {\n              bounds = this[type].layerBounds;\n            } else {\n              bounds.extend(this[type].layerBounds);\n            }\n          }\n          if (this[type].zoomBounds) {\n            if (!zoomBounds) {\n              zoomBounds = this[type].zoomBounds;\n            } else {\n              // Extend layer zoombounds\n              zoomMax = Math.max(zoomMax, this[type].zoomBounds.maxZoom);\n              zoomMin = Math.min(zoomMin, this[type].zoomBounds.minZoom);\n              maxNativeZoom = Math.max(\n                maxNativeZoom,\n                this[type].zoomBounds.maxNativeZoom\n              );\n              minNativeZoom = Math.min(\n                minNativeZoom,\n                this[type].zoomBounds.minNativeZoom\n              );\n              zoomBounds.minZoom = zoomMin;\n              zoomBounds.maxZoom = zoomMax;\n              zoomBounds.minNativeZoom = minNativeZoom;\n              zoomBounds.maxNativeZoom = maxNativeZoom;\n            }\n          }\n        }\n      });\n      if (bounds) {\n        this.bounds = bounds;\n      } else {\n        let projectionBounds = M[this.options.projection].options.bounds;\n        this.bounds = L.bounds(projectionBounds.min, projectionBounds.max);\n      }\n      // we could get here and zoomBounds might still not be defined (empty layer)\n      if (!zoomBounds) zoomBounds = {};\n      if (!zoomBounds.minZoom) {\n        zoomBounds.minZoom = 0;\n      }\n      if (!zoomBounds.maxZoom) {\n        zoomBounds.maxZoom =\n          M[this.options.projection].options.resolutions.length - 1;\n      }\n      if (zoomBounds.minNativeZoom === Infinity) {\n        zoomBounds.minNativeZoom = zoomBounds.minZoom;\n      }\n      if (zoomBounds.maxNativeZoom === -Infinity) {\n        zoomBounds.maxNativeZoom = zoomBounds.maxZoom;\n      }\n      this.zoomBounds = zoomBounds;\n    },\n\n    onRemove: function (map) {\n      L.LayerGroup.prototype.onRemove.call(this, map);\n      L.DomUtil.remove(this._container);\n      map.off('popupopen', this._attachSkipButtons);\n    },\n    getAttribution: function () {\n      return this.options.attribution;\n    },\n    getBase: function () {\n      return new URL(\n        this._content.querySelector('map-base')\n          ? this._content.querySelector('map-base').getAttribute('href')\n          : this._content.nodeName === 'LAYER-'\n          ? this._content.baseURI\n          : this._href,\n        this._href\n      ).href;\n    },\n    appendStyleLink: function (mapLink) {\n      if (!mapLink.link) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapLink.link\n      );\n    },\n    _getStylePositionAndNode: function () {\n      return this._container.lastChild &&\n        (this._container.lastChild.nodeName.toUpperCase() === 'SVG' ||\n          this._container.lastChild.classList.contains('mapml-vector-container'))\n        ? { position: 'beforebegin', node: this._container.lastChild }\n        : this._container.lastChild\n        ? { position: 'afterend', node: this._container.lastChild }\n        : { position: 'afterbegin', node: this._container };\n    },\n    appendStyleElement: function (mapStyle) {\n      if (!mapStyle.styleElement) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapStyle.styleElement\n      );\n    },\n    _initialize: function () {\n      var layer = this;\n      var base = layer.getBase(),\n        mapml = this._content;\n      parseLicenseAndLegend();\n      setLayerTitle();\n      // crs is only set if the layer has the same projection as the map\n      if (M[layer.options.projection]) processTiles();\n      processFeatures();\n      // update controls if needed based on mapml-viewer controls/controlslist attribute\n      if (layer._layerEl.parentElement) {\n        // if layer does not have a parent Element, do not need to set Controls\n        layer._layerEl.parentElement._toggleControls();\n      }\n      // local functions\n      // determine if, where there's no match of the current layer's projection\n      // and that of the map, if there is a linked alternate text/mapml\n      // resource that matches the map's projection\n      function processFeatures() {\n        let native = M.getNativeVariables(layer._content);\n        layer._mapmlvectors = M.featureLayer(null, {\n          // pass the vector layer a renderer of its own, otherwise leaflet\n          // puts everything into the overlayPane\n          renderer: M.featureRenderer(),\n          // pass the vector layer the container for the parent into which\n          // it will append its own container for rendering into\n          pane: layer._container,\n          opacity: layer.options.opacity,\n          projection: layer.options.projection,\n          // by NOT passing options.extent, we are asking the FeatureLayer\n          // to dynamically update its .layerBounds property as features are\n          // added or removed from it\n          native: native,\n          // each owned child layer gets a reference to the root layer\n          _leafletLayer: layer,\n          mapEl: layer._layerEl.parentElement,\n          onEachFeature: function (properties, geometry) {\n            // need to parse as HTML to preserve semantics and styles\n            if (properties) {\n              var c = document.createElement('div');\n              c.classList.add('mapml-popup-content');\n              c.insertAdjacentHTML('afterbegin', properties.innerHTML);\n              geometry.bindPopup(c, { autoClose: false, minWidth: 165 });\n            }\n          }\n        }).addTo(layer);\n      }\n      function processTiles() {\n        if (mapml.querySelector('map-tile')) {\n          var tiles = document.createElement('map-tiles'),\n            zoom =\n              mapml.querySelector('map-meta[name=zoom][content]') ||\n              mapml.querySelector('map-input[type=zoom][value]');\n          tiles.setAttribute(\n            'zoom',\n            (zoom && zoom.getAttribute('content')) ||\n              (zoom && zoom.getAttribute('value')) ||\n              '0'\n          );\n          var newTiles = mapml.getElementsByTagName('map-tile');\n          for (var nt = 0; nt < newTiles.length; nt++) {\n            tiles.appendChild(document.importNode(newTiles[nt], true));\n          }\n          layer._mapmlTileContainer.appendChild(tiles);\n          layer._staticTileLayer = M.staticTileLayer({\n            pane: layer._container,\n            _leafletLayer: layer,\n            projection: layer.options.projection,\n            className: 'mapml-static-tile-layer',\n            tileContainer: layer._mapmlTileContainer,\n            maxZoomBound:\n              M[layer.options.projection].options.resolutions.length - 1,\n            tileSize: M[layer.options.projection].options.crs.tile.bounds.max.x\n          });\n        }\n      }\n      function setLayerTitle() {\n        if (mapml.querySelector('map-title')) {\n          layer._title = mapml.querySelector('map-title').textContent.trim();\n          layer._titleIsReadOnly = true;\n        } else if (layer._layerEl && layer._layerEl.hasAttribute('label')) {\n          layer._title = layer._layerEl.getAttribute('label').trim();\n        }\n      }\n      function parseLicenseAndLegend() {\n        var licenseLink = mapml.querySelector('map-link[rel=license]'),\n          licenseTitle,\n          licenseUrl,\n          attText;\n        if (licenseLink) {\n          licenseTitle = licenseLink.getAttribute('title');\n          licenseUrl = licenseLink.getAttribute('href');\n          attText =\n            '<a href=\"' +\n            licenseUrl +\n            '\" title=\"' +\n            licenseTitle +\n            '\">' +\n            licenseTitle +\n            '</a>';\n        }\n        L.setOptions(layer, { attribution: attText });\n        var legendLink = mapml.querySelector('map-link[rel=legend]');\n        if (legendLink) {\n          layer._legendUrl = legendLink.getAttribute('href');\n        }\n        if (layer._map) {\n          // if the layer is checked in the layer control, force the addition\n          // of the attribution just received\n          if (layer._map.hasLayer(layer)) {\n            layer._map.attributionControl.addAttribution(layer.getAttribution());\n          }\n        }\n      }\n    },\n    getQueryTemplates: function (location, zoom) {\n      const queryLinks = this._layerEl.querySelectorAll(\n        'map-extent[checked] map-link[rel=query]'\n      ).length\n        ? this._layerEl.querySelectorAll(\n            'map-extent[checked] map-link[rel=query]'\n          )\n        : this._layerEl.shadowRoot.querySelectorAll(\n            'map-extent[checked] map-link[rel=query]'\n          ).length\n        ? this._layerEl.shadowRoot.querySelectorAll(\n            'map-extent[checked] map-link[rel=query]'\n          )\n        : null;\n      if (queryLinks) {\n        var templates = [];\n        for (let i = 0; i < queryLinks.length; i++) {\n          const minZoom = queryLinks[i].extent.zoom.minZoom,\n            maxZoom = queryLinks[i].extent.zoom.maxZoom,\n            withinZoomBounds = (z) => {\n              return minZoom <= z && z <= maxZoom;\n            },\n            bounds = queryLinks[i].getBounds();\n\n          if (bounds.contains(location) && withinZoomBounds(zoom)) {\n            templates.push(queryLinks[i]._templateVars);\n          }\n        }\n        return templates;\n      }\n    },\n    _attachSkipButtons: function (e) {\n      let popup = e.popup,\n        map = e.target,\n        layer,\n        group,\n        content = popup._container.getElementsByClassName(\n          'mapml-popup-content'\n        )[0];\n\n      popup._container.setAttribute('role', 'dialog');\n      content.setAttribute('tabindex', '-1');\n      // https://github.com/Maps4HTML/Web-Map-Custom-Element/pull/467#issuecomment-844307818\n      content.setAttribute('role', 'document');\n      popup._count = 0; // used for feature pagination\n\n      if (popup._source._eventParents) {\n        // check if the popup is for a feature or query\n        layer =\n          popup._source._eventParents[\n            Object.keys(popup._source._eventParents)[0]\n          ]; // get first parent of feature, there should only be one\n        group = popup._source.group;\n        // if the popup is for a static / templated feature, the \"zoom to here\" link can be attached once the popup opens\n        attachZoomLink.call(popup);\n      } else {\n        // getting access to the first map-extent to get access to _extentLayer to use it's (possibly) generic _previousFeature + _nextFeature methods.\n        const mapExtent =\n          popup._source._layerEl.querySelector('map-extent') ||\n          popup._source._layerEl.shadowRoot.querySelector('map-extent');\n        layer = mapExtent._extentLayer;\n        // if the popup is for a query, the \"zoom to here\" link should be re-attached every time new pagination features are displayed\n        map.on('attachZoomLink', attachZoomLink, popup);\n      }\n\n      if (popup._container.querySelector('nav[class=\"mapml-focus-buttons\"]')) {\n        L.DomUtil.remove(\n          popup._container.querySelector('nav[class=\"mapml-focus-buttons\"]')\n        );\n        L.DomUtil.remove(popup._container.querySelector('hr'));\n      }\n      //add when popopen event happens instead\n      let div = L.DomUtil.create('nav', 'mapml-focus-buttons');\n\n      // creates |< button, focuses map\n      let mapFocusButton = L.DomUtil.create('button', 'mapml-popup-button', div);\n      mapFocusButton.type = 'button';\n      mapFocusButton.title = 'Focus Map';\n      mapFocusButton.innerHTML = \"<span aria-hidden='true'>|&#10094;</span>\";\n      L.DomEvent.on(\n        mapFocusButton,\n        'click',\n        (e) => {\n          L.DomEvent.stop(e);\n          map.featureIndex._sortIndex();\n          map.closePopup();\n          map._container.focus();\n        },\n        popup\n      );\n\n      // creates < button, focuses previous feature, if none exists focuses the current feature\n      let previousButton = L.DomUtil.create('button', 'mapml-popup-button', div);\n      previousButton.type = 'button';\n      previousButton.title = 'Previous Feature';\n      previousButton.innerHTML = \"<span aria-hidden='true'>&#10094;</span>\";\n      L.DomEvent.on(previousButton, 'click', layer._previousFeature, popup);\n\n      // static feature counter that 1/1\n      let featureCount = L.DomUtil.create('p', 'mapml-feature-count', div),\n        totalFeatures = this._totalFeatureCount ? this._totalFeatureCount : 1;\n      featureCount.innerText = popup._count + 1 + '/' + totalFeatures;\n\n      // creates > button, focuses next feature, if none exists focuses the current feature\n      let nextButton = L.DomUtil.create('button', 'mapml-popup-button', div);\n      nextButton.type = 'button';\n      nextButton.title = 'Next Feature';\n      nextButton.innerHTML = \"<span aria-hidden='true'>&#10095;</span>\";\n      L.DomEvent.on(nextButton, 'click', layer._nextFeature, popup);\n\n      // creates >| button, focuses map controls\n      let controlFocusButton = L.DomUtil.create(\n        'button',\n        'mapml-popup-button',\n        div\n      );\n      controlFocusButton.type = 'button';\n      controlFocusButton.title = 'Focus Controls';\n      controlFocusButton.innerHTML = \"<span aria-hidden='true'>&#10095;|</span>\";\n      L.DomEvent.on(\n        controlFocusButton,\n        'click',\n        (e) => {\n          map.featureIndex._sortIndex();\n          map.featureIndex.currentIndex =\n            map.featureIndex.inBoundFeatures.length - 1;\n          map.featureIndex.inBoundFeatures[0]?.path.setAttribute('tabindex', -1);\n          map.featureIndex.inBoundFeatures[\n            map.featureIndex.currentIndex\n          ]?.path.setAttribute('tabindex', 0);\n          L.DomEvent.stop(e);\n          map.closePopup();\n          map._controlContainer.querySelector('A:not([hidden])').focus();\n        },\n        popup\n      );\n\n      let divider = L.DomUtil.create('hr', 'mapml-popup-divider');\n\n      popup._navigationBar = div;\n      popup._content.appendChild(divider);\n      popup._content.appendChild(div);\n\n      content.focus();\n\n      if (group && !M.options.featureIndexOverlayOption) {\n        // e.target = this._map\n        // Looks for keydown, more specifically tab and shift tab\n        group.setAttribute('aria-expanded', 'true');\n        map.on('keydown', focusFeature);\n      } else {\n        map.on('keydown', focusMap);\n      }\n      // When popup is open, what gets focused with tab needs to be done using JS as the DOM order is not in an accessibility friendly manner\n      function focusFeature(focusEvent) {\n        let path =\n          focusEvent.originalEvent.path ||\n          focusEvent.originalEvent.composedPath();\n        let isTab = focusEvent.originalEvent.keyCode === 9,\n          shiftPressed = focusEvent.originalEvent.shiftKey;\n        if (\n          (path[0].classList.contains('leaflet-popup-close-button') &&\n            isTab &&\n            !shiftPressed) ||\n          focusEvent.originalEvent.keyCode === 27 ||\n          (path[0].classList.contains('leaflet-popup-close-button') &&\n            focusEvent.originalEvent.keyCode === 13)\n        ) {\n          setTimeout(() => {\n            map.closePopup(popup);\n            group.focus();\n            L.DomEvent.stop(focusEvent);\n          }, 0);\n        } else if (\n          path[0].classList.contains('mapml-popup-content') &&\n          isTab &&\n          shiftPressed\n        ) {\n          setTimeout(() => {\n            //timeout needed so focus of the feature is done even after the keypressup event occurs\n            map.closePopup(popup);\n            group.focus();\n            L.DomEvent.stop(focusEvent);\n          }, 0);\n        } else if (\n          path[0] === popup._content.querySelector('a') &&\n          isTab &&\n          shiftPressed\n        ) {\n          setTimeout(() => {\n            map.closePopup(popup);\n            group.focus();\n            L.DomEvent.stop(focusEvent);\n          }, 0);\n        }\n      }\n\n      function focusMap(focusEvent) {\n        let path =\n          focusEvent.originalEvent.path ||\n          focusEvent.originalEvent.composedPath();\n        let isTab = focusEvent.originalEvent.keyCode === 9,\n          shiftPressed = focusEvent.originalEvent.shiftKey;\n\n        if (\n          (focusEvent.originalEvent.keyCode === 13 &&\n            path[0].classList.contains('leaflet-popup-close-button')) ||\n          focusEvent.originalEvent.keyCode === 27\n        ) {\n          L.DomEvent.stopPropagation(focusEvent);\n          map.closePopup(popup);\n          map._container.focus();\n          if (focusEvent.originalEvent.keyCode !== 27) map._popupClosed = true;\n        } else if (\n          isTab &&\n          path[0].classList.contains('leaflet-popup-close-button')\n        ) {\n          map.closePopup(popup);\n        } else if (\n          path[0].classList.contains('mapml-popup-content') &&\n          isTab &&\n          shiftPressed\n        ) {\n          map.closePopup(popup);\n          setTimeout(() => {\n            //timeout needed so focus of the feature is done even after the keypressup event occurs\n            L.DomEvent.stop(focusEvent);\n            map._container.focus();\n          }, 0);\n        } else if (\n          path[0] === popup._content.querySelector('a') &&\n          isTab &&\n          shiftPressed\n        ) {\n          map.closePopup(popup);\n          setTimeout(() => {\n            L.DomEvent.stop(focusEvent);\n            map.getContainer.focus();\n          }, 0);\n        }\n      }\n\n      function attachZoomLink(e) {\n        // this === popup\n        let content = this._content,\n          featureEl = e ? e.currFeature : this._source._groupLayer._featureEl;\n        if (content.querySelector('a.mapml-zoom-link')) {\n          content.querySelector('a.mapml-zoom-link').remove();\n        }\n        if (!featureEl.querySelector('map-geometry')) return;\n        let tL = featureEl.extent.topLeft.gcrs,\n          bR = featureEl.extent.bottomRight.gcrs,\n          center = L.latLngBounds(\n            L.latLng(tL.horizontal, tL.vertical),\n            L.latLng(bR.horizontal, bR.vertical)\n          ).getCenter(true);\n        let zoomLink = document.createElement('a');\n        zoomLink.href = `#${featureEl.getZoomToZoom()},${center.lng},${\n        center.lat\n      }`;\n        zoomLink.innerHTML = `${M.options.locale.popupZoom}`;\n        zoomLink.className = 'mapml-zoom-link';\n        zoomLink.onclick = zoomLink.onkeydown = function (e) {\n          if (!(e instanceof MouseEvent) && e.keyCode !== 13) return;\n          e.preventDefault();\n          featureEl.zoomTo();\n          map.closePopup();\n          map.getContainer().focus();\n        };\n        // we found that the popupopen event is fired as many times as there\n        // are layers on the map (<layer-> elements / MapMLLayers that is).\n        // In each case the target layer is always this layer, so we can't\n        // detect and conditionally add the zoomLink if the target is not this.\n        // so, like Ahmad, we are taking a 'delete everyting each time'\n        // approach (see _attachSkipButtons for this approach taken with\n        // feature navigation buttons); obviously he dealt with this leaflet bug\n        // this way some time ago, and we can't figure out how to get around it\n        // apart from this slightly non-optimal method. Revisit sometime!\n        let link = content.querySelector('.mapml-zoom-link');\n        if (link) link.remove();\n        content.insertBefore(\n          zoomLink,\n          content.querySelector('hr.mapml-popup-divider')\n        );\n      }\n\n      // if popup closes then the focusFeature handler can be removed\n      map.on('popupclose', removeHandlers);\n      function removeHandlers(removeEvent) {\n        if (removeEvent.popup === popup) {\n          map.off('keydown', focusFeature);\n          map.off('keydown', focusMap);\n          map.off('popupopen', attachZoomLink);\n          map.off('popupclose', removeHandlers);\n          if (group) group.setAttribute('aria-expanded', 'false');\n        }\n      }\n    }\n  });\n  var mapMLLayer = function (url, node, options) {\n    if (!url && !node) return null;\n    return new MapMLLayer(url, node, options);\n  };\n\n  var DebugOverlay = L.Layer.extend({\n    onAdd: function (map) {\n      let mapSize = map.getSize();\n\n      //conditionally show container for debug panel/banner only when the map has enough space for it\n      if (mapSize.x > 400 || mapSize.y > 300) {\n        this._container = L.DomUtil.create(\n          'table',\n          'mapml-debug',\n          map._container\n        );\n\n        this._panel = debugPanel({\n          className: 'mapml-debug-panel',\n          pane: this._container\n        });\n        map.addLayer(this._panel);\n      }\n\n      this._grid = debugGrid({\n        className: 'mapml-debug-grid',\n        pane: map._panes.mapPane,\n        zIndex: 400,\n        tileSize: map.options.crs.options.crs.tile.bounds.max.x\n      });\n      map.addLayer(this._grid);\n\n      this._vectors = debugVectors({\n        className: 'mapml-debug-vectors',\n        pane: map._panes.mapPane,\n        toolPane: this._container\n      });\n      map.addLayer(this._vectors);\n    },\n\n    onRemove: function (map) {\n      map.removeLayer(this._grid);\n      map.removeLayer(this._vectors);\n      if (this._panel) {\n        //conditionally remove the panel, as it's not always added\n        map.removeLayer(this._panel);\n        L.DomUtil.remove(this._container);\n      }\n    }\n  });\n\n  var debugOverlay = function () {\n    return new DebugOverlay();\n  };\n\n  var DebugPanel = L.Layer.extend({\n    initialize: function (options) {\n      L.setOptions(this, options);\n    },\n\n    onAdd: function (map) {\n      this._title = L.DomUtil.create(\n        'caption',\n        'mapml-debug-banner',\n        this.options.pane\n      );\n      this._title.innerHTML = 'Debug mode';\n\n      map.debug = {};\n      map.debug._infoContainer = this._debugContainer = L.DomUtil.create(\n        'tbody',\n        'mapml-debug-panel',\n        this.options.pane\n      );\n\n      let infoContainer = map.debug._infoContainer;\n\n      map.debug._tileCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n      map.debug._tileMatrixCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n      map.debug._mapCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n      map.debug._tcrsCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n      map.debug._pcrsCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n      map.debug._gcrsCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n\n      this._map.on('mousemove', this._updateCoords);\n    },\n    onRemove: function () {\n      L.DomUtil.remove(this._title);\n      if (this._debugContainer) {\n        L.DomUtil.remove(this._debugContainer);\n        this._map.off('mousemove', this._updateCoords);\n      }\n    },\n    _updateCoords: function (e) {\n      if (this.contextMenu._visible) return;\n      let mapEl = this.options.mapEl,\n        point = mapEl._map.project(e.latlng),\n        scale = mapEl._map.options.crs.scale(+mapEl.zoom),\n        pcrs = mapEl._map.options.crs.transformation.untransform(point, scale),\n        tileSize = mapEl._map.options.crs.options.crs.tile.bounds.max.x,\n        pointI = point.x % tileSize,\n        pointJ = point.y % tileSize;\n\n      if (pointI < 0) pointI += tileSize;\n      if (pointJ < 0) pointJ += tileSize;\n\n      this.debug._tileCoord.innerHTML = `\n      <th scope=\"row\">tile: </th>\n      <td>i: ${Math.trunc(pointI)}, </td>\n      <td>j: ${Math.trunc(pointJ)}</td>\n      `;\n      this.debug._mapCoord.innerHTML = `\n      <th scope=\"row\">map: </th>\n      <td>i: ${Math.trunc(e.containerPoint.x)}, </td>\n      <td>j: ${Math.trunc(e.containerPoint.y)}</td>\n      `;\n      this.debug._gcrsCoord.innerHTML = `\n      <th scope=\"row\">gcrs: </th>\n      <td>lon: ${e.latlng.lng.toFixed(6)}, </td>\n      <td>lat: ${e.latlng.lat.toFixed(6)}</td>\n      `;\n      this.debug._tcrsCoord.innerHTML = `\n      <th scope=\"row\">tcrs: </th>\n      <td>x: ${Math.trunc(point.x)}, </td>\n      <td>y: ${Math.trunc(point.y)}</td>\n      `;\n      this.debug._tileMatrixCoord.innerHTML = `\n      <th scope=\"row\">tilematrix: </th>\n      <td>column: ${Math.trunc(point.x / tileSize)}, </td>\n      <td>row: ${Math.trunc(point.y / tileSize)}</td>\n      `;\n      this.debug._pcrsCoord.innerHTML = `\n      <th scope=\"row\">pcrs: </th>\n      <td>easting: ${pcrs.x.toFixed(2)}, </td>\n      <td>northing: ${pcrs.y.toFixed(2)}</td>\n      `;\n    }\n  });\n\n  var debugPanel = function (options) {\n    return new DebugPanel(options);\n  };\n\n  var DebugGrid = L.GridLayer.extend({\n    initialize: function (options) {\n      L.setOptions(this, options);\n      L.GridLayer.prototype.initialize.call(this, this._map);\n    },\n\n    createTile: function (coords) {\n      let tile = L.DomUtil.create('div', 'mapml-debug-tile');\n      tile.setAttribute('col', coords.x);\n      tile.setAttribute('row', coords.y);\n      tile.setAttribute('zoom', coords.z);\n      tile.innerHTML = [\n        `col: ${coords.x}`,\n        `row: ${coords.y}`,\n        `zoom: ${coords.z}`\n      ].join(', ');\n\n      tile.style.outline = '1px dashed red';\n      return tile;\n    }\n  });\n\n  var debugGrid = function (options) {\n    return new DebugGrid(options);\n  };\n\n  var DebugVectors = L.LayerGroup.extend({\n    initialize: function (options) {\n      L.setOptions(this, options);\n      L.LayerGroup.prototype.initialize.call(this, this._map, options);\n    },\n    onAdd: function (map) {\n      map.on('overlayremove', this._mapLayerUpdate, this);\n      map.on('overlayadd', this._mapLayerUpdate, this);\n      let center = map.options.crs.transformation.transform(\n        L.point(0, 0),\n        map.options.crs.scale(0)\n      );\n      this._centerVector = L.circle(map.options.crs.pointToLatLng(center, 0), {\n        radius: 250,\n        className: 'mapml-debug-vectors projection-centre'\n      });\n      this._centerVector.bindTooltip('Projection Center');\n\n      this._addBounds(map);\n    },\n    onRemove: function (map) {\n      this.clearLayers();\n    },\n\n    _addBounds: function (map) {\n      // to delay the addBounds to wait for the layer.extentbounds / layer.layerbounds to be ready when the layer- checked attribute is changed\n      setTimeout(() => {\n        let id = Object.keys(map._layers),\n          layers = map._layers,\n          colors = ['#FF5733', '#8DFF33', '#3397FF', '#E433FF', '#F3FF33'],\n          j = 0;\n\n        this.addLayer(this._centerVector);\n\n        for (let i of id) {\n          if (layers[i].layerBounds || layers[i].extentBounds) {\n            let boundsArray;\n            if (layers[i].layerBounds) {\n              boundsArray = [\n                layers[i].layerBounds.min,\n                L.point(layers[i].layerBounds.max.x, layers[i].layerBounds.min.y),\n                layers[i].layerBounds.max,\n                L.point(layers[i].layerBounds.min.x, layers[i].layerBounds.max.y)\n              ];\n            } else {\n              boundsArray = [\n                layers[i].extentBounds.min,\n                L.point(\n                  layers[i].extentBounds.max.x,\n                  layers[i].extentBounds.min.y\n                ),\n                layers[i].extentBounds.max,\n                L.point(\n                  layers[i].extentBounds.min.x,\n                  layers[i].extentBounds.max.y\n                )\n              ];\n            }\n\n            // boundsTestTag adds the value of from the <layer-@data-testid> element\n            // if it exists. this simplifies debugging because the svg path will be\n            // tagged with the layer it came from\n            let boundsTestTag =\n              layers[i].extentBounds &&\n              layers[i].options.linkEl.getLayerEl().hasAttribute('data-testid')\n                ? layers[i].options.linkEl\n                    .getLayerEl()\n                    .getAttribute('data-testid')\n                : layers[i].layerBounds &&\n                  layers[i].options?._leafletLayer?._layerEl.hasAttribute(\n                    'data-testid'\n                  )\n                ? layers[i].options._leafletLayer._layerEl.getAttribute(\n                    'data-testid'\n                  )\n                : '';\n            let boundsRect = projectedExtent(boundsArray, {\n              className: this.options.className.concat(' ', boundsTestTag),\n              color: colors[j % colors.length],\n              weight: 2,\n              opacity: 1,\n              fillOpacity: 0.01,\n              fill: true\n            });\n            if (layers[i].options._leafletLayer)\n              boundsRect.bindTooltip(layers[i].options._leafletLayer._title, {\n                sticky: true\n              });\n            this.addLayer(boundsRect);\n            j++;\n          }\n        }\n\n        if (map.totalLayerBounds) {\n          let totalBoundsArray = [\n            map.totalLayerBounds.min,\n            L.point(map.totalLayerBounds.max.x, map.totalLayerBounds.min.y),\n            map.totalLayerBounds.max,\n            L.point(map.totalLayerBounds.min.x, map.totalLayerBounds.max.y)\n          ];\n\n          let totalBounds = projectedExtent(totalBoundsArray, {\n            className: 'mapml-debug-vectors mapml-total-bounds',\n            color: '#808080',\n            weight: 5,\n            opacity: 0.5,\n            fill: false\n          });\n          this.addLayer(totalBounds);\n        }\n      }, 0);\n    },\n\n    _mapLayerUpdate: function (e) {\n      this.clearLayers();\n      this._addBounds(e.target);\n    }\n  });\n\n  var debugVectors = function (options) {\n    return new DebugVectors(options);\n  };\n\n  var ProjectedExtent = L.Path.extend({\n    getCenter: function (round) {\n      let crs = this._map.options.crs;\n      return crs.unproject(L.bounds(this._locations).getCenter());\n    },\n\n    options: {\n      className: 'mapml-debug-extent'\n    },\n    initialize: function (locations, options) {\n      //locations passed in as pcrs coordinates\n      this._locations = locations;\n      L.setOptions(this, options);\n    },\n\n    _project: function () {\n      this._rings = [];\n      let scale = this._map.options.crs.scale(this._map.getZoom()),\n        map = this._map;\n      for (let i = 0; i < this._locations.length; i++) {\n        let point = map.options.crs.transformation.transform(\n          this._locations[i],\n          scale\n        );\n        //substract the pixel origin from the pixel coordinates to get the location relative to map viewport\n        this._rings.push(\n          L.point(point.x, point.y)._subtract(map.getPixelOrigin())\n        );\n      }\n      //leaflet SVG renderer looks for and array of arrays to build polygons,\n      //in this case it only deals with a rectangle so one closed array or points\n      this._parts = [this._rings];\n    },\n\n    _update: function () {\n      if (!this._map) return;\n      this._renderer._updatePoly(this, true); //passing true creates a closed path i.e. a rectangle\n    }\n  });\n\n  var projectedExtent = function (locations, options) {\n    return new ProjectedExtent(locations, options);\n  };\n\n  var QueryHandler = L.Handler.extend({\n    addHooks: function () {\n      // get a reference to the actual <map> element, so we can\n      // use its layers property to iterate the layers from top down\n      // evaluating if they are 'on the map' (enabled)\n      L.setOptions(this, { mapEl: this._map.options.mapEl });\n      L.DomEvent.on(this._map, 'click', this._queryTopLayer, this);\n      L.DomEvent.on(this._map, 'keypress', this._queryTopLayerAtMapCenter, this);\n    },\n    removeHooks: function () {\n      L.DomEvent.off(this._map, 'click', this._queryTopLayer, this);\n      L.DomEvent.on(this._map, 'keypress', this._queryTopLayerAtMapCenter, this);\n    },\n    _getTopQueryableLayer: function () {\n      var layers = this.options.mapEl.layers;\n      // work backwards in document order (top down)\n      for (var l = layers.length - 1; l >= 0; l--) {\n        if (layers[l].queryable()) {\n          return layers[l]._layer;\n        }\n      }\n    },\n    _queryTopLayerAtMapCenter: function (event) {\n      setTimeout(() => {\n        if (\n          this._map.isFocused &&\n          !this._map._popupClosed &&\n          (event.originalEvent.key === ' ' || +event.originalEvent.keyCode === 13)\n        ) {\n          this._map.fire('click', {\n            latlng: this._map.getCenter(),\n            layerPoint: this._map.latLngToLayerPoint(this._map.getCenter()),\n            containerPoint: this._map.latLngToContainerPoint(\n              this._map.getCenter()\n            )\n          });\n        } else {\n          delete this._map._popupClosed;\n        }\n      }, 0);\n    },\n    _queryTopLayer: function (event) {\n      var layer = this._getTopQueryableLayer();\n      if (layer) {\n        if (layer._mapmlFeatures) delete layer._mapmlFeatures;\n        this._query(event, layer);\n      }\n    },\n    _query(e, layer) {\n      var zoom = e.target.getZoom(),\n        map = this._map,\n        crs = M[layer.options.projection], // the crs for each extent would be the same\n        tileSize = map.options.crs.options.crs.tile.bounds.max.x,\n        container = layer._container,\n        popupOptions = {\n          autoClose: false,\n          autoPan: true,\n          maxHeight: map.getSize().y * 0.5 - 50\n        },\n        tcrs2pcrs = function (c) {\n          return crs.transformation.untransform(c, crs.scale(zoom));\n        },\n        tcrs2gcrs = function (c) {\n          return crs.unproject(\n            crs.transformation.untransform(c, crs.scale(zoom)),\n            zoom\n          );\n        };\n      var tcrsClickLoc = crs.latLngToPoint(e.latlng, zoom),\n        tileMatrixClickLoc = tcrsClickLoc.divideBy(tileSize).floor(),\n        tileBounds = new L.Bounds(\n          tcrsClickLoc.divideBy(tileSize).floor().multiplyBy(tileSize),\n          tcrsClickLoc.divideBy(tileSize).ceil().multiplyBy(tileSize)\n        );\n\n      let point = this._map.project(e.latlng),\n        scale = this._map.options.crs.scale(this._map.getZoom()),\n        pcrsClick = this._map.options.crs.transformation.untransform(\n          point,\n          scale\n        );\n      let templates = layer.getQueryTemplates(pcrsClick, zoom);\n\n      let fetches = [];\n\n      var fetchFeatures = function (template, obj) {\n        const parser = new DOMParser();\n        return fetch(L.Util.template(template.template, obj), {\n          redirect: 'follow'\n        })\n          .then((response) => {\n            if (response.status >= 200 && response.status < 300) {\n              return response.text().then((text) => {\n                return {\n                  contenttype: response.headers.get('Content-Type'),\n                  text: text\n                };\n              });\n            } else {\n              throw new Error(response.status);\n            }\n          })\n          .then((response) => {\n            let features = [];\n            let queryMetas = [];\n            let geom =\n              \"<map-geometry cs='gcrs'><map-point><map-coordinates>\" +\n              e.latlng.lng +\n              ' ' +\n              e.latlng.lat +\n              '</map-coordinates></map-point></map-geometry>';\n            if (response.contenttype.startsWith('text/mapml')) {\n              // the mapmldoc could have <map-meta> elements that are important, perhaps\n              // also, the mapmldoc can have many features\n              let mapmldoc = parser.parseFromString(\n                response.text,\n                'application/xml'\n              );\n              let geometrylessFeatures = mapmldoc.querySelectorAll(\n                'map-feature:not(:has(map-geometry))'\n              );\n              if (geometrylessFeatures.length) {\n                let g = parser.parseFromString(geom, 'application/xml');\n                for (let i = 0; i < geometrylessFeatures.length; i++) {\n                  let f = geometrylessFeatures[i];\n                  f.appendChild(g.firstElementChild.cloneNode(true));\n                }\n              }\n              features = Array.prototype.slice.call(\n                mapmldoc.querySelectorAll('map-feature')\n              );\n              // <map-meta> elements for this query\n              queryMetas = Array.prototype.slice.call(\n                mapmldoc.querySelectorAll(\n                  'map-meta[name=cs], map-meta[name=zoom], map-meta[name=projection]'\n                )\n              );\n              if (queryMetas.length)\n                features.forEach((f) => (f.meta = queryMetas));\n            } else {\n              try {\n                let featureDocument = parser.parseFromString(\n                  response.text,\n                  'application/xml'\n                );\n                let featureCollection =\n                  featureDocument.querySelectorAll('map-feature');\n                if (\n                  featureDocument.querySelector('parsererror') ||\n                  featureCollection.length === 0\n                ) {\n                  throw new Error('parsererror');\n                }\n                let g = parser.parseFromString(geom, 'application/xml');\n                queryMetas = Array.prototype.slice.call(\n                  featureDocument.querySelectorAll(\n                    'map-meta[name=cs], map-meta[name=zoom], map-meta[name=projection]'\n                  )\n                );\n                for (let feature of featureCollection) {\n                  if (!feature.querySelector('map-geometry')) {\n                    feature.appendChild(g.firstElementChild.cloneNode(true));\n                  }\n                  feature.meta = queryMetas;\n                  features.push(feature);\n                }\n              } catch (err) {\n                // try the html parser; script elements are marked as non-functional\n                // by that api, which hopefully works!\n                let html = parser.parseFromString(response.text, 'text/html');\n\n                // synthesize a single feature from text or html content\n                let featureDoc = parser.parseFromString(\n                  '<map-feature><map-properties>' +\n                    '</map-properties>' +\n                    geom +\n                    '</map-feature>',\n                  'text/html'\n                );\n                if (html.body) {\n                  featureDoc\n                    .querySelector('map-properties')\n                    .appendChild(html.querySelector('html'));\n                } else {\n                  featureDoc\n                    .querySelector('map-properties')\n                    .append(response.text);\n                }\n                features.push(featureDoc.querySelector('map-feature'));\n              }\n            }\n            return { features: features, template: template };\n          })\n          .catch((err) => {\n            console.log('Looks like there was a problem. Status: ' + err.message);\n          });\n      };\n\n      for (let i = 0; i < templates.length; i++) {\n        var obj = {},\n          template = templates[i];\n\n        // all of the following are locations that might be used in a query, I think.\n        obj[template.query.tilei] =\n          tcrsClickLoc.x.toFixed() - tileMatrixClickLoc.x * tileSize;\n        obj[template.query.tilej] =\n          tcrsClickLoc.y.toFixed() - tileMatrixClickLoc.y * tileSize;\n\n        // this forces the click to the centre of the map extent in the layer crs\n        obj[template.query.mapi] = map.getSize().divideBy(2).x.toFixed();\n        obj[template.query.mapj] = map.getSize().divideBy(2).y.toFixed();\n\n        obj[template.query.pixelleft] = crs.pointToLatLng(tcrsClickLoc, zoom).lng;\n        obj[template.query.pixeltop] = crs.pointToLatLng(tcrsClickLoc, zoom).lat;\n        obj[template.query.pixelright] = crs.pointToLatLng(\n          tcrsClickLoc.add([1, 1]),\n          zoom\n        ).lng;\n        obj[template.query.pixelbottom] = crs.pointToLatLng(\n          tcrsClickLoc.add([1, 1]),\n          zoom\n        ).lat;\n\n        obj[template.query.column] = tileMatrixClickLoc.x;\n        obj[template.query.row] = tileMatrixClickLoc.y;\n        obj[template.query.x] = tcrsClickLoc.x.toFixed();\n        obj[template.query.y] = tcrsClickLoc.y.toFixed();\n\n        // whereas the layerPoint is calculated relative to the origin plus / minus any\n        // pan movements so is equal to containerPoint at first before any pans, but\n        // changes as the map pans.\n        obj[template.query.easting] = tcrs2pcrs(tcrsClickLoc).x;\n        obj[template.query.northing] = tcrs2pcrs(tcrsClickLoc).y;\n        obj[template.query.longitude] = tcrs2gcrs(tcrsClickLoc).lng;\n        obj[template.query.latitude] = tcrs2gcrs(tcrsClickLoc).lat;\n        obj[template.query.zoom] = zoom;\n        obj[template.query.width] = map.getSize().x;\n        obj[template.query.height] = map.getSize().y;\n        // assumes the click is at the centre of the map, per template.query.mapi, mapj above\n        obj[template.query.mapbottom] = tcrs2pcrs(\n          tcrsClickLoc.add(map.getSize().divideBy(2))\n        ).y;\n        obj[template.query.mapleft] = tcrs2pcrs(\n          tcrsClickLoc.subtract(map.getSize().divideBy(2))\n        ).x;\n        obj[template.query.maptop] = tcrs2pcrs(\n          tcrsClickLoc.subtract(map.getSize().divideBy(2))\n        ).y;\n        obj[template.query.mapright] = tcrs2pcrs(\n          tcrsClickLoc.add(map.getSize().divideBy(2))\n        ).x;\n\n        obj[template.query.tilebottom] = tcrs2pcrs(tileBounds.max).y;\n        obj[template.query.tileleft] = tcrs2pcrs(tileBounds.min).x;\n        obj[template.query.tiletop] = tcrs2pcrs(tileBounds.min).y;\n        obj[template.query.tileright] = tcrs2pcrs(tileBounds.max).x;\n        // add hidden or other variables that may be present into the values to\n        // be processed by L.Util.template below.\n        for (var v in template.query) {\n          if (\n            [\n              'mapi',\n              'mapj',\n              'tilei',\n              'tilej',\n              'row',\n              'col',\n              'x',\n              'y',\n              'easting',\n              'northing',\n              'longitude',\n              'latitude',\n              'width',\n              'height',\n              'zoom',\n              'mapleft',\n              'mapright',\n              ',maptop',\n              'mapbottom',\n              'tileleft',\n              'tileright',\n              'tiletop',\n              'tilebottom',\n              'pixeltop',\n              'pixelbottom',\n              'pixelleft',\n              'pixelright'\n            ].indexOf(v) < 0\n          ) {\n            obj[v] = template.query[v];\n          }\n        }\n        fetches.push(fetchFeatures(template, obj));\n      }\n      Promise.allSettled(fetches).then((results) => {\n        layer._mapmlFeatures = [];\n        // f is an array of {features[], template}\n\n        for (let f of results) {\n          if (f.status === 'fulfilled') {\n            // create connection between queried <map-feature> and its parent <map-link>\n            for (let feature of f.value.features) {\n              feature._linkEl = f.value.template.linkEl;\n            }\n            layer._mapmlFeatures = layer._mapmlFeatures.concat(f.value.features);\n          }\n        }\n        if (layer._mapmlFeatures.length > 0)\n          displayFeaturesPopup(layer._mapmlFeatures, e.latlng);\n      });\n\n      function displayFeaturesPopup(features, loc) {\n        if (features.length === 0) return;\n        let f = M.featureLayer(features, {\n          // pass the vector layer a renderer of its own, otherwise leaflet\n          // puts everything into the overlayPane\n          renderer: M.featureRenderer(),\n          // pass the vector layer the container for the parent into which\n          // it will append its own container for rendering into\n          pane: container,\n          //color: 'yellow',\n          // instead of unprojecting and then projecting and scaling,\n          // a much smarter approach would be to scale at the current\n          // zoom\n          projection: map.options.projection,\n          _leafletLayer: layer,\n          query: true,\n          mapEl: layer.options.mapEl\n        });\n\n        f.addTo(layer);\n\n        let div = L.DomUtil.create('div', 'mapml-popup-content'),\n          c = L.DomUtil.create('iframe');\n        c.style = 'border: none';\n        c.srcdoc = features[0].querySelector(\n          'map-feature map-properties'\n        ).innerHTML;\n        c.setAttribute('sandbox', 'allow-same-origin allow-forms');\n        div.appendChild(c);\n        // passing a latlng to the popup is necessary for when there is no\n        // geometry / null geometry\n        layer._totalFeatureCount = features.length;\n        layer.bindPopup(div, popupOptions).openPopup(loc);\n        layer.on('popupclose', function () {\n          layer.removeLayer(f);\n        });\n        f.showPaginationFeature({\n          i: 0,\n          popup: layer._popup\n        });\n      }\n    }\n  });\n\n  /*\n  MIT License related to portions of M.ContextMenu \n  Copyright (c) 2017 adam.ratcliffe@gmail.com\n  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), \n  to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, \n  and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n  */\n  /* global M, KeyboardEvent */\n\n  var ContextMenu = L.Handler.extend({\n    _touchstart: L.Browser.msPointer\n      ? 'MSPointerDown'\n      : L.Browser.pointer\n      ? 'pointerdown'\n      : 'touchstart',\n\n    initialize: function (map) {\n      L.Handler.prototype.initialize.call(this, map);\n      this.activeIndex = 0; //current fous index on menu\n      this.excludedIndices = [4, 7]; //menu indexes that are --------\n      this.isRunned = false; //variable for tracking edge case\n      //setting the items in the context menu and their callback functions\n      this._menuItems = {};\n\n      const CTXBACK = 0,\n        CTXFWD = 1,\n        CTXRELOAD = 2,\n        CTXFULLSCR = 3,\n        CTXSPACER1 = 4,\n        CTXCOPY = 5,\n        CTXPASTE = 6,\n        CTXSPACER2 = 7,\n        CTXCNTRLS = 8,\n        CTXDEBUG = 9,\n        CTXVWSRC = 10;\n      this._menuItems.CTXBACK = CTXBACK;\n      this._menuItems.CTXFWD = CTXFWD;\n      this._menuItems.CTXRELOAD = CTXRELOAD;\n      this._menuItems.CTXFULLSCR = CTXFULLSCR;\n      this._menuItems.CTXSPACER1 = CTXSPACER1;\n      this._menuItems.CTXCOPY = CTXCOPY;\n      this._menuItems.CTXPASTE = CTXPASTE;\n      this._menuItems.CTXSPACER2 = CTXSPACER2;\n      this._menuItems.CTXCNTRLS = CTXCNTRLS;\n      this._menuItems.CTXDEBUG = CTXDEBUG;\n      this._menuItems.CTXVWSRC = CTXVWSRC;\n\n      this._items = [\n        {\n          // 0\n          text: M.options.locale.cmBack + ' (<kbd>Alt+Left Arrow</kbd>)',\n          callback: this._goBack\n        },\n        {\n          // 1\n          text: M.options.locale.cmForward + ' (<kbd>Alt+Right Arrow</kbd>)',\n          callback: this._goForward\n        },\n        {\n          // 2\n          text: M.options.locale.cmReload + ' (<kbd>Ctrl+R</kbd>)',\n          callback: this._reload\n        },\n        {\n          // 3\n          text: M.options.locale.btnFullScreen + ' (<kbd>F</kbd>)',\n          callback: this._toggleFullScreen\n        },\n        {\n          // 4\n          spacer: '-'\n        },\n        {\n          // 5\n          text: M.options.locale.cmCopyCoords + ' (<kbd>C</kbd>)<span></span>',\n          callback: this._copyCoords,\n          hideOnSelect: false,\n          popup: true,\n          submenu: [\n            {\n              // 5.0\n              text: M.options.locale.cmCopyMapML,\n              callback: this._copyMapML\n            },\n            {\n              // 5.1\n              text: M.options.locale.cmCopyExtent,\n              callback: this._copyExtent\n            },\n            {\n              // 5.2\n              text: M.options.locale.cmCopyLocation,\n              callback: this._copyLocation\n            }\n          ]\n        },\n        {\n          // 6\n          text: M.options.locale.cmPasteLayer + ' (<kbd>P</kbd>)',\n          callback: this._paste\n        },\n        {\n          // 7\n          spacer: '-'\n        },\n        {\n          // 8\n          text: M.options.locale.cmToggleControls + ' (<kbd>T</kbd>)',\n          callback: this._toggleControls\n        },\n        {\n          // 9\n          text: M.options.locale.cmToggleDebug + ' (<kbd>D</kbd>)',\n          callback: this._toggleDebug\n        },\n        {\n          // 10\n          text: M.options.locale.cmViewSource + ' (<kbd>V</kbd>)',\n          callback: this._viewSource\n        }\n      ];\n\n      // setting the default cs for copying location and extent\n      // should be public as they are used in tests\n      this.defExtCS = M.options.defaultExtCoor;\n      this.defLocCS = M.options.defaultLocCoor;\n\n      // Used for layer and map-extent contextmenu\n      const LYRZOOMTO = 0,\n        LYRCOPY = 1;\n      this._menuItems.LYRZOOMTO = LYRZOOMTO;\n      this._menuItems.LYRCOPY = LYRCOPY;\n\n      this._layerItems = [\n        {\n          // 0\n          text: M.options.locale.lmZoomToLayer + ' (<kbd>Z</kbd>)',\n          callback: this._zoomToLayer\n        },\n        {\n          // 1\n          text: M.options.locale.lmCopyLayer + ' (<kbd>L</kbd>)',\n          callback: this._copyLayer\n        }\n      ];\n\n      this._extentLayerItems = [\n        {\n          // 0\n          text: M.options.locale.lmZoomToExtent + ' (<kbd>Z</kbd>)',\n          callback: this._zoomToMapExtent\n        },\n        {\n          // 1\n          text: M.options.locale.lmCopyExtent + ' (<kbd>L</kbd>)',\n          callback: this._copyMapExtent\n        }\n      ];\n      this._mapMenuVisible = false;\n      this._keyboardEvent = false;\n\n      this._container = L.DomUtil.create(\n        'div',\n        'mapml-contextmenu',\n        map.getContainer()\n      );\n      this._container.setAttribute('hidden', '');\n\n      this._items[CTXBACK].el = this._createItem(\n        this._container,\n        this._items[CTXBACK]\n      );\n      this._items[CTXFWD].el = this._createItem(\n        this._container,\n        this._items[CTXFWD]\n      );\n      this._items[CTXRELOAD].el = this._createItem(\n        this._container,\n        this._items[CTXRELOAD]\n      );\n      this._items[CTXFULLSCR].el = this._createItem(\n        this._container,\n        this._items[CTXFULLSCR]\n      );\n      this._items[CTXSPACER1].el = this._createItem(\n        this._container,\n        this._items[CTXSPACER1]\n      );\n      this._items[CTXCOPY].el = this._createItem(\n        this._container,\n        this._items[CTXCOPY]\n      );\n\n      this._copySubMenu = L.DomUtil.create(\n        'div',\n        'mapml-contextmenu mapml-submenu',\n        this._container\n      );\n      this._copySubMenu.id = 'mapml-copy-submenu';\n      this._copySubMenu.setAttribute('hidden', '');\n\n      this._clickEvent = null;\n\n      const CPYMENUMAP = 0,\n        CPYMENUEXTENT = 1,\n        CPYMENULOC = 2;\n      this._menuItems.CPYMENUMAP = CPYMENUMAP;\n      this._menuItems.CPYMENUEXTENT = CPYMENUEXTENT;\n      this._menuItems.CPYMENULOC = CPYMENULOC;\n      this._createItem(\n        this._copySubMenu,\n        this._items[CTXCOPY].submenu[CPYMENUMAP],\n        CPYMENUMAP\n      );\n      this._createItem(\n        this._copySubMenu,\n        this._items[CTXCOPY].submenu[CPYMENUEXTENT],\n        CPYMENUEXTENT\n      );\n      this._createItem(\n        this._copySubMenu,\n        this._items[CTXCOPY].submenu[CPYMENULOC],\n        CPYMENULOC\n      );\n\n      this._items[CTXPASTE].el = this._createItem(\n        this._container,\n        this._items[CTXPASTE]\n      );\n      this._items[CTXSPACER2].el = this._createItem(\n        this._container,\n        this._items[CTXSPACER2]\n      );\n      this._items[CTXCNTRLS].el = this._createItem(\n        this._container,\n        this._items[CTXCNTRLS]\n      );\n      this._items[CTXDEBUG].el = this._createItem(\n        this._container,\n        this._items[CTXDEBUG]\n      );\n      this._items[CTXVWSRC].el = this._createItem(\n        this._container,\n        this._items[CTXVWSRC]\n      );\n\n      this._layerMenu = L.DomUtil.create(\n        'div',\n        'mapml-contextmenu mapml-layer-menu',\n        map.getContainer()\n      );\n      this._layerMenu.setAttribute('hidden', '');\n      this._createItem(this._layerMenu, this._layerItems[LYRZOOMTO]);\n      this._createItem(this._layerMenu, this._layerItems[LYRCOPY]);\n\n      this._extentLayerMenu = L.DomUtil.create(\n        'div',\n        'mapml-contextmenu mapml-extent-menu',\n        map.getContainer()\n      );\n      this._extentLayerMenu.setAttribute('hidden', '');\n      this._createItem(this._extentLayerMenu, this._extentLayerItems[LYRZOOMTO]);\n      this._createItem(this._extentLayerMenu, this._extentLayerItems[LYRCOPY]);\n\n      L.DomEvent.on(this._container, 'click', L.DomEvent.stop)\n        .on(this._container, 'mousedown', L.DomEvent.stop)\n        .on(this._container, 'dblclick', L.DomEvent.stop)\n        .on(this._container, 'contextmenu', L.DomEvent.stop)\n        .on(this._layerMenu, 'click', L.DomEvent.stop)\n        .on(this._layerMenu, 'mousedown', L.DomEvent.stop)\n        .on(this._layerMenu, 'dblclick', L.DomEvent.stop)\n        .on(this._layerMenu, 'contextmenu', L.DomEvent.stop)\n        .on(this._extentLayerMenu, 'click', L.DomEvent.stop)\n        .on(this._extentLayerMenu, 'mousedown', L.DomEvent.stop)\n        .on(this._extentLayerMenu, 'dblclick', L.DomEvent.stop)\n        .on(this._extentLayerMenu, 'contextmenu', L.DomEvent.stop);\n\n      this.t = document.createElement('template');\n      this.t.innerHTML = `<map-feature zoom=\"\">\n        <map-featurecaption></map-featurecaption>\n        <map-properties>\n            <h2></h2>\n            <div style=\"text-align:center\"></div>\n        </map-properties>\n        <map-geometry cs=\"\">\n          <map-point>\n            <map-coordinates></map-coordinates>\n          </map-point>\n        </map-geometry>\n      </map-feature>`;\n    },\n\n    addHooks: function () {\n      var container = this._map.getContainer();\n\n      L.DomEvent.on(container, 'mouseleave', this._hide, this).on(\n        document,\n        'keydown',\n        this._onKeyDown,\n        this\n      );\n\n      if (L.Browser.touch) {\n        L.DomEvent.on(document, this._touchstart, this._hide, this);\n      }\n\n      this._map.on(\n        {\n          contextmenu: this._show,\n          mousedown: this._hide,\n          zoomstart: this._hide\n        },\n        this\n      );\n    },\n\n    removeHooks: function () {\n      var container = this._map.getContainer();\n\n      L.DomEvent.off(container, 'mouseleave', this._hide, this).off(\n        document,\n        'keydown',\n        this._onKeyDown,\n        this\n      );\n\n      if (L.Browser.touch) {\n        L.DomEvent.off(document, this._touchstart, this._hide, this);\n      }\n\n      this._map.off(\n        {\n          contextmenu: this._show,\n          mousedown: this._hide,\n          zoomstart: this._hide\n        },\n        this\n      );\n    },\n\n    _updateCS: function () {\n      if (\n        this.defExtCS !== M.options.defaultExtCoor ||\n        this.defLocCS !== M.options.defaultLocCoor\n      ) {\n        this.defExtCS = M.options.defaultExtCoor;\n        this.defLocCS = M.options.defaultLocCoor;\n      }\n    },\n\n    _copyExtent: function (e) {\n      let context =\n          e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu,\n        coord = context.defExtCS ? context.defExtCS.toLowerCase() : 'pcrs',\n        tL =\n          e instanceof KeyboardEvent\n            ? this.extent.topLeft[coord]\n            : this.options.mapEl.extent.topLeft[coord],\n        bR =\n          e instanceof KeyboardEvent\n            ? this.extent.bottomRight[coord]\n            : this.options.mapEl.extent.bottomRight[coord],\n        data = '';\n      switch (coord) {\n        case 'MapML':\n        default:\n          if (coord === 'pcrs') {\n            data = `<map-meta name=\"extent\" content=\"top-left-easting=${Math.round(\n            tL.horizontal\n          )}, top-left-northing=${Math.round(\n            tL.vertical\n          )}, bottom-right-easting=${Math.round(\n            bR.horizontal\n          )}, bottom-right-northing=${Math.round(bR.vertical)}\"></map-meta>`;\n          } else if (coord === 'gcrs') {\n            data = `<map-meta name=\"extent\" content=\"top-left-longitude=${tL.horizontal}, top-left-latitude=${tL.vertical}, bottom-right-longitude=${bR.horizontal}, bottom-right-latitude=${bR.vertical}\"></map-meta>`;\n          } else if (coord === 'tcrs') {\n            data = `<map-meta name=\"extent\" content=\"top-left-x=${\n            tL[0].horizontal\n          }, top-left-y=${tL[0].vertical}, bottom-right-x=${\n            bR[bR.length - 1].horizontal\n          }, bottom-right-y=${bR[bR.length - 1].vertical}\"></map-meta>`;\n          } else if (coord === 'tilematrix') {\n            data = `<map-meta name=\"extent\" content=\"top-left-column=${\n            tL[0].horizontal\n          }, top-left-row=${tL[0].vertical}, bottom-right-column=${\n            bR[bR.length - 1].horizontal\n          }, bottom-right-row=${bR[bR.length - 1].vertical}\"></map-meta>`;\n          } else {\n            console.log('not support');\n          }\n          break;\n      }\n      context._copyData(data);\n    },\n\n    _zoomToLayer: function (e) {\n      let context =\n        e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu;\n      context._layerClicked.layer._layerEl.zoomTo();\n    },\n\n    _copyLayer: function (e) {\n      let context =\n          e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu,\n        layerElem = context._layerClicked.layer._layerEl;\n      context._copyData(layerElem.getOuterHTML());\n    },\n\n    _zoomToMapExtent: function (e) {\n      let context =\n        e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu;\n      context._layerClicked.extent.zoomTo();\n    },\n\n    _copyMapExtent: function (e) {\n      let context =\n          e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu,\n        extentElem = context._layerClicked.extent;\n      context._copyData(extentElem.getOuterHTML());\n    },\n\n    _goForward: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl.forward();\n    },\n\n    _goBack: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl.back();\n    },\n\n    _reload: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl.reload();\n    },\n\n    _toggleFullScreen: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl._toggleFullScreen();\n    },\n\n    _toggleControls: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      if (mapEl.controls) {\n        mapEl.controls = false;\n      } else {\n        mapEl.controls = true;\n      }\n    },\n\n    _copyMapML: function (e) {\n      let context =\n          e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu,\n        mapEl =\n          e instanceof KeyboardEvent\n            ? this._map.options.mapEl\n            : this.options.mapEl;\n      context._copyData(\n        mapEl.outerHTML.replace(\n          /<div class=\"mapml-web-map\">.*?<\\/div>|<style>\\[is=\"web-map\"].*?<\\/style>|<style>mapml-viewer.*?<\\/style>/gm,\n          ''\n        )\n      );\n    },\n\n    // Add support for pasting GeoJSON in the future\n    _paste: function (e) {\n      let context =\n          e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu,\n        mapEl =\n          e instanceof KeyboardEvent\n            ? this._map.options.mapEl\n            : this.options.mapEl;\n      navigator.clipboard.readText().then((layer) => {\n        M._pasteLayer(mapEl, layer);\n      });\n    },\n\n    _viewSource: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl.viewSource();\n    },\n\n    _toggleDebug: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl.toggleDebug();\n    },\n\n    _copyCoords: function (e) {\n      let directory = this.contextMenu ? this.contextMenu : this;\n      directory._showCopySubMenu(e);\n    },\n\n    _copyData: function (data) {\n      const el = document.createElement('textarea');\n      el.value = data;\n      document.body.appendChild(el);\n      el.select();\n      document.execCommand('copy');\n      document.body.removeChild(el);\n    },\n\n    _copyLocation: function (e) {\n      const menu = this.contextMenu;\n      switch (menu.defLocCS.toLowerCase()) {\n        case 'tile':\n          menu._copyTile.call(this, e);\n          break;\n        case 'tilematrix':\n          menu._copyTileMatrix.call(this, e);\n          break;\n        case 'map':\n          menu._copyMap.call(this, e);\n          break;\n        case 'tcrs':\n          menu._copyTCRS.call(this, e);\n          break;\n        case 'pcrs':\n          menu._copyPCRS.call(this, e);\n          break;\n        case 'gcrs':\n        default:\n          menu._copyGCRS.call(this, e);\n          break;\n      }\n    },\n\n    _copyGCRS: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'gcrs');\n      caption.textContent = `Copied ${projection} gcrs location`;\n      h2.textContent = `Copied ${projection} gcrs location`;\n      div.textContent = `${click.latlng.lng.toFixed(\n      6\n    )} ${click.latlng.lat.toFixed(6)}`;\n      coords.textContent = `${click.latlng.lng.toFixed(\n      6\n    )} ${click.latlng.lat.toFixed(6)}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyTCRS: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        point = mapEl._map.project(click.latlng),\n        pt = { x: point.x.toFixed(), y: point.y.toFixed() },\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'tcrs');\n      caption.textContent = `Copied ${projection} tcrs location`;\n      h2.textContent = `Copied ${projection} tcrs location`;\n      div.textContent = `${pt.x} ${pt.y}`;\n      coords.textContent = `${pt.x} ${pt.y}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyTileMatrix: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        point = mapEl._map.project(click.latlng),\n        tileSize = mapEl._map.options.crs.options.crs.tile.bounds.max.x,\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'gcrs');\n      caption.textContent = `Copied ${projection} tilematrix location (not implemented yet)`;\n      h2.textContent = `Copied ${projection} tilematrix location (not implemented yet)`;\n      div.textContent = `${Math.trunc(point.x / tileSize)} ${Math.trunc(\n      point.y / tileSize\n    )}`;\n      coords.textContent = `${click.latlng.lng.toFixed(\n      6\n    )} ${click.latlng.lat.toFixed(6)}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyPCRS: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        point = mapEl._map.project(click.latlng),\n        scale = mapEl._map.options.crs.scale(+mapEl.zoom),\n        pcrs = mapEl._map.options.crs.transformation\n          .untransform(point, scale)\n          .round(),\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'pcrs');\n      caption.textContent = `Copied ${projection} pcrs location`;\n      h2.textContent = `Copied ${projection} pcrs location`;\n      div.textContent = `${pcrs.x} ${pcrs.y}`;\n      coords.textContent = `${pcrs.x} ${pcrs.y}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyTile: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        // the _map.project method returns pixels, while the _map.crs.project\n        // method returns meters, confusingly:\n        // https://leafletjs.com/reference.html#map-project\n        // https://leafletjs.com/reference.html#crs-project\n        point = mapEl._map.project(click.latlng),\n        tileSize = mapEl._map.options.crs.options.crs.tile.bounds.max.x,\n        pointX = point.x % tileSize,\n        pointY = point.y % tileSize,\n        pt = L.point(pointX, pointY).trunc(),\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      if (pt.x < 0) pt.x += tileSize;\n      if (pt.y < 0) pt.y += tileSize;\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'gcrs');\n      caption.textContent = `Copied ${projection} tile location (not implemented yet)`;\n      h2.textContent = `Copied ${projection} tile location (not implemented yet)`;\n      div.textContent = `${pt.x} ${pt.y}`;\n      coords.textContent = `${click.latlng.lng.toFixed(\n      6\n    )} ${click.latlng.lat.toFixed(6)}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyMap: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        mapPt = click.containerPoint.trunc(),\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'gcrs');\n      caption.textContent = `Copied ${projection} map location (not implemented yet)`;\n      h2.textContent = `Copied ${projection} map location (not implemented yet)`;\n      div.textContent = `${mapPt.x} ${mapPt.y}`;\n      coords.textContent = `${click.latlng.lng.toFixed(\n      6\n    )} ${click.latlng.lat.toFixed(6)}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyAllCoords: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        point = mapEl._map.project(click.latlng),\n        tileSize = mapEl._map.options.crs.options.crs.tile.bounds.max.x,\n        pointX = point.x % tileSize,\n        pointY = point.y % tileSize,\n        scale = mapEl._map.options.crs.scale(+mapEl.zoom),\n        pcrs = mapEl._map.options.crs.transformation.untransform(point, scale);\n      let allData = `z:${mapEl.zoom}\\n`;\n      allData += `tile: i:${Math.trunc(pointX)}, j:${Math.trunc(pointY)}\\n`;\n      allData += `tilematrix: column:${Math.trunc(\n      point.x / tileSize\n    )}, row:${Math.trunc(point.y / tileSize)}\\n`;\n      allData += `map: i:${Math.trunc(click.containerPoint.x)}, j:${Math.trunc(\n      click.containerPoint.y\n    )}\\n`;\n      allData += `tcrs: x:${Math.trunc(point.x)}, y:${Math.trunc(point.y)}\\n`;\n      allData += `pcrs: easting:${pcrs.x.toFixed(2)}, northing:${pcrs.y.toFixed(\n      2\n    )}\\n`;\n      allData += `gcrs: lon :${click.latlng.lng.toFixed(\n      6\n    )}, lat:${click.latlng.lat.toFixed(6)}`;\n      this.contextMenu._copyData(allData);\n    },\n\n    _createItem: function (container, options, index) {\n      if (options.spacer) {\n        return this._createSeparator(container, index);\n      }\n\n      var itemCls = 'mapml-contextmenu-item',\n        el = this._insertElementAt('button', itemCls, container, index),\n        callback = this._createEventHandler(\n          el,\n          options.callback,\n          options.context,\n          options.hideOnSelect\n        ),\n        html = '';\n\n      el.innerHTML = html + options.text;\n      el.setAttribute('type', 'button');\n      el.classList.add('mapml-button');\n      if (options.popup) {\n        el.setAttribute('aria-haspopup', 'true');\n        el.setAttribute('aria-expanded', 'false');\n        el.setAttribute('aria-controls', 'mapml-copy-submenu');\n      }\n\n      L.DomEvent.on(el, 'mouseover', this._onItemMouseOver, this)\n        .on(el, 'mouseout', this._onItemMouseOut, this)\n        .on(el, 'mousedown', L.DomEvent.stopPropagation)\n        .on(el, 'click', callback);\n\n      if (L.Browser.touch) {\n        L.DomEvent.on(el, this._touchstart, L.DomEvent.stopPropagation);\n      }\n\n      // Devices without a mouse fire \"mouseover\" on tap, but never “mouseout\"\n      if (!L.Browser.pointer) {\n        L.DomEvent.on(el, 'click', this._onItemMouseOut, this);\n      }\n\n      return {\n        id: L.Util.stamp(el),\n        el: el,\n        callback: callback\n      };\n    },\n\n    _createSeparator: function (container, index) {\n      let el = this._insertElementAt(\n        'div',\n        'mapml-contextmenu-separator',\n        container,\n        index\n      );\n\n      return {\n        id: L.Util.stamp(el),\n        el: el\n      };\n    },\n\n    _createEventHandler: function (el, func, context, hideOnSelect) {\n      let parent = this;\n\n      hideOnSelect = hideOnSelect !== undefined ? hideOnSelect : true;\n\n      return function (e) {\n        let map = parent._map,\n          containerPoint = parent._showLocation.containerPoint,\n          layerPoint = map.containerPointToLayerPoint(containerPoint),\n          latlng = map.layerPointToLatLng(layerPoint),\n          relatedTarget = parent._showLocation.relatedTarget,\n          data = {\n            containerPoint: containerPoint,\n            layerPoint: layerPoint,\n            latlng: latlng,\n            relatedTarget: relatedTarget\n          };\n\n        if (hideOnSelect) {\n          parent._hide();\n        }\n\n        if (func) {\n          func.call(context || map, data);\n        }\n\n        parent._map.fire('contextmenu.select', {\n          contextmenu: parent,\n          el: el\n        });\n      };\n    },\n\n    _insertElementAt: function (tagName, className, container, index) {\n      let refEl,\n        el = document.createElement(tagName);\n\n      el.className = className;\n\n      if (index !== undefined) {\n        refEl = container.children[index];\n      }\n\n      if (refEl) {\n        container.insertBefore(el, refEl);\n      } else {\n        container.appendChild(el);\n      }\n\n      return el;\n    },\n\n    _show: function (e) {\n      // don't show a context menu for features\n      if (e.originalEvent.target.closest('.mapml-vector-container')) return;\n      if (this._mapMenuVisible) this._hide();\n      this._clickEvent = e;\n      let elem = e.originalEvent.target;\n      // Opening contextmenu for layercontrol\n      if (elem.closest('fieldset')) {\n        elem = elem.closest('fieldset');\n        // layer layercontrol\n        if (elem.className === 'mapml-layer-item') {\n          elem = elem.querySelector('span');\n          this._layerMenu.removeAttribute('hidden');\n          this._showAtPoint(e.containerPoint, e, this._layerMenu);\n          // map-extent layercontrol\n        } else if (elem.className === 'mapml-layer-extent') {\n          elem = elem.querySelector('span');\n          this._extentLayerMenu.removeAttribute('hidden');\n          this._showAtPoint(e.containerPoint, e, this._extentLayerMenu);\n        }\n        this._layerClicked = elem;\n      } else if (\n        // map contextmenu\n        elem.classList.contains('leaflet-container') ||\n        elem.classList.contains('mapml-debug-extent') ||\n        elem.tagName === 'path'\n      ) {\n        let layerList = this._map.options.mapEl.layers;\n        this._layerClicked = Array.from(layerList).find((el) => el.checked);\n        // the 'hidden' attribute must be removed before any attempt to get the size of container\n        let pt = e.containerPoint;\n        // this is for firefox, which reports the e.containerPoint as x=0 when you\n        // use a keyboard Shift+F10 to display the context menu; this appears\n        // to be because blink returns a PointerEvent of type==='contextmenu',\n        // while gecko returns an object (for e.originalEvent).\n        if (L.Browser.gecko) {\n          const getCenter = function (el) {\n            let w = el.getBoundingClientRect().width;\n            let h = el.getBoundingClientRect().height;\n            return { x: Number.parseInt(w / 2), y: Number.parseInt(h / 2) };\n          };\n          pt = getCenter(this._map.getContainer());\n        }\n        this._container.removeAttribute('hidden');\n        this._showAtPoint(pt, e, this._container);\n        this._updateCS();\n      }\n      // Once contextmenu is opened, focus the first item\n      if (e.originalEvent.button === 0 || e.originalEvent.button === -1) {\n        this._keyboardEvent = true;\n        if (this._layerClicked.className.includes('mapml-layer-item')) {\n          let activeEl = document.activeElement;\n          this._elementInFocus = activeEl.shadowRoot.activeElement;\n          this._layerMenuTabs = 1;\n          this._layerMenu.firstChild.focus();\n          //\n        } else if (this._layerClicked.className.includes('mapml-extent-item')) {\n          let activeEl = document.activeElement;\n          this._elementInFocus = activeEl.shadowRoot.activeElement;\n          this._extentLayerMenuTabs = 1;\n          this._extentLayerMenu.firstChild.focus();\n        } else {\n          this._container.querySelectorAll('button:not([disabled])')[0].focus();\n        }\n      }\n    },\n\n    _showAtPoint: function (pt, data, container) {\n      if (this._items.length) {\n        let event = L.extend(data || {}, { contextmenu: this });\n\n        this._showLocation = {\n          containerPoint: pt\n        };\n\n        if (data && data.relatedTarget) {\n          this._showLocation.relatedTarget = data.relatedTarget;\n        }\n\n        this._setPosition(pt, container);\n\n        if (!this._mapMenuVisible) {\n          container.removeAttribute('hidden');\n          this._mapMenuVisible = true;\n        }\n\n        this._map.fire('contextmenu.show', event);\n      }\n    },\n\n    _hide: function () {\n      if (this._mapMenuVisible) {\n        this._mapMenuVisible = false;\n        this._container.setAttribute('hidden', '');\n        this._copySubMenu.setAttribute('hidden', '');\n        this._layerMenu.setAttribute('hidden', '');\n        this._extentLayerMenu.setAttribute('hidden', '');\n        this._map.fire('contextmenu.hide', { contextmenu: this });\n        setTimeout(() => this._map._container.focus(), 0);\n        this.activeIndex = 0;\n        this.isRunned = false;\n      }\n    },\n\n    _setPosition: function (pt, container) {\n      let mapSize = this._map.getSize(),\n        containerSize = this._getElementSize(container),\n        anchor;\n\n      if (this._map.options.contextmenuAnchor) {\n        anchor = L.point(this._map.options.contextmenuAnchor);\n        pt = pt.add(anchor);\n      }\n\n      container._leaflet_pos = pt;\n\n      if (pt.x + containerSize.x > mapSize.x) {\n        container.style.left = 'auto';\n        container.style.right =\n          Math.min(\n            Math.max(mapSize.x - pt.x, 0),\n            mapSize.x - containerSize.x - 1\n          ) + 'px';\n      } else {\n        container.style.left = Math.max(pt.x, 0) + 'px';\n        container.style.right = 'auto';\n      }\n\n      if (pt.y + containerSize.y > mapSize.y) {\n        container.style.top = 'auto';\n        container.style.bottom =\n          Math.min(\n            Math.max(mapSize.y - pt.y, 0),\n            mapSize.y - containerSize.y - 1\n          ) + 'px';\n      } else {\n        container.style.top = Math.max(pt.y, 0) + 'px';\n        container.style.bottom = 'auto';\n      }\n    },\n\n    _getElementSize: function (el) {\n      let size = this._size;\n\n      if (!size || this._sizeChanged) {\n        size = {};\n\n        el.style.left = '-999999px';\n        el.style.right = 'auto';\n\n        size.x = el.offsetWidth;\n        size.y = el.offsetHeight;\n\n        el.style.left = 'auto';\n\n        this._sizeChanged = false;\n      }\n\n      return size;\n    },\n\n    // once Esc is clicked on the layer/extent contextMenu, change the focus back to the layer control\n    _focusOnLayerControl: function () {\n      this._mapMenuVisible = false;\n      delete this._layerMenuTabs;\n      delete this._extentLayerMenuTabs;\n      this._layerMenu.setAttribute('hidden', '');\n      this._extentLayerMenu.setAttribute('hidden', '');\n      if (this._elementInFocus) {\n        this._elementInFocus.focus();\n      } else {\n        this._layerClicked.parentElement.firstChild.focus();\n      }\n      delete this._elementInFocus;\n    },\n\n    _setActiveItem: function (index) {\n      if (\n        document.activeElement.shadowRoot === null &&\n        this.noActiveEl === true\n      ) {\n        //bug fix when theres no active element\n        this.noActiveEl = false;\n        //setting this._items[9] is just for preventing some diabled index, it will be override by later code.\n        this._items[9].el.el.focus();\n      }\n      if (\n        document.activeElement.shadowRoot.activeElement.innerHTML ===\n        this._items[index].el.el.innerHTML\n      ) {\n        //edge case where pressing shift f10 focuses the first element on contextmenu (if already focused, have to press arrow twice to go down)\n        let next = index + 1;\n        while (this._items[next].el.el.disabled) {\n          next++;\n          if (next >= this._items.length) {\n            next = 0;\n          }\n        }\n        this._setActiveItem(next);\n      } else {\n        if (this.excludedIndices.includes(index)) {\n          // find the next or previous non-excluded item\n          let nextIndex = index + 1;\n          let prevIndex = index - 1;\n          while (\n            this.excludedIndices.includes(nextIndex) ||\n            this._items[nextIndex].el.el.disabled\n          ) {\n            nextIndex++;\n            if (nextIndex >= this._items.length) {\n              nextIndex = 0;\n            }\n          }\n          while (\n            this.excludedIndices.includes(prevIndex) ||\n            this._items[prevIndex].el.el.disabled\n          ) {\n            prevIndex--;\n            if (prevIndex < 0) {\n              prevIndex = this._items.length - 1;\n            }\n          }\n          // set the active item to the next or previous non-excluded item\n          if (this.activeIndex < index) {\n            this._setActiveItem(nextIndex);\n          } else {\n            this._setActiveItem(prevIndex);\n          }\n        } else {\n          // set the focus item\n          this._items[index].el.el.focus();\n          this.activeIndex = index;\n        }\n      }\n    },\n\n    _onKeyDown: function (e) {\n      if (!this._mapMenuVisible || e.key === 'Shift') return;\n\n      if (e.code === 'Enter' || e.code === 'Tab' || e.code.startsWith('Arrow'))\n        e.preventDefault();\n\n      if (e.code === 'ArrowUp' || (e.shiftKey && e.code === 'Tab')) {\n        if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          (document.activeElement.shadowRoot === null || //null happens when the focus is on submenu and when mouse hovers on main menu, submenu disappears\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n              this._copySubMenu.children[this._menuItems.CPYMENUMAP].innerHTML)\n        ) {\n          //\"map\" on submenu\n          this._copySubMenu.children[this._menuItems.CPYMENULOC].focus();\n        } else if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._copySubMenu.children[this._menuItems.CPYMENUEXTENT].innerHTML\n        ) {\n          //\"extent\" on submenu\n          this._copySubMenu.children[this._menuItems.CPYMENUMAP].focus();\n        } else if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._copySubMenu.children[this._menuItems.CPYMENULOC].innerHTML\n        ) {\n          //\"Location\" on submenu\n          this._copySubMenu.children[this._menuItems.CPYMENUEXTENT].focus();\n        } else if (\n          !this._layerMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._layerMenu.children[this._menuItems.LYRZOOMTO].innerHTML\n        ) {\n          //\"zoom to layer\" on layermenu\n          this._layerMenu.children[this._menuItems.LYRCOPY].focus();\n        } else if (!this._layerMenu.hasAttribute('hidden')) {\n          this._layerMenu.children[this._menuItems.LYRZOOMTO].focus();\n        } else if (\n          !this._extentLayerMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._extentLayerMenu.children[this._menuItems.LYRZOOMTO].innerHTML\n        ) {\n          //\"zoom to extent\" on layermenu\n          this._extentLayerMenu.children[this._menuItems.LYRCOPY].focus();\n        } else if (!this._extentLayerMenu.hasAttribute('hidden')) {\n          this._extentLayerMenu.children[this._menuItems.LYRZOOMTO].focus();\n        } else {\n          if (this.activeIndex > 0) {\n            let prevIndex = this.activeIndex - 1;\n            while (this._items[prevIndex].el.el.disabled) {\n              prevIndex--;\n              if (prevIndex < 0) {\n                prevIndex = this._items.length - 1;\n              }\n            }\n            this._setActiveItem(prevIndex);\n          } else {\n            this._setActiveItem(this._items.length - 1);\n          }\n        }\n      } else if (e.code === 'ArrowDown' || e.code === 'Tab') {\n        if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          (document.activeElement.shadowRoot === null ||\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n              this._copySubMenu.children[this._menuItems.CPYMENULOC].innerHTML)\n        ) {\n          this._copySubMenu.children[this._menuItems.CPYMENUMAP].focus();\n        } else if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._copySubMenu.children[this._menuItems.CPYMENUEXTENT].innerHTML\n        ) {\n          this._copySubMenu.children[this._menuItems.CPYMENULOC].focus();\n        } else if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._copySubMenu.children[this._menuItems.CPYMENUMAP].innerHTML\n        ) {\n          this._copySubMenu.children[this._menuItems.CPYMENUEXTENT].focus();\n        } else if (\n          !this._layerMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._layerMenu.children[this._menuItems.LYRZOOMTO].innerHTML\n        ) {\n          this._layerMenu.children[this._menuItems.LYRCOPY].focus();\n        } else if (!this._layerMenu.hasAttribute('hidden')) {\n          this._layerMenu.children[this._menuItems.LYRZOOMTO].focus();\n        } else if (\n          !this._extentLayerMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._extentLayerMenu.children[this._menuItems.LYRZOOMTO].innerHTML\n        ) {\n          this._extentLayerMenu.children[this._menuItems.LYRCOPY].focus();\n        } else if (!this._extentLayerMenu.hasAttribute('hidden')) {\n          this._extentLayerMenu.children[this._menuItems.LYRZOOMTO].focus();\n        } else {\n          if (this.activeIndex < this._items.length - 1) {\n            //edge case at index 0\n            if (\n              !this.isRunned &&\n              this.activeIndex === 0 &&\n              !this._items[this.activeIndex].el.el.disabled\n            ) {\n              this._setActiveItem(0);\n              this.isRunned = true;\n            } else {\n              //edge case over\n              let nextIndex = this.activeIndex + 1;\n              while (this._items[nextIndex].el.el.disabled) {\n                nextIndex++;\n                if (nextIndex >= this._items.length) {\n                  nextIndex = 0;\n                }\n              }\n              this._setActiveItem(nextIndex);\n            }\n          } else {\n            let nextIndex = 0;\n            while (this._items[nextIndex].el.el.disabled) {\n              nextIndex++;\n              if (nextIndex >= this._items.length) {\n                nextIndex = 0;\n              }\n            }\n            this._setActiveItem(nextIndex);\n          }\n        }\n      } else if (e.code === 'ArrowRight') {\n        if (\n          document.activeElement.shadowRoot !== null &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._items[this._menuItems.CTXCOPY].el.el.innerHTML && //'copy'\n          this._copySubMenu.hasAttribute('hidden')\n        ) {\n          this._showCopySubMenu();\n          this._copySubMenu.children[0].focus();\n        } else if (\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._items[this._menuItems.CTXCOPY].el.el.innerHTML &&\n          !this._copySubMenu.hasAttribute('hidden')\n        ) {\n          this._copySubMenu.children[0].focus();\n        }\n      } else if (e.code === 'ArrowLeft') {\n        if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot !== null\n        ) {\n          if (\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n              this._copySubMenu.children[this._menuItems.CPYMENUMAP].innerHTML ||\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n              this._copySubMenu.children[this._menuItems.CPYMENUEXTENT]\n                .innerHTML ||\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n              this._copySubMenu.children[this._menuItems.CPYMENULOC].innerHTML\n          ) {\n            this._copySubMenu.setAttribute('hidden', '');\n            this._setActiveItem(this._menuItems.CTXCOPY);\n          }\n        }\n      } else if (e.code === 'Escape') {\n        if (this._layerMenuTabs || this._extentLayerMenuTabs) {\n          L.DomEvent.stop(e);\n          this._focusOnLayerControl();\n          return;\n        }\n        if (document.activeElement.shadowRoot === null) {\n          this._hide();\n        } else {\n          if (!this._copySubMenu.hasAttribute('hidden')) {\n            if (\n              document.activeElement.shadowRoot.activeElement.innerHTML ===\n                this._copySubMenu.children[this._menuItems.CPYMENUMAP]\n                  .innerHTML ||\n              document.activeElement.shadowRoot.activeElement.innerHTML ===\n                this._copySubMenu.children[this._menuItems.CPYMENUEXTENT]\n                  .innerHTML ||\n              document.activeElement.shadowRoot.activeElement.innerHTML ===\n                this._copySubMenu.children[this._menuItems.CPYMENULOC].innerHTML\n            ) {\n              this._copySubMenu.setAttribute('hidden', '');\n              this._setActiveItem(this._menuItems.CTXCOPY);\n            }\n          } else {\n            this._hide();\n          }\n        }\n      } else if (\n        e.code !== 'KeyC' &&\n        document.activeElement.shadowRoot.activeElement.innerHTML !==\n          this._items[this._menuItems.CTXCOPY].el.el.innerHTML\n      ) {\n        this._hide();\n      }\n      // using KeyboardEvent.code for its mnemonics and case-independence\n      switch (e.code) {\n        case 'Enter':\n          if (\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._items[this._menuItems.CTXCOPY].el.el.innerHTML\n          ) {\n            this._copyCoords({\n              latlng: this._map.getCenter()\n            });\n            this._copySubMenu.firstChild.focus();\n          } else {\n            if (\n              this._map._container.parentNode.activeElement.parentNode.classList.contains(\n                'mapml-contextmenu'\n              )\n            )\n              this._map._container.parentNode.activeElement.click();\n          }\n          break;\n        case 'Space':\n          if (\n            this._map._container.parentNode.activeElement.parentNode.classList.contains(\n              'mapml-contextmenu'\n            )\n          )\n            this._map._container.parentNode.activeElement.click();\n          break;\n        case 'KeyC':\n          this._copyCoords({\n            latlng: this._map.getCenter()\n          });\n          this._copySubMenu.firstChild.focus();\n          break;\n        case 'KeyD':\n          this._toggleDebug(e);\n          break;\n        case 'KeyM':\n          this._copyMapML(e);\n          break;\n        case 'KeyL':\n          if (this._layerClicked.className.includes('mapml-layer-item')) {\n            this._copyLayer(e);\n          } else if (this._layerClicked.className.includes('mapml-extent-item')) {\n            this._copyMapExtent(e);\n          }\n          break;\n        case 'KeyF':\n          this._toggleFullScreen(e);\n          break;\n        case 'KeyP':\n          this._paste(e);\n          break;\n        case 'KeyT':\n          this._toggleControls(e);\n          break;\n        case 'KeyV':\n          this._viewSource(e);\n          break;\n        case 'KeyZ':\n          if (this._layerClicked.className.includes('mapml-layer-item')) {\n            this._zoomToLayer(e);\n          } else if (this._layerClicked.className.includes('mapml-extent-item')) {\n            this._zoomToMapExtent(e);\n          }\n          break;\n      }\n    },\n\n    _showCopySubMenu: function (e) {\n      let mapSize = this._map.getSize(),\n        click = this._clickEvent,\n        menu = this._copySubMenu,\n        copyEl = this._items[5].el.el;\n\n      copyEl.setAttribute('aria-expanded', 'true');\n      menu.removeAttribute('hidden');\n\n      const menuWidth = this._container.offsetWidth,\n        menuHeight = this._container.offsetHeight,\n        submenuWidth = menu.offsetWidth;\n      if (click.containerPoint.x + menuWidth + submenuWidth > mapSize.x) {\n        menu.style.left = 'auto';\n        menu.style.right = menuWidth + 'px';\n      } else {\n        menu.style.left = menuWidth + 'px';\n        menu.style.right = 'auto';\n      }\n\n      menu.style.top = 100 - 22 + 'px';\n      menu.style.bottom = 'auto';\n    },\n\n    _hideCopySubMenu: function (e) {\n      if (\n        !e.relatedTarget ||\n        !e.relatedTarget.parentElement ||\n        e.relatedTarget.parentElement.classList.contains('mapml-submenu') ||\n        e.relatedTarget.classList.contains('mapml-submenu')\n      )\n        return;\n      let menu = this._copySubMenu,\n        copyEl = this._items[4].el.el;\n      copyEl.setAttribute('aria-expanded', 'false');\n      menu.setAttribute('hidden', '');\n      this.noActiveEl = true; //variable to keep track of no focus element on contextmenu, bug fix for arrow key navigation\n    },\n\n    _onItemMouseOver: function (e) {\n      L.DomUtil.addClass(e.target || e.srcElement, 'over');\n      if (e.srcElement.innerText === M.options.locale.cmCopyCoords + ' (C)')\n        this._showCopySubMenu(e);\n    },\n\n    _onItemMouseOut: function (e) {\n      L.DomUtil.removeClass(e.target || e.srcElement, 'over');\n      this._hideCopySubMenu(e);\n    },\n\n    toggleContextMenuItem: function (options, state) {\n      options = options.toUpperCase();\n      if (state === 'disabled') {\n        if (options === 'CONTROLS') {\n          this._items[8].el.el.disabled = true;\n        } else if (options === 'BACK') {\n          this._items[0].el.el.disabled = true;\n        } else if (options === 'FORWARD') {\n          this._items[1].el.el.disabled = true;\n        } else if (options === 'RELOAD') {\n          this._items[2].el.el.disabled = true;\n        }\n      } else if (state === 'enabled') {\n        if (options === 'CONTROLS') {\n          this._items[8].el.el.disabled = false;\n        } else if (options === 'BACK') {\n          this._items[0].el.el.disabled = false;\n        } else if (options === 'FORWARD') {\n          this._items[1].el.el.disabled = false;\n        } else if (options === 'RELOAD') {\n          this._items[2].el.el.disabled = false;\n        }\n      }\n    },\n\n    setViewFullScreenInnerHTML: function (options) {\n      if (options === 'view') {\n        this._map.contextMenu._items[3].el.el.innerHTML =\n          M.options.locale.btnFullScreen + ' (<kbd>F</kbd>)';\n      } else if (options === 'exit') {\n        this._map.contextMenu._items[3].el.el.innerHTML =\n          M.options.locale.btnExitFullScreen + ' (<kbd>F</kbd>)';\n      }\n    }\n  });\n\n  var Util = {\n    // _convertAndFormatPCRS returns the converted CRS and formatted pcrsBounds in gcrs, pcrs, tcrs, and tilematrix. Used for setting extent for the map and layer (map.extent, layer.extent).\n    // _convertAndFormatPCRS: L.Bounds, _map, projection -> {...}\n    _convertAndFormatPCRS: function (pcrsBounds, crs, projection) {\n      if (!pcrsBounds || !crs) return {};\n\n      let tcrsTopLeft = [],\n        tcrsBottomRight = [],\n        tileMatrixTopLeft = [],\n        tileMatrixBottomRight = [],\n        tileSize = crs.options.crs.tile.bounds.max.y;\n\n      for (let i = 0; i < crs.options.resolutions.length; i++) {\n        let scale = crs.scale(i),\n          minConverted = crs.transformation.transform(pcrsBounds.min, scale),\n          maxConverted = crs.transformation.transform(pcrsBounds.max, scale);\n\n        tcrsTopLeft.push({\n          horizontal: minConverted.x,\n          vertical: maxConverted.y\n        });\n        tcrsBottomRight.push({\n          horizontal: maxConverted.x,\n          vertical: minConverted.y\n        });\n\n        //converts the tcrs values from earlier to tilematrix\n        tileMatrixTopLeft.push({\n          horizontal: tcrsTopLeft[i].horizontal / tileSize,\n          vertical: tcrsTopLeft[i].vertical / tileSize\n        });\n        tileMatrixBottomRight.push({\n          horizontal: tcrsBottomRight[i].horizontal / tileSize,\n          vertical: tcrsBottomRight[i].vertical / tileSize\n        });\n      }\n\n      //converts the gcrs, I believe it can take any number values from -inf to +inf\n      let unprojectedMin = crs.unproject(pcrsBounds.min),\n        unprojectedMax = crs.unproject(pcrsBounds.max);\n\n      let gcrs = {\n        topLeft: {\n          horizontal: unprojectedMin.lng,\n          vertical: unprojectedMax.lat\n        },\n        bottomRight: {\n          horizontal: unprojectedMax.lng,\n          vertical: unprojectedMin.lat\n        }\n      };\n\n      //formats known pcrs bounds to correct format\n      let pcrs = {\n        topLeft: {\n          horizontal: pcrsBounds.min.x,\n          vertical: pcrsBounds.max.y\n        },\n        bottomRight: {\n          horizontal: pcrsBounds.max.x,\n          vertical: pcrsBounds.min.y\n        }\n      };\n\n      //formats all extent data\n      let extent = {\n        topLeft: {\n          tcrs: tcrsTopLeft,\n          tilematrix: tileMatrixTopLeft,\n          gcrs: gcrs.topLeft,\n          pcrs: pcrs.topLeft\n        },\n        bottomRight: {\n          tcrs: tcrsBottomRight,\n          tilematrix: tileMatrixBottomRight,\n          gcrs: gcrs.bottomRight,\n          pcrs: pcrs.bottomRight\n        }\n      };\n      if (projection) {\n        extent.projection = projection;\n      }\n      return extent;\n    },\n    // extentToBounds: returns bounds in gcrs, pcrs. Used for setting bounds for the map (map.totalLayerBounds).\n    // extentToBounds: {...}, crs -> L.Bounds / L.LatlngBounds\n    extentToBounds(extent, crs) {\n      switch (crs.toUpperCase()) {\n        case 'PCRS':\n          return L.bounds(\n            L.point(extent.topLeft.pcrs.horizontal, extent.topLeft.pcrs.vertical),\n            L.point(\n              extent.bottomRight.pcrs.horizontal,\n              extent.bottomRight.pcrs.vertical\n            )\n          );\n        case 'GCRS':\n          return L.latLngBounds(\n            L.latLng(\n              extent.topLeft.gcrs.vertical,\n              extent.topLeft.gcrs.horizontal\n            ),\n            L.latLng(\n              extent.bottomRight.gcrs.vertical,\n              extent.bottomRight.gcrs.horizontal\n            )\n          );\n      }\n    },\n\n    // axisToCS returns the CRS when given the axis:\n    // https://maps4html.org/web-map-doc/docs/elements/input/#axis\n    // axisToCS: (Axis String) -> (CRS String)\n    axisToCS: function (axis) {\n      try {\n        switch (axis.toLowerCase()) {\n          case 'row':\n          case 'column':\n            return 'TILEMATRIX';\n          case 'i':\n          case 'j':\n            return ['MAP', 'TILE'];\n          case 'x':\n          case 'y':\n            return 'TCRS';\n          case 'latitude':\n          case 'longitude':\n            return 'GCRS';\n          case 'northing':\n          case 'easting':\n            return 'PCRS';\n          default:\n            return M.FALLBACK_CS;\n        }\n      } catch (e) {\n        return undefined;\n      }\n    },\n\n    // csToAxes takes a given cs and retuns the axes, first horizontal then vertical\n    // https://maps4html.org/web-map-doc/docs/elements/input/#axis\n    // csToAxes: (CRS String) -> [(horizontal axis String), (Vertical axis String)]\n    csToAxes: function (cs) {\n      try {\n        switch (cs.toLowerCase()) {\n          case 'tilematrix':\n            return ['column', 'row'];\n          case 'map':\n          case 'tile':\n            return ['i', 'j'];\n          case 'tcrs':\n            return ['x', 'y'];\n          case 'gcrs':\n            return ['longitude', 'latitude'];\n          case 'pcrs':\n            return ['easting', 'northing'];\n        }\n      } catch (e) {\n        return undefined;\n      }\n    },\n\n    // axisToXY takes horizontal axis and returns 'x', or takes vertical axis and returns 'y'\n    // https://maps4html.org/web-map-doc/docs/elements/input/#axis\n    // axisToXY: (Axis String) -> 'x' or 'y'\n    axisToXY: function (axis) {\n      try {\n        switch (axis.toLowerCase()) {\n          case 'i':\n          case 'column':\n          case 'longitude':\n          case 'x':\n          case 'easting':\n            return 'x';\n          case 'row':\n          case 'j':\n          case 'latitude':\n          case 'y':\n          case 'northing':\n            return 'y';\n\n          default:\n            return undefined;\n        }\n      } catch (e) {\n        return undefined;\n      }\n    },\n\n    // convertPCRSBounds converts pcrsBounds to the given cs Bounds.\n    // convertPCRSBounds: L.Bounds, Int, L.CRS, Str('PCRS'|'TCRS'|'TILEMATRIX'|'GCRS') -> L.Bounds\n    convertPCRSBounds: function (pcrsBounds, zoom, projection, cs) {\n      if (\n        !pcrsBounds ||\n        (!zoom && zoom !== 0) ||\n        !Number.isFinite(+zoom) ||\n        !projection ||\n        !cs\n      )\n        return undefined;\n      projection = typeof projection === 'string' ? M[projection] : projection;\n      switch (cs.toUpperCase()) {\n        case 'PCRS':\n          return pcrsBounds;\n        case 'TCRS':\n        case 'TILEMATRIX':\n          let minPixel = projection.transformation.transform(\n              pcrsBounds.min,\n              projection.scale(+zoom)\n            ),\n            maxPixel = projection.transformation.transform(\n              pcrsBounds.max,\n              projection.scale(+zoom)\n            );\n          if (cs.toUpperCase() === 'TCRS') return L.bounds(minPixel, maxPixel);\n          let tileSize = projection.options.crs.tile.bounds.max.x;\n          return L.bounds(\n            L.point(minPixel.x / tileSize, minPixel.y / tileSize),\n            L.point(maxPixel.x / tileSize, maxPixel.y / tileSize)\n          );\n        case 'GCRS':\n          let minGCRS = projection.unproject(pcrsBounds.min),\n            maxGCRS = projection.unproject(pcrsBounds.max);\n          return L.bounds(\n            L.point(minGCRS.lng, minGCRS.lat),\n            L.point(maxGCRS.lng, maxGCRS.lat)\n          );\n        default:\n          return undefined;\n      }\n    },\n\n    // pointToPCRSPoint takes a point, with a projection and cs and converts it to a pcrs L.point/L.latLng\n    //pointToPCRSPoint: L.Point, Int, L.CRS, Str('PCRS'|'TCRS'|'TILEMATRIX'|'GCRS') -> L.point|L.latLng\n    pointToPCRSPoint: function (point, zoom, projection, cs) {\n      if (\n        !point ||\n        (zoom !== undefined && !Number.isFinite(+zoom)) ||\n        (zoom === undefined &&\n          (cs === 'TILEMATRIX' || cs === 'TCRS' || cs === 'TILE')) ||\n        !cs ||\n        !projection\n      )\n        return undefined;\n      projection = typeof projection === 'string' ? M[projection] : projection;\n      let tileSize = projection.options.crs.tile.bounds.max.x;\n      switch (cs.toUpperCase()) {\n        case 'TILEMATRIX':\n          return M.pixelToPCRSPoint(\n            L.point(point.x * tileSize, point.y * tileSize),\n            zoom,\n            projection\n          );\n        case 'PCRS':\n          return point;\n        case 'TCRS' :\n          return M.pixelToPCRSPoint(point, zoom, projection);\n        case 'GCRS':\n          return projection.project(L.latLng(point.y, point.x));\n        default:\n          return undefined;\n      }\n    },\n\n    // pixelToPCRSPoint takes a pixel L.point, the zoom and projection and returns a L.point in pcrs\n    // pixelToPCRSPoint: L.Point, Int, L.CRS|Str -> L.point\n    pixelToPCRSPoint: function (point, zoom, projection) {\n      if (\n        !point ||\n        (!zoom && zoom !== 0) ||\n        !Number.isFinite(+zoom) ||\n        !projection\n      )\n        return undefined;\n      projection = typeof projection === 'string' ? M[projection] : projection;\n      return projection.transformation.untransform(point, projection.scale(zoom));\n    },\n\n    // boundsToPCRSBounds converts bounds with projection and cs to PCRS bounds\n    // boundsToPCRSBounds: L.bounds, Int, L.CRS|Str, Str('PCRS'|'TCRS'|'TILEMATRIX'|'GCRS') -> L.bounds\n    boundsToPCRSBounds: function (bounds, zoom, projection, cs) {\n      if (\n        !bounds ||\n        !bounds.max ||\n        !bounds.min ||\n        (zoom !== undefined && !Number.isFinite(+zoom)) ||\n        (zoom === undefined &&\n          (cs === 'TILEMATRIX' || cs === 'TCRS' || cs === 'TILE')) ||\n        !projection ||\n        !cs\n      )\n        return undefined;\n      projection = typeof projection === 'string' ? M[projection] : projection;\n      return L.bounds(\n        M.pointToPCRSPoint(bounds.min, zoom, projection, cs),\n        M.pointToPCRSPoint(bounds.max, zoom, projection, cs)\n      );\n    },\n\n    //L.bounds have fixed point positions, where min is always topleft, max is always bottom right, and the values are always sorted by leaflet\n    //important to consider when working with pcrs where the origin is not topleft but rather bottomleft, could lead to confusion\n    pixelToPCRSBounds: function (bounds, zoom, projection) {\n      if (\n        !bounds ||\n        !bounds.max ||\n        !bounds.min ||\n        (!zoom && zoom !== 0) ||\n        !Number.isFinite(+zoom) ||\n        !projection\n      )\n        return undefined;\n      projection = typeof projection === 'string' ? M[projection] : projection;\n      return L.bounds(\n        M.pixelToPCRSPoint(bounds.min, zoom, projection),\n        M.pixelToPCRSPoint(bounds.max, zoom, projection)\n      );\n    },\n\n    //meta content is the content attribute of meta\n    // input \"max=5,min=4\" => [[max,5][min,5]]\n    _metaContentToObject: function (input) {\n      if (!input || input instanceof Object) return {};\n      let content = input.split(/\\s+/).join('');\n      let contentArray = {};\n      let stringSplit = content.split(',');\n\n      for (let i = 0; i < stringSplit.length; i++) {\n        let prop = stringSplit[i].split('=');\n        if (prop.length === 2) contentArray[prop[0]] = prop[1];\n      }\n      if (contentArray !== '' && stringSplit[0].split('=').length === 1)\n        contentArray.content = stringSplit[0];\n      return contentArray;\n    },\n\n    // _coordsToArray returns an array of arrays of coordinate pairs\n    // _coordsToArray: (\"1,2,3,4\") -> [[1,2],[3,4]]\n    _coordsToArray: function (containerPoints) {\n      for (\n        var i = 1, pairs = [], coords = containerPoints.split(',');\n        i < coords.length;\n        i += 2\n      ) {\n        pairs.push([parseInt(coords[i - 1]), parseInt(coords[i])]);\n      }\n      return pairs;\n    },\n\n    // _splitCoordinate splits string coordinates to an array as floating point numbers\n    _splitCoordinate: function (element, index, array) {\n      var a = [];\n      element.split(/\\s+/gim).forEach(M._parseNumber, a);\n      this.push(a);\n    },\n\n    // _parseNumber parses a string as a floating point number, helper function for _splitCoordinate\n    _parseNumber: function (element, index, array) {\n      this.push(parseFloat(element));\n    },\n\n    // _handleLink handles map-a links, when clicked on a map-a link\n    _handleLink: function (link, leafletLayer) {\n      let zoomTo,\n        justPan = false,\n        layer,\n        map = leafletLayer._map,\n        opacity;\n      if (link.type === 'text/html' && link.target !== '_blank') {\n        // all other target values other than blank behave as _top\n        link.target = '_top';\n      } else if (link.type !== 'text/html' && link.url.includes('#')) {\n        let hash = link.url.split('#'),\n          loc = hash[1].split(',');\n        zoomTo = { z: loc[0] || 0, lng: loc[1] || 0, lat: loc[2] || 0 };\n        justPan = !hash[0]; // if the first half of the array is an empty string then the link is just for panning\n        if (['/', '.', '#'].includes(link.url[0])) link.target = '_self';\n      }\n      if (!justPan) {\n        layer = document.createElement('layer-');\n        layer.setAttribute('src', link.url);\n        layer.setAttribute('checked', '');\n        switch (link.target) {\n          case '_blank':\n            if (link.type === 'text/html') {\n              window.open(link.url);\n            } else {\n              postTraversalSetup();\n              map.options.mapEl.appendChild(layer);\n            }\n            break;\n          case '_parent':\n            postTraversalSetup();\n            for (let l of map.options.mapEl.querySelectorAll('layer-'))\n              if (l._layer !== leafletLayer) map.options.mapEl.removeChild(l);\n            map.options.mapEl.appendChild(layer);\n            map.options.mapEl.removeChild(leafletLayer._layerEl);\n            break;\n          case '_top':\n            window.location.href = link.url;\n            break;\n          default:\n            postTraversalSetup();\n            opacity = leafletLayer._layerEl.opacity;\n            leafletLayer._layerEl.insertAdjacentElement('beforebegin', layer);\n            map.options.mapEl.removeChild(leafletLayer._layerEl);\n        }\n      } else if (zoomTo && !link.inPlace && justPan) {\n        leafletLayer._map.options.mapEl.zoomTo(\n          +zoomTo.lat,\n          +zoomTo.lng,\n          +zoomTo.z\n        );\n        if (opacity) layer.opacity = opacity;\n        map.getContainer().focus();\n      }\n\n      function postTraversalSetup() {\n        // when the projection is changed as part of the link traversal process,\n        // it's necessary to set the map viewer's lat, lon and zoom NOW, so that\n        // the promises that are created when the viewer's projection is changed\n        // can use the viewer's lat, lon and zoom properties that were in effect\n        // before the projection change i.e. in the closure for that code\n        // see mapml-viewer / map is=web-map projection attributeChangedCallback\n        // specifically required for use cases like changing projection after\n        // link traversal, e.g. BC link here https://maps4html.org/experiments/linking/features/\n        if (!link.inPlace && zoomTo) updateMapZoomTo(zoomTo);\n        // the layer is newly created, so have to wait until it's fully init'd\n        // before setting properties.\n        layer.whenReady().then(() => {\n          // if the map projection isnt' changed by link traversal, it's necessary\n          // to perform pan/zoom operations after the layer is ready\n          if (!link.inPlace && zoomTo)\n            layer.parentElement.zoomTo(+zoomTo.lat, +zoomTo.lng, +zoomTo.z);\n          else if (!link.inPlace) layer.zoomTo();\n          // not sure if this is necessary\n          if (opacity) layer.opacity = opacity;\n          // this is necessary to display the FeatureIndexOverlay, I believe\n          map.getContainer().focus();\n        });\n      }\n\n      function updateMapZoomTo(zoomTo) {\n        // can't use mapEl.zoomTo(...) here, it's too slow!\n        map.options.mapEl.lat = +zoomTo.lat;\n        map.options.mapEl.lon = +zoomTo.lng;\n        map.options.mapEl.zoom = +zoomTo.z;\n      }\n    },\n    getBoundsFromMeta: function (mapml) {\n      if (!mapml) return null;\n      let cs,\n        pseudo = mapml instanceof ShadowRoot ? ':host' : ':scope',\n        projection =\n          (mapml.querySelector(pseudo + ' > map-meta[name=projection]') &&\n            M._metaContentToObject(\n              mapml\n                .querySelector(pseudo + ' > map-meta[name=projection]')\n                .getAttribute('content')\n            ).content.toUpperCase()) ||\n          M.FALLBACK_PROJECTION;\n      try {\n        let meta =\n          mapml.querySelector(pseudo + ' > map-meta[name=extent]') &&\n          M._metaContentToObject(\n            mapml\n              .querySelector(pseudo + ' > map-meta[name=extent]')\n              .getAttribute('content')\n          );\n\n        let zoom = meta.zoom;\n\n        let metaKeys = Object.keys(meta);\n        for (let i = 0; i < metaKeys.length; i++) {\n          if (!metaKeys[i].includes('zoom')) {\n            cs = M.axisToCS(metaKeys[i].split('-')[2]);\n            break;\n          }\n        }\n        // this could happen if the content didn't match the grammar for map-meta[name=extent]\n        if (cs === undefined) throw new Error('cs undefined when getting bounds');\n\n        // when cs is tilematrix, tcrs or tile, zoom is required.\n        // should throw / return null instead of trying to construct a bounds\n\n        if (\n          zoom === undefined &&\n          (cs === 'TILEMATRIX' || cs === 'TCRS' || cs === 'TILE')\n        )\n          throw new Error(\n            'map-meta[name=extent] zoom= parameter not provided for tcrs,tile or tilematrix bounds'\n          );\n        let axes = M.csToAxes(cs);\n        return M.boundsToPCRSBounds(\n          L.bounds(\n            L.point(+meta[`top-left-${axes[0]}`], +meta[`top-left-${axes[1]}`]),\n            L.point(\n              +meta[`bottom-right-${axes[0]}`],\n              +meta[`bottom-right-${axes[1]}`]\n            )\n          ),\n          zoom,\n          projection,\n          cs\n        );\n      } catch (error) {\n        //if error then by default set the layer to osm and bounds to the entire map view\n        return M.boundsToPCRSBounds(\n          M[projection].options.crs.tilematrix.bounds(0),\n          0,\n          projection,\n          cs\n        );\n      }\n    },\n    /**\n     * TODO Review and improve design logic with Aliyan\n     *\n     * Parses object from <map-meta name=\"zoom\" content=\"...\">\n     * @param {type} mapml\n     * @returns {minZoom, maxZoom, minNativeZoom, maxNativeZoom}\n     */\n    getZoomBoundsFromMeta: function (mapml) {\n      if (!mapml) return null;\n      let pseudo = mapml instanceof ShadowRoot ? ':host' : ':scope';\n\n      let meta = M._metaContentToObject(\n        mapml\n          .querySelector(pseudo + '> map-meta[name=zoom]')\n          .getAttribute('content')\n      );\n      if (meta.min && meta.max && meta.value)\n        return {\n          minZoom: +meta.min,\n          maxZoom: +meta.max,\n          minNativeZoom: +meta.value,\n          maxNativeZoom: +meta.value\n        };\n      else if (meta.min && meta.max)\n        return {\n          minZoom: +meta.min,\n          maxZoom: +meta.max\n        };\n      else if (meta.min)\n        return {\n          minZoom: +meta.min\n        };\n      else if (meta.max)\n        return {\n          maxZoom: +meta.max\n        };\n    },\n    getZoomBounds: function (mapml, nativeZoom) {\n      if (!mapml) return null;\n      let nMin = 100,\n        nMax = 0,\n        features = mapml.querySelectorAll('map-feature'),\n        meta,\n        projection;\n      for (let i = 0; i < features.length; i++) {\n        let lZoom = +features[i].getAttribute('zoom');\n        if (!features[i].getAttribute('zoom')) lZoom = nativeZoom;\n        nMax = Math.max(nMax, lZoom);\n        nMin = Math.min(nMin, lZoom);\n      }\n      try {\n        projection = M._metaContentToObject(\n          mapml.querySelector('map-meta[name=projection]').getAttribute('content')\n        ).content;\n        meta = M._metaContentToObject(\n          mapml.querySelector('map-meta[name=zoom]').getAttribute('content')\n        );\n      } catch (error) {\n        return {\n          minZoom: 0,\n          maxZoom:\n            M[projection || M.FALLBACK_PROJECTION].options.resolutions.length - 1,\n          minNativeZoom: nMin,\n          maxNativeZoom: nMax\n        };\n      }\n      return {\n        minZoom: +meta.min,\n        maxZoom: +meta.max,\n        minNativeZoom: nMin,\n        maxNativeZoom: nMax\n      };\n    },\n    // getNativeVariables: returns an object with the native zoom and CS,\n    //                     based on the map-metas that are available within\n    //                     the layer or the fallback default values.\n    // getNativeVariables: mapml-||layer-||null||[map-feature,...] -> {zoom: _, val: _}\n    // mapml can be a mapml- element, layer- element, null, or an array of map-features\n    getNativeVariables: function (mapml) {\n      let nativeZoom, nativeCS;\n      // when mapml is an array of features provided by the query\n      if (\n        mapml.length &&\n        mapml[0].parentElement.parentElement &&\n        mapml[0].parentElement.parentElement.tagName === 'mapml-'\n      ) {\n        let mapmlEl = mapml[0].parentElement.parentElement;\n        nativeZoom =\n          (mapmlEl.querySelector &&\n            mapmlEl.querySelector('map-meta[name=zoom]') &&\n            +M._metaContentToObject(\n              mapmlEl.querySelector('map-meta[name=zoom]').getAttribute('content')\n            ).value) ||\n          0;\n        nativeCS =\n          (mapmlEl.querySelector &&\n            mapmlEl.querySelector('map-meta[name=cs]') &&\n            M._metaContentToObject(\n              mapmlEl.querySelector('map-meta[name=cs]').getAttribute('content')\n            ).content) ||\n          'GCRS';\n      } else {\n        // when mapml is null or a layer-/mapml- element\n        nativeZoom =\n          (mapml.querySelector &&\n            mapml.querySelector('map-meta[name=zoom]') &&\n            +M._metaContentToObject(\n              mapml.querySelector('map-meta[name=zoom]').getAttribute('content')\n            ).value) ||\n          0;\n        nativeCS =\n          (mapml.querySelector &&\n            mapml.querySelector('map-meta[name=cs]') &&\n            M._metaContentToObject(\n              mapml.querySelector('map-meta[name=cs]').getAttribute('content')\n            ).content) ||\n          'GCRS';\n      }\n      return { zoom: nativeZoom, cs: nativeCS };\n    },\n\n    // _gcrsToTileMatrix returns the [column, row] of the tiles at map center. Used for Announce movement for screen readers\n    // _gcrsToTileMatrix: map/mapml-viewer -> [column, row]\n    _gcrsToTileMatrix: function (mapEl) {\n      let point = mapEl._map.project(mapEl._map.getCenter());\n      let tileSize = mapEl._map.options.crs.options.crs.tile.bounds.max.y;\n      let column = Math.trunc(point.x / tileSize);\n      let row = Math.trunc(point.y / tileSize);\n      return [column, row];\n    },\n\n    // Pastes text to a mapml-viewer/map element(mapEl), text can be a mapml link, geojson, or a layer-\n    //    used for pasting layers through ctrl+v, drag/drop, and pasting through the contextmenu\n    // _pasteLayer: HTMLElement Str -> None\n    // Effects: append a layer- element to mapEl, if it is valid\n    _pasteLayer: function (mapEl, text) {\n      try {\n        new URL(text);\n        // create a new <layer-> child of the <mapml-viewer> element\n        let l =\n          '<layer- src=\"' +\n          text +\n          '\" label=\"' +\n          M.options.locale.dfLayer +\n          '\" checked=\"\"></layer->';\n        mapEl.insertAdjacentHTML('beforeend', l);\n        mapEl.lastElementChild.whenReady().catch(() => {\n          if (mapEl) {\n            // should invoke lifecyle callbacks automatically by removing it from DOM\n            mapEl.removeChild(mapEl.lastChild);\n          }\n          // garbage collect it\n          l = null;\n        });\n      } catch (err) {\n        text = text\n          .replace(/(<!--.*?-->)|(<!--[\\S\\s]+?-->)|(<!--[\\S\\s]*?$)/g, '')\n          .trim();\n        if (text.slice(0, 7) === '<layer-' && text.slice(-9) === '</layer->') {\n          mapEl.insertAdjacentHTML('beforeend', text);\n        } else if (\n          text.slice(0, 12) === '<map-feature' &&\n          text.slice(-14) === '</map-feature>'\n        ) {\n          let layer =\n            `<layer- label=\"${M.options.locale.dfPastedLayer}\" checked>\n                       <map-meta name='projection' content='${mapEl.projection}'></map-meta>` +\n            text +\n            '</layer->';\n          mapEl.insertAdjacentHTML('beforeend', layer);\n        } else {\n          try {\n            mapEl.geojson2mapml(JSON.parse(text));\n          } catch {\n            console.log('Invalid Input!');\n          }\n        }\n      }\n    },\n\n    // Takes GeoJSON Properties to return an HTML table, helper function\n    //    for geojson2mapml\n    // _properties2Table: geojsonPropertiesOBJ -> HTML Table\n    _properties2Table: function (json) {\n      let table = document.createElement('table');\n\n      // Creating a Table Header\n      let thead = table.createTHead();\n      let row = thead.insertRow();\n      let th1 = document.createElement('th');\n      let th2 = document.createElement('th');\n      th1.appendChild(document.createTextNode('Property name'));\n      th2.appendChild(document.createTextNode('Property value'));\n      th1.setAttribute('role', 'columnheader');\n      th2.setAttribute('role', 'columnheader');\n      th1.setAttribute('scope', 'col');\n      th2.setAttribute('scope', 'col');\n      row.appendChild(th1);\n      row.appendChild(th2);\n\n      // Creating table body and populating it from the JSON\n      let tbody = table.createTBody();\n      for (let key in json) {\n        if (json.hasOwnProperty(key)) {\n          let row = tbody.insertRow();\n          let th = document.createElement('th');\n          let td = document.createElement('td');\n          th.appendChild(document.createTextNode(key));\n          td.appendChild(document.createTextNode(json[key]));\n          th.setAttribute('scope', 'row');\n          td.setAttribute('itemprop', key);\n          row.appendChild(th);\n          row.appendChild(td);\n        }\n      }\n      return table;\n    },\n\n    // Takes bbox array and a x,y coordinate to possibly update the extent, returns extent\n    //    for geojson2mapml\n    // _updateExtent: [min x, min y, max x, max y], x, y -> [min x, min y, max x, max y]\n    _updateExtent: function (bboxExtent, x, y) {\n      if (bboxExtent === {}) {\n        return bboxExtent;\n      }\n      bboxExtent[0] = Math.min(x, bboxExtent[0]);\n      bboxExtent[1] = Math.min(y, bboxExtent[1]);\n      bboxExtent[2] = Math.max(x, bboxExtent[2]);\n      bboxExtent[3] = Math.max(y, bboxExtent[3]);\n      return bboxExtent;\n    },\n\n    // Takes a GeoJSON geojson and an options Object which returns a <layer-> Element\n    // The options object can contain the following:\n    //      label            - String, contains the layer name, if included overrides the default label mapping\n    //      projection       - String, contains the projection of the layer (OSMTILE, WGS84, CBMTILE, APSTILE), defaults to   OSMTILE\n    //      caption          - Function | String, function accepts one argument being the feature object which produces the   featurecaption string OR a string that is the name of the property that will be mapped to featurecaption\n    //      properties       - Function | String | HTMLElement, a function which maps the geojson feature to an HTMLElement   or a string that will be parsed as an HTMLElement or an HTMLElement\n    //      geometryFunction - Function, A function you supply that can add classes, hyperlinks and spans to the created  <map-geometry> element, default would be the plain map-geometry element\n    // geojson2mapml: geojson Object <layer-> [min x, min y, max x, max y] -> <layer->\n    geojson2mapml: function (json, options = {}, layer = null, bboxExtent = {}) {\n      let defaults = {\n        label: null,\n        projection: 'OSMTILE',\n        caption: null,\n        properties: null,\n        geometryFunction: null\n      };\n      // assign default values for undefined options\n      options = Object.assign({}, defaults, options);\n\n      // If string json is received\n      if (typeof json === 'string') {\n        json = JSON.parse(json);\n      }\n      let geometryType = [\n        'POINT',\n        'LINESTRING',\n        'POLYGON',\n        'MULTIPOINT',\n        'MULTILINESTRING',\n        'MULTIPOLYGON',\n        'GEOMETRYCOLLECTION'\n      ];\n      let jsonType = json.type.toUpperCase();\n      let out = '';\n      let setExtent = false;\n\n      // HTML parser\n      let parser = new DOMParser();\n\n      // initializing layer\n      if (layer === null) {\n        if (!json.bbox) {\n          setExtent = true;\n        }\n        // creating an empty mapml layer\n        let xmlStringLayer =\n          \"<layer- label='' checked><map-meta name='projection' content='\" +\n          options.projection +\n          \"'></map-meta><map-meta name='cs' content='gcrs'></map-meta></layer->\";\n        layer = parser.parseFromString(xmlStringLayer, 'text/html');\n        //console.log(layer)\n        if (options.label !== null) {\n          layer.querySelector('layer-').setAttribute('label', options.label);\n        } else if (json.name) {\n          layer.querySelector('layer-').setAttribute('label', json.name);\n        } else if (json.title) {\n          layer.querySelector('layer-').setAttribute('label', json.title);\n        } else {\n          layer\n            .querySelector('layer-')\n            .setAttribute('label', M.options.locale.dfLayer);\n        }\n      }\n      let point = '<map-point></map-point>';\n      point = parser.parseFromString(point, 'text/html');\n\n      let multiPoint =\n        '<map-multipoint><map-coordinates></map-coordinates></map-multipoint>';\n      multiPoint = parser.parseFromString(multiPoint, 'text/html');\n\n      let linestring =\n        '<map-linestring><map-coordinates></map-coordinates></map-linestring>';\n      linestring = parser.parseFromString(linestring, 'text/html');\n\n      let multilinestring = '<map-multilinestring></map-multilinestring>';\n      multilinestring = parser.parseFromString(multilinestring, 'text/html');\n\n      let polygon = '<map-polygon></map-polygon>';\n      polygon = parser.parseFromString(polygon, 'text/html');\n\n      let multiPolygon = '<map-multipolygon></map-multipolygon>';\n      multiPolygon = parser.parseFromString(multiPolygon, 'text/html');\n\n      let geometrycollection =\n        '<map-geometrycollection></map-geometrycollection>';\n      geometrycollection = parser.parseFromString(\n        geometrycollection,\n        'text/html'\n      );\n\n      let feature =\n        '<map-feature><map-featurecaption></map-featurecaption><map-geometry></map-geometry><map-properties></map-properties></map-feature>';\n      feature = parser.parseFromString(feature, 'text/html');\n\n      // Template to add coordinates to Geometries\n      let coords = '<map-coordinates></map-coordinates>';\n      coords = parser.parseFromString(coords, 'text/html');\n\n      //console.log(layer);\n      if (jsonType === 'FEATURECOLLECTION') {\n        // Setting bbox if it exists\n        if (json.bbox) {\n          layer\n            .querySelector('layer-')\n            .insertAdjacentHTML(\n              'afterbegin',\n              \"<map-meta name='extent' content='top-left-longitude=\" +\n                json.bbox[0] +\n                ', top-left-latitude=' +\n                json.bbox[1] +\n                ', bottom-right-longitude=' +\n                json.bbox[2] +\n                ',bottom-right-latitude=' +\n                json.bbox[3] +\n                \"'></map-meta>\"\n            );\n        } else {\n          bboxExtent = [\n            Infinity,\n            Infinity,\n            Number.NEGATIVE_INFINITY,\n            Number.NEGATIVE_INFINITY\n          ];\n        }\n\n        let features = json.features;\n        //console.log(\"Features length - \" + features.length);\n        for (let l = 0; l < features.length; l++) {\n          M.geojson2mapml(features[l], options, layer, bboxExtent);\n        }\n      } else if (jsonType === 'FEATURE') {\n        let clone_feature = feature.cloneNode(true);\n        let curr_feature = clone_feature.querySelector('map-feature');\n\n        // Setting bbox if it exists\n        if (json.bbox) {\n          layer\n            .querySelector('layer-')\n            .insertAdjacentHTML(\n              'afterbegin',\n              \"<map-meta name='extent' content='top-left-longitude=\" +\n                json.bbox[0] +\n                ', top-left-latitude=' +\n                json.bbox[1] +\n                ', bottom-right-longitude=' +\n                json.bbox[2] +\n                ',bottom-right-latitude=' +\n                json.bbox[3] +\n                \"'></map-meta>\"\n            );\n        } else if (\n          typeof bboxExtent === 'object' &&\n          bboxExtent.length === undefined\n        ) {\n          bboxExtent = [\n            Infinity,\n            Infinity,\n            Number.NEGATIVE_INFINITY,\n            Number.NEGATIVE_INFINITY\n          ];\n        }\n\n        // Setting featurecaption\n        let featureCaption = layer.querySelector('layer-').getAttribute('label');\n        if (typeof options.caption === 'function') {\n          featureCaption = options.caption(json);\n        } else if (typeof options.caption === 'string') {\n          featureCaption = json.properties[options.caption];\n          // if property does not exist\n          if (featureCaption === undefined) {\n            featureCaption = options.caption;\n          }\n        } else if (json.id) {\n          // when no caption option available try setting id as featurecaption\n          featureCaption = json.id;\n        }\n        curr_feature.querySelector('map-featurecaption').innerHTML =\n          featureCaption;\n\n        // Setting Properties\n        let p;\n        // if properties function is passed\n        if (typeof options.properties === 'function') {\n          p = options.properties(json);\n          // if function output is not an element, ignore the properties.\n          if (!(p instanceof Element)) {\n            p = false;\n            console.error(\n              'options.properties function returns a string instead of an HTMLElement.'\n            );\n          }\n        } else if (typeof options.properties === 'string') {\n          // if properties string is passed\n          curr_feature\n            .querySelector('map-properties')\n            .insertAdjacentHTML('beforeend', options.properties);\n          p = false;\n        } else if (options.properties instanceof HTMLElement) {\n          // if an HTMLElement is passed - NOT TESTED\n          p = options.properties;\n        } else {\n          // If no properties function, string or HTMLElement is passed\n          p = M._properties2Table(json.properties);\n        }\n\n        if (p) {\n          curr_feature.querySelector('map-properties').appendChild(p);\n        }\n\n        // Setting map-geometry\n        let g = M.geojson2mapml(json.geometry, options, layer, bboxExtent);\n        if (typeof options.geometryFunction === 'function') {\n          curr_feature\n            .querySelector('map-geometry')\n            .appendChild(options.geometryFunction(g, json));\n        } else {\n          curr_feature.querySelector('map-geometry').appendChild(g);\n        }\n\n        // Appending feature to layer\n        layer.querySelector('layer-').appendChild(curr_feature);\n      } else if (geometryType.includes(jsonType)) {\n        //console.log(\"Geometry Type - \" + jsonType);\n        switch (jsonType) {\n          case 'POINT':\n            bboxExtent = M._updateExtent(\n              bboxExtent,\n              json.coordinates[0],\n              json.coordinates[1]\n            );\n            out = json.coordinates[0] + ' ' + json.coordinates[1];\n\n            // Create Point element\n            let clone_point = point.cloneNode(true);\n            clone_point = clone_point.querySelector('map-point');\n\n            // Create map-coords to add to the polygon\n            let clone_coords = coords.cloneNode(true);\n            clone_coords = clone_coords.querySelector('map-coordinates');\n\n            clone_coords.innerHTML = out;\n\n            clone_point.appendChild(clone_coords);\n            //console.log(clone_point);\n            return clone_point;\n\n          case 'LINESTRING':\n            let clone_linestring = linestring.cloneNode(true);\n            let linestring_coordindates =\n              clone_linestring.querySelector('map-coordinates');\n\n            out = '';\n\n            for (let x = 0; x < json.coordinates.length; x++) {\n              bboxExtent = M._updateExtent(\n                bboxExtent,\n                json.coordinates[x][0],\n                json.coordinates[x][1]\n              );\n              out =\n                out + json.coordinates[x][0] + ' ' + json.coordinates[x][1] + ' ';\n            }\n\n            linestring_coordindates.innerHTML = out;\n            //console.log(clone_linestring.querySelector('map-linestring'));\n            return clone_linestring.querySelector('map-linestring');\n\n          case 'POLYGON':\n            let clone_polygon = polygon.cloneNode(true);\n            clone_polygon = clone_polygon.querySelector('map-polygon');\n\n            // Going over each coordinates\n            for (let y = 0; y < json.coordinates.length; y++) {\n              let out = '';\n              let clone_coords = coords.cloneNode(true);\n              clone_coords = clone_coords.querySelector('map-coordinates');\n\n              // Going over coordinates for the polygon\n              for (let x = 0; x < json.coordinates[y].length; x++) {\n                bboxExtent = M._updateExtent(\n                  bboxExtent,\n                  json.coordinates[y][x][0],\n                  json.coordinates[y][x][1]\n                );\n                out =\n                  out +\n                  json.coordinates[y][x][0] +\n                  ' ' +\n                  json.coordinates[y][x][1] +\n                  ' ';\n              }\n\n              // Create map-coordinates element and append it to clone_polygon\n              clone_coords.innerHTML = out;\n\n              clone_polygon.appendChild(clone_coords);\n            }\n            //console.log(clone_polygon);\n            return clone_polygon;\n\n          case 'MULTIPOINT':\n            out = '';\n            // Create multipoint element\n            let clone_multipoint = multiPoint.cloneNode(true);\n            clone_multipoint = clone_multipoint.querySelector('map-multipoint');\n\n            for (let i = 0; i < json.coordinates.length; i++) {\n              bboxExtent = M._updateExtent(\n                bboxExtent,\n                json.coordinates[i][0],\n                json.coordinates[i][1]\n              );\n              out =\n                out + json.coordinates[i][0] + ' ' + json.coordinates[i][1] + ' ';\n            }\n            clone_multipoint.querySelector('map-coordinates').innerHTML = out;\n            return clone_multipoint;\n\n          case 'MULTILINESTRING':\n            let clone_multilinestring = multilinestring.cloneNode(true);\n            clone_multilinestring = clone_multilinestring.querySelector(\n              'map-multilinestring'\n            );\n\n            for (let i = 0; i < json.coordinates.length; i++) {\n              let out = '';\n              let clone_coords = coords.cloneNode(true);\n              clone_coords = clone_coords.querySelector('map-coordinates');\n              for (let y = 0; y < json.coordinates[i].length; y++) {\n                bboxExtent = M._updateExtent(\n                  bboxExtent,\n                  json.coordinates[i][y][0],\n                  json.coordinates[i][y][1]\n                );\n                out =\n                  out +\n                  json.coordinates[i][y][0] +\n                  ' ' +\n                  json.coordinates[i][y][1] +\n                  ' ';\n              }\n              clone_coords.innerHTML = out;\n              clone_multilinestring.appendChild(clone_coords);\n            }\n            return clone_multilinestring;\n\n          case 'MULTIPOLYGON':\n            let m = multiPolygon.cloneNode(true);\n            m = m.querySelector('map-multiPolygon');\n\n            // Going over each Polygon\n            for (let i = 0; i < json.coordinates.length; i++) {\n              let clone_polygon = polygon.cloneNode(true);\n              clone_polygon = clone_polygon.querySelector('map-polygon');\n\n              // Going over each coordinates\n              for (let y = 0; y < json.coordinates[i].length; y++) {\n                let out = '';\n                let clone_coords = coords.cloneNode(true);\n                clone_coords = clone_coords.querySelector('map-coordinates');\n\n                // Going over coordinates for the polygon\n                for (let x = 0; x < json.coordinates[i][y].length; x++) {\n                  bboxExtent = M._updateExtent(\n                    bboxExtent,\n                    json.coordinates[i][y][x][0],\n                    json.coordinates[i][y][x][1]\n                  );\n                  out =\n                    out +\n                    json.coordinates[i][y][x][0] +\n                    ' ' +\n                    json.coordinates[i][y][x][1] +\n                    ' ';\n                }\n\n                // Create map-coordinates element and append it to clone_polygon\n                clone_coords.innerHTML = out;\n\n                clone_polygon.appendChild(clone_coords);\n              }\n              m.appendChild(clone_polygon);\n            }\n            return m;\n          case 'GEOMETRYCOLLECTION': // ---------------------------------------------------------------------------\n            let g = geometrycollection.cloneNode(true);\n            g = g.querySelector('map-geometrycollection');\n            //console.log(json.geometries);\n            for (let i = 0; i < json.geometries.length; i++) {\n              let fg = M.geojson2mapml(\n                json.geometries[i],\n                options,\n                layer,\n                bboxExtent\n              );\n              g.appendChild(fg);\n            }\n            return g;\n        }\n      }\n      //Add default bbox\n      if (setExtent) {\n        layer\n          .querySelector('layer-')\n          .insertAdjacentHTML(\n            'afterbegin',\n            \"<map-meta name='extent' content='top-left-longitude=\" +\n              bboxExtent[0] +\n              ', top-left-latitude=' +\n              bboxExtent[1] +\n              ', bottom-right-longitude=' +\n              bboxExtent[2] +\n              ',bottom-right-latitude=' +\n              bboxExtent[3] +\n              \"'></map-meta>\"\n          );\n      }\n      return layer.querySelector('layer-');\n    },\n\n    // Takes an array of length n to return an array of arrays with length 2, helper function\n    //    for mapml2geojson\n    // _breakArray: arr(float) -> arr(arr(float, float))\n    _breakArray: function (arr) {\n      let size = 2;\n      let arrayOfArrays = [];\n      // removing anything other than numbers, ., - (used to remove <map-span> tags)\n      arr = arr.filter((x) => !/[^\\d.-]/g.test(x)).filter((x) => x);\n      for (let i = 0; i < arr.length; i += size) {\n        arrayOfArrays.push(arr.slice(i, i + size).map(Number));\n      }\n      return arrayOfArrays;\n    },\n\n    // Takes an HTML Table to return geojson properties, helper function\n    //    for mapml2geojson\n    // _table2properties: HTML Table -> geojson\n    _table2properties: function (table) {\n      // removing thead, if it exists\n      let head = table.querySelector('thead');\n      if (head !== null) {\n        table.querySelector('thead').remove();\n      }\n      let json = {};\n      table.querySelectorAll('tr').forEach((tr) => {\n        let tableData = tr.querySelectorAll('th, td');\n        json[tableData[0].innerHTML] = tableData[1].innerHTML;\n      });\n      return json;\n    },\n\n    // Converts a geometry element (el) to geojson, helper function\n    //    for mapml2geojson, NOTE - el can not be a map-geometrycollection\n    // _geometry2geojson: (child of <map-geometry>), Proj4, Proj4, Bool -> geojson\n    _geometry2geojson: function (el, source, dest, transform) {\n      // remove map-a, map-span elements if the geometry is wrapped in them\n      while (\n        el.nodeName.toUpperCase() === 'MAP-SPAN' ||\n        el.nodeName.toUpperCase() === 'MAP-A'\n      ) {\n        el = el.firstElementChild;\n      }\n      let elem = el.nodeName;\n      let j = {};\n      let coord;\n\n      switch (elem.toUpperCase()) {\n        case 'MAP-POINT':\n          j.type = 'Point';\n          if (transform) {\n            let pointConv = proj4.transform(\n              source,\n              dest,\n              el\n                .querySelector('map-coordinates')\n                .innerHTML.split(/[<>\\ ]/g)\n                .map(Number)\n            );\n            j.coordinates = [pointConv.x, pointConv.y];\n          } else {\n            j.coordinates = el\n              .querySelector('map-coordinates')\n              .innerHTML.split(/[<>\\ ]/g)\n              .map(Number);\n          }\n          break;\n        case 'MAP-LINESTRING':\n          j.type = 'LineString';\n          coord = el.querySelector('map-coordinates').innerHTML.split(/[<>\\ ]/g);\n          coord = M._breakArray(coord);\n          if (transform) {\n            coord = M._pcrsToGcrs(coord, source, dest);\n          }\n          j.coordinates = coord;\n          break;\n        case 'MAP-POLYGON':\n          j.type = 'Polygon';\n          j.coordinates = [];\n          let x = 0;\n          el.querySelectorAll('map-coordinates').forEach((coord) => {\n            coord = coord.innerHTML.split(/[<>\\ ]/g);\n            coord = M._breakArray(coord);\n            if (transform) {\n              coord = M._pcrsToGcrs(coord, source, dest);\n            }\n            j.coordinates[x] = coord;\n            x++;\n          });\n          break;\n        case 'MAP-MULTIPOINT':\n          j.type = 'MultiPoint';\n          coord = M._breakArray(\n            el.querySelector('map-coordinates').innerHTML.split(/[<>\\ ]/g)\n          );\n          if (transform) {\n            coord = M._pcrsToGcrs(coord, source, dest);\n          }\n          j.coordinates = coord;\n          break;\n        case 'MAP-MULTILINESTRING':\n          j.type = 'MultiLineString';\n          j.coordinates = [];\n          let i = 0;\n          el.querySelectorAll('map-coordinates').forEach((coord) => {\n            coord = coord.innerHTML.split(/[<>\\ ]/g);\n            coord = M._breakArray(coord);\n            if (transform) {\n              coord = M._pcrsToGcrs(coord, source, dest);\n            }\n            j.coordinates[i] = coord;\n            i++;\n          });\n          break;\n        case 'MAP-MULTIPOLYGON':\n          j.type = 'MultiPolygon';\n          j.coordinates = [];\n          let p = 0;\n          el.querySelectorAll('map-polygon').forEach((poly) => {\n            let y = 0;\n            j.coordinates.push([]);\n            poly.querySelectorAll('map-coordinates').forEach((coord) => {\n              coord = coord.innerHTML.split(/[<>\\ ]/g);\n              coord = M._breakArray(coord);\n              if (transform) {\n                coord = M._pcrsToGcrs(coord, source, dest);\n              }\n              j.coordinates[p].push([]);\n              j.coordinates[p][y] = coord;\n              y++;\n            });\n            p++;\n          });\n          break;\n      }\n      return j;\n    },\n\n    // _pcrsToGcrs: arrof([x,y]) Proj4, Proj4 -> arrof[x,y]\n    _pcrsToGcrs: function (arr, source, dest) {\n      let newArr = [];\n      for (let i = 0; i < arr.length; i++) {\n        let conv = proj4.transform(source, dest, arr[i]);\n        conv = [conv.x, conv.y];\n        newArr.push(conv);\n      }\n      return newArr;\n    },\n\n    // Takes an <layer-> element and returns a geojson feature collection object\n    // The options object can contain the following:\n    //      propertyFunction   - function(<map-properties>), A function that maps the features' <map-properties> element to   a GeoJSON \"properties\" member.\n    //      transform          - Bool, Transform coordinates to gcrs values, defaults to True\n    // mapml2geojson: <layer-> Object -> GeoJSON\n    mapml2geojson: function (element, options = {}) {\n      let defaults = {\n        propertyFunction: null,\n        transform: true\n      };\n      // assign default values for undefined options\n      options = Object.assign({}, defaults, options);\n\n      let json = {};\n      json.type = 'FeatureCollection';\n      json.title = element.getAttribute('label');\n      json.features = [];\n\n      // Transforming Coordinates to gcrs if transformation = true and coordinate is not (EPSG:3857 or EPSG:4326)\n      let source = null;\n      let dest = null;\n      if (options.transform) {\n        source = new proj4.Proj(element.parentElement._map.options.crs.code);\n        dest = new proj4.Proj('EPSG:4326');\n        if (\n          element.parentElement._map.options.crs.code === 'EPSG:3857' ||\n          element.parentElement._map.options.crs.code === 'EPSG:4326'\n        ) {\n          options.transform = false;\n        }\n      }\n\n      // Setting all meta settings, if any\n      let metas = element.querySelectorAll('map-meta');\n      metas.forEach((meta) => {\n        let name = meta.getAttribute('name');\n        if (name === 'extent') {\n          let content = meta.getAttribute('content');\n          let arr = content.split(',');\n          let ex = {};\n          for (let i = 0; i < arr.length; i++) {\n            let s = arr[i].split('=');\n            s[0] = s[0].trim(); // removing whitespace\n            s[1] = parseFloat(s[1]);\n            ex[s[0]] = s[1];\n          }\n          json.bbox = [\n            ex['top-left-longitude'],\n            ex['top-left-latitude'],\n            ex['bottom-right-longitude'],\n            ex['bottom-right-latitude']\n          ];\n        }\n      });\n\n      // Iterating over each feature\n      let features = element.querySelectorAll('map-feature');\n      let num = 0;\n\n      // Going over each feature in the layer\n      features.forEach((feature) => {\n        //console.log(feature);\n\n        json.features[num] = { type: 'Feature' };\n        json.features[num].geometry = {};\n        json.features[num].properties = {};\n\n        // setting properties when function presented\n        if (!feature.querySelector('map-properties')) {\n          json.features[num].properties = null;\n        } else if (typeof options.propertyFunction === 'function') {\n          let properties = options.propertyFunction(\n            feature.querySelector('map-properties')\n          );\n          json.features[num].properties = properties;\n        } else if (\n          feature.querySelector('map-properties').querySelector('table') !== null\n        ) {\n          // setting properties when table presented\n          let table = feature\n              .querySelector('map-properties')\n              .querySelector('table')\n              .cloneNode(true),\n            properties = M._table2properties(table);\n          json.features[num].properties = properties;\n        } else {\n          // when no table present, strip any possible html tags to only get text\n          json.features[num].properties = {\n            prop0: feature\n              .querySelector('map-properties')\n              .innerHTML.replace(/(<([^>]+)>)/gi, '')\n          };\n        }\n\n        let geom = feature.querySelector('map-geometry').firstElementChild;\n\n        // remove map-a, map-span elements if the geometry is wrapped in them\n        while (\n          geom.nodeName.toUpperCase() === 'MAP-SPAN' ||\n          geom.nodeName.toUpperCase() === 'MAP-A'\n        ) {\n          geom = geom.firstElementChild;\n        }\n\n        // Adding Geometry\n        if (geom.nodeName.toUpperCase() !== 'MAP-GEOMETRYCOLLECTION') {\n          json.features[num].geometry = M._geometry2geojson(\n            geom,\n            source,\n            dest,\n            options.transform\n          );\n        } else {\n          json.features[num].geometry.type = 'GeometryCollection';\n          json.features[num].geometry.geometries = [];\n\n          let geoms = geom.children;\n          Array.from(geoms).forEach((g) => {\n            // omit all map-span, map-a that may be present in geometry-collection\n            let n = g.nodeName.toUpperCase();\n            if (n === 'MAP-SPAN' || n === 'MAP-A') {\n              g = g.cloneNode(true);\n              [...g.querySelectorAll('map-a, map-span')].forEach((e) =>\n                e.replaceWith(...e.children)\n              );\n              Array.from(g.children).forEach((i) => {\n                i = M._geometry2geojson(i, source, dest, options.transform);\n                json.features[num].geometry.geometries.push(i);\n              });\n            } else {\n              g = M._geometry2geojson(g, source, dest, options.transform);\n              json.features[num].geometry.geometries.push(g);\n            }\n          });\n        }\n        //going to next feature\n        num++;\n      });\n\n      return json;\n    },\n\n    // Takes leaflet bound, leaflet map and min and max zoom limit,\n    // return the maximum zoom level that can show the bound completely\n    // getMaxZoom: L.Bound, L.Map, Number, Number -> Number\n    getMaxZoom: function (bound, map, minZoom, maxZoom) {\n      if (!bound) return;\n\n      let newZoom = map.getZoom(),\n        scale = map.options.crs.scale(newZoom),\n        mapCenterTCRS = map.options.crs.transformation.transform(\n          bound.getCenter(true),\n          scale\n        );\n\n      let mapHalf = map.getSize().divideBy(2),\n        mapTlNew = mapCenterTCRS.subtract(mapHalf).round(),\n        mapBrNew = mapCenterTCRS.add(mapHalf).round();\n\n      let mapTlPCRSNew = M.pixelToPCRSPoint(\n          mapTlNew,\n          newZoom,\n          map.options.projection\n        ),\n        mapBrPCRSNew = M.pixelToPCRSPoint(\n          mapBrNew,\n          newZoom,\n          map.options.projection\n        );\n\n      let mapPCRS = L.bounds(mapTlPCRSNew, mapBrPCRSNew),\n        zOffset = mapPCRS.contains(bound) ? 1 : -1;\n\n      while (\n        (zOffset === -1 && !mapPCRS.contains(bound) && newZoom - 1 >= minZoom) ||\n        (zOffset === 1 && mapPCRS.contains(bound) && newZoom + 1 <= maxZoom)\n      ) {\n        newZoom += zOffset;\n        scale = map.options.crs.scale(newZoom);\n        mapCenterTCRS = map.options.crs.transformation.transform(\n          bound.getCenter(true),\n          scale\n        );\n\n        mapTlNew = mapCenterTCRS.subtract(mapHalf).round();\n        mapBrNew = mapCenterTCRS.add(mapHalf).round();\n        mapTlPCRSNew = M.pixelToPCRSPoint(\n          mapTlNew,\n          newZoom,\n          map.options.projection\n        );\n        mapBrPCRSNew = M.pixelToPCRSPoint(\n          mapBrNew,\n          newZoom,\n          map.options.projection\n        );\n\n        mapPCRS = L.bounds(mapTlPCRSNew, mapBrPCRSNew);\n      }\n\n      if (\n        zOffset === 1 &&\n        newZoom - 1 >= 0 &&\n        !(newZoom === maxZoom && mapPCRS.contains(bound))\n      )\n        newZoom--;\n      return newZoom;\n    },\n    getClosest(node, selector) {\n      if (!node) {\n        return null;\n      }\n      if (node instanceof ShadowRoot) {\n        return M.getClosest(node.host, selector);\n      }\n\n      if (node instanceof HTMLElement) {\n        if (node.matches(selector)) {\n          return node;\n        } else {\n          return M.getClosest(node.parentNode, selector);\n        }\n      }\n\n      return M.getClosest(node.parentNode, selector);\n    }\n  };\n\n  var AttributionButton = L.Control.Attribution.extend({\n    options: {\n      prefix:\n        '<img src=\"https://www.w3.org/community/src/templates/wordpress/StoryTeller/favicon.ico\" style=\"position: relative; top: 5px\" alt=\"W3C Community and Business Groups logo\"> <a href=\"https://www.w3.org/community/maps4html/\">Maps for HTML Community Group</a> | <img src=\"data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTIiIGhlaWdodD0iOCI+PHBhdGggZmlsbD0iIzRDN0JFMSIgZD0iTTAgMGgxMnY0SDB6Ii8+PHBhdGggZmlsbD0iI0ZGRDUwMCIgZD0iTTAgNGgxMnYzSDB6Ii8+PHBhdGggZmlsbD0iI0UwQkMwMCIgZD0iTTAgN2gxMnYxSDB6Ii8+PC9zdmc+\" style=\"padding-right: 0.3em;\" alt=\"Slava Ukraini\"> <a href=\"https://leafletjs.com\" title=\"A JS library for interactive maps\">Leaflet</a> '\n    },\n\n    onAdd: function (map) {\n      map.attributionControl = this;\n      this._container = L.DomUtil.create(\n        'details',\n        'leaflet-control-attribution'\n      );\n      L.DomEvent.disableClickPropagation(this._container);\n\n      for (var i in map._layers) {\n        if (map._layers[i].getAttribution) {\n          this.addAttribution(map._layers[i].getAttribution());\n        }\n      }\n\n      this._update();\n\n      map.on('layeradd', this._addAttribution, this);\n\n      let dialog = document.createElement('dialog');\n      dialog.setAttribute('class', 'shortcuts-dialog');\n      dialog.setAttribute('autofocus', '');\n      dialog.onclick = function (e) {\n        e.stopPropagation();\n      };\n      dialog.innerHTML =\n        `<b>${M.options.locale.kbdShortcuts} </b><button aria-label=\"Close\" onclick='this.parentElement.close()'>X</button>` +\n        `<ul><b>${M.options.locale.kbdMovement}</b><li><kbd>&#8593</kbd> ${M.options.locale.kbdPanUp}</li><li><kbd>&#8595</kbd> ${M.options.locale.kbdPanDown}</li><li><kbd>&#8592</kbd> ${M.options.locale.kbdPanLeft}</li><li><kbd>&#8594</kbd> ${M.options.locale.kbdPanRight}</li><li><kbd>+</kbd> ${M.options.locale.btnZoomIn}</li><li><kbd>-</kbd> ${M.options.locale.btnZoomOut}</li><li><kbd>shift</kbd> + <kbd>&#8592/&#8593/&#8594/&#8595</kbd> 3x ${M.options.locale.kbdPanIncrement}</li><li><kbd>ctrl</kbd> + <kbd>&#8592/&#8593/&#8594/&#8595</kbd> 0.2x ${M.options.locale.kbdPanIncrement}</li><li><kbd>shift</kbd> + <kbd>+/-</kbd> ${M.options.locale.kbdZoom}</li></ul>` +\n        `<ul><b>${M.options.locale.kbdFeature}</b><li><kbd>&#8592/&#8593</kbd> ${M.options.locale.kbdPrevFeature}</li><li><kbd>&#8594/&#8595</kbd> ${M.options.locale.kbdNextFeature}</li></ul>`;\n      map._container.appendChild(dialog);\n\n      return this._container;\n    },\n\n    _update: function () {\n      if (!this._map) {\n        return;\n      }\n\n      var attribs = [];\n\n      for (var i in this._attributions) {\n        if (this._attributions[i]) {\n          attribs.push(i);\n        }\n      }\n\n      var prefixAndAttribs = [];\n\n      if (this.options.prefix) {\n        prefixAndAttribs.push(this.options.prefix);\n      }\n      if (attribs.length) {\n        prefixAndAttribs.push(attribs.join(', '));\n      }\n      this._container.innerHTML =\n        `<summary><svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" height=\"30px\" viewBox=\"0 0 24 24\" width=\"30px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"></path><path d=\"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"></path></svg></summary>` +\n        '<div class=\"mapml-attribution-container\">' +\n        `<button onclick=\"this.closest(\\'.leaflet-container\\').querySelector(\\'.shortcuts-dialog\\').showModal()\" class=\"shortcuts-button mapml-button\">${M.options.locale.kbdShortcuts}</button> | ` +\n        prefixAndAttribs.join(' <span aria-hidden=\"true\">|</span> ') +\n        '</div>';\n      this._container.setAttribute('role', 'group');\n      this._container.setAttribute(\n        'aria-label',\n        `${M.options.locale.btnAttribution}`\n      );\n    }\n  });\n\n  L.Map.mergeOptions({\n    attributionControl: false,\n    toggleableAttributionControl: true\n  });\n\n  L.Map.addInitHook(function () {\n    if (this.options.toggleableAttributionControl) {\n      new AttributionButton().addTo(this);\n    }\n  });\n\n  var attributionButton = function (options) {\n    return new AttributionButton(options);\n  };\n\n  var ReloadButton = L.Control.extend({\n    options: {\n      position: 'topleft'\n    },\n\n    onAdd: function (map) {\n      let container = L.DomUtil.create('div', 'mapml-reload-button leaflet-bar');\n\n      let link = L.DomUtil.create('button', 'mapml-reload-button', container);\n      link.innerHTML = \"<span aria-hidden='true'>&#x021BA</span>\";\n      link.title = M.options.locale.cmReload;\n      link.setAttribute('type', 'button');\n      link.classList.add('mapml-button');\n      link.setAttribute('aria-label', 'Reload');\n\n      L.DomEvent.disableClickPropagation(link);\n      L.DomEvent.on(link, 'click', L.DomEvent.stop);\n      L.DomEvent.on(link, 'click', this._goReload, this);\n\n      this._reloadButton = link;\n\n      this._updateDisabled();\n      map.on('moveend', this._updateDisabled, this);\n\n      return container;\n    },\n\n    onRemove: function (map) {\n      map.off('moveend', this._updateDisabled, this);\n    },\n\n    disable: function () {\n      this._disabled = true;\n      this._updateDisabled();\n      return this;\n    },\n\n    enable: function () {\n      this._disabled = false;\n      this._updateDisabled();\n      return this;\n    },\n\n    _goReload: function (e) {\n      if (!this._disabled && this._map.options.mapEl._history.length > 1) {\n        this._map.options.mapEl.reload();\n      }\n    },\n\n    _updateDisabled: function () {\n      setTimeout(() => {\n        L.DomUtil.removeClass(this._reloadButton, 'leaflet-disabled');\n        this._reloadButton.setAttribute('aria-disabled', 'false');\n\n        if (\n          this._map &&\n          (this._disabled || this._map.options.mapEl._history.length <= 1)\n        ) {\n          L.DomUtil.addClass(this._reloadButton, 'leaflet-disabled');\n          this._reloadButton.setAttribute('aria-disabled', 'true');\n        }\n      }, 0);\n    }\n  });\n\n  var reloadButton = function (options) {\n    return new ReloadButton(options);\n  };\n\n  var ScaleBar = L.Control.Scale.extend({\n    options: {\n      maxWidth: 100,\n      updateWhenIdle: true,\n      position: 'bottomleft'\n    },\n\n    onAdd: function (map) {\n      // create output tag for screenreader to read from\n      let outputScale =\n        \"<output role='status' aria-live='polite' aria-atomic='true' class='mapml-screen-reader-output-scale'></output>\";\n      map._container.insertAdjacentHTML('beforeend', outputScale);\n\n      // initialize _container\n      this._container = L.DomUtil.create('div', 'mapml-control-scale');\n      let scaleControl = L.Control.Scale.prototype.onAdd.call(this, map);\n      this._container.appendChild(scaleControl);\n      this._container.setAttribute('tabindex', 0);\n      this._scaleControl = this;\n\n      // run on load\n      setTimeout(() => {\n        this._updateOutput();\n        this._focusOutput();\n      }, 0);\n\n      // update whenever map is zoomed or dragged\n      map.on('zoomend moveend', this._updateOutput, this);\n\n      // have screenreader read out everytime the map is focused\n      this._map._container.addEventListener('focus', () => this._focusOutput());\n\n      return this._container;\n    },\n\n    onRemove: function (map) {\n      map.off('zoomend moveend', this._updateOutput, this);\n    },\n\n    getContainer: function () {\n      return this._container;\n    },\n\n    _pixelsToDistance: function (px, units) {\n      let dpi = window.devicePixelRatio * 96; // default dpi\n      if (units === 'metric') {\n        return (px / dpi) * 2.54; // inches to cm\n      }\n      return px / dpi;\n    },\n\n    _scaleLength: function (scale) {\n      let scaleLength = scale.getAttribute('style');\n      let finalLength = parseInt(scaleLength.match(/width:\\s*(\\d+)px/)[1]);\n\n      return finalLength;\n    },\n\n    _focusOutput: function () {\n      setTimeout(() => {\n        let outputFocus = this._map._container.querySelector(\n          '.mapml-screen-reader-output-scale'\n        );\n        outputFocus.textContent = '';\n        setTimeout(() => {\n          outputFocus.textContent = this._container.getAttribute('aria-label');\n        }, 100);\n      }, 0);\n    },\n\n    _updateOutput: function () {\n      let output = '';\n      let scaleLine = this._scaleControl\n        .getContainer()\n        .getElementsByClassName('leaflet-control-scale-line')[0];\n\n      if (this.options.metric) {\n        let distance = parseFloat(\n          this._pixelsToDistance(this._scaleLength(scaleLine), 'metric').toFixed(\n            1\n          )\n        );\n        output = `${distance} centimeters to ${scaleLine.textContent.trim()}`;\n        output = output.replace(/(\\d+)\\s*m\\b/g, '$1 meters');\n        output = output.replace(/ km/g, ' kilometers');\n      } else {\n        let distance = parseFloat(\n          this._pixelsToDistance(\n            this._scaleLength(scaleLine),\n            'imperial'\n          ).toFixed(1)\n        );\n        output = `${distance} inches to ${scaleLine.textContent.trim()}`;\n        output = output.replace(/ft/g, 'feet');\n        output = output.replace(/mi/g, 'miles');\n      }\n\n      this._container.setAttribute('aria-label', output);\n      this._map._container.querySelector(\n        '.mapml-screen-reader-output-scale'\n      ).textContent = output;\n    }\n  });\n  var scaleBar = function (options) {\n    return new ScaleBar(options);\n  };\n\n  var FullscreenButton = L.Control.extend({\n    options: {\n      position: 'topleft',\n      title: {\n        false: 'View Fullscreen',\n        true: 'Exit Fullscreen'\n      }\n    },\n\n    onAdd: function (map) {\n      var container = L.DomUtil.create(\n        'div',\n        'leaflet-control-fullscreen leaflet-bar leaflet-control'\n      );\n\n      this.link = L.DomUtil.create(\n        'a',\n        'leaflet-control-fullscreen-button leaflet-bar-part',\n        container\n      );\n      this.link.href = '#';\n      this.link.setAttribute('role', 'button');\n\n      this._map = map;\n      this._map.on('fullscreenchange', this._toggleTitle, this);\n      this._toggleTitle();\n\n      L.DomEvent.on(this.link, 'click', this._click, this);\n\n      return container;\n    },\n\n    onRemove: function (map) {\n      map.off('fullscreenchange', this._toggleTitle, this);\n    },\n\n    _click: function (e) {\n      L.DomEvent.stopPropagation(e);\n      L.DomEvent.preventDefault(e);\n      this._map.toggleFullscreen(this.options);\n    },\n\n    _toggleTitle: function () {\n      this.link.title = this.options.title[this._map.isFullscreen()];\n    }\n  });\n\n  L.Map.include({\n    isFullscreen: function () {\n      return this._isFullscreen || false;\n    },\n\n    toggleFullscreen: function (options) {\n      // the <map> element can't contain a shadow root, so we used a child <div>\n      // <mapml-viewer> can contain a shadow root, so return it directly\n      var mapEl = M.getClosest(this.getContainer(), 'mapml-viewer,[is=web-map]');\n      if (this.isFullscreen()) {\n        if (options && options.pseudoFullscreen) {\n          this._disablePseudoFullscreen(mapEl);\n        } else if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.webkitCancelFullScreen) {\n          document.webkitCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        } else {\n          this._disablePseudoFullscreen(mapEl);\n        }\n      } else {\n        if (options && options.pseudoFullscreen) {\n          this._enablePseudoFullscreen(mapEl);\n        } else if (mapEl.requestFullscreen) {\n          mapEl.requestFullscreen();\n        } else if (mapEl.mozRequestFullScreen) {\n          mapEl.mozRequestFullScreen();\n        } else if (mapEl.webkitRequestFullscreen) {\n          mapEl.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n        } else if (mapEl.msRequestFullscreen) {\n          mapEl.msRequestFullscreen();\n        } else {\n          this._enablePseudoFullscreen(mapEl);\n        }\n      }\n      this.getContainer().focus();\n    },\n\n    _enablePseudoFullscreen: function (container) {\n      L.DomUtil.addClass(container, 'leaflet-pseudo-fullscreen');\n      this._setFullscreen(true);\n      this.fire('fullscreenchange');\n    },\n\n    _disablePseudoFullscreen: function (container) {\n      L.DomUtil.removeClass(container, 'leaflet-pseudo-fullscreen');\n      this._setFullscreen(false);\n      this.fire('fullscreenchange');\n    },\n\n    _setFullscreen: function (fullscreen) {\n      this._isFullscreen = fullscreen;\n      var container = M.getClosest(\n        this.getContainer(),\n        'mapml-viewer,[is=web-map]'\n      );\n      if (fullscreen) {\n        L.DomUtil.addClass(container, 'mapml-fullscreen-on');\n      } else {\n        L.DomUtil.removeClass(container, 'mapml-fullscreen-on');\n      }\n      this.invalidateSize();\n    },\n\n    _onFullscreenChange: function (e) {\n      var fullscreenElement = M.getClosest(this.getContainer(), ':fullscreen'),\n        mapEl = M.getClosest(this.getContainer(), 'mapml-viewer,[is=web-map]');\n      if (fullscreenElement === mapEl && !this._isFullscreen) {\n        this._setFullscreen(true);\n        this.fire('fullscreenchange');\n      } else if (fullscreenElement !== mapEl && this._isFullscreen) {\n        this._setFullscreen(false);\n        this.fire('fullscreenchange');\n      }\n    }\n  });\n\n  L.Map.mergeOptions({\n    fullscreenControl: false\n  });\n\n  L.Map.addInitHook(function () {\n    if (this.options.fullscreenControl) {\n      this.fullscreenControl = new FullscreenButton(\n        this.options.fullscreenControl\n      );\n      this.addControl(this.fullscreenControl);\n    }\n\n    var fullscreenchange;\n\n    if ('onfullscreenchange' in document) {\n      fullscreenchange = 'fullscreenchange';\n    } else if ('onmozfullscreenchange' in document) {\n      fullscreenchange = 'mozfullscreenchange';\n    } else if ('onwebkitfullscreenchange' in document) {\n      fullscreenchange = 'webkitfullscreenchange';\n    } else if ('onmsfullscreenchange' in document) {\n      fullscreenchange = 'MSFullscreenChange';\n    }\n\n    if (fullscreenchange) {\n      var onFullscreenChange = L.bind(this._onFullscreenChange, this);\n\n      this.whenReady(function () {\n        L.DomEvent.on(document, fullscreenchange, onFullscreenChange);\n      });\n\n      this.on('unload', function () {\n        L.DomEvent.off(document, fullscreenchange, onFullscreenChange);\n      });\n    }\n  });\n\n  var fullscreenButton = function (options) {\n    return new FullscreenButton(options);\n  };\n\n  var GeolocationButton = L.Control.extend({\n    options: {\n      position: 'bottomright'\n    },\n\n    onAdd: function (map) {\n      // customize locate control to focus map after start/stop, so that\n      // featureIndexOverlay is correctly displayed\n      L.Control.CustomLocate = L.Control.Locate.extend({\n        start: function () {\n          L.Control.Locate.prototype.start.call(this);\n          map.getContainer().focus();\n        },\n        stop: function () {\n          L.Control.Locate.prototype.stop.call(this);\n          map.getContainer().focus();\n        }\n      });\n      this.locateControl = new L.Control.CustomLocate({\n        showPopup: false,\n        strings: {\n          title: M.options.locale.btnLocTrackOff\n        },\n        position: this.options.position,\n        locateOptions: {\n          maxZoom: 16\n        }\n      }).addTo(map);\n\n      var container = this.locateControl._container;\n      var button = this.locateControl;\n      var observer = new MutationObserver(function (mutations) {\n        if (\n          container.classList.contains('active') &&\n          container.classList.contains('following')\n        ) {\n          container.firstChild.title = M.options.locale.btnLocTrackOn;\n          button._marker.bindTooltip(M.options.locale.btnMyLocTrackOn, {\n            permanent: true\n          });\n        } else if (container.classList.contains('active')) {\n          container.firstChild.title = M.options.locale.btnLocTrackLastKnown;\n          button._marker.bindTooltip(M.options.locale.btnMyLastKnownLocTrackOn);\n        } else {\n          container.firstChild.title = M.options.locale.btnLocTrackOff;\n        }\n      });\n      var observerConfig = { attributes: true, attributeFilter: ['class'] };\n      observer.observe(container, observerConfig);\n\n      return container;\n    },\n\n    stop: function () {\n      return this.locateControl.stop();\n    }\n  });\n\n  var geolocationButton = function (options) {\n    return new GeolocationButton(options);\n  };\n\n  var Crosshair = L.Layer.extend({\n    onAdd: function (map) {\n      // SVG crosshair design from https://github.com/xguaita/Leaflet.MapCenterCoord/blob/master/src/icons/MapCenterCoordIcon1.svg?short_path=81a5c76\n      // Optimized with SVGOMG: https://jakearchibald.github.io/svgomg/\n      let svgInnerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" viewBox=\"0 0 100 100\"><g stroke=\"#fff\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"50.028\" cy=\"50.219\" r=\"3.923\" stroke-width=\"2\" color=\"currentColor\" overflow=\"visible\"/><path stroke-width=\"3\" d=\"M4.973 54.424h31.768a4.204 4.204 0 1 0 0-8.409H4.973A4.203 4.203 0 0 0 .77 50.22a4.203 4.203 0 0 0 4.204 4.205z\" color=\"currentColor\" overflow=\"visible\"/><path stroke-width=\"3\" d=\"M54.232 5.165a4.204 4.204 0 1 0-8.408 0v31.767a4.204 4.204 0 1 0 8.408 0V5.165z\"/><path stroke-width=\"3\" d=\"M99.288 50.22a4.204 4.204 0 0 0-4.204-4.205H63.317a4.204 4.204 0 1 0 0 8.409h31.767a4.205 4.205 0 0 0 4.204-4.205zM45.823 95.274a4.204 4.204 0 1 0 8.409 0V63.506a4.204 4.204 0 1 0-8.409 0v31.768z\" color=\"currentColor\" overflow=\"visible\"/></g></svg>`;\n\n      this._container = L.DomUtil.create(\n        'div',\n        'mapml-crosshair',\n        map._container\n      );\n      this._container.innerHTML = svgInnerHTML;\n      map.isFocused = false;\n      this._isQueryable = false;\n\n      map.on(\n        'layerchange layeradd layerremove overlayremove',\n        this._toggleEvents,\n        this\n      );\n      map.on('popupopen', this._isMapFocused, this);\n      L.DomEvent.on(\n        map._container,\n        'keydown keyup mousedown',\n        this._isMapFocused,\n        this\n      );\n\n      this._addOrRemoveCrosshair();\n    },\n\n    onRemove: function (map) {\n      map.off(\n        'layerchange layeradd layerremove overlayremove',\n        this._toggleEvents\n      );\n      map.off('popupopen', this._isMapFocused);\n      L.DomEvent.off(\n        map._container,\n        'keydown keyup mousedown',\n        this._isMapFocused\n      );\n    },\n\n    _toggleEvents: function () {\n      if (this._hasQueryableLayer()) {\n        this._map.on('viewreset move moveend', this._addOrRemoveCrosshair, this);\n      } else {\n        this._map.off('viewreset move moveend', this._addOrRemoveCrosshair, this);\n      }\n      this._addOrRemoveCrosshair();\n    },\n\n    _addOrRemoveCrosshair: function (e) {\n      if (this._hasQueryableLayer()) {\n        this._container.removeAttribute('hidden');\n      } else {\n        this._container.setAttribute('hidden', '');\n      }\n    },\n\n    _addOrRemoveMapOutline: function (e) {\n      let mapContainer = this._map._container;\n      if (this._map.isFocused && !this._outline) {\n        this._outline = L.DomUtil.create('div', 'mapml-outline', mapContainer);\n      } else if (!this._map.isFocused && this._outline) {\n        L.DomUtil.remove(this._outline);\n        delete this._outline;\n      }\n    },\n\n    _hasQueryableLayer: function () {\n      let layers = this._map.options.mapEl.layers;\n      if (this._map.isFocused) {\n        for (let layer of layers) {\n          if (layer.queryable()) {\n            return true;\n          }\n        }\n      }\n      return false;\n    },\n\n    // TODO: should be merged with the 'mapfocused' event emitted by mapml-viewer and map, not trivial\n    _isMapFocused: function (e) {\n      //set this._map.isFocused = true if arrow buttons are used\n      if (!this._map._container.parentNode.activeElement) {\n        this._map.isFocused = false;\n        return;\n      }\n      let isLeafletContainer =\n        this._map._container.parentNode.activeElement.classList.contains(\n          'leaflet-container'\n        );\n      if (\n        isLeafletContainer &&\n        ['keydown'].includes(e.type) &&\n        e.shiftKey &&\n        e.keyCode === 9\n      ) {\n        this._map.isFocused = false;\n      } else\n        this._map.isFocused =\n          isLeafletContainer && ['keyup', 'keydown'].includes(e.type);\n\n      if (this._map.isFocused) this._map.fire('mapkeyboardfocused');\n      this._addOrRemoveMapOutline();\n      this._addOrRemoveCrosshair();\n    }\n  });\n\n  var crosshair = function (options) {\n    return new Crosshair(options);\n  };\n\n  /**\n   * M.Path is a extension of L.Path that understands mapml feature markup\n   * It converts the markup to the following structure (abstract enough to encompass all feature types) for example:\n   *  this._outlinePath = HTMLElement;\n   *  this._parts = [\n   *    {\n   *      path: HTMLElement,\n   *      rings:[\n   *        {points:[{x:1,y:1}, ...]},\n   *        ...\n   *      ],\n   *      subrings:[\n   *        {points:[{x:2, y:2}, ...], cls:\"Span Class Name\", path: HTMLElement,},\n   *        ...\n   *      ],\n   *      cls:\"className\",\n   *    },\n   *    ...\n   *  ];\n   */\n  var Path = L.Path.extend({\n    /**\n     * Initializes the M.Path\n     * @param {HTMLElement} markup - The markup representation of the feature\n     * @param {Object} options - The options of the feature\n     */\n    initialize: function (markup, options) {\n      this.type = markup.tagName.toUpperCase();\n\n      if (this.type === 'MAP-POINT' || this.type === 'MAP-MULTIPOINT')\n        options.fillOpacity = 1;\n\n      if (options.wrappers.length > 0)\n        options = Object.assign(this._convertWrappers(options.wrappers), options);\n      L.setOptions(this, options);\n\n      this.group = this.options.group;\n      this.options.interactive =\n        this.options.link ||\n        (this.options.properties && this.options.onEachFeature);\n\n      this._parts = [];\n      this._markup = markup;\n      this.options.zoom = markup.zoom ?? this.options.nativeZoom;\n\n      this._convertMarkup();\n\n      if (markup.querySelector('map-span') || markup.querySelector('map-a')) {\n        this._generateOutlinePoints();\n      }\n\n      this.isClosed = this._isClosed();\n    },\n\n    /**\n     * Attaches link handler to the sub parts' paths\n     * @param {SVGElement} elem - The element to add listeners to, either path or g elements\n     * @param {Object} link - The link object that contains the url, type and target data\n     * @param leafletLayer\n     */\n    attachLinkHandler: function (elem, link, leafletLayer) {\n      let dragStart,\n        container = document.createElement('div'),\n        p = document.createElement('p'),\n        hovered = false;\n      container.classList.add('mapml-link-preview');\n      container.appendChild(p);\n      elem.classList.add('map-a');\n      if (link.visited) elem.classList.add('map-a-visited');\n      elem.mousedown = (e) => (dragStart = { x: e.clientX, y: e.clientY });\n      L.DomEvent.on(elem, 'mousedown', elem.mousedown, this);\n      elem.mouseup = (e) => {\n        if (e.button !== 0) return; // don't trigger when button isn't left click\n        let onTop = true,\n          nextLayer = this.options._leafletLayer._layerEl.nextElementSibling;\n        while (nextLayer && onTop) {\n          if (nextLayer.tagName && nextLayer.tagName.toUpperCase() === 'LAYER-')\n            onTop = !nextLayer.queryable();\n          nextLayer = nextLayer.nextElementSibling;\n        }\n        if (onTop && dragStart) {\n          //M._handleLink gets called twice, once in the target phase on the path\n          //element, then in the bubble phase on the g element\n          //Using stopPropagation leaves the mouse in the mousedown state\n          if (e.eventPhase === Event.BUBBLING_PHASE) return;\n          let dist = Math.sqrt(\n            Math.pow(dragStart.x - e.clientX, 2) +\n              Math.pow(dragStart.y - e.clientY, 2)\n          );\n          if (dist <= 5) {\n            link.visited = true;\n            elem.setAttribute('stroke', '#6c00a2');\n            elem.classList.add('map-a-visited');\n            M._handleLink(link, leafletLayer);\n          }\n        }\n      };\n      L.DomEvent.on(elem, 'mouseup', elem.mouseup, this);\n      L.DomEvent.on(\n        elem,\n        'keypress',\n        (e) => {\n          L.DomEvent.stop(e);\n          if (e.keyCode === 13 || e.keyCode === 32) {\n            link.visited = true;\n            elem.setAttribute('stroke', '#6c00a2');\n            elem.classList.add('map-a-visited');\n            M._handleLink(link, leafletLayer);\n          }\n        },\n        this\n      );\n      L.DomEvent.on(\n        elem,\n        'mouseenter keyup',\n        (e) => {\n          if (e.target !== e.currentTarget) return;\n          hovered = true;\n          let resolver = document.createElement('a'),\n            mapWidth = this._map.getContainer().clientWidth;\n          resolver.href = link.url;\n          p.innerHTML = resolver.href;\n\n          this._map.getContainer().appendChild(container);\n\n          while (p.clientWidth > mapWidth / 2) {\n            p.innerHTML =\n              p.innerHTML.substring(0, p.innerHTML.length - 5) + '...';\n          }\n          setTimeout(() => {\n            if (hovered) p.innerHTML = resolver.href;\n          }, 1000);\n        },\n        this\n      );\n      L.DomEvent.on(\n        elem,\n        'mouseout keydown mousedown',\n        (e) => {\n          if (e.target !== e.currentTarget || !container.parentElement) return;\n          hovered = false;\n          this._map.getContainer().removeChild(container);\n        },\n        this\n      );\n      leafletLayer.on('add', addMouseHandler, leafletLayer);\n      function handleMouse(e) {\n        //adds a lot of event handlers\n        if (!container.parentElement) return;\n        hovered = false;\n        this._map.getContainer().removeChild(container);\n      }\n      function addMouseHandler() {\n        L.DomEvent.on(\n          this._map.getContainer(),\n          'mouseout mouseenter click',\n          handleMouse,\n          this\n        );\n      }\n      leafletLayer.on('remove', removeMouseHandler, leafletLayer);\n      function removeMouseHandler() {\n        L.DomEvent.off(this._map.getContainer(), {\n          mouseout: handleMouse,\n          mouseenter: handleMouse,\n          click: handleMouse\n        });\n      }\n    },\n\n    /**\n     * Updates internal structure of the feature to the new map state, the structure can be found in this._parts\n     * @param {L.Map} addedMap - The map that the feature is part of, can be left blank in the case of static features\n     * @param {L.Point} tileOrigin - The tile origin for the feature, if blank then it takes the maps pixel origin in the function\n     * @param {int} zoomingTo - The zoom the map is animating to, if left blank then it takes the map zoom, its provided because in templated tiles zoom is delayed\n     * @private\n     */\n    _project: function (addedMap, tileOrigin = undefined, zoomingTo = undefined) {\n      let map = addedMap || this._map,\n        origin = tileOrigin || map.getPixelOrigin(),\n        zoom = zoomingTo === undefined ? map.getZoom() : zoomingTo;\n      for (let p of this._parts) {\n        p.pixelRings = this._convertRing(p.rings, map, origin, zoom);\n        for (let subP of p.subrings) {\n          subP.pixelSubrings = this._convertRing([subP], map, origin, zoom);\n        }\n      }\n      if (!this._outline) return;\n      this.pixelOutline = [];\n      for (let o of this._outline) {\n        this.pixelOutline = this.pixelOutline.concat(\n          this._convertRing(o, map, origin, zoom)\n        );\n      }\n    },\n\n    /**\n     * Converts the PCRS points to pixel points that can be used to create the SVG\n     * @param {L.Point[][]} r - Is the rings of a feature, either the mainParts, subParts or outline\n     * @param {L.Map} map - The map that the feature is part of\n     * @param {L.Point} origin - The origin used to calculate the pixel points\n     * @param {int} zoom - The current zoom level of the map\n     * @returns {L.Point[][]}\n     * @private\n     */\n    _convertRing: function (r, map, origin, zoom) {\n      // TODO: Implement Ramer-Douglas-Peucer Algo for simplifying points\n      let scale = map.options.crs.scale(zoom),\n        parts = [];\n      for (let sub of r) {\n        let interm = [];\n        for (let p of sub.points) {\n          let conv = map.options.crs.transformation.transform(p, scale);\n          interm.push(L.point(conv.x, conv.y)._subtract(origin).round());\n        }\n        parts.push(interm);\n      }\n      return parts;\n    },\n\n    /**\n     * Updates the features\n     * @private\n     */\n    _update: function () {\n      if (!this._map) return;\n      this._renderer._updateFeature(this);\n    },\n\n    /**\n     * Converts the map-spans, a and divs around a geometry subtype into options for the feature\n     * @param {HTMLElement[]} elems - The current zoom level of the map\n     * @private\n     */\n    _convertWrappers: function (elems) {\n      if (!elems || elems.length === 0) return;\n      let classList = '',\n        output = {};\n      for (let elem of elems) {\n        if (elem.tagName.toUpperCase() !== 'MAP-A' && elem.className) {\n          classList += `${elem.className} `;\n        } else if (!output.link && elem.getAttribute('href')) {\n          let link = {};\n          link.url = elem.getAttribute('href');\n          if (elem.hasAttribute('target'))\n            link.target = elem.getAttribute('target');\n          if (elem.hasAttribute('type')) link.type = elem.getAttribute('type');\n          if (elem.hasAttribute('inplace')) link.inPlace = true;\n          output.link = link;\n        }\n      }\n      output.className = `${classList} ${this.options.className}`.trim();\n      return output;\n    },\n\n    /**\n     * Converts this._markup to the internal structure of features\n     * @private\n     */\n    _convertMarkup: function () {\n      if (!this._markup) return;\n\n      let attr = this._markup.attributes;\n      this.featureAttributes = {};\n      if (\n        this.options.link &&\n        this._markup.parentElement.tagName.toUpperCase() === 'MAP-A' &&\n        this._markup.parentElement.parentElement.tagName.toUpperCase() !==\n          'MAP-GEOMETRY'\n      )\n        this.featureAttributes.tabindex = '0';\n      for (let i = 0; i < attr.length; i++) {\n        this.featureAttributes[attr[i].name] = attr[i].value;\n      }\n\n      let first = true;\n      for (let c of this._markup.querySelectorAll('map-coordinates')) {\n        //loops through the coordinates of the child\n        let ring = [],\n          subRings = [];\n        this._coordinateToArrays(c, ring, subRings, this.options.className); //creates an array of pcrs points for the main ring and the subparts\n        if (!first && this.type === 'MAP-POLYGON') {\n          this._parts[0].rings.push(ring[0]);\n          if (subRings.length > 0)\n            this._parts[0].subrings = this._parts[0].subrings.concat(subRings);\n        } else if (this.type === 'MAP-MULTIPOINT') {\n          for (let point of ring[0].points.concat(subRings)) {\n            this._parts.push({\n              rings: [{ points: [point] }],\n              subrings: [],\n              cls: `${point.cls || ''} ${this.options.className || ''}`.trim()\n            });\n          }\n        } else {\n          this._parts.push({\n            rings: ring,\n            subrings: subRings,\n            cls: `${this.featureAttributes.class || ''} ${\n            this.options.className || ''\n          }`.trim()\n          });\n        }\n        first = false;\n      }\n    },\n\n    /**\n     * Generates the feature outline, subtracting the map-spans to generate those separately\n     * @private\n     */\n    _generateOutlinePoints: function () {\n      if (\n        this.type === 'MAP-MULTIPOINT' ||\n        this.type === 'MAP-POINT' ||\n        this.type === 'MAP-LINESTRING' ||\n        this.type === 'MAP-MULTILINESTRING'\n      )\n        return;\n\n      this._outline = [];\n      for (let coords of this._markup.querySelectorAll('map-coordinates')) {\n        let nodes = coords.childNodes,\n          cur = 0,\n          tempDiv = document.createElement('div'),\n          nodeLength = nodes.length;\n        for (let i = 0; i < nodes.length; i++) {\n          if (nodes[i].textContent.trim().length === 0) {\n            nodes[i].remove();\n          }\n        }\n        for (let n of nodes) {\n          let line = [];\n          if (!n.tagName) {\n            //no tagName means it's text content\n            let c = '',\n              ind = (((cur - 1) % nodes.length) + nodes.length) % nodes.length; // this equation turns Javascript's % to how it behaves in C for example\n            if (nodes[ind].tagName) {\n              let prev = nodes[ind].textContent.trim().split(/\\s+/);\n              c += `${prev[prev.length - 2]} ${prev[prev.length - 1]} `;\n            }\n            c += n.textContent;\n            ind = (((cur + 1) % nodes.length) + nodes.length) % nodes.length; // this is equivalent to C/C++'s (cur + 1) % nodes.length\n            if (nodes[ind].tagName) {\n              let next = nodes[ind].textContent.trim().split(/\\s+/);\n              c += ` ${next[0]} ${next[1]} `;\n            }\n            tempDiv.innerHTML = c;\n            this._coordinateToArrays(\n              tempDiv,\n              line,\n              [],\n              true,\n              this.featureAttributes.class || this.options.className\n            );\n            this._outline.push(line);\n          }\n          cur++;\n        }\n      }\n    },\n\n    /**\n     * Converts map-coordinates element to an object representing the parts and subParts\n     * @param {HTMLElement} coords - A single map-coordinates element\n     * @param {Object[]} main - An empty array representing the main parts\n     * @param {Object[]} subParts - An empty array representing the sub parts\n     * @param {boolean} isFirst - A true | false representing if the current HTML element is the parent map-coordinates element or not\n     * @param {string} cls - The class of the coordinate/span\n     * @param parents\n     * @private\n     */\n    _coordinateToArrays: function (\n      coords,\n      main,\n      subParts,\n      isFirst = true,\n      cls = undefined,\n      parents = []\n    ) {\n      for (let span of coords.children) {\n        this._coordinateToArrays(\n          span,\n          main,\n          subParts,\n          false,\n          span.getAttribute('class'),\n          parents.concat([span])\n        );\n      }\n      let noSpan = coords.textContent.replace(/(<([^>]+)>)/gi, ''),\n        pairs = noSpan.trim().match(/(\\S+\\s+\\S+)/gim),\n        local = [],\n        bounds;\n      for (let p of pairs) {\n        let numPair = [];\n        p.split(/\\s+/gim).forEach(M._parseNumber, numPair);\n        let point = M.pointToPCRSPoint(\n          L.point(numPair),\n          this.options.zoom,\n          this.options.projection,\n          this.options.nativeCS\n        );\n        local.push(point);\n        bounds = bounds ? bounds.extend(point) : L.bounds(point, point);\n      }\n      if (this._bounds) {\n        this._bounds.extend(bounds.min);\n        this._bounds.extend(bounds.max);\n      } else {\n        this._bounds = bounds;\n      }\n      if (isFirst) {\n        main.push({ points: local });\n      } else {\n        let attrMap = {},\n          attr = coords.attributes,\n          wrapperAttr = this._convertWrappers(parents);\n        if (wrapperAttr.link) attrMap.tabindex = '0';\n        for (let i = 0; i < attr.length; i++) {\n          if (attr[i].name === 'class') continue;\n          attrMap[attr[i].name] = attr[i].value;\n        }\n        subParts.unshift({\n          points: local,\n          center: bounds.getCenter(),\n          cls: `${cls || ''} ${wrapperAttr.className || ''}`.trim(),\n          attr: attrMap,\n          link: wrapperAttr.link,\n          linkTarget: wrapperAttr.linkTarget,\n          linkType: wrapperAttr.linkType\n        });\n      }\n    },\n\n    /**\n     * Returns if the feature is closed or open, useful when styling\n     * @returns {boolean}\n     * @private\n     */\n    _isClosed: function () {\n      switch (this.type) {\n        case 'MAP-POLYGON':\n        case 'MAP-MULTIPOLYGON':\n        case 'MAP-POINT':\n        case 'MAP-MULTIPOINT':\n          return true;\n        case 'MAP-LINESTRING':\n        case 'MAP-MULTILINESTRING':\n          return false;\n        default:\n          return false;\n      }\n    },\n\n    /**\n     * Returns the center of the entire feature\n     * @returns {L.Point}\n     */\n    getCenter: function () {\n      if (!this._bounds) return null;\n      return this._map.options.crs.unproject(this._bounds.getCenter());\n    },\n\n    getPCRSCenter: function () {\n      return this._bounds.getCenter();\n    }\n  });\n\n  /**\n   *\n   * @param {HTMLElement} markup - The markup of the feature\n   * @param {Object} options - Options of the feature\n   * @returns {M.Path}\n   */\n  var path = function (markup, options) {\n    return new Path(markup, options);\n  };\n\n  /**\n   * Returns a new Feature Renderer\n   * @param {Object} options - Options for the renderer\n   * @returns {*}\n   */\n  var FeatureRenderer = L.SVG.extend({\n    /**\n     * Override method of same name from L.SVG, use the this._container property\n     * to set up the role=\"none presentation\" on featureGroupu container,\n     * per this recommendation:\n     * https://github.com/Maps4HTML/Web-Map-Custom-Element/pull/471#issuecomment-845192246\n     * @private overrides ancestor method so that we have a _container to work with\n     */\n    _initContainer: function () {\n      // call the method we're overriding, per https://leafletjs.com/examples/extending/extending-1-classes.html#methods-of-the-parent-class\n      // note you have to pass 'this' as the first arg\n      L.SVG.prototype._initContainer.call(this);\n      // knowing that the previous method call creates the this._container, we\n      // access it and set the role=\"none presetation\" which suppresses the\n      // announcement of \"Graphic\" on each feature focus.\n      this._container.setAttribute('role', 'none presentation');\n    },\n\n    /**\n     * Creates all the appropriate path elements for a M.Path\n     * @param {M.Path} layer - The M.Path that needs paths generated\n     * @param {boolean} stampLayer - Whether or not a layer should be stamped and stored in the renderer layers\n     * @private\n     */\n    _initPath: function (layer, stampLayer = true) {\n      if (layer._outline) {\n        let outlinePath = L.SVG.create('path');\n        if (layer.options.className)\n          L.DomUtil.addClass(\n            outlinePath,\n            layer.featureAttributes.class || layer.options.className\n          );\n        L.DomUtil.addClass(outlinePath, 'mapml-feature-outline');\n        outlinePath.style.fill = 'none';\n        layer.outlinePath = outlinePath;\n      }\n\n      //creates the main parts and sub parts paths\n      for (let p of layer._parts) {\n        if (p.rings) {\n          this._createPath(\n            p,\n            layer.options.className,\n            layer.featureAttributes['aria-label'],\n            layer.options.interactive,\n            layer.featureAttributes\n          );\n          if (layer.outlinePath) p.path.style.stroke = 'none';\n        }\n        if (p.subrings) {\n          for (let r of p.subrings) {\n            this._createPath(\n              r,\n              layer.options.className,\n              r.attr['aria-label'],\n              r.link !== undefined,\n              r.attr\n            );\n          }\n        }\n        this._updateStyle(layer);\n      }\n      if (stampLayer) {\n        let stamp = L.stamp(layer);\n        this._layers[stamp] = layer;\n      }\n    },\n\n    /**\n     * Creates paths for either mainParts, subParts or outline of a feature\n     * @param {Object} ring - The ring the current path is being generated for\n     * @param {string} title - The accessible aria-label of a path\n     * @param {string} cls - The class of the path\n     * @param {boolean} interactive - The boolean representing whether a feature is interactive or not\n     * @param {Object} attr - Attributes map\n     * @private\n     */\n    _createPath: function (\n      ring,\n      cls,\n      title,\n      interactive = false,\n      attr = undefined\n    ) {\n      let p = L.SVG.create('path');\n      ring.path = p;\n      if (!attr) {\n        if (title) p.setAttribute('aria-label', title);\n      } else {\n        for (let [name, value] of Object.entries(attr)) {\n          if (name === 'id' || name === 'tabindex') continue;\n          p.setAttribute(name, value);\n        }\n      }\n      if (ring.cls || cls) {\n        L.DomUtil.addClass(p, ring.cls || cls);\n      }\n      if (interactive) {\n        L.DomUtil.addClass(p, 'leaflet-interactive');\n      }\n    },\n\n    /**\n     * Adds all the paths needed for a feature\n     * @param {M.Path} layer - The feature that needs it's paths added\n     * @param {HTMLElement} container - The location the paths need to be added to\n     * @param {boolean} interactive - Whether a feature is interactive or not\n     * @private\n     */\n    _addPath: function (layer, container = undefined, interactive = true) {\n      if (!this._rootGroup && !container) {\n        this._initContainer();\n      }\n      let c = container || this._rootGroup,\n        outlineAdded = false;\n      if (interactive) {\n        layer.addInteractiveTarget(layer.group);\n      }\n      for (let p of layer._parts) {\n        if (p.path) layer.group.appendChild(p.path);\n        if (interactive) {\n          if (layer.options.link)\n            layer.attachLinkHandler(\n              p.path,\n              layer.options.link,\n              layer.options._leafletLayer\n            );\n          layer.addInteractiveTarget(p.path);\n        }\n\n        if (!outlineAdded && layer.pixelOutline) {\n          layer.group.appendChild(layer.outlinePath);\n          outlineAdded = true;\n        }\n\n        for (let subP of p.subrings) {\n          if (subP.path) {\n            if (subP.link) {\n              layer.attachLinkHandler(\n                subP.path,\n                subP.link,\n                layer.options._leafletLayer\n              );\n              layer.addInteractiveTarget(subP.path);\n            }\n            layer.group.appendChild(subP.path);\n          }\n        }\n      }\n      c.appendChild(layer.group);\n    },\n\n    /**\n     * Removes all the paths related to a feature\n     * @param {M.Path} layer - The feature who's paths need to be removed\n     * @private\n     */\n    _removePath: function (layer) {\n      for (let p of layer._parts) {\n        if (p.path) {\n          layer.removeInteractiveTarget(p.path);\n          L.DomUtil.remove(p.path);\n        }\n        for (let subP of p.subrings) {\n          if (subP.path) L.DomUtil.remove(subP.path);\n        }\n      }\n      if (layer.outlinePath) L.DomUtil.remove(layer.outlinePath);\n      layer.removeInteractiveTarget(layer.group);\n      L.DomUtil.remove(layer.group);\n      delete this._layers[L.stamp(layer)];\n    },\n\n    /**\n     * Updates the d attribute of all paths of a feature\n     * @param {M.Path} layer - The Feature that needs updating\n     * @private\n     */\n    _updateFeature: function (layer) {\n      if (layer.pixelOutline)\n        this._setPath(\n          layer.outlinePath,\n          this.geometryToPath(layer.pixelOutline, false)\n        );\n      for (let p of layer._parts) {\n        this._setPath(p.path, this.geometryToPath(p.pixelRings, layer.isClosed));\n        for (let subP of p.subrings) {\n          this._setPath(\n            subP.path,\n            this.geometryToPath(subP.pixelSubrings, false)\n          );\n        }\n      }\n    },\n\n    /**\n     * Generates the marker d attribute for a given point\n     * @param {L.Point} p - The point of the marker\n     * @returns {string}\n     * @private\n     */\n    _pointToMarker: function (p) {\n      return `M${p.x} ${p.y} L${p.x - 12.5} ${p.y - 30} C${p.x - 12.5} ${\n      p.y - 50\n    }, ${p.x + 12.5} ${p.y - 50}, ${p.x + 12.5} ${p.y - 30} L${p.x} ${p.y}z`;\n    },\n\n    /**\n     * Updates the styles of all paths of a feature\n     * @param {M.Path} layer - The feature that needs styles updated\n     * @private\n     */\n    _updateStyle: function (layer) {\n      this._updatePathStyle(layer.outlinePath, layer, false, true);\n      for (let p of layer._parts) {\n        if (p.path) {\n          this._updatePathStyle(p.path, layer, true);\n        }\n        for (let subP of p.subrings) {\n          if (subP.path) this._updatePathStyle(subP.path, layer);\n        }\n      }\n    },\n\n    /**\n     * Updates the style of a single path\n     * @param {HTMLElement} path - The path that needs updating\n     * @param {M.Path} layer - The feature layer\n     * @param {boolean} isMain - Whether it's the main parts or not\n     * @param {boolean} isOutline - Whether a path is an outline or not\n     * @private\n     */\n    _updatePathStyle: function (path, layer, isMain = false, isOutline = false) {\n      if (!path || !layer) {\n        return;\n      }\n      let options = layer.options,\n        isClosed = layer.isClosed;\n      if (\n        (options.stroke && (!isClosed || isOutline)) ||\n        (isMain && !layer.outlinePath)\n      ) {\n        path.setAttribute('stroke', options.color);\n        path.setAttribute('stroke-opacity', options.opacity);\n        path.setAttribute('stroke-width', options.weight);\n        path.setAttribute('stroke-linecap', options.lineCap);\n        path.setAttribute('stroke-linejoin', options.lineJoin);\n\n        if (options.dashArray) {\n          path.setAttribute('stroke-dasharray', options.dashArray);\n        } else {\n          path.removeAttribute('stroke-dasharray');\n        }\n\n        if (options.dashOffset) {\n          path.setAttribute('stroke-dashoffset', options.dashOffset);\n        } else {\n          path.removeAttribute('stroke-dashoffset');\n        }\n\n        if (options.link) {\n          path.setAttribute(\n            'stroke',\n            options.link.visited ? '#6c00a2' : '#0000EE'\n          );\n          path.setAttribute('stroke-opacity', '1');\n          path.setAttribute('stroke-width', '1px');\n          path.setAttribute('stroke-dasharray', 'none');\n        }\n      } else {\n        path.setAttribute('stroke', 'none');\n      }\n\n      if (isClosed && !isOutline) {\n        if (!options.fill) {\n          path.setAttribute('fill', options.fillColor || options.color);\n          path.setAttribute('fill-opacity', options.fillOpacity);\n          path.setAttribute('fill-rule', options.fillRule || 'evenodd');\n        } else {\n          path.setAttribute('fill', options.color);\n        }\n      } else {\n        path.setAttribute('fill', 'none');\n      }\n    },\n\n    /**\n     * Sets the d attribute of a path\n     * @param {HTMLElement} path - The path that is being updated\n     * @param {string} def - The new d attribute of the path\n     * @private\n     */\n    _setPath: function (path, def) {\n      path.setAttribute('d', def);\n    },\n\n    /**\n     * Generates the d string of a feature part\n     * @param {L.Point[]} rings - The points making up a given part of a feature\n     * @param {boolean} closed - Whether a feature is closed or not\n     * @returns {string}\n     */\n    geometryToPath: function (rings, closed) {\n      let str = '',\n        i,\n        j,\n        len,\n        len2,\n        points,\n        p;\n\n      for (i = 0, len = rings.length; i < len; i++) {\n        points = rings[i];\n        if (points.length === 1) {\n          return this._pointToMarker(points[0]);\n        }\n        for (j = 0, len2 = points.length; j < len2; j++) {\n          p = points[j];\n          str += (j ? 'L' : 'M') + p.x + ' ' + p.y;\n        }\n        str += closed ? 'z' : '';\n      }\n      return str || 'M0 0';\n    }\n  });\n\n  /**\n   * Returns new M.FeatureRenderer\n   * @param {Object} options - Options for the renderer\n   * @returns {M.FeatureRenderer}\n   */\n  var featureRenderer = function (options) {\n    return new FeatureRenderer(options);\n  };\n\n  var Geometry = L.FeatureGroup.extend({\n    /**\n     * Initialize the feature group\n     * @param {M.Path[]} layers\n     * @param {Object} options\n     */\n    initialize: function (layers, options) {\n      if (options.wrappers && options.wrappers.length > 0)\n        options = Object.assign(\n          M.Path.prototype._convertWrappers(options.wrappers),\n          options\n        );\n\n      L.LayerGroup.prototype.initialize.call(this, layers, options);\n      this._featureEl = this.options.mapmlFeature;\n\n      this.layerBounds = options.layerBounds;\n      this.zoomBounds = options.zoomBounds;\n\n      let firstLayer = layers[Object.keys(layers)[0]];\n      if (layers.length === 1 && firstLayer.options.link)\n        this.options.link = firstLayer.options.link;\n      if (\n        (this.options.onEachFeature && this.options.properties) ||\n        this.options.link\n      ) {\n        L.DomUtil.addClass(this.options.group, 'leaflet-interactive');\n        if (this.options.link) {\n          M.Path.prototype.attachLinkHandler.call(\n            this,\n            this.options.group,\n            this.options.link,\n            this.options._leafletLayer\n          );\n          this.options.group.setAttribute('role', 'link');\n        } else {\n          this.options.group.setAttribute('aria-expanded', 'false');\n          this.options.group.setAttribute('role', 'button');\n          this.options.onEachFeature(this.options.properties, this);\n          this.off('click', this._openPopup);\n        }\n      }\n\n      L.DomEvent.on(this.options.group, 'keyup keydown', this._handleFocus, this);\n      this.options.group.setAttribute('aria-label', this.options.accessibleTitle);\n      if (this.options.featureID)\n        this.options.group.setAttribute('data-fid', this.options.featureID);\n      for (let feature of layers) {\n        feature._groupLayer = this;\n      }\n    },\n\n    onAdd: function (map) {\n      L.LayerGroup.prototype.onAdd.call(this, map);\n      this.updateInteraction();\n    },\n\n    updateInteraction: function () {\n      let map = this._map || this.options._leafletLayer._map;\n      if (this.options.onEachFeature || this.options.link)\n        map.featureIndex.addToIndex(\n          this,\n          this.getPCRSCenter(),\n          this.options.group\n        );\n\n      for (let layerID in this._layers) {\n        let layer = this._layers[layerID];\n        for (let part of layer._parts) {\n          if (layer.featureAttributes && layer.featureAttributes.tabindex)\n            map.featureIndex.addToIndex(layer, layer.getPCRSCenter(), part.path);\n          for (let subPart of part.subrings) {\n            if (subPart.attr && subPart.attr.tabindex)\n              map.featureIndex.addToIndex(layer, subPart.center, subPart.path);\n          }\n        }\n      }\n    },\n\n    /**\n     * Check whether the feature group should be rendered at current map zoom level\n     * @param {Number} zoom - current map zoom\n     * @param {Object} vectorMinZoom - the minimum zoom bound of vector layer\n     * @param {Object} vectorMaxZoom - the maximum zoom bound of vector layer\n     * @returns {Boolean}\n     * @private\n     */\n    _checkRender: function (zoom, vectorMinZoom, vectorMaxZoom) {\n      let minZoom = this._featureEl.min,\n        maxZoom = this._featureEl.max;\n      // if the current map zoom falls below/above the zoom bounds of the vector layer\n      if (zoom > vectorMaxZoom || zoom < vectorMinZoom) return false;\n      // if the current map zoom falls below/above the [min, max] range\n      if (\n        (minZoom !== null && zoom < +minZoom) ||\n        (maxZoom !== null && zoom > +maxZoom)\n      ) {\n        return false;\n      }\n      return true;\n    },\n\n    /**\n     * Handler for focus events\n     * @param {L.DOMEvent} e - Event that occurred\n     * @private\n     */\n    _handleFocus: function (e) {\n      // tab, shift, cr, esc, up, left, down, right,\n      if (\n        [9, 16, 27, 37, 38, 39, 40].includes(e.keyCode) &&\n        e.type === 'keydown'\n      ) {\n        let index = this._map.featureIndex.currentIndex;\n        // Down/right arrow keys replicate tabbing through the feature index\n        // Up/left arrow keys replicate shift-tabbing through the feature index\n        if (e.keyCode === 37 || e.keyCode === 38) {\n          L.DomEvent.stop(e);\n          this._map.featureIndex.inBoundFeatures[index].path.setAttribute(\n            'tabindex',\n            -1\n          );\n          if (index === 0) {\n            this._map.featureIndex.inBoundFeatures[\n              this._map.featureIndex.inBoundFeatures.length - 1\n            ].path.focus();\n            this._map.featureIndex.currentIndex =\n              this._map.featureIndex.inBoundFeatures.length - 1;\n          } else {\n            this._map.featureIndex.inBoundFeatures[index - 1].path.focus();\n            this._map.featureIndex.currentIndex--;\n          }\n        } else if (e.keyCode === 39 || e.keyCode === 40) {\n          L.DomEvent.stop(e);\n          this._map.featureIndex.inBoundFeatures[index].path.setAttribute(\n            'tabindex',\n            -1\n          );\n          if (index === this._map.featureIndex.inBoundFeatures.length - 1) {\n            this._map.featureIndex.inBoundFeatures[0].path.focus();\n            this._map.featureIndex.currentIndex = 0;\n          } else {\n            this._map.featureIndex.inBoundFeatures[index + 1].path.focus();\n            this._map.featureIndex.currentIndex++;\n          }\n        } else if (e.keyCode === 27) {\n          let shadowRoot = this._map.options.mapEl.shadowRoot\n            ? this._map.options.mapEl.shadowRoot\n            : this._map.options.mapEl.querySelector('.mapml-web-map').shadowRoot;\n          if (shadowRoot.activeElement.nodeName !== 'g') return;\n          this._map._container.focus();\n        } else if (e.keyCode === 9) {\n          let obj = this;\n          setTimeout(function () {\n            obj._map.featureIndex.inBoundFeatures[0].path.setAttribute(\n              'tabindex',\n              0\n            );\n          }, 0);\n        }\n        // tab, shift, cr, esc, right, left, up, down,\n        // 1, 2, 3, 4, 5, 6, 7 (featureIndexOverlay available index items\n        // [8, 9] being allocated to next, previous menu items).\n      } else if (\n        ![9, 16, 13, 27, 37, 38, 39, 40, 49, 50, 51, 52, 53, 54, 55].includes(\n          e.keyCode\n        )\n      ) {\n        this._map.featureIndex.currentIndex = 0;\n        this._map.featureIndex.inBoundFeatures[0].path.focus();\n      }\n\n      // 27 added so that the tooltip opens when dismissing popup with 'esc' key\n      if (e.target.tagName.toUpperCase() !== 'G') return;\n      if (\n        [9, 13, 16, 37, 38, 39, 40, 49, 50, 51, 52, 53, 54, 55, 27].includes(\n          e.keyCode\n        ) &&\n        e.type === 'keyup'\n      ) {\n        this.openTooltip();\n      } else if (e.keyCode === 13 || e.keyCode === 32) {\n        this.closeTooltip();\n        if (!this.options.link && this.options.onEachFeature) {\n          L.DomEvent.stop(e);\n          this.openPopup();\n        }\n      } else {\n        this.closeTooltip();\n      }\n    },\n\n    /**\n     * Add a M.Path to the M.Geometry\n     * @param layer\n     */\n    addLayer: function (layer) {\n      if (!layer.options.link && layer.options.interactive) {\n        this.options.onEachFeature(this.options.properties, layer);\n      }\n      L.FeatureGroup.prototype.addLayer.call(this, layer);\n    },\n\n    /**\n     * Focuses the previous function in the sequence on previous button press\n     * @param e\n     * @private\n     */\n    _previousFeature: function (e) {\n      L.DomEvent.stop(e);\n      this._map.featureIndex.currentIndex = Math.max(\n        this._map.featureIndex.currentIndex - 1,\n        0\n      );\n      let prevFocus =\n        this._map.featureIndex.inBoundFeatures[\n          this._map.featureIndex.currentIndex\n        ];\n      prevFocus.path.focus();\n      this._map.closePopup();\n    },\n\n    /**\n     * Focuses next feature in sequence\n     * @param e\n     * @private\n     */\n    _nextFeature: function (e) {\n      L.DomEvent.stop(e);\n      this._map.featureIndex.currentIndex = Math.min(\n        this._map.featureIndex.currentIndex + 1,\n        this._map.featureIndex.inBoundFeatures.length - 1\n      );\n      let nextFocus =\n        this._map.featureIndex.inBoundFeatures[\n          this._map.featureIndex.currentIndex\n        ];\n      nextFocus.path.focus();\n      this._map.closePopup();\n    },\n\n    getPCRSCenter: function () {\n      let bounds;\n      for (let l in this._layers) {\n        let layer = this._layers[l];\n        if (!bounds) {\n          bounds = L.bounds(layer.getPCRSCenter(), layer.getPCRSCenter());\n        } else {\n          bounds.extend(layer.getPCRSCenter());\n        }\n      }\n      return bounds.getCenter();\n    }\n  });\n\n  /**\n   * Returns new M.Geometry\n   * @param {M.Path[]} layers - Layers belonging to feature group\n   * @param {Object} options - Options for the feature group\n   * @returns {M.Geometry}\n   */\n  var geometry = function (layers, options) {\n    return new Geometry(layers, options);\n  };\n\n  var AnnounceMovement = L.Handler.extend({\n    addHooks: function () {\n      this._map.on({\n        layeradd: this.totalBounds,\n        layerremove: this.totalBounds\n      });\n\n      this._map.options.mapEl.addEventListener(\n        'map-moveend',\n        this.announceBounds\n      );\n      this._map.dragging._draggable.addEventListener('dragstart', this.dragged);\n      this._map.options.mapEl.addEventListener(\n        'mapfocused',\n        this.focusAnnouncement\n      );\n    },\n    removeHooks: function () {\n      this._map.off({\n        layeradd: this.totalBounds,\n        layerremove: this.totalBounds\n      });\n\n      this._map.options.mapEl.removeEventListener(\n        'map-moveend',\n        this.announceBounds\n      );\n      this._map.dragging._draggable.removeEventListener(\n        'dragstart',\n        this.dragged\n      );\n      this._map.options.mapEl.removeEventListener(\n        'mapfocused',\n        this.focusAnnouncement\n      );\n    },\n\n    focusAnnouncement: function () {\n      let mapEl = this;\n      setTimeout(function () {\n        let el = mapEl.querySelector('.mapml-web-map')\n          ? mapEl\n              .querySelector('.mapml-web-map')\n              .shadowRoot.querySelector('.leaflet-container')\n          : mapEl.shadowRoot.querySelector('.leaflet-container');\n\n        let mapZoom = mapEl._map.getZoom();\n        let standard = M.options.locale.amZoom + ' ' + mapZoom;\n\n        if (mapZoom === mapEl._map.getMaxZoom()) {\n          standard = M.options.locale.amMaxZoom + ' ' + standard;\n        } else if (mapZoom === mapEl._map._layersMinZoom) {\n          standard = M.options.locale.amMinZoom + ' ' + standard;\n        }\n\n        el.setAttribute('aria-roledescription', 'region ' + standard);\n        setTimeout(function () {\n          el.removeAttribute('aria-roledescription');\n        }, 2000);\n      }, 0);\n    },\n\n    announceBounds: function () {\n      if (this._traversalCall > 0) {\n        return;\n      }\n      let mapZoom = this._map.getZoom();\n      let mapBounds = M.pixelToPCRSBounds(\n        this._map.getPixelBounds(),\n        mapZoom,\n        this._map.options.projection\n      );\n\n      let visible = true;\n      if (this._map.totalLayerBounds) {\n        visible =\n          mapZoom <= this._map.getMaxZoom() &&\n          mapZoom >= this._map.getMinZoom() &&\n          this._map.totalLayerBounds.overlaps(mapBounds);\n      }\n\n      let output = this.querySelector('.mapml-web-map')\n        ? this.querySelector('.mapml-web-map').shadowRoot.querySelector(\n            '.mapml-screen-reader-output'\n          )\n        : this.shadowRoot.querySelector('.mapml-screen-reader-output');\n\n      let standard = M.options.locale.amZoom + ' ' + mapZoom;\n\n      if (!visible) {\n        let outOfBoundsPos = this._history[this._historyIndex];\n        let inBoundsPos = this._history[this._historyIndex - 1];\n        this.back();\n        this._history.pop();\n\n        if (outOfBoundsPos.zoom !== inBoundsPos.zoom) {\n          output.innerText = M.options.locale.amZoomedOut;\n        } else if (this._map.dragging._draggable.wasDragged) {\n          output.innerText = M.options.locale.amDraggedOut;\n        } else if (outOfBoundsPos.x > inBoundsPos.x) {\n          output.innerText = M.options.locale.amEastBound;\n        } else if (outOfBoundsPos.x < inBoundsPos.x) {\n          output.innerText = M.options.locale.amWestBound;\n        } else if (outOfBoundsPos.y < inBoundsPos.y) {\n          output.innerText = M.options.locale.amNorthBound;\n        } else if (outOfBoundsPos.y > inBoundsPos.y) {\n          output.innerText = M.options.locale.amSouthBound;\n        }\n      } else {\n        let prevZoom = this._history[this._historyIndex - 1]\n          ? this._history[this._historyIndex - 1].zoom\n          : this._history[this._historyIndex].zoom;\n        if (mapZoom === this._map.getMaxZoom() && mapZoom !== prevZoom) {\n          output.innerText = M.options.locale.amMaxZoom + ' ' + standard;\n        } else if (mapZoom === this._map._layersMinZoom && mapZoom !== prevZoom) {\n          output.innerText = M.options.locale.amMinZoom + ' ' + standard;\n        } else {\n          output.innerText = standard;\n        }\n      }\n      this._map.dragging._draggable.wasDragged = false;\n    },\n\n    totalBounds: function (e) {\n      // don't bother with non-MapMLLayer layers...\n      if (!e.layer._layerEl) return;\n      let map = this.options.mapEl;\n      map.whenLayersReady().then(() => {\n        let layers = map.querySelectorAll('layer-');\n        let bounds;\n        for (let i = 0; i < layers.length; i++) {\n          // the _layer may no longer exist if this is invoked by layerremove\n          if (layers[i]._layer) {\n            let extent = layers[i].extent;\n            if (bounds && extent) {\n              bounds.extend(M.extentToBounds(extent, 'pcrs'));\n            } else if (extent) {\n              bounds = M.extentToBounds(extent, 'pcrs');\n            }\n          }\n        }\n\n        this.totalLayerBounds = bounds;\n      });\n    },\n\n    dragged: function () {\n      this.wasDragged = true;\n    }\n  });\n\n  var FeatureIndex = L.Handler.extend({\n    initialize: function (map) {\n      L.Handler.prototype.initialize.call(this, map);\n      this.inBoundFeatures = [];\n      this.outBoundFeatures = [];\n      this.currentIndex = 0;\n      this._mapPCRSBounds = M.pixelToPCRSBounds(\n        map.getPixelBounds(),\n        map.getZoom(),\n        map.options.projection\n      );\n    },\n\n    addHooks: function () {\n      this._map.on('mapkeyboardfocused', this._updateMapBounds, this);\n      this._map.on('mapkeyboardfocused', this._sortIndex, this);\n    },\n\n    removeHooks: function () {\n      this._map.off('mapkeyboardfocused', this._updateMapBounds);\n      this._map.off('mapkeyboardfocused', this._sortIndex);\n    },\n\n    /**\n     * Adds a svg element to the index of tabbable features, it also keeps track of the layer it's associated + center\n     * @param layer - the layer object the feature is associated with\n     * @param lc - the layer center\n     * @param path - the svg element that needs to be focused, can be a path or g\n     */\n    addToIndex: function (layer, lc, path) {\n      let mc = this._mapPCRSBounds.getCenter();\n      let dist = Math.sqrt(Math.pow(lc.x - mc.x, 2) + Math.pow(lc.y - mc.y, 2));\n      let index = this._mapPCRSBounds.contains(lc)\n        ? this.inBoundFeatures\n        : this.outBoundFeatures;\n\n      let elem = { path: path, layer: layer, center: lc, dist: dist };\n      path.setAttribute('tabindex', -1);\n\n      index.push(elem);\n\n      // TODO: this insertion loop has potential to be improved slightly\n      for (\n        let i = index.length - 1;\n        i > 0 && index[i].dist < index[i - 1].dist;\n        i--\n      ) {\n        let tmp = index[i];\n        index[i] = index[i - 1];\n        index[i - 1] = tmp;\n      }\n\n      if (this._mapPCRSBounds.contains(lc)) this.inBoundFeatures = index;\n      else this.outBoundFeatures = index;\n    },\n\n    /**\n     * Removes features that are no longer on the map, also moves features to the respective array depending\n     * on whether the feature is in the maps viewport or not\n     */\n    cleanIndex: function () {\n      this.currentIndex = 0;\n      this.inBoundFeatures = this.inBoundFeatures.filter((elem) => {\n        let inbound = this._mapPCRSBounds.contains(elem.center);\n        elem.path.setAttribute('tabindex', -1);\n        if (elem.layer._map && !inbound) {\n          this.outBoundFeatures.push(elem);\n        }\n        return elem.layer._map && inbound;\n      });\n      this.outBoundFeatures = this.outBoundFeatures.filter((elem) => {\n        let inbound = this._mapPCRSBounds.contains(elem.center);\n        elem.path.setAttribute('tabindex', -1);\n        if (elem.layer._map && inbound) {\n          this.inBoundFeatures.push(elem);\n        }\n        return elem.layer._map && !inbound;\n      });\n    },\n\n    /**\n     * Sorts the index of features in the map's viewport based on distance from center\n     * @private\n     */\n    _sortIndex: function () {\n      this.cleanIndex();\n      if (this.inBoundFeatures.length === 0) return;\n\n      let mc = this._mapPCRSBounds.getCenter();\n\n      this.inBoundFeatures.sort(function (a, b) {\n        let ac = a.center;\n        let bc = b.center;\n        a.dist = Math.sqrt(Math.pow(ac.x - mc.x, 2) + Math.pow(ac.y - mc.y, 2));\n        b.dist = Math.sqrt(Math.pow(bc.x - mc.x, 2) + Math.pow(bc.y - mc.y, 2));\n        return a.dist - b.dist;\n      });\n      this.inBoundFeatures[0].path.setAttribute('tabindex', 0);\n    },\n\n    /**\n     * Event handler for 'mapfocused' event to update the map's bounds in terms of PCRS\n     * @param e - the event object\n     * @private\n     */\n    _updateMapBounds: function (e) {\n      // TODO: map's PCRS bounds is used in other parts of the viewer, can be moved out to the map object directly\n      this._mapPCRSBounds = M.pixelToPCRSBounds(\n        this._map.getPixelBounds(),\n        this._map.getZoom(),\n        this._map.options.projection\n      );\n    }\n  });\n\n  var Options = {\n    featureIndexOverlayOption: false,\n    announceMovement: false,\n    announceScale: { metric: true, imperial: false },\n    defaultExtCoor: 'pcrs',\n    defaultLocCoor: 'gcrs',\n    locale: {\n      cmBack: 'Back',\n      cmForward: 'Forward',\n      cmReload: 'Reload',\n      cmToggleControls: 'Toggle Controls',\n      cmCopyCoords: 'Copy',\n      cmCopyMapML: 'Map',\n      cmCopyExtent: 'Extent',\n      cmCopyLocation: 'Location',\n      cmToggleDebug: 'Toggle Debug Mode',\n      cmPasteLayer: 'Paste',\n      cmViewSource: 'View Map Source',\n      lmZoomToLayer: 'Zoom To Layer',\n      lmCopyLayer: 'Copy Layer',\n      lmZoomToExtent: 'Zoom To Sub-layer',\n      lmCopyExtent: 'Copy Sub-layer',\n      lcOpacity: 'Opacity',\n      btnAttribution: 'Map data attribution',\n      btnZoomIn: 'Zoom in',\n      btnZoomOut: 'Zoom out',\n      btnFullScreen: 'View Fullscreen',\n      btnExitFullScreen: 'Exit Fullscreen',\n      btnLocTrackOn: 'Show my location - location tracking on',\n      btnMyLocTrackOn: 'My current location, shown on map',\n      btnLocTrackOff: 'Show my location - location tracking off',\n      btnLocTrackLastKnown: 'Show my location - last known location shown',\n      btnMyLastKnownLocTrackOn: 'My last known location, shown on map',\n      amZoom: 'zoom level',\n      amColumn: 'column',\n      amRow: 'row',\n      amMaxZoom: 'At maximum zoom level, zoom in disabled',\n      amMinZoom: 'At minimum zoom level, zoom out disabled',\n      amZoomedOut: 'Zoomed out of bounds, returning to',\n      amDraggedOut: 'Dragged out of bounds, returning to',\n      amEastBound: 'Reached east bound, panning east disabled',\n      amWestBound: 'Reached west bound, panning west disabled',\n      amNorthBound: 'Reached north bound, panning north disabled',\n      amSouthBound: 'Reached south bound, panning south disabled',\n      kbdShortcuts: 'Keyboard shortcuts',\n      kbdMovement: 'Movement keys',\n      kbdFeature: 'Feature navigation keys',\n      kbdPanUp: 'Pan up',\n      kbdPanDown: 'Pan down',\n      kbdPanLeft: 'Pan left',\n      kbdPanRight: 'Pan right',\n      kbdPanIncrement: 'pan increment',\n      kbdZoom: 'Zoom in/out 3 levels',\n      kbdPrevFeature: 'Previous feature',\n      kbdNextFeature: 'Next feature',\n      dfLayer: 'Layer',\n      dfExtent: 'Sub-layer',\n      popupZoom: 'Zoom to here',\n      dfPastedLayer: 'Pasted layer',\n      fIndexNoFeatures: 'No features found'\n    }\n  };\n\n  L.Map.Keyboard.include({\n    _onKeyDown: function (e) {\n      if (e.altKey || e.metaKey) {\n        return;\n      }\n\n      let zoomIn = {\n        187: 187,\n        107: 107,\n        61: 61,\n        171: 171\n      };\n\n      let zoomOut = {\n        189: 189,\n        109: 109,\n        54: 54,\n        173: 173\n      };\n\n      var key = e.keyCode,\n        map = this._map,\n        offset;\n\n      if (key in this._panKeys) {\n        if (!map._panAnim || !map._panAnim._inProgress) {\n          offset = this._panKeys[key];\n          if (e.shiftKey) {\n            offset = L.point(offset).multiplyBy(3);\n          }\n          if (e.ctrlKey) {\n            offset = L.point(offset).divideBy(5);\n          }\n\n          map.panBy(offset);\n\n          if (map.options.maxBounds) {\n            map.panInsideBounds(map.options.maxBounds);\n          }\n        }\n      } else if (key in this._zoomKeys) {\n        if (\n          (key in zoomIn && map.getMaxZoom() !== map.getZoom()) ||\n          (key in zoomOut && map._layersMinZoom !== map.getZoom())\n        )\n          map.setZoom(map.getZoom() + (e.shiftKey ? 3 : 1) * this._zoomKeys[key]);\n      } else if (\n        key === 27 &&\n        map._popup &&\n        map._popup.options.closeOnEscapeKey\n      ) {\n        map.closePopup();\n      } else {\n        return;\n      }\n\n      L.DomEvent.stop(e);\n    }\n  });\n\n  var FeatureIndexOverlay = L.Layer.extend({\n    onAdd: function (map) {\n      let svgInnerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" viewBox=\"0 0 100 100\"><path fill=\"none\" stroke=\"#000\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"3\" d=\"M0 0h100v100H0z\" color=\"#000\" overflow=\"visible\"/></svg>`;\n\n      this._container = L.DomUtil.create(\n        'div',\n        'mapml-feature-index-box',\n        map._container\n      );\n      this._container.innerHTML = svgInnerHTML;\n\n      this._output = L.DomUtil.create(\n        'output',\n        'mapml-feature-index',\n        map._container\n      );\n      this._output.setAttribute('role', 'status');\n      this._output.setAttribute('aria-live', 'polite');\n      this._output.setAttribute('aria-atomic', 'true');\n      this._body = L.DomUtil.create(\n        'span',\n        'mapml-feature-index-content',\n        this._output\n      );\n      this._body.index = 0;\n      this._output.initialFocus = false;\n      map.on('focus blur popupclose', this._addOrRemoveFeatureIndex, this);\n      map.on('moveend focus templatedfeatureslayeradd', this._checkOverlap, this);\n      map.on('keydown', this._onKeyDown, this);\n      this._addOrRemoveFeatureIndex();\n    },\n\n    _calculateReticleBounds: function () {\n      let bounds = this._map.getPixelBounds();\n      let center = bounds.getCenter();\n      let wRatio =\n        Math.abs(bounds.min.x - bounds.max.x) / this._map.options.mapEl.width;\n      let hRatio =\n        Math.abs(bounds.min.y - bounds.max.y) / this._map.options.mapEl.height;\n\n      let reticleDimension = getComputedStyle(this._container).width.replace(\n        /[^\\d.]/g,\n        ''\n      );\n      if (getComputedStyle(this._container).width.slice(-1) === '%') {\n        reticleDimension =\n          (reticleDimension * this._map.options.mapEl.width) / 100;\n      }\n      let w = (wRatio * reticleDimension) / 2;\n      let h = (hRatio * reticleDimension) / 2;\n      let minPoint = L.point(center.x - w, center.y + h);\n      let maxPoint = L.point(center.x + w, center.y - h);\n      let b = L.bounds(minPoint, maxPoint);\n      return M.pixelToPCRSBounds(\n        b,\n        this._map.getZoom(),\n        this._map.options.projection\n      );\n    },\n\n    _checkOverlap: function (e) {\n      if (e.type === 'focus') this._output.initialFocus = true;\n      if (!this._output.initialFocus) return;\n      if (this._output.popupClosed) {\n        this._output.popupClosed = false;\n        return;\n      }\n\n      this._map.fire('mapkeyboardfocused');\n\n      let featureIndexBounds = this._calculateReticleBounds();\n      let features = this._map.featureIndex.inBoundFeatures;\n      let index = 1;\n      let keys = Object.keys(features);\n      let body = this._body;\n      let noFeaturesMessage = document.createElement('span');\n      noFeaturesMessage.innerHTML = M.options.locale.fIndexNoFeatures;\n\n      body.innerHTML = '';\n      body.index = 0;\n\n      body.allFeatures = [];\n      keys.forEach((i) => {\n        let layer = features[i].layer;\n        let layers = features[i].layer._layers;\n        let bounds = L.bounds();\n\n        if (layers) {\n          let keys = Object.keys(layers);\n          keys.forEach((j) => {\n            if (!bounds)\n              bounds = L.bounds(\n                layer._layers[j]._bounds.min,\n                layer._layers[j]._bounds.max\n              );\n            bounds.extend(layer._layers[j]._bounds.min);\n            bounds.extend(layer._layers[j]._bounds.max);\n          });\n        } else if (layer._bounds) {\n          bounds = L.bounds(layer._bounds.min, layer._bounds.max);\n        }\n\n        if (featureIndexBounds.overlaps(bounds)) {\n          let label = features[i].path.getAttribute('aria-label');\n\n          if (index < 8) {\n            body.appendChild(this._updateOutput(label, index, index));\n          }\n          if (index % 7 === 0 || index === 1) {\n            body.allFeatures.push([]);\n          }\n          body.allFeatures[Math.floor((index - 1) / 7)].push({\n            label,\n            index,\n            layer\n          });\n          if (body.allFeatures[1] && body.allFeatures[1].length === 1) {\n            body.appendChild(this._updateOutput('More results', 0, 9));\n          }\n          index += 1;\n        }\n      });\n      this._addToggleKeys();\n      if (index === 1) {\n        body.appendChild(noFeaturesMessage);\n      }\n    },\n\n    _updateOutput: function (label, index, key) {\n      let span = document.createElement('span');\n      span.setAttribute('data-index', index);\n      //\", \" adds a brief auditory pause when a screen reader is reading through the feature index\n      //also prevents names with numbers + key from being combined when read\n      span.innerHTML = `<kbd>${key}</kbd>` + ' ' + label + '<span>, </span>';\n      return span;\n    },\n\n    _addToggleKeys: function () {\n      let allFeatures = this._body.allFeatures;\n      for (let i = 0; i < allFeatures.length; i++) {\n        if (allFeatures[i].length === 0) return;\n        if (allFeatures[i - 1]) {\n          let label = 'Previous results';\n          allFeatures[i].push({ label });\n        }\n\n        if (allFeatures[i + 1] && allFeatures[i + 1].length > 0) {\n          let label = 'More results';\n          allFeatures[i].push({ label });\n        }\n      }\n    },\n\n    _onKeyDown: function (e) {\n      let body = this._body;\n      let key = e.originalEvent.keyCode;\n      if (key >= 49 && key <= 55) {\n        if (!body.allFeatures[body.index]) return;\n        let feature = body.allFeatures[body.index][key - 49];\n        if (!feature) return;\n        let layer = feature.layer;\n        if (layer) {\n          this._map.featureIndex.currentIndex = feature.index - 1;\n          if (layer._popup) {\n            this._map.closePopup();\n            layer.openPopup();\n          } else layer.options.group.focus();\n        }\n      } else if (key === 56) {\n        this._newContent(body, -1);\n      } else if (key === 57) {\n        this._newContent(body, 1);\n      }\n    },\n\n    _newContent: function (body, direction) {\n      let index = body.firstChild.getAttribute('data-index');\n      let newContent = body.allFeatures[Math.floor((index - 1) / 7 + direction)];\n      if (newContent && newContent.length > 0) {\n        body.innerHTML = '';\n        body.index += direction;\n        for (let i = 0; i < newContent.length; i++) {\n          let feature = newContent[i];\n          let index = feature.index ? feature.index : 0;\n          let key = i + 1;\n          if (feature.label === 'More results') key = 9;\n          if (feature.label === 'Previous results') key = 8;\n          body.appendChild(this._updateOutput(feature.label, index, key));\n        }\n      }\n    },\n\n    _addOrRemoveFeatureIndex: function (e) {\n      //Toggle aria-hidden attribute so screen reader rereads the feature index on focus\n      if (!this._output.initialFocus) {\n        this._output.setAttribute('aria-hidden', 'true');\n      } else if (this._output.hasAttribute('aria-hidden')) {\n        let obj = this;\n        setTimeout(function () {\n          obj._output.removeAttribute('aria-hidden');\n        }, 100);\n      }\n\n      if (e && e.type === 'popupclose') {\n        this._output.setAttribute('aria-hidden', 'true');\n        this._output.popupClosed = true;\n      } else if (e && e.type === 'focus') {\n        this._container.removeAttribute('hidden');\n        this._output.classList.remove('mapml-screen-reader-output');\n        // this is a very subtle branch.  The event that gets handled below is a blur\n        // event, which happens to have the e.target._popup property\n        // when there will be a popup.  Because blur gets handled here, it doesn't\n        // get handled in the next else if block, which would hide both the reticle\n        // and the index menu, and then recursively call this method with no event\n        // argument, which manipulates the aria-hidden attribute on the output\n        // in order to have the screenreader read its contents when the focus returns\n        // to (what exactly???).\n      } else if (e && e.target._popup) {\n        this._container.setAttribute('hidden', '');\n      } else if (e && e.type === 'blur') {\n        this._container.setAttribute('hidden', '');\n        this._output.classList.add('mapml-screen-reader-output');\n        this._output.initialFocus = false;\n        this._addOrRemoveFeatureIndex();\n      } else {\n        // this is the default block, called when no event is passed (recursive call)\n        this._container.setAttribute('hidden', '');\n        this._output.classList.add('mapml-screen-reader-output');\n      }\n    }\n  });\n\n  var featureIndexOverlay = function (options) {\n    return new FeatureIndexOverlay(options);\n  };\n\n  var createLayerControlExtentHTML = function () {\n    var extent = L.DomUtil.create('fieldset', 'mapml-layer-extent'),\n      extentProperties = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-properties',\n        extent\n      ),\n      extentSettings = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-settings',\n        extent\n      ),\n      extentLabel = L.DomUtil.create(\n        'label',\n        'mapml-layer-item-toggle',\n        extentProperties\n      ),\n      input = L.DomUtil.create('input'),\n      svgExtentControlIcon = L.SVG.create('svg'),\n      extentControlPath1 = L.SVG.create('path'),\n      extentControlPath2 = L.SVG.create('path'),\n      extentNameIcon = L.DomUtil.create('span'),\n      extentItemControls = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-controls',\n        extentProperties\n      ),\n      opacityControl = L.DomUtil.create(\n        'details',\n        'mapml-layer-item-details mapml-control-layers',\n        extentSettings\n      ),\n      extentOpacitySummary = L.DomUtil.create('summary', '', opacityControl),\n      mapEl = this.getMapEl(),\n      layerEl = this.getLayerEl(),\n      opacity = L.DomUtil.create('input', '', opacityControl);\n    extentSettings.hidden = true;\n    extent.setAttribute('aria-grabbed', 'false');\n\n    // append the svg paths\n    svgExtentControlIcon.setAttribute('viewBox', '0 0 24 24');\n    svgExtentControlIcon.setAttribute('height', '22');\n    svgExtentControlIcon.setAttribute('width', '22');\n    extentControlPath1.setAttribute('d', 'M0 0h24v24H0z');\n    extentControlPath1.setAttribute('fill', 'none');\n    extentControlPath2.setAttribute(\n      'd',\n      'M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z'\n    );\n    svgExtentControlIcon.appendChild(extentControlPath1);\n    svgExtentControlIcon.appendChild(extentControlPath2);\n\n    let mapSelects = this.querySelectorAll('map-select');\n    if (mapSelects.length) {\n      var frag = document.createDocumentFragment();\n      for (var i = 0; i < mapSelects.length; i++) {\n        frag.appendChild(mapSelects[i].selectdetails);\n      }\n      extentSettings.appendChild(frag);\n    }\n\n    let removeExtentButton = L.DomUtil.create(\n      'button',\n      'mapml-layer-item-remove-control',\n      extentItemControls\n    );\n    removeExtentButton.type = 'button';\n    removeExtentButton.title = 'Remove Sub Layer';\n    removeExtentButton.innerHTML = \"<span aria-hidden='true'>&#10005;</span>\";\n    removeExtentButton.classList.add('mapml-button');\n    removeExtentButton.addEventListener('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.remove();\n    });\n\n    let extentsettingsButton = L.DomUtil.create(\n      'button',\n      'mapml-layer-item-settings-control',\n      extentItemControls\n    );\n    extentsettingsButton.type = 'button';\n    extentsettingsButton.title = 'Extent Settings';\n    extentsettingsButton.setAttribute('aria-expanded', false);\n    extentsettingsButton.classList.add('mapml-button');\n    L.DomEvent.on(\n      extentsettingsButton,\n      'click',\n      (e) => {\n        if (extentSettings.hidden === true) {\n          extentsettingsButton.setAttribute('aria-expanded', true);\n          extentSettings.hidden = false;\n        } else {\n          extentsettingsButton.setAttribute('aria-expanded', false);\n          extentSettings.hidden = true;\n        }\n      },\n      this\n    );\n\n    extentNameIcon.setAttribute('aria-hidden', true);\n    extentLabel.appendChild(input);\n    extentsettingsButton.appendChild(extentNameIcon);\n    extentNameIcon.appendChild(svgExtentControlIcon);\n    extentOpacitySummary.innerText = 'Opacity';\n    extentOpacitySummary.id =\n      'mapml-extent-item-opacity-' + L.stamp(extentOpacitySummary);\n    opacity.setAttribute('type', 'range');\n    opacity.setAttribute('min', '0');\n    opacity.setAttribute('max', '1.0');\n    opacity.setAttribute('step', '0.1');\n    opacity.setAttribute(\n      'aria-labelledby',\n      'mapml-extent-item-opacity-' + L.stamp(extentOpacitySummary)\n    );\n    const changeOpacity = function (e) {\n      if (e && e.target && e.target.value >= 0 && e.target.value <= 1.0) {\n        this._extentLayer.changeOpacity(e.target.value);\n      }\n    };\n    opacity.setAttribute('value', this.opacity);\n    opacity.value = this._extentLayer._container.style.opacity || '1.0';\n    opacity.addEventListener('change', changeOpacity.bind(this));\n\n    var extentItemNameSpan = L.DomUtil.create(\n      'span',\n      'mapml-extent-item-name',\n      extentLabel\n    );\n    input.type = 'checkbox';\n    input.defaultChecked = this.checked;\n    extentItemNameSpan.innerHTML = this.label;\n    const changeCheck = function () {\n      this.checked = !this.checked;\n    };\n    // save for later access by API\n    this._layerControlCheckbox = input;\n    input.addEventListener('change', changeCheck.bind(this));\n    extentItemNameSpan.id =\n      'mapml-extent-item-name-{' + L.stamp(extentItemNameSpan) + '}';\n    extent.setAttribute('aria-labelledby', extentItemNameSpan.id);\n    extentItemNameSpan.extent = this;\n\n    extent.ontouchstart = extent.onmousedown = (downEvent) => {\n      if (\n        (downEvent.target.parentElement.tagName.toLowerCase() === 'label' &&\n          downEvent.target.tagName.toLowerCase() !== 'input') ||\n        downEvent.target.tagName.toLowerCase() === 'label'\n      ) {\n        downEvent.stopPropagation();\n        downEvent =\n          downEvent instanceof TouchEvent ? downEvent.touches[0] : downEvent;\n\n        let control = extent,\n          controls = extent.parentNode,\n          moving = false,\n          yPos = downEvent.clientY,\n          originalPosition = Array.from(\n            extent.parentElement.querySelectorAll('fieldset')\n          ).indexOf(extent);\n\n        document.body.ontouchmove = document.body.onmousemove = (moveEvent) => {\n          moveEvent.preventDefault();\n          moveEvent =\n            moveEvent instanceof TouchEvent ? moveEvent.touches[0] : moveEvent;\n\n          // Fixes flickering by only moving element when there is enough space\n          let offset = moveEvent.clientY - yPos;\n          moving = Math.abs(offset) > 15 || moving;\n          if (\n            (controls && !moving) ||\n            (controls && controls.childElementCount <= 1) ||\n            controls.getBoundingClientRect().top >\n              control.getBoundingClientRect().bottom ||\n            controls.getBoundingClientRect().bottom <\n              control.getBoundingClientRect().top\n          ) {\n            return;\n          }\n\n          controls.classList.add('mapml-draggable');\n          control.style.transform = 'translateY(' + offset + 'px)';\n          control.style.pointerEvents = 'none';\n\n          let x = moveEvent.clientX,\n            y = moveEvent.clientY,\n            root =\n              mapEl.tagName === 'MAPML-VIEWER'\n                ? mapEl.shadowRoot\n                : mapEl.querySelector('.mapml-web-map').shadowRoot,\n            elementAt = root.elementFromPoint(x, y),\n            swapControl =\n              !elementAt || !elementAt.closest('fieldset')\n                ? control\n                : elementAt.closest('fieldset');\n\n          swapControl =\n            Math.abs(offset) <= swapControl.offsetHeight ? control : swapControl;\n\n          control.setAttribute('aria-grabbed', 'true');\n          control.setAttribute('aria-dropeffect', 'move');\n          if (swapControl && controls === swapControl.parentNode) {\n            swapControl =\n              swapControl !== control.nextSibling\n                ? swapControl\n                : swapControl.nextSibling;\n            if (control !== swapControl) {\n              yPos = moveEvent.clientY;\n              control.style.transform = null;\n            }\n            controls.insertBefore(control, swapControl);\n          }\n        };\n\n        document.body.ontouchend = document.body.onmouseup = () => {\n          let newPosition = Array.from(\n            extent.parentElement.querySelectorAll('fieldset')\n          ).indexOf(extent);\n          control.setAttribute('aria-grabbed', 'false');\n          control.removeAttribute('aria-dropeffect');\n          control.style.pointerEvents = null;\n          control.style.transform = null;\n          if (originalPosition !== newPosition) {\n            let controlsElems = controls.children,\n              zIndex = 0;\n            for (let c of controlsElems) {\n              let extentEl = c.querySelector('span').extent;\n\n              extentEl.setAttribute('data-moving', '');\n              const node = layerEl.src ? layerEl.shadowRoot : layerEl;\n              node.append(extentEl);\n              extentEl.removeAttribute('data-moving');\n\n              extentEl.extentZIndex = zIndex;\n              extentEl._extentLayer.setZIndex(zIndex);\n              zIndex++;\n            }\n          }\n          controls.classList.remove('mapml-draggable');\n          document.body.ontouchmove =\n            document.body.onmousemove =\n            document.body.ontouchend =\n            document.body.onmouseup =\n              null;\n        };\n      }\n    };\n    this._extentRootFieldset = extent;\n    this._opacitySlider = opacity;\n    this._opacityControl = opacityControl;\n    this._layerControlLabel = extentLabel;\n    return extent;\n  };\n\n  var createLayerControlHTML = async function () {\n    var fieldset = L.DomUtil.create('fieldset', 'mapml-layer-item'),\n      input = L.DomUtil.create('input'),\n      layerItemName = L.DomUtil.create('span', 'mapml-layer-item-name'),\n      settingsButtonNameIcon = L.DomUtil.create('span'),\n      layerItemProperty = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-properties',\n        fieldset\n      ),\n      layerItemSettings = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-settings',\n        fieldset\n      ),\n      itemToggleLabel = L.DomUtil.create(\n        'label',\n        'mapml-layer-item-toggle',\n        layerItemProperty\n      ),\n      layerItemControls = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-controls',\n        layerItemProperty\n      ),\n      opacityControl = L.DomUtil.create(\n        'details',\n        'mapml-layer-item-opacity mapml-control-layers',\n        layerItemSettings\n      ),\n      opacity = L.DomUtil.create('input'),\n      opacityControlSummary = L.DomUtil.create('summary'),\n      svgSettingsControlIcon = L.SVG.create('svg'),\n      settingsControlPath1 = L.SVG.create('path'),\n      settingsControlPath2 = L.SVG.create('path'),\n      extentsFieldset = L.DomUtil.create(\n        'fieldset',\n        'mapml-layer-grouped-extents'\n      ),\n      mapEl = this.parentNode;\n\n    // append the paths in svg for the remove layer and toggle icons\n    svgSettingsControlIcon.setAttribute('viewBox', '0 0 24 24');\n    svgSettingsControlIcon.setAttribute('height', '22');\n    svgSettingsControlIcon.setAttribute('width', '22');\n    svgSettingsControlIcon.setAttribute('fill', 'currentColor');\n    settingsControlPath1.setAttribute('d', 'M0 0h24v24H0z');\n    settingsControlPath1.setAttribute('fill', 'none');\n    settingsControlPath2.setAttribute(\n      'd',\n      'M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z'\n    );\n    svgSettingsControlIcon.appendChild(settingsControlPath1);\n    svgSettingsControlIcon.appendChild(settingsControlPath2);\n\n    layerItemSettings.hidden = true;\n    settingsButtonNameIcon.setAttribute('aria-hidden', true);\n\n    let removeControlButton = L.DomUtil.create(\n      'button',\n      'mapml-layer-item-remove-control',\n      layerItemControls\n    );\n    removeControlButton.type = 'button';\n    removeControlButton.title = 'Remove Layer';\n    removeControlButton.innerHTML = \"<span aria-hidden='true'>&#10005;</span>\";\n    removeControlButton.classList.add('mapml-button');\n    L.DomEvent.on(removeControlButton, 'click', L.DomEvent.stop);\n    L.DomEvent.on(\n      removeControlButton,\n      'click',\n      (e) => {\n        let fieldset = 0,\n          elem,\n          root;\n        root =\n          mapEl.tagName === 'MAPML-VIEWER'\n            ? mapEl.shadowRoot\n            : mapEl.querySelector('.mapml-web-map').shadowRoot;\n        if (\n          e.target.closest('fieldset').nextElementSibling &&\n          !e.target.closest('fieldset').nextElementSibling.disbaled\n        ) {\n          elem = e.target.closest('fieldset').previousElementSibling;\n          while (elem) {\n            fieldset += 2; // find the next layer menu item\n            elem = elem.previousElementSibling;\n          }\n        } else {\n          // focus on the link\n          elem = 'link';\n        }\n        mapEl.removeChild(\n          e.target.closest('fieldset').querySelector('span').layer._layerEl\n        );\n        elem = elem\n          ? root.querySelector('.leaflet-control-attribution').firstElementChild\n          : (elem = root.querySelectorAll('input')[fieldset]);\n        elem.focus();\n      },\n      this._layer\n    );\n\n    let itemSettingControlButton = L.DomUtil.create(\n      'button',\n      'mapml-layer-item-settings-control',\n      layerItemControls\n    );\n    itemSettingControlButton.type = 'button';\n    itemSettingControlButton.title = 'Layer Settings';\n    itemSettingControlButton.setAttribute('aria-expanded', false);\n    itemSettingControlButton.classList.add('mapml-button');\n    L.DomEvent.on(\n      itemSettingControlButton,\n      'click',\n      (e) => {\n        let layerControl = this._layer._layerEl._layerControl._container;\n        if (!layerControl._isExpanded && e.pointerType === 'touch') {\n          layerControl._isExpanded = true;\n          return;\n        }\n        if (layerItemSettings.hidden === true) {\n          itemSettingControlButton.setAttribute('aria-expanded', true);\n          layerItemSettings.hidden = false;\n        } else {\n          itemSettingControlButton.setAttribute('aria-expanded', false);\n          layerItemSettings.hidden = true;\n        }\n      },\n      this._layer\n    );\n\n    input.defaultChecked = this.checked;\n    input.type = 'checkbox';\n    input.setAttribute('class', 'leaflet-control-layers-selector');\n    layerItemName.layer = this._layer;\n    const changeCheck = function () {\n      this.checked = !this.checked;\n    };\n    input.addEventListener('change', changeCheck.bind(this));\n    if (this._layer._legendUrl) {\n      var legendLink = document.createElement('a');\n      legendLink.text = ' ' + this._layer._title;\n      legendLink.href = this._layer._legendUrl;\n      legendLink.target = '_blank';\n      legendLink.draggable = false;\n      layerItemName.appendChild(legendLink);\n    } else {\n      layerItemName.innerHTML = this._layer._title;\n    }\n    layerItemName.id = 'mapml-layer-item-name-{' + L.stamp(layerItemName) + '}';\n    opacityControlSummary.innerText = 'Opacity';\n    opacityControlSummary.id =\n      'mapml-layer-item-opacity-' + L.stamp(opacityControlSummary);\n    opacityControl.appendChild(opacityControlSummary);\n    opacityControl.appendChild(opacity);\n    opacity.setAttribute('type', 'range');\n    opacity.setAttribute('min', '0');\n    opacity.setAttribute('max', '1.0');\n    opacity.setAttribute('value', this._layer._container.style.opacity || '1.0');\n    opacity.setAttribute('step', '0.1');\n    opacity.setAttribute(\n      'aria-labelledby',\n      'mapml-layer-item-opacity-' + L.stamp(opacityControlSummary)\n    );\n\n    const changeOpacity = function (e) {\n      if (e && e.target && e.target.value >= 0 && e.target.value <= 1.0) {\n        this._layer.changeOpacity(e.target.value);\n      }\n    };\n    opacity.value = this._layer._container.style.opacity || '1.0';\n    opacity.addEventListener('change', changeOpacity.bind(this));\n\n    fieldset.setAttribute('aria-grabbed', 'false');\n    fieldset.setAttribute('aria-labelledby', layerItemName.id);\n\n    fieldset.ontouchstart = fieldset.onmousedown = (downEvent) => {\n      if (\n        (downEvent.target.parentElement.tagName.toLowerCase() === 'label' &&\n          downEvent.target.tagName.toLowerCase() !== 'input') ||\n        downEvent.target.tagName.toLowerCase() === 'label'\n      ) {\n        downEvent =\n          downEvent instanceof TouchEvent ? downEvent.touches[0] : downEvent;\n        let control = fieldset,\n          controls = fieldset.parentNode,\n          moving = false,\n          yPos = downEvent.clientY,\n          originalPosition = Array.from(\n            controls.querySelectorAll('fieldset')\n          ).indexOf(fieldset);\n\n        document.body.ontouchmove = document.body.onmousemove = (moveEvent) => {\n          moveEvent.preventDefault();\n          moveEvent =\n            moveEvent instanceof TouchEvent ? moveEvent.touches[0] : moveEvent;\n\n          // Fixes flickering by only moving element when there is enough space\n          let offset = moveEvent.clientY - yPos;\n          moving = Math.abs(offset) > 15 || moving;\n          if (\n            (controls && !moving) ||\n            (controls && controls.childElementCount <= 1) ||\n            controls.getBoundingClientRect().top >\n              control.getBoundingClientRect().bottom ||\n            controls.getBoundingClientRect().bottom <\n              control.getBoundingClientRect().top\n          ) {\n            return;\n          }\n\n          controls.classList.add('mapml-draggable');\n          control.style.transform = 'translateY(' + offset + 'px)';\n          control.style.pointerEvents = 'none';\n\n          let x = moveEvent.clientX,\n            y = moveEvent.clientY,\n            root =\n              mapEl.tagName === 'MAPML-VIEWER'\n                ? mapEl.shadowRoot\n                : mapEl.querySelector('.mapml-web-map').shadowRoot,\n            elementAt = root.elementFromPoint(x, y),\n            swapControl =\n              !elementAt || !elementAt.closest('fieldset')\n                ? control\n                : elementAt.closest('fieldset');\n\n          swapControl =\n            Math.abs(offset) <= swapControl.offsetHeight ? control : swapControl;\n\n          control.setAttribute('aria-grabbed', 'true');\n          control.setAttribute('aria-dropeffect', 'move');\n          if (swapControl && controls === swapControl.parentNode) {\n            swapControl =\n              swapControl !== control.nextSibling\n                ? swapControl\n                : swapControl.nextSibling;\n            if (control !== swapControl) {\n              yPos = moveEvent.clientY;\n              control.style.transform = null;\n            }\n            controls.insertBefore(control, swapControl);\n          }\n        };\n\n        document.body.ontouchend = document.body.onmouseup = () => {\n          let newPosition = Array.from(\n            controls.querySelectorAll('fieldset')\n          ).indexOf(fieldset);\n          control.setAttribute('aria-grabbed', 'false');\n          control.removeAttribute('aria-dropeffect');\n          control.style.pointerEvents = null;\n          control.style.transform = null;\n          if (originalPosition !== newPosition) {\n            let controlsElems = controls.children,\n              zIndex = 1;\n            // re-order layer elements DOM order\n            for (let c of controlsElems) {\n              let layerEl = c.querySelector('span').layer._layerEl;\n              layerEl.setAttribute('data-moving', '');\n              mapEl.insertAdjacentElement('beforeend', layerEl);\n              layerEl.removeAttribute('data-moving');\n            }\n            // update zIndex of all layer- elements\n            let layers = mapEl.querySelectorAll('layer-');\n            for (let i = 0; i < layers.length; i++) {\n              let layer = layers[i]._layer;\n              if (layer.options.zIndex !== zIndex) {\n                layer.setZIndex(zIndex);\n              }\n              zIndex++;\n            }\n          }\n          controls.classList.remove('mapml-draggable');\n          document.body.ontouchmove =\n            document.body.onmousemove =\n            document.body.onmouseup =\n              null;\n        };\n      }\n    };\n\n    itemToggleLabel.appendChild(input);\n    itemToggleLabel.appendChild(layerItemName);\n    itemSettingControlButton.appendChild(settingsButtonNameIcon);\n    settingsButtonNameIcon.appendChild(svgSettingsControlIcon);\n\n    let mapml = this.src ? this.shadowRoot : this;\n    var styleLinks = mapml.querySelectorAll(\n      'map-link[rel=style],map-link[rel=\"self style\"],map-link[rel=\"style self\"]'\n    );\n    let styles;\n    if (styleLinks) {\n      styles = this.getAlternateStyles(styleLinks);\n      if (styles) {\n        layerItemSettings.appendChild(styles);\n      }\n    }\n\n    this._layerControlCheckbox = input;\n    this._layerControlLabel = itemToggleLabel;\n    this._opacityControl = opacityControl;\n    this._opacitySlider = opacity;\n    this._layerControlHTML = fieldset;\n    this._layerItemSettingsHTML = layerItemSettings;\n    this._propertiesGroupAnatomy = extentsFieldset;\n    this._styles = styles;\n    extentsFieldset.setAttribute('aria-label', 'Sublayers');\n    extentsFieldset.setAttribute('hidden', '');\n    let mapExtents = mapml.querySelectorAll('map-extent:not([hidden])');\n    let mapExtentLayerControls = [];\n    for (let i = 0; i < mapExtents.length; i++) {\n      mapExtentLayerControls.push(mapExtents[i].whenReady());\n      // if any map-extent is not hidden, the parent fieldset should not be hidden\n      extentsFieldset.removeAttribute('hidden');\n    }\n    await Promise.all(mapExtentLayerControls);\n    for (let i = 0; i < mapExtents.length; i++) {\n      extentsFieldset.appendChild(mapExtents[i].getLayerControlHTML());\n    }\n    layerItemSettings.appendChild(extentsFieldset);\n    return this._layerControlHTML;\n  };\n\n  class ZoomInput {\n    constructor(name, min, max, value, step, layer) {\n      this.name = name;\n      this.min = min;\n      this.max = max;\n      this.value = value;\n      this.step = step;\n      this.layer = layer;\n    }\n\n    validateInput() {\n      // name is required\n      if (!this.name) {\n        return false;\n      }\n      // min and max can not be present\n      // fallback would be layer's meta, -> projection min, max\n      // don't need value, map-meta max value, -> fallback is max zoom of projection\n      // don't need step, defaults to 1\n      return true;\n    }\n\n    getValue() {\n      return this.layer._map.options.mapEl.zoom;\n    }\n  }\n\n  class HiddenInput {\n    constructor(name, value) {\n      this.name = name;\n      this.value = value;\n    }\n\n    validateInput() {\n      // name is required\n      // value is required\n      if (!this.name || !this.value) {\n        return false;\n      }\n      return true;\n    }\n\n    getValue() {\n      return this.value;\n    }\n  }\n\n  class WidthInput {\n    constructor(name, layer) {\n      this.name = name;\n      this.layer = layer;\n    }\n\n    validateInput() {\n      // name is required\n      if (!this.name) {\n        return false;\n      }\n      return true;\n    }\n\n    getValue() {\n      return this.layer._map.getSize().x;\n    }\n  }\n\n  class HeightInput {\n    constructor(name, layer) {\n      this.name = name;\n      this.layer = layer;\n    }\n\n    validateInput() {\n      // name is required\n      if (!this.name) {\n        return false;\n      }\n      return true;\n    }\n\n    getValue() {\n      return this.layer._map.getSize().y;\n    }\n  }\n\n  class LocationInput {\n    constructor(name, position, axis, units, min, max, rel, layer) {\n      this.name = name;\n      this.position = position;\n      this.axis = axis;\n      // if unit/cs not present, find it\n      if (!units && axis && !['i', 'j'].includes(axis)) {\n        this.units = M.axisToCS(axis).toLowerCase();\n      } else {\n        this.units = units; // cs\n      }\n      this.min = min;\n      this.max = max;\n      this.rel = rel;\n      this.layer = layer;\n    }\n\n    validateInput() {\n      // name is required\n      // axis is required\n      if (!this.name || !this.axis) {\n        return false;\n      }\n      // cs/units is only required when the axis is i/j. To differentiate between the units/cs\n      if (\n        (this.axis === 'i' || this.axis === 'j') &&\n        !['map', 'tile'].includes(this.units)\n      ) {\n        return false;\n      }\n      // check if axis match the units/cs\n      if (this.units) {\n        let axisCS = M.axisToCS(this.axis);\n        if (\n          typeof axisCS === 'string' &&\n          axisCS.toUpperCase() !== this.units.toUpperCase()\n        ) {\n          return false;\n        }\n      }\n      // position is not required, will default to top-left\n      // min max fallbacks, map-meta -> projection\n      // rel not required, default is image/extent\n      return true;\n    }\n\n    _TCRSToPCRS(coords, zoom) {\n      // TCRS pixel point to Projected CRS point (in meters, presumably)\n      var map = this.layer._map,\n        crs = map.options.crs,\n        loc = crs.transformation.untransform(coords, crs.scale(zoom));\n      return loc;\n    }\n\n    getValue(zoom = undefined, bounds = undefined) {\n      // units = cs\n      //<input name=\"...\" units=\"pcrs\" type=\"location\" position=\"top|bottom-left|right\" axis=\"northing|easting|latitude|longitude\">\n      if (zoom === undefined) zoom = this.layer._map.getZoom();\n      if (bounds === undefined) bounds = this.layer._map.getPixelBounds();\n\n      if (this.units === 'pcrs' || this.units === 'gcrs') {\n        switch (this.axis) {\n          case 'longitude':\n          case 'easting':\n            if (this.position) {\n              if (this.position.match(/.*?-left/i)) {\n                return this._TCRSToPCRS(bounds.min, zoom).x;\n              } else if (this.position.match(/.*?-right/i)) {\n                return this._TCRSToPCRS(bounds.max, zoom).x;\n              }\n            } else {\n              // position is not required, will default to top-left\n              return this._TCRSToPCRS(bounds.min, zoom).x;\n            }\n            break;\n          case 'latitude':\n          case 'northing':\n            if (this.position) {\n              if (this.position.match(/top-.*?/i)) {\n                return this._TCRSToPCRS(bounds.min, zoom).y;\n              } else if (this.position.match(/bottom-.*?/i)) {\n                return this._TCRSToPCRS(bounds.max, zoom).y;\n              }\n            } else {\n              // position is not required, will default to top-left\n              return this._TCRSToPCRS(bounds.min, zoom).y;\n            }\n            break;\n        }\n      } else if (this.units === 'tilematrix') {\n        // Value is retrieved from the createTile method of TemplatedTileLayer, on move end.\n        // Different values for each tile when filling in the map tiles on the map.\n        // Currently storing all x,y,z within one object,\n        // TODO: change return value as needed based on usage by map-input\n        // https://github.com/Leaflet/Leaflet/blob/6994baf25f267db1c8b720c28a61e0700d0aa0e8/src/layer/tile/GridLayer.js#L652\n        const center = this.layer._map.getCenter();\n        const templatedTileLayer = this.layer._extentLayer._templates[0].layer;\n        const pixelBounds = templatedTileLayer._getTiledPixelBounds(center);\n        const tileRange = templatedTileLayer._pxBoundsToTileRange(pixelBounds);\n        let obj = [];\n        for (let j = tileRange.min.y; j <= tileRange.max.y; j++) {\n          for (let i = tileRange.min.x; i <= tileRange.max.x; i++) {\n            const coords = new L.Point(i, j);\n            coords.z = templatedTileLayer._tileZoom;\n            obj.push(coords);\n          }\n        }\n        return obj;\n      } else if (this.units === 'tile' || this.units === 'map') ;\n      return;\n    }\n  }\n\n  class DOMTokenList {\n    /* jshint ignore:start */\n    #element; // create element as a private property\n    #valueSet; // needed to prevent infinite recursive calls to CE setAttribute\n    #attribute; // the name of the attribute that will be a DOMTokenList\n    #domain; // the domain of token values supported by this attribute\n    /* jshint ignore:end */\n    constructor(initialValue, element, attribute, domain) {\n      // create donor/host div to extract DomTokenList from\n      const hostingElement = document.createElement('div');\n      this.domtokenlist = hostingElement.classList;\n\n      // to check if value is being set, protects from infinite recursion\n      // from attributeChangedCallback of mapml-viewer and web-map\n      this.#valueSet = false; // jshint ignore:line\n      this.domtokenlist.value = initialValue ?? '';\n      this.#element = element; // jshint ignore:line\n      this.#attribute = attribute; // jshint ignore:line\n      this.#domain = domain; // jshint ignore:line\n    }\n\n    get valueSet() {\n      return this.#valueSet; // jshint ignore:line\n    }\n\n    get length() {\n      return this.domtokenlist.length;\n    }\n\n    get value() {\n      return this.domtokenlist.value;\n    }\n    set value(val) {\n      if (val === null) {\n        // when attribute is being removed\n        this.domtokenlist.value = '';\n      } else {\n        this.domtokenlist.value = val.toLowerCase();\n        /* jshint ignore:start */\n        this.#valueSet = true;\n        this.#element.setAttribute(this.#attribute, this.domtokenlist.value);\n        this.#valueSet = false;\n        /* jshint ignore:end */\n      }\n    }\n\n    item(index) {\n      return this.domtokenlist.item(index);\n    }\n\n    contains(token) {\n      return this.domtokenlist.contains(token);\n    }\n\n    // Modified default behavior\n    add(token) {\n      this.domtokenlist.add(token);\n      this.#element.setAttribute(this.#attribute, this.domtokenlist.value); // jshint ignore:line\n    }\n\n    // Modified default behavior\n    remove(token) {\n      this.domtokenlist.remove(token);\n      this.#element.setAttribute(this.#attribute, this.domtokenlist.value); // jshint ignore:line\n    }\n\n    // Modified default behavior\n    replace(oldToken, newToken) {\n      this.domtokenlist.replace(oldToken, newToken);\n      this.#element.setAttribute(this.#attribute, this.domtokenlist.value); // jshint ignore:line\n    }\n\n    // Modified default behavior\n    supports(token) {\n      /* jshint ignore:start */\n      if (this.#domain.includes(token)) {\n        return true;\n      } else {\n        return false;\n      }\n      /* jshint ignore:end */\n    }\n\n    // Modified default behavior\n    //https://developer.mozilla.org/en-US/docs/Web/API/DOMTokenList/toggle\n    toggle(token, force) {\n      this.domtokenlist.toggle(token, force);\n      this.#element.setAttribute(this.#attribute, this.domtokenlist.value); // jshint ignore:line\n    }\n\n    entries() {\n      return this.domtokenlist.entries();\n    }\n\n    //https://developer.mozilla.org/en-US/docs/Web/API/DOMTokenList/forEach\n    forEach(callback, thisArg) {\n      this.domtokenlist.forEach(callback, thisArg);\n    }\n\n    //https://developer.mozilla.org/en-US/docs/Web/API/DOMTokenList/keys\n    keys() {\n      return this.domtokenlist.keys();\n    }\n\n    //https://developer.mozilla.org/en-US/docs/Web/API/DOMTokenList/values\n    values() {\n      return this.domtokenlist.values();\n    }\n  }\n\n  /*\n   * Copyright 2015-2016 Canada Centre for Mapping and Earth Observation,\n   * Earth Sciences Sector, Natural Resources Canada.\n   *\n   * License\n   *\n   * By obtaining and/or copying this work, you (the licensee) agree that you have\n   * read, understood, and will comply with the following terms and conditions.\n   *\n   * Permission to copy, modify, and distribute this work, with or without\n   * modification, for any purpose and without fee or royalty is hereby granted,\n   * provided that you include the following on ALL copies of the work or portions\n   * thereof, including modifications:\n   *\n   * The full text of this NOTICE in a location viewable to users of the\n   * redistributed or derivative work.\n   *\n   * Any pre-existing intellectual property disclaimers, notices, or terms and\n   * conditions. If none exist, the W3C Software and Document Short Notice should\n   * be included.\n   *\n   * Notice of any changes or modifications, through a copyright statement on the\n   * new code or document such as \"This software or document includes material\n   * copied from or derived from [title and URI of the W3C document].\n   * Copyright © [YEAR] W3C® (MIT, ERCIM, Keio, Beihang).\"\n   *\n   * Disclaimers\n   *\n   * THIS WORK IS PROVIDED \"AS IS,\" AND COPYRIGHT HOLDERS MAKE NO REPRESENTATIONS\n   * OR WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO, WARRANTIES OF\n   * MERCHANTABILITY OR FITNESS FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF THE\n   * SOFTWARE OR DOCUMENT WILL NOT INFRINGE ANY THIRD PARTY PATENTS, COPYRIGHTS,\n   * TRADEMARKS OR OTHER RIGHTS.\n   * COPYRIGHT HOLDERS WILL NOT BE LIABLE FOR ANY DIRECT, INDIRECT, SPECIAL OR\n   * CONSEQUENTIAL DAMAGES ARISING OUT OF ANY USE OF THE SOFTWARE OR DOCUMENT.\n   *\n   * The name and trademarks of copyright holders may NOT be used in advertising or\n   * publicity pertaining to the work without specific, written prior permission.\n   * Title to copyright in this work will at all times remain with copyright holders.\n   */\n\n  /* global L, Node */\n  (function (window, document, undefined$1) {\n    var M = {};\n    window.M = M;\n\n    (function () {\n      M.detectImagePath = function (container) {\n        // this relies on the CSS style leaflet-default-icon-path containing a\n        // relative url() that leads to a valid icon file.  Since that depends on\n        // how all of this stuff is deployed (i.e. custom element or as leaflet-plugin)\n        // also, because we're using 'shady DOM' api, the container must be\n        // a shady dom container, because the custom element tags it with added\n        // style-scope ... and related classes.\n        var el = L.DomUtil.create('div', 'leaflet-default-icon-path', container);\n        var path =\n          L.DomUtil.getStyle(el, 'background-image') ||\n          L.DomUtil.getStyle(el, 'backgroundImage'); // IE8\n\n        container.removeChild(el);\n\n        if (path === null || path.indexOf('url') !== 0) {\n          path = '';\n        } else {\n          path = path\n            .replace(/^url\\([\"']?/, '')\n            .replace(/marker-icon\\.png[\"']?\\)$/, '');\n        }\n\n        return path;\n      };\n      M.mime = 'text/mapml';\n\n      let mapOptions = window.document.head.querySelector('map-options');\n      M.options = Options;\n      if (mapOptions)\n        M.options = Object.assign(M.options, JSON.parse(mapOptions.innerHTML));\n\n      // see https://leafletjs.com/reference-1.5.0.html#crs-l-crs-base\n      // \"new classes can't inherit from (L.CRS), and methods can't be added\n      // to (L.CRS.anything) with the include function\n      // so we'll use the options property as a way to integrate needed\n      // properties and methods...\n      M.WGS84 = new L.Proj.CRS(\n        'EPSG:4326',\n        '+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs ',\n        {\n          origin: [-180, +90],\n          bounds: L.bounds([\n            [-180, -90],\n            [180, 90]\n          ]),\n          resolutions: [\n            0.703125, 0.3515625, 0.17578125, 0.087890625, 0.0439453125,\n            0.02197265625, 0.010986328125, 0.0054931640625, 0.00274658203125,\n            0.001373291015625, 0.0006866455078125, 0.0003433227539062,\n            0.0001716613769531, 0.0000858306884766, 0.0000429153442383,\n            0.0000214576721191, 0.0000107288360596, 0.0000053644180298,\n            0.0000026822090149, 0.0000013411045074, 0.0000006705522537,\n            0.0000003352761269\n          ],\n          crs: {\n            tcrs: {\n              horizontal: {\n                name: 'x',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.WGS84.options.bounds.getSize().x /\n                      M.WGS84.options.resolutions[zoom]\n                  )\n              },\n              vertical: {\n                name: 'y',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.WGS84.options.bounds.getSize().y /\n                      M.WGS84.options.resolutions[zoom]\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [\n                    M.WGS84.options.crs.tcrs.horizontal.min,\n                    M.WGS84.options.crs.tcrs.vertical.min\n                  ],\n                  [\n                    M.WGS84.options.crs.tcrs.horizontal.max(zoom),\n                    M.WGS84.options.crs.tcrs.vertical.max(zoom)\n                  ]\n                )\n            },\n            pcrs: {\n              horizontal: {\n                name: 'longitude',\n                get min() {\n                  return M.WGS84.options.crs.gcrs.horizontal.min;\n                },\n                get max() {\n                  return M.WGS84.options.crs.gcrs.horizontal.max;\n                }\n              },\n              vertical: {\n                name: 'latitude',\n                get min() {\n                  return M.WGS84.options.crs.gcrs.vertical.min;\n                },\n                get max() {\n                  return M.WGS84.options.crs.gcrs.vertical.max;\n                }\n              },\n              get bounds() {\n                return M.WGS84.options.bounds;\n              }\n            },\n            gcrs: {\n              horizontal: {\n                name: 'longitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: -180.0,\n                max: 180.0\n              },\n              vertical: {\n                name: 'latitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: -90.0,\n                max: 90.0\n              },\n              get bounds() {\n                return L.latLngBounds(\n                  [\n                    M.WGS84.options.crs.gcrs.vertical.min,\n                    M.WGS84.options.crs.gcrs.horizontal.min\n                  ],\n                  [\n                    M.WGS84.options.crs.gcrs.vertical.max,\n                    M.WGS84.options.crs.gcrs.horizontal.max\n                  ]\n                );\n              }\n            },\n            map: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: (map) => map.getSize().x\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: (map) => map.getSize().y\n              },\n              bounds: (map) => L.bounds(L.point([0, 0]), map.getSize())\n            },\n            tile: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: 256\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: 256\n              },\n              get bounds() {\n                return L.bounds(\n                  [\n                    M.WGS84.options.crs.tile.horizontal.min,\n                    M.WGS84.options.crs.tile.vertical.min\n                  ],\n                  [\n                    M.WGS84.options.crs.tile.horizontal.max,\n                    M.WGS84.options.crs.tile.vertical.max\n                  ]\n                );\n              }\n            },\n            tilematrix: {\n              horizontal: {\n                name: 'column',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.WGS84.options.crs.tcrs.horizontal.max(zoom) /\n                      M.WGS84.options.crs.tile.bounds.getSize().x\n                  )\n              },\n              vertical: {\n                name: 'row',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.WGS84.options.crs.tcrs.vertical.max(zoom) /\n                      M.WGS84.options.crs.tile.bounds.getSize().y\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [\n                    M.WGS84.options.crs.tilematrix.horizontal.min,\n                    M.WGS84.options.crs.tilematrix.vertical.min\n                  ],\n                  [\n                    M.WGS84.options.crs.tilematrix.horizontal.max(zoom),\n                    M.WGS84.options.crs.tilematrix.vertical.max(zoom)\n                  ]\n                )\n            }\n          }\n        }\n      );\n      M.CBMTILE = new L.Proj.CRS(\n        'EPSG:3978',\n        '+proj=lcc +lat_1=49 +lat_2=77 +lat_0=49 +lon_0=-95 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs',\n        {\n          origin: [-34655800, 39310000],\n          bounds: L.bounds([\n            [-34655800, -39000000],\n            [10000000, 39310000]\n          ]),\n          resolutions: [\n            38364.660062653464, 22489.62831258996, 13229.193125052918,\n            7937.5158750317505, 4630.2175937685215, 2645.8386250105837,\n            1587.5031750063501, 926.0435187537042, 529.1677250021168,\n            317.50063500127004, 185.20870375074085, 111.12522225044451,\n            66.1459656252646, 38.36466006265346, 22.48962831258996,\n            13.229193125052918, 7.9375158750317505, 4.6302175937685215,\n            2.6458386250105836, 1.5875031750063502, 0.92604351875370428,\n            0.52916772500211673, 0.31750063500127002, 0.18520870375074083,\n            0.11112522225044451, 0.066145965625264591\n          ],\n          crs: {\n            tcrs: {\n              horizontal: {\n                name: 'x',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.CBMTILE.options.bounds.getSize().x /\n                      M.CBMTILE.options.resolutions[zoom]\n                  )\n              },\n              vertical: {\n                name: 'y',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.CBMTILE.options.bounds.getSize().y /\n                      M.CBMTILE.options.resolutions[zoom]\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [\n                    M.CBMTILE.options.crs.tcrs.horizontal.min,\n                    M.CBMTILE.options.crs.tcrs.vertical.min\n                  ],\n                  [\n                    M.CBMTILE.options.crs.tcrs.horizontal.max(zoom),\n                    M.CBMTILE.options.crs.tcrs.vertical.max(zoom)\n                  ]\n                )\n            },\n            pcrs: {\n              horizontal: {\n                name: 'easting',\n                get min() {\n                  return M.CBMTILE.options.bounds.min.x;\n                },\n                get max() {\n                  return M.CBMTILE.options.bounds.max.x;\n                }\n              },\n              vertical: {\n                name: 'northing',\n                get min() {\n                  return M.CBMTILE.options.bounds.min.y;\n                },\n                get max() {\n                  return M.CBMTILE.options.bounds.max.y;\n                }\n              },\n              get bounds() {\n                return M.CBMTILE.options.bounds;\n              }\n            },\n            gcrs: {\n              horizontal: {\n                name: 'longitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: -141.01,\n                max: -47.74\n              },\n              vertical: {\n                name: 'latitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: 40.04,\n                max: 86.46\n              },\n              get bounds() {\n                return L.latLngBounds(\n                  [\n                    M.CBMTILE.options.crs.gcrs.vertical.min,\n                    M.CBMTILE.options.crs.gcrs.horizontal.min\n                  ],\n                  [\n                    M.CBMTILE.options.crs.gcrs.vertical.max,\n                    M.CBMTILE.options.crs.gcrs.horizontal.max\n                  ]\n                );\n              }\n            },\n            map: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: (map) => map.getSize().x\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: (map) => map.getSize().y\n              },\n              bounds: (map) => L.bounds(L.point([0, 0]), map.getSize())\n            },\n            tile: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: 256\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: 256\n              },\n              get bounds() {\n                return L.bounds(\n                  [\n                    M.CBMTILE.options.crs.tile.horizontal.min,\n                    M.CBMTILE.options.crs.tile.vertical.min\n                  ],\n                  [\n                    M.CBMTILE.options.crs.tile.horizontal.max,\n                    M.CBMTILE.options.crs.tile.vertical.max\n                  ]\n                );\n              }\n            },\n            tilematrix: {\n              horizontal: {\n                name: 'column',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.CBMTILE.options.crs.tcrs.horizontal.max(zoom) /\n                      M.CBMTILE.options.crs.tile.bounds.getSize().x\n                  )\n              },\n              vertical: {\n                name: 'row',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.CBMTILE.options.crs.tcrs.vertical.max(zoom) /\n                      M.CBMTILE.options.crs.tile.bounds.getSize().y\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [0, 0],\n                  [\n                    M.CBMTILE.options.crs.tilematrix.horizontal.max(zoom),\n                    M.CBMTILE.options.crs.tilematrix.vertical.max(zoom)\n                  ]\n                )\n            }\n          }\n        }\n      );\n      M.APSTILE = new L.Proj.CRS(\n        'EPSG:5936',\n        '+proj=stere +lat_0=90 +lat_ts=50 +lon_0=-150 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m +no_defs',\n        {\n          origin: [-2.8567784109255e7, 3.2567784109255e7],\n          bounds: L.bounds([\n            [-28567784.109254867, -28567784.109254755],\n            [32567784.109255023, 32567784.10925506]\n          ]),\n          resolutions: [\n            238810.813354, 119405.406677, 59702.7033384999, 29851.3516692501,\n            14925.675834625, 7462.83791731252, 3731.41895865639, 1865.70947932806,\n            932.854739664032, 466.427369832148, 233.213684916074,\n            116.606842458037, 58.3034212288862, 29.1517106145754,\n            14.5758553072877, 7.28792765351156, 3.64396382688807,\n            1.82198191331174, 0.910990956788164, 0.45549547826179\n          ],\n          crs: {\n            tcrs: {\n              horizontal: {\n                name: 'x',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.APSTILE.options.bounds.getSize().x /\n                      M.APSTILE.options.resolutions[zoom]\n                  )\n              },\n              vertical: {\n                name: 'y',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.APSTILE.options.bounds.getSize().y /\n                      M.APSTILE.options.resolutions[zoom]\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [\n                    M.APSTILE.options.crs.tcrs.horizontal.min,\n                    M.APSTILE.options.crs.tcrs.vertical.min\n                  ],\n                  [\n                    M.APSTILE.options.crs.tcrs.horizontal.max(zoom),\n                    M.APSTILE.options.crs.tcrs.vertical.max(zoom)\n                  ]\n                )\n            },\n            pcrs: {\n              horizontal: {\n                name: 'easting',\n                get min() {\n                  return M.APSTILE.options.bounds.min.x;\n                },\n                get max() {\n                  return M.APSTILE.options.bounds.max.x;\n                }\n              },\n              vertical: {\n                name: 'northing',\n                get min() {\n                  return M.APSTILE.options.bounds.min.y;\n                },\n                get max() {\n                  return M.APSTILE.options.bounds.max.y;\n                }\n              },\n              get bounds() {\n                return M.APSTILE.options.bounds;\n              }\n            },\n            gcrs: {\n              horizontal: {\n                name: 'longitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: -180.0,\n                max: 180.0\n              },\n              vertical: {\n                name: 'latitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: 60.0,\n                max: 90.0\n              },\n              get bounds() {\n                return L.latLngBounds(\n                  [\n                    M.APSTILE.options.crs.gcrs.vertical.min,\n                    M.APSTILE.options.crs.gcrs.horizontal.min\n                  ],\n                  [\n                    M.APSTILE.options.crs.gcrs.vertical.max,\n                    M.APSTILE.options.crs.gcrs.horizontal.max\n                  ]\n                );\n              }\n            },\n            map: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: (map) => map.getSize().x\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: (map) => map.getSize().y\n              },\n              bounds: (map) => L.bounds(L.point([0, 0]), map.getSize())\n            },\n            tile: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: 256\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: 256\n              },\n              get bounds() {\n                return L.bounds(\n                  [\n                    M.APSTILE.options.crs.tile.horizontal.min,\n                    M.APSTILE.options.crs.tile.vertical.min\n                  ],\n                  [\n                    M.APSTILE.options.crs.tile.horizontal.max,\n                    M.APSTILE.options.crs.tile.vertical.max\n                  ]\n                );\n              }\n            },\n            tilematrix: {\n              horizontal: {\n                name: 'column',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.APSTILE.options.crs.tcrs.horizontal.max(zoom) /\n                      M.APSTILE.options.crs.tile.bounds.getSize().x\n                  )\n              },\n              vertical: {\n                name: 'row',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.APSTILE.options.crs.tcrs.vertical.max(zoom) /\n                      M.APSTILE.options.crs.tile.bounds.getSize().y\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [0, 0],\n                  [\n                    M.APSTILE.options.crs.tilematrix.horizontal.max(zoom),\n                    M.APSTILE.options.crs.tilematrix.vertical.max(zoom)\n                  ]\n                )\n            }\n          }\n        }\n      );\n      M.OSMTILE = L.CRS.EPSG3857;\n      L.setOptions(M.OSMTILE, {\n        origin: [-20037508.342787, 20037508.342787],\n        bounds: L.bounds([\n          [-20037508.342787, -20037508.342787],\n          [20037508.342787, 20037508.342787]\n        ]),\n        resolutions: [\n          156543.0339, 78271.51695, 39135.758475, 19567.8792375, 9783.93961875,\n          4891.969809375, 2445.9849046875, 1222.9924523438, 611.49622617188,\n          305.74811308594, 152.87405654297, 76.437028271484, 38.218514135742,\n          19.109257067871, 9.5546285339355, 4.7773142669678, 2.3886571334839,\n          1.1943285667419, 0.59716428337097, 0.29858214168549, 0.14929107084274,\n          0.074645535421371, 0.03732276771068573, 0.018661383855342865,\n          0.009330691927671432495\n        ],\n        crs: {\n          tcrs: {\n            horizontal: {\n              name: 'x',\n              min: 0,\n              max: (zoom) =>\n                Math.round(\n                  M.OSMTILE.options.bounds.getSize().x /\n                    M.OSMTILE.options.resolutions[zoom]\n                )\n            },\n            vertical: {\n              name: 'y',\n              min: 0,\n              max: (zoom) =>\n                Math.round(\n                  M.OSMTILE.options.bounds.getSize().y /\n                    M.OSMTILE.options.resolutions[zoom]\n                )\n            },\n            bounds: (zoom) =>\n              L.bounds(\n                [\n                  M.OSMTILE.options.crs.tcrs.horizontal.min,\n                  M.OSMTILE.options.crs.tcrs.vertical.min\n                ],\n                [\n                  M.OSMTILE.options.crs.tcrs.horizontal.max(zoom),\n                  M.OSMTILE.options.crs.tcrs.vertical.max(zoom)\n                ]\n              )\n          },\n          pcrs: {\n            horizontal: {\n              name: 'easting',\n              get min() {\n                return M.OSMTILE.options.bounds.min.x;\n              },\n              get max() {\n                return M.OSMTILE.options.bounds.max.x;\n              }\n            },\n            vertical: {\n              name: 'northing',\n              get min() {\n                return M.OSMTILE.options.bounds.min.y;\n              },\n              get max() {\n                return M.OSMTILE.options.bounds.max.y;\n              }\n            },\n            get bounds() {\n              return M.OSMTILE.options.bounds;\n            }\n          },\n          gcrs: {\n            horizontal: {\n              name: 'longitude',\n              get min() {\n                return M.OSMTILE.unproject(M.OSMTILE.options.bounds.min).lng;\n              },\n              get max() {\n                return M.OSMTILE.unproject(M.OSMTILE.options.bounds.max).lng;\n              }\n            },\n            vertical: {\n              name: 'latitude',\n              get min() {\n                return M.OSMTILE.unproject(M.OSMTILE.options.bounds.min).lat;\n              },\n              get max() {\n                return M.OSMTILE.unproject(M.OSMTILE.options.bounds.max).lat;\n              }\n            },\n            get bounds() {\n              return L.latLngBounds(\n                [\n                  M.OSMTILE.options.crs.gcrs.vertical.min,\n                  M.OSMTILE.options.crs.gcrs.horizontal.min\n                ],\n                [\n                  M.OSMTILE.options.crs.gcrs.vertical.max,\n                  M.OSMTILE.options.crs.gcrs.horizontal.max\n                ]\n              );\n            }\n          },\n          map: {\n            horizontal: {\n              name: 'i',\n              min: 0,\n              max: (map) => map.getSize().x\n            },\n            vertical: {\n              name: 'j',\n              min: 0,\n              max: (map) => map.getSize().y\n            },\n            bounds: (map) => L.bounds(L.point([0, 0]), map.getSize())\n          },\n          tile: {\n            horizontal: {\n              name: 'i',\n              min: 0,\n              max: 256\n            },\n            vertical: {\n              name: 'j',\n              min: 0,\n              max: 256\n            },\n            get bounds() {\n              return L.bounds(\n                [\n                  M.OSMTILE.options.crs.tile.horizontal.min,\n                  M.OSMTILE.options.crs.tile.vertical.min\n                ],\n                [\n                  M.OSMTILE.options.crs.tile.horizontal.max,\n                  M.OSMTILE.options.crs.tile.vertical.max\n                ]\n              );\n            }\n          },\n          tilematrix: {\n            horizontal: {\n              name: 'column',\n              min: 0,\n              max: (zoom) =>\n                Math.round(\n                  M.OSMTILE.options.crs.tcrs.horizontal.max(zoom) /\n                    M.OSMTILE.options.crs.tile.bounds.getSize().x\n                )\n            },\n            vertical: {\n              name: 'row',\n              min: 0,\n              max: (zoom) =>\n                Math.round(\n                  M.OSMTILE.options.crs.tcrs.vertical.max(zoom) /\n                    M.OSMTILE.options.crs.tile.bounds.getSize().y\n                )\n            },\n            bounds: (zoom) =>\n              L.bounds(\n                [0, 0],\n                [\n                  M.OSMTILE.options.crs.tilematrix.horizontal.max(zoom),\n                  M.OSMTILE.options.crs.tilematrix.vertical.max(zoom)\n                ]\n              )\n          }\n        }\n      });\n    })();\n\n    M._handleLink = Util._handleLink;\n    M.convertPCRSBounds = Util.convertPCRSBounds;\n    M.axisToXY = Util.axisToXY;\n    M.csToAxes = Util.csToAxes;\n    M._convertAndFormatPCRS = Util._convertAndFormatPCRS;\n    M.extentToBounds = Util.extentToBounds;\n    M.axisToCS = Util.axisToCS;\n    M._parseNumber = Util._parseNumber;\n    M._splitCoordinate = Util._splitCoordinate;\n    M.boundsToPCRSBounds = Util.boundsToPCRSBounds;\n    M.pixelToPCRSBounds = Util.pixelToPCRSBounds;\n    M._metaContentToObject = Util._metaContentToObject;\n    M._coordsToArray = Util._coordsToArray;\n    M.pointToPCRSPoint = Util.pointToPCRSPoint;\n    M.pixelToPCRSPoint = Util.pixelToPCRSPoint;\n    M._gcrsToTileMatrix = Util._gcrsToTileMatrix;\n    M._pasteLayer = Util._pasteLayer;\n    M._properties2Table = Util._properties2Table;\n    M._updateExtent = Util._updateExtent;\n    M.geojson2mapml = Util.geojson2mapml;\n    M._breakArray = Util._breakArray;\n    M._table2properties = Util._table2properties;\n    M._geometry2geojson = Util._geometry2geojson;\n    M._pcrsToGcrs = Util._pcrsToGcrs;\n    M.mapml2geojson = Util.mapml2geojson;\n    M.getMaxZoom = Util.getMaxZoom;\n    M.getBoundsFromMeta = Util.getBoundsFromMeta;\n    M.getZoomBoundsFromMeta = Util.getZoomBoundsFromMeta;\n    M.getZoomBounds = Util.getZoomBounds;\n    M.getNativeVariables = Util.getNativeVariables;\n    M.getClosest = Util.getClosest;\n\n    M.QueryHandler = QueryHandler;\n    M.ContextMenu = ContextMenu;\n    M.AnnounceMovement = AnnounceMovement;\n    M.FeatureIndex = FeatureIndex;\n\n    // see https://leafletjs.com/examples/extending/extending-3-controls.html#handlers\n    L.Map.addInitHook('addHandler', 'query', M.QueryHandler);\n    L.Map.addInitHook('addHandler', 'contextMenu', M.ContextMenu);\n    L.Map.addInitHook('addHandler', 'announceMovement', M.AnnounceMovement);\n    L.Map.addInitHook('addHandler', 'featureIndex', M.FeatureIndex);\n\n    M.MapMLLayer = MapMLLayer;\n    M.mapMLLayer = mapMLLayer;\n\n    M.ImageLayer = ImageLayer;\n    M.imageLayer = imageLayer;\n\n    M.TemplatedImageLayer = TemplatedImageLayer;\n    M.templatedImageLayer = templatedImageLayer;\n\n    M.TemplatedFeaturesLayer = TemplatedFeaturesLayer;\n    M.templatedFeaturesLayer = templatedFeaturesLayer;\n\n    M.ExtentLayer = ExtentLayer;\n    M.extentLayer = extentLayer;\n\n    M.TemplatedTileLayer = TemplatedTileLayer;\n    M.templatedTileLayer = templatedTileLayer;\n\n    M.FeatureLayer = FeatureLayer;\n    M.featureLayer = featureLayer;\n\n    M.LayerControl = LayerControl;\n    M.layerControl = layerControl;\n\n    M.AttributionButton = AttributionButton;\n    M.attributionButton = attributionButton;\n\n    M.ReloadButton = ReloadButton;\n    M.reloadButton = reloadButton;\n\n    M.ScaleBar = ScaleBar;\n    M.scaleBar = scaleBar;\n\n    M.FullscreenButton = FullscreenButton;\n    M.fullscreenButton = fullscreenButton;\n\n    M.geolocationButton = geolocationButton;\n\n    M.StaticTileLayer = StaticTileLayer;\n    M.staticTileLayer = staticTileLayer;\n\n    M.DebugOverlay = DebugOverlay;\n    M.debugOverlay = debugOverlay;\n\n    M.Crosshair = Crosshair;\n    M.crosshair = crosshair;\n\n    M.FeatureIndexOverlay = FeatureIndexOverlay;\n    M.featureIndexOverlay = featureIndexOverlay;\n\n    M.Path = Path;\n    M.path = path;\n\n    M.FeatureRenderer = FeatureRenderer;\n    M.featureRenderer = featureRenderer;\n\n    M.Geometry = Geometry;\n    M.geometry = geometry;\n\n    // element support\n    M._createLayerControlExtentHTML = createLayerControlExtentHTML;\n    M._createLayerControlHTML = createLayerControlHTML;\n    M.ZoomInput = ZoomInput;\n    M.HiddenInput = HiddenInput;\n    M.WidthInput = WidthInput;\n    M.HeightInput = HeightInput;\n    M.LocationInput = LocationInput;\n\n    // constants\n    M.TILE_SIZE = 256;\n    M.FALLBACK_PROJECTION = 'OSMTILE';\n    M.FALLBACK_CS = 'TILEMATRIX';\n    M.BLANK_TT_TREF = 'mapmltemplatedtileplaceholder';\n\n    M.DOMTokenList = DOMTokenList;\n    M.pmtilesLayer = leafletLayer;\n    M.LineSymbolizer = LineSymbolizer;\n    M.PolygonSymbolizer = PolygonSymbolizer;\n    M.templatedPMTilesLayer = templatedPMTilesLayer;\n    M.TemplatedPMTilesLayer = TemplatedPMTilesLayer;\n  })(window);\n\n}());\n"],"names":["staticTileLayer","options","StaticTileLayer","layerControl","layers","LayerControl","featureLayer","mapml","FeatureLayer","templatedTileLayer","template","TemplatedTileLayer","extentLayer","ExtentLayer","templatedFeaturesLayer","TemplatedFeaturesLayer","templatedImageLayer","TemplatedImageLayer","L","GridLayer","extend","initialize","setOptions","this","zoomBounds","_getZoomBounds","tileContainer","maxZoomBound","_groups","_groupTiles","getElementsByTagName","_bounds","_getLayerBounds","projection","layerBounds","Object","keys","let","key","min","max","onAdd","map","_map","prototype","call","_handleMoveEnd","getEvents","events","_parentOnMoveEnd","moveend","move","isVisible","mapZoom","getZoom","zoomLevel","maxNativeZoom","minNativeZoom","maxZoom","minZoom","overlaps","M","pixelToPCRSBounds","getPixelBounds","e","_isValidTile","coords","_tileCoordsToKey","createTile","tileGroup","tileElem","document","createElement","tileSize","getTileSize","setAttribute","x","y","z","i","length","tile","width","height","alt","src","appendChild","tileGroups","crs","bounds","sCoords","split","pixelCoords","point","pixelBounds","zoom","container","meta","_metaContentToObject","_leafletLayer","_layerEl","querySelector","getAttribute","tiles","nativeZoom","value","lZoom","Math","tileMap","row","col","tileCode","push","Control","Layers","autoZIndex","sortLayers","sortFunction","layerA","layerB","zIndex","overlays","_layerControlInputs","_layers","_lastZIndex","_handlingClick","_addLayer","_initLayout","DomEvent","on","_container","_focusFirstLayer","_preventDefaultContextMenu","_update","_showControls","onRemove","off","addOrUpdateOverlay","layer","name","alreadyThere","addOverlay","removeAttribute","removeLayer","_checkDisabledLayers","elem","className","children","setTimeout","focus","DomUtil","empty","_baseLayersList","_overlaysList","baseLayersPresent","overlaysPresent","obj","baseLayersCount","sort","a","b","_addItem","overlay","hideSingleBase","style","display","_separator","layercontrols","_layerControlHTML","input","layerId","stamp","collapse","includes","contextMenu","_extentLayerMenu","hidden","_layerMenu","target","tagName","relatedTarget","parentElement","removeClass","originalEvent","pointerType","_isExpanded","latlng","mouseEventToLatLng","containerPoint","mouseEventToContainerPoint","preventDefault","fire","FeatureGroup","query","create","pane","addClass","renderer","_queryFeatures","features","_features","_staticFeature","mapEl","withinZoom","_validateRendering","showPaginationFeature","addLayer","layerToAdd","featureZoom","mapmlFeature","addRendering","featureToAdd","remove","featureIndex","cleanIndex","featureToRemove","_leaflet_id","_removeFromFeaturesList","id","removeRendering","feature","splice","zoomend","_handleZoomEnd","_linkEl","shadowRoot","replaceChildren","clearLayers","addFeature","popup","_navigationBar","innerText","_totalFeatureCount","_content","srcdoc","innerHTML","currFeature","once","_removeCSS","hasLayer","k","geometry","renderable","_checkRender","placeholder","defaultOptions","group","parentNode","replaceWith","insertAdjacentElement","_setZoomTransform","center","clampZoom","scale","getZoomScale","translate","multiplyBy","subtract","_getNewPixelOrigin","round","any3d","setTransform","setPosition","createGeometry","fallbackCS","tileZoom","assign","filter","classList","title","properties","add","insertAdjacentHTML","cs","extentToBounds","extent","_geometryToLayer","color","hasAttribute","resetStyle","onEachFeature","bindTooltip","interactive","sticky","toUpperCase","_groupEl","Util","_setLayerStyle","setStyle","eachLayer","toDelete","querySelectorAll","removeChild","vectorOptions","svgGroup","SVG","copyOptions","_featureEl","geo","path","nativeCS","featureID","wrappers","_getGeometryParents","groupOptions","accessibleTitle","collections","subType","elems","concat","TileLayer","tms","_setUpTileTemplateVars","linkEl","extentBounds","_template","_initContainer","child","getMapEl","mapBounds","_updateZIndex","dispatchEvent","CustomEvent","detail","appendTile","type","startsWith","_url","BLANK_TT_TREF","_fetchTile","_mapmlTileReady","getPane","url","getTileUrl","fetch","redirect","then","response","status","Promise","resolve","console","log","reject","text","DOMParser","parseFromString","_createFeatures","catch","_parseStylesheetAsHTML","base","Element","URL","href","styleElm","ss","stylesheets","nodeName","linkElm","copyAttributes","textContent","s","source","Array","from","attributes","forEach","attribute","nodeValue","markup","svg","g","xOffset","yOffset","tileFeatures","fallback","getNativeVariables","FeatureRenderer","_initPath","_project","_addPath","_updateFeature","toString","tilematrix","contains","v","zoomInput","_getZoomForUrl","pcrs","easting","left","_tileMatrixToPCRSPosition","right","northing","top","bottom","indexOf","infinite","invertedY","_globalTileRange","r","detectRetina","Browser","retina","pos","nwPoint","scaleBy","sePoint","centrePoint","floor","nw","transformation","untransform","se","cen","result","Point","east","north","inputs","values","units","axis","position","select","toLowerCase","horizontal","resolutions","isNaN","Number","parseFloat","vertical","match","parsedselect","htmlselect","pcrs2tilematrix","c","transform","divideBy","bind","initialValue","boundsToPCRSBounds","axisToCS","pcrsBounds","zmin","zmax","_clampZoom","clamp","step","LayerGroup","_extentEl","extentEl","changeOpacity","opacity","zoomstart","_onZoomStart","closePopup","getContainer","parentLayer","_layer","redraw","setZIndex","undefined","_previousFeature","_count","_nextFeature","_source","_opacity","_opacitySlider","appendStyleLink","mapLink","link","positionAndNode","_getStylePositionAndNode","node","lastChild","appendStyleElement","mapStyle","styleElement","Layer","_setUpFeaturesTemplateVars","_onMoveEnd","addTo","featureRenderer","bindPopup","autoClose","minWidth","parent","history","_history","current","previous","steppedZoom","headers","parser","context","_pullFeatureFeed","scaleBounds","getCenter","_getfeaturesUrl","Headers","Accept","limit","frag","createDocumentFragment","elements","featuresReady","whenReady","allSettled","_updateTabIndex","error","layerNum","_path","childElementCount","getSize","_TCRSToPCRS","featuresVarNames","_setUpExtentTemplateVars","_clearLayer","_onAdd","containerImages","_addImage","loc","overlayToRemove","_imageOverlay","getImageUrl","size","imageLayer","_step","_overlayToRemove","_scaleImage","_image","_pixelOrigins","getPixelOrigin","pixelOrigin","extentVarNames","__create","__defProp","defineProperty","__getOwnPropDesc","getOwnPropertyDescriptor","__getOwnPropNames","getOwnPropertyNames","__getProtoOf","getPrototypeOf","__hasOwnProp","hasOwnProperty","__pow","pow","__commonJS","cb","mod","exports","__toESM","isNodeMode","to","except","desc","get","enumerable","__copyProps","__esModule","__async","__this","__arguments","generator","fulfilled","step2","next","rejected","throw","x2","done","apply","require_point_geometry","node_modules/@mapbox/point-geometry/index.js","module","Point9","clone","p","_add","sub","_sub","multByPoint","_multByPoint","divByPoint","_divByPoint","mult","_mult","div","_div","rotate","_rotate","rotateAround","_rotateAround","matMult","m","_matMult","unit","_unit","perp","_perp","_round","mag","sqrt","equals","other","dist","distSqr","dx","dy","angle","atan2","angleTo","angleWith","angleWithSep","cos","sin","convert","isArray","require_vectortilefeature","node_modules/@mapbox/vector-tile/lib/vectortilefeature.js","VectorTileFeature","pbf","end","_pbf","_geometry","_keys","_values","readFields","readFeature","tag","readVarint","readTag","types","loadGeometry","line","cmdLen","cmd","lines","readSVarint","Error","bbox","x1","Infinity","x22","y1","y2","toGeoJSON","j","x0","y0","project3","j2","PI","atan","exp","points","i2","rings","len","polygon","ccw","polygons","area","ring","p1","p2","sum","signedArea","classifyRings","coordinates","require_vectortilelayer","node_modules/@mapbox/vector-tile/lib/vectortilelayer.js","VectorTileLayer","version","readLayer","readString","readFloat","readDouble","readVarint64","readBoolean","readValueMessage","require_vectortile","node_modules/@mapbox/vector-tile/lib/vectortile.js","readTile","require_vector_tile","node_modules/@mapbox/vector-tile/index.js","VectorTile","require_ieee754","node_modules/ieee754/index.js","read","buffer","offset","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","d","NaN","write","rt","abs","LN2","require_pbf","node_modules/pbf/index.js","Pbf","ieee754","buf","ArrayBuffer","isView","Uint8Array","Varint","Fixed64","Bytes","Fixed32","SHIFT_LEFT_32","SHIFT_RIGHT_32","utf8TextDecoder","TextDecoder","readPackedEnd","toNum2","low","high","isSigned","makeRoomForExtraLength","startPos","extraLen","realloc","writePackedVarint","arr2","writeVarint","writePackedSVarint","writeSVarint","writePackedFloat","writeFloat","writePackedDouble","writeDouble","writePackedBoolean","writeBoolean","writePackedFixed32","writeFixed32","writePackedSFixed32","writeSFixed32","writePackedFixed64","writeFixed64","writePackedSFixed64","writeSFixed64","readUInt32","writeInt32","val","readInt32","destroy","readField","skip","readMessage","readFixed32","readSFixed32","readFixed64","readSFixed64","l","h","readVarintRemainder2","num","Boolean","decode","subarray","b1","b2","b3","str","b0","bytesPerSequence","String","fromCharCode","readUtf8","readBytes","readPackedVarint","readPackedSVarint","readPackedBoolean","readPackedFloat","readPackedDouble","readPackedFixed32","readPackedSFixed32","readPackedFixed64","readPackedSFixed64","writeTag","set","finish","writeBigVarintLow","lsb","writeBigVarintHigh","writeBigVarint","writeString","lead","charCodeAt","writeUtf8","writeBytes","writeRawMessage","fn","writeMessage","writeBytesField","writeFixed32Field","writeSFixed32Field","writeFixed64Field","writeSFixed64Field","writeVarintField","writeSVarintField","writeStringField","writeFloatField","writeDoubleField","writeBooleanField","require_rbush_min","node_modules/rbush/rbush.min.js","t2","i3","n2","r3","n","r2","_maxEntries","_minEntries","ceil","clear","e2","minX","minY","maxX","maxY","a2","h2","o","leaf","f","u","o2","pop","t3","r4","e3","a3","h3","s2","f2","u2","l2","d2","all","_all","data","search","toBBox","collides","load","insert","_build","slice","_splitRoot","_insert","_condense","compareMinX","compareMinY","toJSON","fromJSON","m2","c2","_chooseSubtree","_split","_adjustParentBBoxes","_chooseSplitAxis","_chooseSplitIndex","_allDistMargin","t","define","amd","self","RBush","guard","ColorError$1","constructor","super","parseToRgba","trim","normalizedColor","namedColorRegex","test","normalizedColorName","compressedColorMap","hash2","hash","nameToHex","reducedHexMatch","reducedHexRegex","exec","parseInt","hexMatch","hexRegex","rgbaMatch","rgbaRegex","hslaMatch","hslaRegex","hue","saturation","lightness","roundColor","huePrime","chroma","secondComponent","red","green","blue","lightnessModification","finalRed","finalGreen","finalBlue","hslToRgb","colorToInt","replace","reduce","acc","substring","hex","prefix","amount","join","RegExp","mix","color1","color2","weight","normalize","index","r1","g1","a1","g2","alphaDelta","normalizedWeight","weight2","weight1","alpha","toFixed","import_point_geometry3","StringAttr","defaultValue","perFeature","NumberAttr","TextAttr","_a2","labelProps","textTransform","retval","property","props","wordsArray","capsArray","word","FontAttr","_b2","font","family","fontFamily","fontSize","fontWeight","fontStyle","ArrayAttr","import_point_geometry","simpleLabel","mls","minimum","repeatDistance","cellSize","candidates","ls","segment","pts","maxAngleDelta","targetLen","chunks","abmag","bcmag","abx","aby","bcx","bcy","iStart","dStart","beginIndex","beginDistance","endIndex","endDistance","acos","linelabel","start","default","normalized","freb","eb","u16","i32","import_point_geometry2","import_vector_tile","import_pbf","__pow2","__async2","u8","Uint16Array","Int32Array","fleb","fdeb","clim","_a","fl","fd","rev","hMap","cd","mb","le","co","rvb","sv","r_1","flt","fdt","inflt","dat","st","dict","sl","dl","noBuf","noSt","cbuf","bl","nbuf","final","bt","lm","dm","lbt","dbt","tbts","bits","shft","err","flrm","fdrm","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","bits16","dsym","shift2","dend","slc","gzs","flg","zs","gzl","zls","ec","ind","msg","nt","code","captureStackTrace","et","decompressSync","opts","out","dictionary","td","stream","shift","unshift","getUint24","view","getUint16","getUint8","getUint48","getUint32","queryTile","offsetLen","queryView","isDir","byteLength","cmp","tz","tx","ty","compare","entrySort","parseEntry","dataview","zRaw","sortDir","entries","DataView","createDirectory","entry","v2_default","getHeader","resp","getBytes","jsonSize","rootEntries","dec","jsonMetadata","JSON","parse","tileCompression","compression","minzoom","maxzoom","centerLon","centerLat","centerZoom","minLon","minLat","maxLon","maxLat","specVersion","rootDirectoryOffset","rootDirectoryLength","jsonMetadataOffset","jsonMetadataLength","leafDirectoryOffset","leafDirectoryLength","tileDataOffset","tileDataLength","numAddressedTiles","numTileEntries","numTileContents","clustered","internalCompression","tileType","etag","getZxy","header","cache","signal","rootDir","getArrayBuffer","tileData","leafcoords","numEntries","leafLevel","levelDiff","trunc","deriveLeaf","leafdirEntry","queryLeafdir","leafDir","tileEntry","toNum","readVarintRemainder","tzValues","defaultDecompress","globalThis","DecompressionStream","Response","body","pipeThrough","arrayBuffer","FetchSource","customHeaders","mustReload","getKey","setHeaders","passedSignal","controller","AbortController","requestHeaders","contentRange","actualLength","substr","range","newEtag","EtagMismatch","contentLength","abort","cacheControl","expires","getUint64","wh","wl","deserializeIndex","lastId","tileId","runLength","getHeaderAndRoot","decompress","warn","detectVersion","bytes","getInt32","bytesToHeader","rootDirData","dirKey","SharedPromiseCache","maxCacheEntries","prefetch","Map","invalidations","counter","cacheKey","cacheValue","lastUsed","res","prune","getDirectory","directory","has","minUsed","minKey","delete","invalidate","PMTiles","getZxyAttempt","ry","xy","rx","zxyToTileId","dO","dL","depth","findTile","getMetadataAttempt","decompressed","getMetadata","toIndex","parseTile","loaded","geom","loadGeomAndBbox","numVertices","part","geomType","PmtilesSource","shouldCancelZooms","zoomaborts","za","ZxySource","R","MAX_LATITUDE","MAXCOORD","sqr","dist2","w","isInRing","inside","xi","yi","xj","yj","pointInPolygon","isInCurrentExterior","isCcw","pointMinDistToLines","TileCache","inflight","idx","used","performance","now","ifentry","ifentry2","queryFeatures","lng","lat","brushSize","projected","constrainedLat","onZoom","tileX","tileY","layerName","layerArr","pointMinDistToPoints","PolygonSymbolizer","pattern","fill","stroke","doStroke","before","ctx","patten","globalAlpha","fillStyle","strokeStyle","lineWidth","createPattern","draw","beginPath","poly","pt","moveTo","lineTo","stops","getStopIndex","factor","difference","progress","linear","LineSymbolizer","dash","dashColor","dashWidth","lineCap","lineJoin","save","setLineDash","restore","CircleSymbolizer","radius","arc","place","layout","anchor","bboxes","GroupSymbolizer","list","first","labels","label","draws","CenteredSymbolizer","symbolizer","placed","firstLabel","justify","TextSymbolizer","lineHeight","letterSpacing","maxLineCodeUnits","maxLineChars","scratch","linebreak","maxUnits","spaceBefore","lastIndexOf","spaceAfter","after","longestLine","longestLineLen","metrics","measureText","ascent","actualBoundingBoxAscent","descent","actualBoundingBoxDescent","extra","textStrokeWidth","startX","xPos","letter","strokeText","fillText","CenteredTextSymbolizer","centered","OffsetSymbolizer","offsetX","offsetY","placements","ddValues","_c","fb","offsetXvalue","offsetYvalue","justifyValue","ddOffsetX","ddOffsetY","ddJustify","ddPlacements","getBbox","origin","placement","xAxisOffset","computeXaxisOffset","yAxisOffset","computeYaxisOffset","computeJustify","bboxCollides","order","placeLabelInPoint","labelWidth","labelHalfWidth","labelHalfHeight","labelBottom","labelCenterHeight","fixedJustify","OffsetTextSymbolizer","LineLabelSymbolizer","maxLabelCodeUnits","maxLabelChars","fbbox","overzoom","labelCandidates","candidate","cells","spacing","lineCells","heightPlacement","deduplicationKey","deduplicationDistance","getString","getNumber","themes_default","light","background","earth","park_a","park_b","hospital","industrial","school","wood_a","wood_b","pedestrian","scrub_a","scrub_b","glacier","sand","beach","aerodrome","runway","water","pier","zoo","military","tunnel_other_casing","tunnel_minor_casing","tunnel_link_casing","tunnel_medium_casing","tunnel_major_casing","tunnel_highway_casing","tunnel_other","tunnel_minor","tunnel_link","tunnel_medium","tunnel_major","tunnel_highway","transit_pier","buildings","minor_service_casing","minor_casing","link_casing","medium_casing","major_casing_late","highway_casing_late","minor_service","minor_a","minor_b","medium","major_casing_early","major","highway_casing_early","highway","railway","boundaries","waterway_label","bridges_other_casing","bridges_minor_casing","bridges_link_casing","bridges_medium_casing","bridges_major_casing","bridges_highway_casing","bridges_other","bridges_minor","bridges_link","bridges_medium","bridges_major","bridges_highway","roads_label_minor","roads_label_minor_halo","roads_label_major","roads_label_major_halo","ocean_label","peak_label","subplace_label","subplace_label_halo","city_circle","city_circle_stroke","city_label","city_label_halo","state_label","state_label_halo","country_label","dark","white","grayscale","black","import_point_geometry5","import_rbush","import_point_geometry4","transformGeom","loop","coord","wrap","dim","View","tileCache","maxDataLevel","dataTilesForBounds","displayZoom","fractional","needed","dataTile","basetileSize","dataZoom","mintileX","mintileY","maxtileX","maxtileY","dataTileForDisplayTile","displayTile","tt","getDisplayTile","roundedZoom","Index","maxLabeledTiles","tree","hasPrefix","tileKey","searchBbox","Set","indexedLabel","searchLabel","labelCollides","deduplicationCollides","testBbox","collision","makeEntry","newSet","wrapsLeft","wrapsRight","newBboxes","duplicateLabel","entry2","pruneOrNoop","keyAdded","added","maxKey","maxDist","keysForDs","existingKey","existing","pruneKey","keyToRemove","indexedLabels","entriesToDelete","removeLabel","labelToRemove","Labeler","labelRules2","callback","labelRules","preparedTilemap","preparedTiles","keysAdding","preparedTile","tilesInvalidated","rule","visible","dsName","dataSource","dataLayer","feats","transformed","labelAdded","conflict","findInvalidatedTiles","tileWidth","minx","miny","maxx","maxy","leveldiff","log2","wrappedX","covering","allAdded","Labelers","labelers","labeler","getIndex","import_point_geometry6","templatedPMTilesLayer","TemplatedPMTilesLayer","location","ImageLayer","mapMLLayer","MapMLLayer","debugOverlay","DebugOverlay","import_point_geometry8","reflect","promise","reason","leafletLayer","LeafletLayer","options2","noWrap","attribution","theme","paintRules","kind","minAdminLevel","nametags","popRank","backgroundColor","lastRequestedZ","tasks","views","sourceToViews","maxDataZoom","pathname","endsWith","sources","sourcesToViews","debug","getContext","onTilesInvalidated","rerenderTile","window","devicePixelRatio","tileDelay","lang","renderTile","element","promises","tileResponses","tileResponse","layoutTime","labelData","_getTiledPixelBounds","tileRange","_pxBoundsToTileRange","tileCenter","priority","distanceTo","duration","clearRect","fillRect","paintingTime","paintRules2","rules","clip","miterLimit","po","ps","rect","fbox","bbox2","strokeRect","paint","xray","ypos","unwrappedK","_tiles","wrappedCoord","_wrapCoords","_keyToTileCoords","el","queryTileFeaturesDebug","featuresBySourceName","sourceName","clearLayout","rerenderTiles","showTile","_removeTile","removed","pmtilesOptions","PAINT_RULES","LABEL_RULES","THEME","_pmtilesLayer","pmtilesLayer","ImageOverlay","_location","_size","_angle","viewreset","_reset","_zoomAnimated","zoomanim","_animateZoom","_onImageLoad","_initImage","addInteractiveTarget","removeInteractiveTarget","Date","_updateOpacity","image","nextFrame","fade","setOpacity","cancelAnimFrame","_fadeFrame","requestAnimFrame","layerEl","_href","_mapmlTileContainer","_initialize","getHref","titleIsReadOnly","_titleIsReadOnly","setName","newName","_title","getName","_staticTileLayer","_attachSkipButtons","_calculateBounds","projectionBounds","getBoundsFromMeta","getZoomBoundsFromMeta","mapExtents","zoomMax","zoomMin","mapExtentLayer","_extentLayer","getAttribution","getBase","baseURI","native","licenseLink","licenseTitle","licenseUrl","attText","legendLink","_legendUrl","attributionControl","addAttribution","parseLicenseAndLegend","newTiles","importNode","processTiles","_mapmlvectors","_toggleControls","getQueryTemplates","queryLinks","templates","getBounds","_templateVars","content","getElementsByClassName","_eventParents","attachZoomLink","mapExtent","mapFocusButton","stop","_sortIndex","previousButton","featureCount","totalFeatures","nextButton","controlFocusButton","currentIndex","inBoundFeatures","_controlContainer","divider","focusFeature","focusEvent","composedPath","isTab","keyCode","shiftPressed","shiftKey","focusMap","stopPropagation","_popupClosed","featureEl","_groupLayer","tL","topLeft","gcrs","bR","bottomRight","latLngBounds","latLng","zoomLink","getZoomToZoom","locale","popupZoom","onclick","onkeydown","MouseEvent","zoomTo","insertBefore","featureIndexOverlayOption","removeHandlers","removeEvent","mapSize","_panel","debugPanel","_grid","debugGrid","_panes","mapPane","_vectors","debugVectors","toolPane","DebugPanel","_infoContainer","_debugContainer","infoContainer","_tileCoord","_tileMatrixCoord","_mapCoord","_tcrsCoord","_pcrsCoord","_gcrsCoord","_updateCoords","_visible","project","pointI","pointJ","DebugGrid","outline","DebugVectors","_mapLayerUpdate","_centerVector","circle","pointToLatLng","_addBounds","colors","boundsArray","boundsTestTag","getLayerEl","boundsRect","projectedExtent","fillOpacity","totalBounds","totalLayerBounds","totalBoundsArray","ProjectedExtent","Path","unproject","_locations","locations","_rings","_subtract","_parts","_renderer","_updatePoly","QueryHandler","Handler","addHooks","_queryTopLayer","_queryTopLayerAtMapCenter","removeHooks","_getTopQueryableLayer","queryable","event","isFocused","layerPoint","latLngToLayerPoint","latLngToContainerPoint","_mapmlFeatures","_query","tcrs2pcrs","tcrs2gcrs","popupOptions","autoPan","maxHeight","tcrsClickLoc","latLngToPoint","tileMatrixClickLoc","tileBounds","Bounds","pcrsClick","fetches","tilei","tilej","mapi","mapj","pixelleft","pixeltop","pixelright","pixelbottom","column","longitude","latitude","mapbottom","mapleft","maptop","mapright","tilebottom","tileleft","tiletop","tileright","contenttype","queryMetas","mapmldoc","geometrylessFeatures","firstElementChild","cloneNode","featureDocument","featureCollection","html","featureDoc","append","message","fetchFeatures","results","openPopup","_popup","displayFeaturesPopup","ContextMenu","_touchstart","msPointer","pointer","activeIndex","excludedIndices","isRunned","_menuItems","CTXBACK","CTXFWD","CTXRELOAD","CTXFULLSCR","CTXSPACER1","CTXCOPY","CTXPASTE","CTXSPACER2","CTXCNTRLS","CTXDEBUG","CTXVWSRC","_items","cmBack","_goBack","cmForward","_goForward","cmReload","_reload","btnFullScreen","_toggleFullScreen","spacer","cmCopyCoords","_copyCoords","hideOnSelect","submenu","cmCopyMapML","_copyMapML","cmCopyExtent","_copyExtent","cmCopyLocation","_copyLocation","cmPasteLayer","_paste","cmToggleControls","cmToggleDebug","_toggleDebug","cmViewSource","_viewSource","defExtCS","defaultExtCoor","defLocCS","defaultLocCoor","LYRZOOMTO","LYRCOPY","_layerItems","lmZoomToLayer","_zoomToLayer","lmCopyLayer","_copyLayer","_extentLayerItems","lmZoomToExtent","_zoomToMapExtent","lmCopyExtent","_copyMapExtent","_mapMenuVisible","_keyboardEvent","_createItem","_copySubMenu","_clickEvent","CPYMENUMAP","CPYMENUEXTENT","CPYMENULOC","_hide","_onKeyDown","touch","contextmenu","_show","mousedown","_updateCS","KeyboardEvent","_copyData","_layerClicked","layerElem","getOuterHTML","extentElem","forward","back","reload","controls","outerHTML","navigator","clipboard","readText","_pasteLayer","viewSource","toggleDebug","_showCopySubMenu","execCommand","menu","_copyTile","_copyTileMatrix","_copyMap","_copyTCRS","_copyPCRS","_copyGCRS","click","caption","pointX","pointY","mapPt","_copyAllCoords","allData","_createSeparator","_insertElementAt","_createEventHandler","_onItemMouseOver","_onItemMouseOut","func","_showLocation","containerPointToLayerPoint","layerPointToLatLng","refEl","closest","_showAtPoint","layerList","find","checked","gecko","getBoundingClientRect","activeEl","button","activeElement","_elementInFocus","_layerMenuTabs","firstChild","_extentLayerMenuTabs","_setPosition","containerSize","_getElementSize","contextmenuAnchor","_leaflet_pos","_sizeChanged","offsetWidth","offsetHeight","_focusOnLayerControl","_setActiveItem","noActiveEl","disabled","nextIndex","prevIndex","copyEl","menuWidth","submenuWidth","_hideCopySubMenu","srcElement","toggleContextMenuItem","state","setViewFullScreenInnerHTML","btnExitFullScreen","tcrsTopLeft","tcrsBottomRight","tileMatrixTopLeft","tileMatrixBottomRight","minConverted","maxConverted","unprojectedMin","unprojectedMax","tcrs","FALLBACK_CS","isFinite","minPixel","maxPixel","minGCRS","maxGCRS","pixelToPCRSPoint","pointToPCRSPoint","contentArray","stringSplit","prop","containerPoints","pairs","array","_parseNumber","justPan","inPlace","open","postTraversalSetup","lon","pseudo","ShadowRoot","FALLBACK_PROJECTION","metaKeys","axes","csToAxes","nMin","nMax","mapmlEl","dfLayer","lastElementChild","dfPastedLayer","geojson2mapml","json","table","thead","createTHead","insertRow","th1","th2","createTextNode","tbody","createTBody","th","bboxExtent","geometryFunction","jsonType","setExtent","xmlStringLayer","multiPoint","linestring","multilinestring","multiPolygon","geometrycollection","NEGATIVE_INFINITY","clone_feature","curr_feature","featureCaption","HTMLElement","_properties2Table","_updateExtent","clone_point","clone_coords","clone_linestring","linestring_coordindates","clone_polygon","clone_multipoint","clone_multilinestring","geometries","fg","arr","arrayOfArrays","tableData","tr","dest","pointConv","proj4","_breakArray","_pcrsToGcrs","newArr","conv","propertyFunction","Proj","metas","ex","_table2properties","prop0","_geometry2geojson","geoms","bound","newZoom","mapCenterTCRS","mapHalf","mapTlNew","mapBrNew","mapTlPCRSNew","mapBrPCRSNew","mapPCRS","zOffset","selector","getClosest","host","matches","AttributionButton","Attribution","disableClickPropagation","_addAttribution","dialog","kbdShortcuts","kbdMovement","kbdPanUp","kbdPanDown","kbdPanLeft","kbdPanRight","btnZoomIn","btnZoomOut","kbdPanIncrement","kbdZoom","kbdFeature","kbdPrevFeature","kbdNextFeature","attribs","_attributions","prefixAndAttribs","btnAttribution","mergeOptions","toggleableAttributionControl","addInitHook","attributionButton","reloadButton","ReloadButton","scaleBar","ScaleBar","_goReload","_reloadButton","_updateDisabled","disable","_disabled","enable","Scale","maxWidth","updateWhenIdle","scaleControl","_scaleControl","_updateOutput","_focusOutput","addEventListener","_pixelsToDistance","px","dpi","_scaleLength","scaleLength","outputFocus","output","scaleLine","distance","metric","FullscreenButton","false","true","_toggleTitle","_click","toggleFullscreen","isFullscreen","include","_isFullscreen","pseudoFullscreen","_disablePseudoFullscreen","exitFullscreen","mozCancelFullScreen","webkitCancelFullScreen","msExitFullscreen","_enablePseudoFullscreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","ALLOW_KEYBOARD_INPUT","msRequestFullscreen","_setFullscreen","fullscreen","invalidateSize","_onFullscreenChange","fullscreenElement","fullscreenControl","fullscreenchange","onFullscreenChange","addControl","fullscreenButton","geolocationButton","GeolocationButton","crosshair","Crosshair","Geometry","CustomLocate","Locate","locateControl","showPopup","strings","btnLocTrackOff","locateOptions","MutationObserver","mutations","btnLocTrackOn","_marker","btnMyLocTrackOn","permanent","btnLocTrackLastKnown","btnMyLastKnownLocTrackOn","observe","attributeFilter","_isQueryable","_toggleEvents","_isMapFocused","_addOrRemoveCrosshair","_hasQueryableLayer","_addOrRemoveMapOutline","mapContainer","_outline","isLeafletContainer","_convertWrappers","_markup","_convertMarkup","_generateOutlinePoints","isClosed","_isClosed","attachLinkHandler","dragStart","hovered","handleMouse","visited","clientX","clientY","mouseup","onTop","nextLayer","nextElementSibling","eventPhase","Event","BUBBLING_PHASE","_handleLink","currentTarget","resolver","mapWidth","clientWidth","mouseout","mouseenter","addedMap","tileOrigin","zoomingTo","pixelRings","_convertRing","subP","subrings","pixelSubrings","pixelOutline","parts","interm","attr","featureAttributes","tabindex","subRings","_coordinateToArrays","cls","class","nodes","childNodes","cur","tempDiv","prev","main","subParts","isFirst","parents","span","noSpan","local","numPair","attrMap","wrapperAttr","linkTarget","linkType","getPCRSCenter","stampLayer","outlinePath","_createPath","_updateStyle","_rootGroup","outlineAdded","_removePath","_setPath","geometryToPath","_pointToMarker","_updatePathStyle","isMain","isOutline","dashArray","dashOffset","fillColor","fillRule","def","closed","len2","firstLayer","_openPopup","_handleFocus","updateInteraction","layerID","addToIndex","subPart","vectorMinZoom","vectorMaxZoom","openTooltip","closeTooltip","prevFocus","nextFocus","AnnounceMovement","layeradd","layerremove","announceBounds","dragging","_draggable","dragged","focusAnnouncement","removeEventListener","standard","amZoom","getMaxZoom","amMaxZoom","_layersMinZoom","amMinZoom","_traversalCall","getMinZoom","outOfBoundsPos","prevZoom","_historyIndex","inBoundsPos","amZoomedOut","wasDragged","amDraggedOut","amEastBound","amWestBound","amNorthBound","amSouthBound","whenLayersReady","FeatureIndex","outBoundFeatures","_mapPCRSBounds","_updateMapBounds","lc","mc","tmp","inbound","ac","bc","Options","announceMovement","announceScale","imperial","lcOpacity","amColumn","amRow","dfExtent","fIndexNoFeatures","Keyboard","altKey","metaKey","_panKeys","_panAnim","_inProgress","ctrlKey","panBy","maxBounds","panInsideBounds","_zoomKeys","187","107","61","171","189","109","54","173","setZoom","closeOnEscapeKey","featureIndexOverlay","FeatureIndexOverlay","createLayerControlExtentHTML","extentProperties","extentSettings","extentLabel","svgExtentControlIcon","extentControlPath1","extentControlPath2","extentNameIcon","extentItemControls","opacityControl","extentOpacitySummary","mapSelects","selectdetails","removeExtentButton","extentsettingsButton","extentItemNameSpan","defaultChecked","_layerControlCheckbox","ontouchstart","onmousedown","downEvent","TouchEvent","touches","control","moving","yPos","originalPosition","ontouchmove","onmousemove","moveEvent","pointerEvents","root","elementAt","elementFromPoint","swapControl","nextSibling","ontouchend","onmouseup","newPosition","controlsElems","extentZIndex","_extentRootFieldset","_opacityControl","_layerControlLabel","async","createLayerControlHTML","fieldset","layerItemName","settingsButtonNameIcon","layerItemProperty","layerItemSettings","itemToggleLabel","layerItemControls","opacityControlSummary","svgSettingsControlIcon","settingsControlPath1","settingsControlPath2","extentsFieldset","removeControlButton","disbaled","previousElementSibling","itemSettingControlButton","_layerControl","draggable","styleLinks","styles","getAlternateStyles","_layerItemSettingsHTML","_propertiesGroupAnatomy","_styles","mapExtentLayerControls","getLayerControlHTML","_output","_body","initialFocus","_addOrRemoveFeatureIndex","_checkOverlap","_calculateReticleBounds","wRatio","hRatio","reticleDimension","getComputedStyle","minPoint","maxPoint","popupClosed","featureIndexBounds","noFeaturesMessage","allFeatures","_addToggleKeys","_newContent","direction","newContent","ZoomInput","validateInput","getValue","HiddenInput","WidthInput","HeightInput","LocationInput","rel","axisCS","_templates","_tileZoom","DOMTokenList","#element","#valueSet","#attribute","#domain","domain","hostingElement","domtokenlist","valueSet","item","token","oldToken","newToken","supports","toggle","force","thisArg","detectImagePath","getStyle","mime","mapOptions","head","WGS84","CRS","CBMTILE","APSTILE","OSMTILE","EPSG3857","convertPCRSBounds","axisToXY","_convertAndFormatPCRS","_splitCoordinate","_coordsToArray","_gcrsToTileMatrix","mapml2geojson","getZoomBounds","_createLayerControlExtentHTML","_createLayerControlHTML","TILE_SIZE"],"mappings":"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"}