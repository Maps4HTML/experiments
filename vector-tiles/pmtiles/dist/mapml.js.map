{"version":3,"file":"mapml.js","sources":["mapml.js"],"sourcesContent":["(function () {\n  'use strict';\n\n  var StaticTileLayer = L.GridLayer.extend({\n    initialize: function (options) {\n      L.setOptions(this, options);\n      this.zoomBounds = this._getZoomBounds(\n        options.tileContainer,\n        options.maxZoomBound\n      );\n      L.extend(this.options, this.zoomBounds);\n      this._groups = this._groupTiles(\n        this.options.tileContainer.getElementsByTagName('map-tile')\n      );\n      this._bounds = this._getLayerBounds(this._groups, this.options.projection); //stores meter values of bounds\n      this.layerBounds = this._bounds[Object.keys(this._bounds)[0]];\n      for (let key of Object.keys(this._bounds)) {\n        this.layerBounds.extend(this._bounds[key].min);\n        this.layerBounds.extend(this._bounds[key].max);\n      }\n    },\n\n    onAdd: function (map) {\n      this._map = map;\n      L.GridLayer.prototype.onAdd.call(this, this._map);\n      this._handleMoveEnd();\n    },\n\n    getEvents: function () {\n      let events = L.GridLayer.prototype.getEvents.call(this, this._map);\n      this._parentOnMoveEnd = events.moveend;\n      events.moveend = this._handleMoveEnd;\n      events.move = () => {}; //needed to prevent moveend from running\n      return events;\n    },\n\n    isVisible: function () {\n      let mapZoom = this._map.getZoom();\n      let zoomLevel = mapZoom;\n      zoomLevel =\n        zoomLevel > this.options.maxNativeZoom\n          ? this.options.maxNativeZoom\n          : zoomLevel;\n      zoomLevel =\n        zoomLevel < this.options.minNativeZoom\n          ? this.options.minNativeZoom\n          : zoomLevel;\n      return (\n        mapZoom <= this.zoomBounds.maxZoom &&\n        mapZoom >= this.zoomBounds.minZoom &&\n        this._bounds[zoomLevel] &&\n        this._bounds[zoomLevel].overlaps(\n          M.pixelToPCRSBounds(\n            this._map.getPixelBounds(),\n            this._map.getZoom(),\n            this._map.options.projection\n          )\n        )\n      );\n    },\n\n    //sets the bounds flag of the layer and calls default moveEnd if within bounds\n    //its the zoom level is between the nativeZoom and zoom then it uses the nativeZoom value to get the bound its checking\n    _handleMoveEnd: function (e) {\n      if (!this.isVisible()) return; //onMoveEnd still gets fired even when layer is out of bounds??, most likely need to overrride _onMoveEnd\n      this._parentOnMoveEnd();\n    },\n\n    _isValidTile(coords) {\n      return this._groups[this._tileCoordsToKey(coords)];\n    },\n\n    createTile: function (coords) {\n      let tileGroup = this._groups[this._tileCoordsToKey(coords)] || [],\n        tileElem = document.createElement('map-tile'),\n        tileSize = this.getTileSize();\n      tileElem.setAttribute('col', coords.x);\n      tileElem.setAttribute('row', coords.y);\n      tileElem.setAttribute('zoom', coords.z);\n\n      for (let i = 0; i < tileGroup.length; i++) {\n        let tile = document.createElement('img');\n        tile.width = tileSize.x;\n        tile.height = tileSize.y;\n        tile.alt = '';\n        tile.setAttribute('role', 'presentation');\n        tile.src = tileGroup[i].src;\n        tileElem.appendChild(tile);\n      }\n      return tileElem;\n    },\n\n    _getLayerBounds: function (tileGroups, projection) {\n      let layerBounds = {},\n        tileSize = M[projection].options.crs.tile.bounds.max.x;\n      for (let tile in tileGroups) {\n        let sCoords = tile.split(':'),\n          pixelCoords = {};\n        pixelCoords.x = +sCoords[0] * tileSize;\n        pixelCoords.y = +sCoords[1] * tileSize;\n        pixelCoords.z = +sCoords[2]; //+String same as parseInt(String)\n        if (sCoords[2] in layerBounds) {\n          layerBounds[sCoords[2]].extend(L.point(pixelCoords.x, pixelCoords.y));\n          layerBounds[sCoords[2]].extend(\n            L.point(pixelCoords.x + tileSize, pixelCoords.y + tileSize)\n          );\n        } else {\n          layerBounds[sCoords[2]] = L.bounds(\n            L.point(pixelCoords.x, pixelCoords.y),\n            L.point(pixelCoords.x + tileSize, pixelCoords.y + tileSize)\n          );\n        }\n      }\n      // TODO: optimize by removing 2nd loop, add util function to convert point in pixels to point in pcrs, use that instead then this loop\n      // won't be needed\n      for (let pixelBounds in layerBounds) {\n        let zoom = +pixelBounds;\n        layerBounds[pixelBounds] = M.pixelToPCRSBounds(\n          layerBounds[pixelBounds],\n          zoom,\n          projection\n        );\n      }\n      return layerBounds;\n    },\n\n    _getZoomBounds: function (container, maxZoomBound) {\n      if (!container) return null;\n      // should read zoom information from map-meta (of layer-) instead of the zoom attribute value of map-tile\n      let meta = M._metaContentToObject(\n          this.options._leafletLayer._layerEl\n            .querySelector('map-meta[name=zoom]')\n            .getAttribute('content')\n        ),\n        zoom = {},\n        tiles = container.getElementsByTagName('map-tile');\n      zoom.nativeZoom = +meta.value || 0;\n      zoom.maxNativeZoom = 0;\n      zoom.minNativeZoom = maxZoomBound;\n      for (let i = 0; i < tiles.length; i++) {\n        let lZoom = +tiles[i].getAttribute('zoom');\n        if (!tiles[i].getAttribute('zoom')) lZoom = zoom.nativeZoom;\n        zoom.minNativeZoom = Math.min(zoom.minNativeZoom, lZoom);\n        zoom.maxNativeZoom = Math.max(zoom.maxNativeZoom, lZoom);\n      }\n\n      // currently the min and max zoom bounds of staticTileLayer is set based on map-meta\n      // can be hard coded to only natively zoom out 2 levels, any more and too many tiles are going to be loaded in at one time\n      // it will avoid lagging the users computer, but it will also cause the bug that the initial zoom level of map is inproperly set\n      zoom.minZoom = +meta.min || 0;\n      zoom.maxZoom = +meta.max || maxZoomBound;\n      return zoom;\n    },\n\n    _groupTiles: function (tiles) {\n      let tileMap = {};\n      for (let i = 0; i < tiles.length; i++) {\n        let tile = {};\n        tile.row = +tiles[i].getAttribute('row');\n        tile.col = +tiles[i].getAttribute('col');\n        tile.zoom = +tiles[i].getAttribute('zoom') || this.options.nativeZoom;\n        tile.src = tiles[i].getAttribute('src');\n        let tileCode = tile.col + ':' + tile.row + ':' + tile.zoom;\n        if (tileCode in tileMap) {\n          tileMap[tileCode].push(tile);\n        } else {\n          tileMap[tileCode] = [tile];\n        }\n      }\n      return tileMap;\n    }\n  });\n\n  var staticTileLayer = function (options) {\n    return new StaticTileLayer(options);\n  };\n\n  var LayerControl = L.Control.Layers.extend({\n    /* removes 'base' layers as a concept */\n    options: {\n      autoZIndex: false,\n      sortLayers: true,\n      sortFunction: function (layerA, layerB) {\n        return layerA.options.zIndex < layerB.options.zIndex\n          ? -1\n          : layerA.options.zIndex > layerB.options.zIndex\n          ? 1\n          : 0;\n      }\n    },\n    initialize: function (overlays, options) {\n      L.setOptions(this, options);\n\n      // the _layers array contains objects like {layer: layer, name: \"name\", overlay: true}\n      // the array index is the id of the layer returned by L.stamp(layer) which I guess is a unique hash\n      this._layerControlInputs = [];\n      this._layers = [];\n      this._lastZIndex = 0;\n      this._handlingClick = false;\n\n      for (var i in overlays) {\n        this._addLayer(overlays[i], i, true);\n      }\n    },\n    onAdd: function () {\n      this._initLayout();\n      // Adding event on layer control button\n      L.DomEvent.on(\n        this._container.getElementsByTagName('a')[0],\n        'keydown',\n        this._focusFirstLayer,\n        this._container\n      );\n      L.DomEvent.on(\n        this._container,\n        'contextmenu',\n        this._preventDefaultContextMenu,\n        this\n      );\n      this._update();\n      if (this._layers.length < 1 && !this._map._showControls) {\n        this._container.setAttribute('hidden', '');\n      } else {\n        this._map._showControls = true;\n      }\n      return this._container;\n    },\n    onRemove: function (map) {\n      L.DomEvent.off(\n        this._container.getElementsByTagName('a')[0],\n        'keydown',\n        this._focusFirstLayer,\n        this._container\n      );\n    },\n    addOrUpdateOverlay: function (layer, name) {\n      var alreadyThere = false;\n      for (var i = 0; i < this._layers.length; i++) {\n        if (this._layers[i].layer === layer) {\n          alreadyThere = true;\n          this._layers[i].name = name;\n          // replace the controls with updated controls if necessary.\n          break;\n        }\n      }\n      if (!alreadyThere) {\n        this.addOverlay(layer, name);\n      }\n      if (this._layers.length > 0) {\n        this._container.removeAttribute('hidden');\n        this._map._showControls = true;\n      }\n      return this._map ? this._update() : this;\n    },\n    removeLayer: function (layer) {\n      L.Control.Layers.prototype.removeLayer.call(this, layer);\n      if (this._layers.length === 0) {\n        this._container.setAttribute('hidden', '');\n      }\n    },\n\n    _checkDisabledLayers: function () {},\n\n    // focus the first layer in the layer control when enter is pressed\n    _focusFirstLayer: function (e) {\n      if (\n        e.key === 'Enter' &&\n        this.className ===\n          'leaflet-control-layers leaflet-control leaflet-control-layers-expanded'\n      ) {\n        var elem =\n          this.children[1].children[2].children[0].children[0].children[0]\n            .children[0];\n        if (elem) setTimeout(() => elem.focus(), 0);\n      }\n    },\n\n    // imported from leaflet with slight modifications\n    // for layerControl ordering based on zIndex\n    _update: function () {\n      if (!this._container) {\n        return this;\n      }\n\n      L.DomUtil.empty(this._baseLayersList);\n      L.DomUtil.empty(this._overlaysList);\n\n      this._layerControlInputs = [];\n      var baseLayersPresent,\n        overlaysPresent,\n        i,\n        obj,\n        baseLayersCount = 0;\n\n      // <----------- MODIFICATION from the default _update method\n      // sort the layercontrol layers object based on the zIndex\n      // provided by MapMLLayer\n      if (this.options.sortLayers) {\n        this._layers.sort((a, b) =>\n          this.options.sortFunction(a.layer, b.layer, a.name, b.name)\n        );\n      }\n      // -------------------------------------------------->\n      for (i = 0; i < this._layers.length; i++) {\n        obj = this._layers[i];\n        this._addItem(obj);\n        overlaysPresent = overlaysPresent || obj.overlay;\n        baseLayersPresent = baseLayersPresent || !obj.overlay;\n        baseLayersCount += !obj.overlay ? 1 : 0;\n      }\n\n      // Hide base layers section if there's only one layer.\n      if (this.options.hideSingleBase) {\n        baseLayersPresent = baseLayersPresent && baseLayersCount > 1;\n        this._baseLayersList.style.display = baseLayersPresent ? '' : 'none';\n      }\n\n      this._separator.style.display =\n        overlaysPresent && baseLayersPresent ? '' : 'none';\n\n      return this;\n    },\n\n    _addItem: function (obj) {\n      var layercontrols = obj.layer._layerEl._layerControlHTML;\n      // the input is required by Leaflet...\n      obj.input = layercontrols.querySelector(\n        'input.leaflet-control-layers-selector'\n      );\n\n      this._layerControlInputs.push(obj.input);\n      obj.input.layerId = L.stamp(obj.layer);\n\n      this._overlaysList.appendChild(layercontrols);\n      return layercontrols;\n    },\n\n    //overrides collapse and conditionally collapses the panel\n    collapse: function (e) {\n      // if layer control is not expanded, return\n      if (!this._container.className.includes('expanded')) {\n        return;\n      }\n      // return if layer contextmenu is still open\n      if (\n        !this._map.contextMenu._extentLayerMenu.hidden ||\n        !this._map.contextMenu._layerMenu.hidden\n      ) {\n        return;\n      }\n      if (\n        e.target.tagName === 'SELECT' ||\n        (e.relatedTarget &&\n          e.relatedTarget.parentElement &&\n          (e.relatedTarget.className === 'mapml-contextmenu mapml-layer-menu' ||\n            e.relatedTarget.parentElement.className ===\n              'mapml-contextmenu mapml-layer-menu')) ||\n        (this._map && this._map.contextMenu._layerMenu.style.display === 'block')\n      )\n        return this;\n\n      L.DomUtil.removeClass(this._container, 'leaflet-control-layers-expanded');\n      if (e.originalEvent?.pointerType === 'touch') {\n        this._container._isExpanded = false;\n      }\n      return this;\n    },\n    _preventDefaultContextMenu: function (e) {\n      let latlng = this._map.mouseEventToLatLng(e);\n      let containerPoint = this._map.mouseEventToContainerPoint(e);\n      e.preventDefault();\n      // for touch devices, when the layer control is not expanded,\n      // the layer context menu should not show on map\n      if (!this._container._isExpanded && e.pointerType === 'touch') {\n        this._container._isExpanded = true;\n        return;\n      }\n      this._map.fire('contextmenu', {\n        originalEvent: e,\n        containerPoint: containerPoint,\n        latlng: latlng\n      });\n    }\n  });\n  var layerControl = function (layers, options) {\n    return new LayerControl(layers, options);\n  };\n\n  var FeatureLayer = L.FeatureGroup.extend({\n    /*\n     * M.MapML turns any MapML feature data into a Leaflet layer. Based on L.GeoJSON.\n     *\n     * Used by MapMLLayer to create _mapmlvectors property, used to render features\n     */\n    initialize: function (mapml, options) {\n      /*\n          mapml:\n          1. for query: an array of map-feature elements that it fetches\n          2. for static templated feature: null\n          3. for non-templated feature: layer- (with no src) or mapml file (with src)\n        */\n      // options.extent: when you use a FeatureLayer, you can either get it to calculate the\n      // .layerBounds dynamically (the default), based on adds/removes of features from the layer/\n      // or you can construct it with a bounds (via options.extent),\n      // which will then remain static for the lifetime of the layer\n\n      L.FeatureGroup.prototype.initialize.call(this, null, options);\n      // this.options.static is false ONLY for tiled vector features\n      // this._staticFeature is ONLY true when not used by TemplatedFeaturesLayer\n      // this.options.query true when created by QueryHandler.js\n\n      if (!this.options.tiles) {\n        // not a tiled vector layer\n        this._container = null;\n        if (this.options.query) {\n          this._container = L.DomUtil.create(\n            'div',\n            'leaflet-layer',\n            this.options.pane\n          );\n          // must have leaflet-pane class because of new/changed rule in leaflet.css\n          // info: https://github.com/Leaflet/Leaflet/pull/4597\n          L.DomUtil.addClass(\n            this._container,\n            'leaflet-pane mapml-vector-container'\n          );\n        } else if (this.options._leafletLayer) {\n          this._container = L.DomUtil.create(\n            'div',\n            'leaflet-layer',\n            this.options.pane\n          );\n          L.DomUtil.addClass(\n            this._container,\n            'leaflet-pane mapml-vector-container'\n          );\n          // static mapmlvector should always at the top\n          //        this._container.style.zIndex = 1000;\n        } else {\n          // if the current featureLayer is a sublayer of templatedFeatureLayer,\n          // append <svg> directly to the templated feature container (passed in as options.pane)\n          this._container = this.options.pane;\n          L.DomUtil.addClass(\n            this._container,\n            'leaflet-pane mapml-vector-container'\n          );\n        }\n        L.setOptions(this.options.renderer, { pane: this._container });\n      }\n      if (this.options.query) {\n        this._queryFeatures = mapml.features ? mapml.features : mapml;\n      } else if (!mapml) {\n        // use this.options._leafletLayer to distinguish the featureLayer constructed for initialization and for templated features / tiles\n        if (this.options._leafletLayer) {\n          // this._staticFeature should be set to true to make sure the _getEvents works properly\n          this._features = {};\n          this._staticFeature = true;\n        }\n      }\n    },\n\n    isVisible: function () {\n      let map = this.options.mapEl._map;\n      // if query, isVisible is unconditionally true\n      if (this.options.query) return true;\n      // if the featureLayer is for static features, i.e. it is the mapmlvector layer,\n      // if it is empty, isVisible = false\n      // this._staticFeature: flag to determine if the featureLayer is used by static features only\n      // this._features: check if the current static featureLayer is empty\n      // (Object.keys(this._features).length === 0 => this._features is an empty object)\n      else if (this._staticFeature && Object.keys(this._features).length === 0) {\n        return false;\n      } else {\n        let mapZoom = map.getZoom(),\n          zoomBounds = this.zoomBounds || this.options.zoomBounds,\n          layerBounds = this.layerBounds || this.options.layerBounds,\n          withinZoom = zoomBounds\n            ? mapZoom <= zoomBounds.maxZoom && mapZoom >= zoomBounds.minZoom\n            : false;\n        return (\n          withinZoom &&\n          this._layers &&\n          layerBounds &&\n          layerBounds.overlaps(\n            M.pixelToPCRSBounds(\n              map.getPixelBounds(),\n              mapZoom,\n              map.options.projection\n            )\n          )\n        );\n      }\n    },\n\n    onAdd: function (map) {\n      this._map = map;\n      L.FeatureGroup.prototype.onAdd.call(this, map);\n      if (this._staticFeature) {\n        this._validateRendering();\n      }\n      if (this._queryFeatures)\n        map.on('featurepagination', this.showPaginationFeature, this);\n    },\n    addLayer: function (layerToAdd) {\n      L.FeatureGroup.prototype.addLayer.call(this, layerToAdd);\n      // static FeatureLayer (e.g. MapMLLayer._mapmlvectors) NEVER has a\n      // .layerBounds property, so if there is this.options.layerBounds, don't\n      // go copying it to this.layerBounds.  Same for zoomBounds.\n      // bug alert: it's necessary to create a new bounds object to initialize\n      // this.layerBounds, to avoid changing the layerBounds of the first geometry\n      // added to this layer\n      if (!this.options.layerBounds) {\n        this.layerBounds = this.layerBounds\n          ? this.layerBounds.extend(layerToAdd.layerBounds)\n          : L.bounds(layerToAdd.layerBounds.min, layerToAdd.layerBounds.max);\n\n        if (this.zoomBounds) {\n          if (layerToAdd.zoomBounds.minZoom < this.zoomBounds.minZoom)\n            this.zoomBounds.minZoom = layerToAdd.zoomBounds.minZoom;\n          if (layerToAdd.zoomBounds.maxZoom > this.zoomBounds.maxZoom)\n            this.zoomBounds.maxZoom = layerToAdd.zoomBounds.maxZoom;\n          if (layerToAdd.zoomBounds.minNativeZoom < this.zoomBounds.minNativeZoom)\n            this.zoomBounds.minNativeZoom = layerToAdd.zoomBounds.minNativeZoom;\n          if (layerToAdd.zoomBounds.maxNativeZoom > this.zoomBounds.maxNativeZoom)\n            this.zoomBounds.maxNativeZoom = layerToAdd.zoomBounds.maxNativeZoom;\n        } else {\n          this.zoomBounds = layerToAdd.zoomBounds;\n        }\n      }\n      if (this._staticFeature) {\n        // TODO: validate the use the feature.zoom which is new (was in createGeometry)\n        let featureZoom = layerToAdd.options.mapmlFeature.zoom;\n        if (featureZoom in this._features) {\n          this._features[featureZoom].push(layerToAdd);\n        } else {\n          this._features[featureZoom] = [layerToAdd];\n        }\n        // hide/display features based on the their zoom limits\n        this._validateRendering();\n      }\n      return this;\n    },\n    addRendering: function (featureToAdd) {\n      L.FeatureGroup.prototype.addLayer.call(this, featureToAdd);\n    },\n    onRemove: function (map) {\n      if (this._queryFeatures) {\n        map.off('featurepagination', this.showPaginationFeature, this);\n        delete this._queryFeatures;\n        L.DomUtil.remove(this._container);\n      }\n      L.FeatureGroup.prototype.onRemove.call(this, map);\n      this._map.featureIndex.cleanIndex();\n    },\n\n    removeLayer: function (featureToRemove) {\n      L.FeatureGroup.prototype.removeLayer.call(this, featureToRemove);\n      if (!this.options.layerBounds) {\n        delete this.layerBounds;\n        // this ensures that the <layer->.extent gets recalculated if needed\n        delete this.options._leafletLayer.bounds;\n        delete this.zoomBounds;\n        // this ensures that the <layer->.extent gets recalculated if needed\n        delete this.options._leafletLayer.zoomBounds;\n        delete this._layers[featureToRemove._leaflet_id];\n        this._removeFromFeaturesList(featureToRemove);\n        // iterate through all remaining layers\n        let layerBounds, zoomBounds;\n        let layerIds = Object.keys(this._layers);\n        // re-calculate the layerBounds and zoomBounds for the whole layer when\n        // a feature is permanently removed from the overall layer\n        // bug alert: it's necessary to create a new bounds object to initialize\n        // this.layerBounds, to avoid changing the layerBounds of the first geometry\n        // added to this layer\n        for (let id of layerIds) {\n          let layer = this._layers[id];\n          if (layerBounds) {\n            layerBounds.extend(layer.layerBounds);\n          } else {\n            layerBounds = L.bounds(layer.layerBounds.min, layer.layerBounds.max);\n          }\n          if (zoomBounds) {\n            if (layer.zoomBounds.minZoom < zoomBounds.minZoom)\n              zoomBounds.minZoom = layer.zoomBounds.minZoom;\n            if (layer.zoomBounds.maxZoom > zoomBounds.maxZoom)\n              zoomBounds.maxZoom = layer.zoomBounds.maxZoom;\n            if (layer.zoomBounds.minNativeZoom < zoomBounds.minNativeZoom)\n              zoomBounds.minNativeZoom = layer.zoomBounds.minNativeZoom;\n            if (layer.zoomBounds.maxNativeZoom > zoomBounds.maxNativeZoom)\n              zoomBounds.maxNativeZoom = layer.zoomBounds.maxNativeZoom;\n          } else {\n            zoomBounds = {};\n            zoomBounds.minZoom = layer.zoomBounds.minZoom;\n            zoomBounds.maxZoom = layer.zoomBounds.maxZoom;\n            zoomBounds.minNativeZoom = layer.zoomBounds.minNativeZoom;\n            zoomBounds.maxNativeZoom = layer.zoomBounds.maxNativeZoom;\n          }\n        }\n        // If the last feature is removed, we should remove the .layerBounds and\n        // .zoomBounds properties, so that the FeatureLayer may be ignored\n        if (layerBounds) {\n          this.layerBounds = layerBounds;\n        } else {\n          delete this.layerBounds;\n        }\n        if (zoomBounds) {\n          this.zoomBounds = zoomBounds;\n        } else {\n          delete this.zoomBounds;\n          delete this.options.zoomBounds;\n        }\n      }\n      return this;\n    },\n    /**\n     * Remove the geomtry rendering (an svg g/ M.Geomtry) from the L.FeatureGroup\n     * _layers array, so that it's not visible on the map, but still contributes\n     * to the bounds and zoom limits of the M.FeatureLayer.\n     *\n     * @param {type} featureToRemove\n     * @returns {undefined}\n     */\n    removeRendering: function (featureToRemove) {\n      L.FeatureGroup.prototype.removeLayer.call(this, featureToRemove);\n    },\n    _removeFromFeaturesList: function (feature) {\n      for (let zoom in this._features)\n        for (let i = 0; i < this._features[zoom].length; ++i) {\n          let feature = this._features[zoom][i];\n          if (feature._leaflet_id === feature._leaflet_id) {\n            this._features[zoom].splice(i, 1);\n            break;\n          }\n        }\n    },\n    getEvents: function () {\n      if (this._staticFeature) {\n        return {\n          moveend: this._handleMoveEnd,\n          zoomend: this._handleZoomEnd\n        };\n      }\n      return {};\n    },\n\n    // for query\n    showPaginationFeature: function (e) {\n      if (this.options.query && this._queryFeatures[e.i]) {\n        let feature = this._queryFeatures[e.i];\n        feature._linkEl.shadowRoot.replaceChildren();\n        this.clearLayers();\n        // append all map-meta from mapml document\n        if (feature.meta) {\n          for (let i = 0; i < feature.meta.length; i++) {\n            feature._linkEl.shadowRoot.appendChild(feature.meta[i]);\n          }\n        }\n        feature._linkEl.shadowRoot.appendChild(feature);\n        feature.addFeature(this);\n        e.popup._navigationBar.querySelector('p').innerText =\n          e.i + 1 + '/' + this.options._leafletLayer._totalFeatureCount;\n        e.popup._content\n          .querySelector('iframe')\n          .setAttribute('sandbox', 'allow-same-origin allow-forms');\n        e.popup._content.querySelector('iframe').srcdoc =\n          feature.querySelector('map-properties').innerHTML;\n        // \"zoom to here\" link need to be re-set for every pagination\n        this._map.fire('attachZoomLink', { i: e.i, currFeature: feature });\n        this._map.once(\n          'popupclose',\n          function (e) {\n            this.shadowRoot.innerHTML = '';\n          },\n          feature._linkEl\n        );\n      }\n    },\n\n    _handleMoveEnd: function () {\n      this._removeCSS();\n    },\n\n    _handleZoomEnd: function (e) {\n      // handle zoom end gets called twice for every zoom, this condition makes it go through once only.\n      if (this.zoomBounds) {\n        this._validateRendering();\n      }\n    },\n    /*\n     * _validateRendering prunes the features currently in the _features hashmap (created\n     * by us).  _features categorizes features by zoom, and is used to remove or add\n     * features from the map based on the map-feature min/max getters.  It also\n     * maintains the _map.featureIndex property, which is used to control the tab\n     * order for interactive (static) features currently rendered on the map.\n     * @private\n     *  */\n    _validateRendering: function () {\n      // since features are removed and re-added by zoom level, need to clean the feature index before re-adding\n      if (this._map) this._map.featureIndex.cleanIndex();\n      let map = this._map || this.options._leafletLayer._map;\n      // it's important that we not try to validate rendering if the FeatureLayer\n      // isn't actually  being rendered (i.e. on the map.  the _map property can't\n      // be used because once it's assigned  (by onAdd, above) it's never unassigned.\n      if (!map.hasLayer(this)) return;\n      if (this._features) {\n        for (let zoom in this._features) {\n          for (let k = 0; k < this._features[zoom].length; k++) {\n            let geometry = this._features[zoom][k],\n              renderable = geometry._checkRender(\n                map.getZoom(),\n                this.zoomBounds.minZoom,\n                this.zoomBounds.maxZoom\n              );\n            if (!renderable) {\n              // insert a placeholder in the dom rendering for the geometry\n              // so that it retains its layering order when it is next rendered\n              let placeholder = document.createElement('span');\n              placeholder.id = geometry._leaflet_id;\n              // geometry.defaultOptions.group is the rendered svg g element in sd\n              geometry.defaultOptions.group.insertAdjacentElement(\n                'beforebegin',\n                placeholder\n              );\n              // removing the rendering without removing the feature from the feature list\n              this.removeRendering(geometry);\n            } else if (\n              // checking for _map so we do not enter this code block during the connectedCallBack of the map-feature\n              !map.hasLayer(geometry) &&\n              !geometry._map\n            ) {\n              this.addRendering(geometry);\n              // update the layerbounds\n              let placeholder =\n                geometry.defaultOptions.group.parentNode.querySelector(\n                  `span[id=\"${geometry._leaflet_id}\"]`\n                );\n              placeholder.replaceWith(geometry.defaultOptions.group);\n            }\n          }\n        }\n      }\n    },\n\n    _setZoomTransform: function (center, clampZoom) {\n      var scale = this._map.getZoomScale(this._map.getZoom(), clampZoom),\n        translate = center\n          .multiplyBy(scale)\n          .subtract(this._map._getNewPixelOrigin(center, this._map.getZoom()))\n          .round();\n\n      if (any3d) {\n        L.setTransform(this._layers[clampZoom], translate, scale);\n      } else {\n        L.setPosition(this._layers[clampZoom], translate);\n      }\n    },\n\n    /**\n     * Render a <map-feature> as a Leaflet layer that can be added to a map or\n     * LayerGroup as required.  Kind of a \"factory\" method.\n     *\n     * Uses this.options, so if you need to, you can construct an M.featureLayer\n     * with options set as required\n     *\n     * @param feature - a <map-feature> element\n     * @param {String} fallbackCS - \"gcrs\" | \"pcrs\"\n     * @param {String} tileZoom - the zoom of the map at which the coordinates will exist\n     *\n     * @returns M.Geometry, which is an L.FeatureGroup\n     * @public\n     */\n    createGeometry: function (feature, fallbackCS, tileZoom) {\n      // was let options = this.options, but that was causing unwanted side-effects\n      // because we were adding .layerBounds and .zoomBounds to it before passing\n      // to _createGeometry, which meant that FeatureLayer was sprouting\n      // options.layerBounds and .zoomBounds when it should not have those props\n      let options = Object.assign({}, this.options);\n\n      if (options.filter && !options.filter(feature)) {\n        return;\n      }\n\n      if (feature.classList.length) {\n        options.className = feature.classList.value;\n      }\n      // tileZoom is only used when the map-feature is discarded i.e. for rendering\n      // vector tiles' feature geometries in bulk (in this case only the geomtry\n      // is rendered on a tile-shaped FeatureLayer\n      let zoom = feature.zoom ?? tileZoom,\n        title = feature.querySelector('map-featurecaption');\n      title = title ? title.innerHTML : 'Feature';\n\n      if (feature.querySelector('map-properties')) {\n        options.properties = document.createElement('div');\n        options.properties.classList.add('mapml-popup-content');\n        options.properties.insertAdjacentHTML(\n          'afterbegin',\n          feature.querySelector('map-properties').innerHTML\n        );\n      }\n      let cs =\n        feature.getElementsByTagName('map-geometry')[0]?.getAttribute('cs') ||\n        fallbackCS;\n      // options.layerBounds and options.zoomBounds are set by TemplatedTileLayer._createFeatures\n      // each geometry needs bounds so that it can be a good community member of this._layers\n      if (this._staticFeature || this.options.query) {\n        options.layerBounds = M.extentToBounds(feature.extent, 'PCRS');\n        options.zoomBounds = feature.extent.zoom;\n      }\n      let geometry = this._geometryToLayer(feature, options, cs, +zoom, title);\n      if (geometry && Object.keys(geometry._layers).length !== 0) {\n        // if the layer is being used as a query handler output, it will have\n        // a color option set.  Otherwise, copy classes from the feature\n        if (!geometry.options.color && feature.hasAttribute('class')) {\n          geometry.options.className = feature.getAttribute('class');\n        }\n        geometry.defaultOptions = geometry.options;\n        this.resetStyle(geometry);\n\n        if (options.onEachFeature) {\n          geometry.bindTooltip(title, { interactive: true, sticky: true });\n        }\n        if (feature.tagName.toUpperCase() === 'MAP-FEATURE') {\n          feature._groupEl = geometry.options.group;\n        }\n        return geometry;\n      }\n    },\n\n    resetStyle: function (layer) {\n      var style = this.options.style;\n      if (style) {\n        // reset any custom styles\n        L.Util.extend(layer.options, layer.defaultOptions);\n        this._setLayerStyle(layer, style);\n      }\n    },\n\n    setStyle: function (style) {\n      this.eachLayer(function (layer) {\n        this._setLayerStyle(layer, style);\n      }, this);\n    },\n\n    _setLayerStyle: function (layer, style) {\n      if (typeof style === 'function') {\n        style = style(layer.feature);\n      }\n      if (layer.setStyle) {\n        layer.setStyle(style);\n      }\n    },\n    _removeCSS: function () {\n      let toDelete = this._container.querySelectorAll(\n        'link[rel=stylesheet],style'\n      );\n      for (let i = 0; i < toDelete.length; i++) {\n        this._container.removeChild(toDelete[i]);\n      }\n    },\n    _geometryToLayer: function (feature, vectorOptions, cs, zoom, title) {\n      let geometry = feature.getElementsByTagName('map-geometry')[0],\n        group = [],\n        svgGroup = L.SVG.create('g'),\n        copyOptions = Object.assign({}, vectorOptions);\n      svgGroup._featureEl = feature; // rendered <g> has a reference to map-feature\n      if (geometry) {\n        for (let geo of geometry.querySelectorAll(\n          'map-polygon, map-linestring, map-multilinestring, map-point, map-multipoint'\n        )) {\n          group.push(\n            M.path(\n              geo,\n              Object.assign(copyOptions, {\n                nativeCS: cs,\n                nativeZoom: zoom,\n                projection: this.options.projection,\n                featureID: feature.id,\n                group: svgGroup,\n                wrappers: this._getGeometryParents(geo.parentElement),\n                featureLayer: this,\n                _leafletLayer: this.options._leafletLayer\n              })\n            )\n          );\n        }\n        let groupOptions = {\n            group: svgGroup,\n            mapmlFeature: feature,\n            featureID: feature.id,\n            accessibleTitle: title,\n            onEachFeature: vectorOptions.onEachFeature,\n            properties: vectorOptions.properties,\n            _leafletLayer: this.options._leafletLayer,\n            layerBounds: vectorOptions.layerBounds,\n            zoomBounds: vectorOptions.zoomBounds\n          },\n          collections =\n            geometry.querySelector('map-multipolygon') ||\n            geometry.querySelector('map-geometrycollection');\n        if (collections)\n          groupOptions.wrappers = this._getGeometryParents(\n            collections.parentElement\n          );\n        return M.geometry(group, groupOptions);\n      }\n    },\n\n    _getGeometryParents: function (subType, elems = []) {\n      if (subType && subType.tagName.toUpperCase() !== 'MAP-GEOMETRY') {\n        if (\n          subType.tagName.toUpperCase() === 'MAP-MULTIPOLYGON' ||\n          subType.tagName.toUpperCase() === 'MAP-GEOMETRYCOLLECTION'\n        )\n          return this._getGeometryParents(subType.parentElement, elems);\n        return this._getGeometryParents(\n          subType.parentElement,\n          elems.concat([subType])\n        );\n      } else {\n        return elems;\n      }\n    }\n  });\n  var featureLayer = function (mapml, options) {\n    return new FeatureLayer(mapml, options);\n  };\n\n  var TemplatedTileLayer = L.TileLayer.extend({\n    // a TemplateTileLayer is similar to a L.TileLayer except its templates are\n    // defined by the <map-extent><template/></map-extent>\n    // content found in the MapML document.  As such, the client map does not\n    // 'revisit' the server for more MapML content, it simply fills the map extent\n    // with tiles for which it generates requests on demand (as the user pans/zooms/resizes\n    // the map)\n    initialize: function (template, options) {\n      // _setUpTileTemplateVars needs options.crs, not available unless we set\n      // options first...\n      options.tms = template.tms;\n      // it's critical to have this.options.minZoom, minNativeZoom, maxZoom, maxNativeZoom\n      // because they are used by Leaflet Map and GridLayer, but we\n      // don't need two copies of that info on our options object, so set the\n      // .zoomBounds property (which is used externally), then delete the option\n      // before unpacking the zoomBound object's properties onto this.options.minZ... etc.\n      this.zoomBounds = Object.assign({}, options.zoomBounds);\n      // unpack object to this.options.minZ... etc where minZ... are the props\n      // of the this.zoomBounds object:\n      L.extend(options, this.zoomBounds);\n      L.setOptions(this, options);\n      // _setup call here relies on this.options.minZ.. etc\n      this._setUpTileTemplateVars(template);\n      this._linkEl = options.linkEl;\n      this.extentBounds = this.options.extentBounds;\n      // get rid of duplicate information as it is confusing\n      delete this.options.zoomBounds;\n      delete this.options.extentBounds;\n\n      this._template = template;\n      this._initContainer();\n      // call the parent constructor with the template tref value, per the\n      // Leaflet tutorial: http://leafletjs.com/examples/extending/extending-1-classes.html#methods-of-the-parent-class\n      L.TileLayer.prototype.initialize.call(\n        this,\n        template.template,\n        L.extend(options, { pane: this.options.pane })\n      );\n    },\n    onAdd: function (map) {\n      this.options.pane.appendChild(this._container);\n      L.TileLayer.prototype.onAdd.call(this, map);\n      this._handleMoveEnd();\n    },\n\n    onRemove: function () {\n      L.DomUtil.remove(this._container);\n      // should clean up the container\n      for (let child of this._container.children) {\n        L.DomUtil.remove(child);\n      }\n    },\n\n    getEvents: function () {\n      let events = L.TileLayer.prototype.getEvents.call(this, this._map);\n      this._parentOnMoveEnd = events.moveend;\n      events.moveend = this._handleMoveEnd;\n      return events;\n    },\n\n    isVisible: function () {\n      let map = this._linkEl.getMapEl()._map;\n      let mapZoom = map.getZoom();\n      let mapBounds = M.pixelToPCRSBounds(\n        map.getPixelBounds(),\n        mapZoom,\n        map.options.projection\n      );\n      return (\n        mapZoom <= this.zoomBounds.maxZoom &&\n        mapZoom >= this.zoomBounds.minZoom &&\n        this.extentBounds.overlaps(mapBounds)\n      );\n    },\n\n    _initContainer: function () {\n      if (this._container) {\n        return;\n      }\n\n      this._container = L.DomUtil.create(\n        'div',\n        'leaflet-layer',\n        this.options.pane\n      );\n      L.DomUtil.addClass(this._container, 'mapml-templated-tile-container');\n      this._updateZIndex();\n    },\n\n    _handleMoveEnd: function (e) {\n      if (!this.isVisible()) return;\n      this._parentOnMoveEnd();\n    },\n    createTile: function (coords) {\n      let tileGroup = document.createElement('DIV'),\n        tileSize = this.getTileSize();\n      L.DomUtil.addClass(tileGroup, 'mapml-tile-group');\n      L.DomUtil.addClass(tileGroup, 'leaflet-tile');\n\n      this._template.linkEl.dispatchEvent(\n        new CustomEvent('tileloadstart', {\n          detail: {\n            x: coords.x,\n            y: coords.y,\n            zoom: coords.z,\n            appendTile: (elem) => {\n              tileGroup.appendChild(elem);\n            }\n          }\n        })\n      );\n\n      if (this._template.type.startsWith('image/')) {\n        let tile = L.TileLayer.prototype.createTile.call(\n          this,\n          coords,\n          function () {}\n        );\n        tile.width = tileSize.x;\n        tile.height = tileSize.y;\n        tileGroup.appendChild(tile);\n      } else if (!this._url.includes(M.BLANK_TT_TREF)) {\n        // tiles of type=\"text/mapml\" will have to fetch content while creating\n        // the tile here, unless there can be a callback associated to the element\n        // that will render the content in the alread-placed tile\n        // var tile = L.DomUtil.create('canvas', 'leaflet-tile');\n        this._fetchTile(coords, tileGroup);\n      }\n      return tileGroup;\n    },\n    _mapmlTileReady: function (tile) {\n      L.DomUtil.addClass(tile, 'leaflet-tile-loaded');\n    },\n    // instead of being child of a pane, the TemplatedTileLayers are 'owned' by the group,\n    // and so are DOM children of the group, not the pane element (the MapMLLayer is\n    // a child of the overlay pane and always has a set of sub-layers)\n    getPane: function () {\n      return this.options.pane;\n    },\n    _fetchTile: function (coords, tile) {\n      let url = this.getTileUrl(coords);\n      if (url) {\n        fetch(url, { redirect: 'follow' })\n          .then(function (response) {\n            if (response.status >= 200 && response.status < 300) {\n              return Promise.resolve(response);\n            } else {\n              console.log(\n                'Looks like there was a problem. Status Code: ' + response.status\n              );\n              return Promise.reject(response);\n            }\n          })\n          .then(function (response) {\n            return response.text();\n          })\n          .then((text) => {\n            var parser = new DOMParser();\n            return parser.parseFromString(text, 'application/xml');\n          })\n          .then((mapml) => {\n            this._createFeatures(mapml, coords, tile);\n            this._mapmlTileReady(tile);\n          })\n          .catch((err) => {\n            console.log('Error Creating Tile');\n          });\n      }\n    },\n\n    // TO DO: get rid of this function altogether; see TO DO below re: map-link\n    // shadow root\n    // _parseStylesheetAsHTML parses map-link and map-style from mapml and inserts them to the container as HTML\n    _parseStylesheetAsHTML: function (mapml, base, container) {\n      if (\n        !(container instanceof Element) ||\n        !mapml ||\n        !mapml.querySelector('map-link[rel=stylesheet],map-style')\n      )\n        return;\n\n      if (base instanceof Element) {\n        base = base.getAttribute('href')\n          ? base.getAttribute('href')\n          : document.URL;\n      } else if (!base || base === '' || base instanceof Object) {\n        return;\n      }\n\n      var ss = [];\n      var stylesheets = mapml.querySelectorAll(\n        'map-link[rel=stylesheet],map-style'\n      );\n      for (var i = 0; i < stylesheets.length; i++) {\n        if (stylesheets[i].nodeName.toUpperCase() === 'MAP-LINK') {\n          var href = stylesheets[i].hasAttribute('href')\n            ? new URL(stylesheets[i].getAttribute('href'), base).href\n            : null;\n          if (href) {\n            if (!container.querySelector(\"link[href='\" + href + \"']\")) {\n              var linkElm = document.createElement('link');\n              copyAttributes(stylesheets[i], linkElm);\n              linkElm.setAttribute('href', href);\n              ss.push(linkElm);\n            }\n          }\n        } else {\n          // <map-style>\n          var styleElm = document.createElement('style');\n          copyAttributes(stylesheets[i], styleElm);\n          styleElm.textContent = stylesheets[i].textContent;\n          ss.push(styleElm);\n        }\n      }\n      // insert <link> or <style> elements after the begining  of the container\n      // element, in document order as copied from original mapml document\n      // note the code below assumes hrefs have been resolved and elements\n      // re-parsed from xml and serialized as html elements ready for insertion\n      for (var s = ss.length - 1; s >= 0; s--) {\n        container.insertAdjacentElement('afterbegin', ss[s]);\n      }\n      function copyAttributes(source, target) {\n        return Array.from(source.attributes).forEach((attribute) => {\n          if (attribute.nodeName !== 'href')\n            target.setAttribute(attribute.nodeName, attribute.nodeValue);\n        });\n      }\n    },\n\n    _createFeatures: function (markup, coords, tile) {\n      // TO DO: create a shadow root for the <map-link> that hosts this layer,\n      // populate it with map-tile, map-link and map-style elements that are\n      // fetched.\n      let stylesheets = markup.querySelector(\n        'map-link[rel=stylesheet],map-style'\n      );\n      if (stylesheets) {\n        let base =\n          markup.querySelector('map-base') &&\n          markup.querySelector('map-base').hasAttribute('href')\n            ? new URL(markup.querySelector('map-base').getAttribute('href')).href\n            : markup.URL;\n        this._parseStylesheetAsHTML(markup, base, tile);\n      }\n\n      let svg = L.SVG.create('svg'),\n        g = L.SVG.create('g'),\n        tileSize = this._map.options.crs.options.crs.tile.bounds.max.x,\n        xOffset = coords.x * tileSize,\n        yOffset = coords.y * tileSize;\n\n      let tileFeatures = M.featureLayer(null, {\n        projection: this._map.options.projection,\n        tiles: true,\n        layerBounds: this.extentBounds,\n        zoomBounds: this.zoomBounds,\n        interactive: false,\n        mapEl: this._linkEl.getMapEl()\n      });\n      let fallback = M.getNativeVariables(markup);\n      let features = markup.querySelectorAll('map-feature:has(> map-geometry)');\n      for (let i = 0; i < features.length; i++) {\n        let feature = tileFeatures.createGeometry(\n          features[i],\n          fallback.cs,\n          coords.z\n        );\n        for (let featureID in feature._layers) {\n          let layer = feature._layers[featureID];\n          M.FeatureRenderer.prototype._initPath(layer, false);\n          layer._project(this._map, L.point([xOffset, yOffset]), coords.z);\n          M.FeatureRenderer.prototype._addPath(layer, g, false);\n          M.FeatureRenderer.prototype._updateFeature(layer);\n        }\n      }\n      svg.setAttribute('width', tileSize.toString());\n      svg.setAttribute('height', tileSize.toString());\n      svg.appendChild(g);\n      tile.appendChild(svg);\n    },\n\n    getTileUrl: function (coords) {\n      if (\n        coords.z >= this._template.tilematrix.bounds.length ||\n        !this._template.tilematrix.bounds[coords.z].contains(coords)\n      ) {\n        return '';\n      }\n      var obj = {},\n        linkEl = this._template.linkEl,\n        zoomInput = linkEl.zoomInput;\n      obj[this._template.tilematrix.col.name] = coords.x;\n      obj[this._template.tilematrix.row.name] = coords.y;\n      if (\n        zoomInput &&\n        linkEl.hasAttribute('tref') &&\n        linkEl\n          .getAttribute('tref')\n          .includes(`{${zoomInput.getAttribute('name')}}`)\n      ) {\n        obj[this._template.zoom.name] = this._getZoomForUrl();\n      }\n      obj[this._template.pcrs.easting.left] = this._tileMatrixToPCRSPosition(\n        coords,\n        'top-left'\n      ).x;\n      obj[this._template.pcrs.easting.right] = this._tileMatrixToPCRSPosition(\n        coords,\n        'top-right'\n      ).x;\n      obj[this._template.pcrs.northing.top] = this._tileMatrixToPCRSPosition(\n        coords,\n        'top-left'\n      ).y;\n      obj[this._template.pcrs.northing.bottom] = this._tileMatrixToPCRSPosition(\n        coords,\n        'bottom-left'\n      ).y;\n      for (var v in this._template.tile) {\n        if (\n          ['row', 'col', 'zoom', 'left', 'right', 'top', 'bottom'].indexOf(v) < 0\n        ) {\n          obj[v] = this._template.tile[v];\n        }\n      }\n      if (this._map && !this._map.options.crs.infinite) {\n        let invertedY = this._globalTileRange.max.y - coords.y;\n        if (this.options.tms) {\n          obj[this._template.tilematrix.row.name] = invertedY;\n        }\n        //obj[`-${this._template.tilematrix.row.name}`] = invertedY; //leaflet has this but I dont see a use in storing row and -row as it doesnt follow that pattern\n      }\n      obj.r =\n        this.options.detectRetina && L.Browser.retina && this.options.maxZoom > 0\n          ? '@2x'\n          : '';\n      return L.Util.template(this._url, obj);\n    },\n    _tileMatrixToPCRSPosition: function (coords, pos) {\n      // this is a tile:\n      //\n      //   top-left         top-center           top-right\n      //      +------------------+------------------+\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      + center-left    center               + center-right\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      |                  |                  |\n      //      +------------------+------------------+\n      //   bottom-left     bottom-center      bottom-right\n\n      var map = this._map,\n        crs = map.options.crs,\n        tileSize = this.getTileSize(),\n        nwPoint = coords.scaleBy(tileSize),\n        sePoint = nwPoint.add(tileSize),\n        centrePoint = nwPoint.add(Math.floor(tileSize / 2)),\n        nw = crs.transformation.untransform(nwPoint, crs.scale(coords.z)),\n        se = crs.transformation.untransform(sePoint, crs.scale(coords.z)),\n        cen = crs.transformation.untransform(centrePoint, crs.scale(coords.z)),\n        result = null;\n\n      switch (pos) {\n        case 'top-left':\n          result = nw;\n          break;\n        case 'bottom-left':\n          result = new L.Point(nw.x, se.y);\n          break;\n        case 'center-left':\n          result = new L.Point(nw.x, cen.y);\n          break;\n        case 'top-right':\n          result = new L.Point(se.x, nw.y);\n          break;\n        case 'bottom-right':\n          result = se;\n          break;\n        case 'center-right':\n          result = new L.Point(se.x, cen.y);\n          break;\n        case 'top-center':\n          result = new L.Point(cen.x, nw.y);\n          break;\n        case 'bottom-center':\n          result = new L.Point(cen.x, se.y);\n          break;\n        case 'center':\n          result = cen;\n          break;\n      }\n      return result;\n    },\n    _setUpTileTemplateVars: function (template) {\n      // process the inputs associated to template and create an object named\n      // tile with member properties as follows:\n      // {row: 'rowvarname',\n      //  col: 'colvarname',\n      //  left: 'leftvarname',\n      //  right: 'rightvarname',\n      //  top: 'topvarname',\n      //  bottom: 'bottomvarname'}\n      template.tile = {};\n      var inputs = template.values,\n        crs = this.options.crs.options,\n        east,\n        north,\n        row,\n        col;\n\n      for (var i = 0; i < template.values.length; i++) {\n        var type = inputs[i].getAttribute('type'),\n          units = inputs[i].getAttribute('units'),\n          axis = inputs[i].getAttribute('axis'),\n          name = inputs[i].getAttribute('name'),\n          position = inputs[i].getAttribute('position'),\n          select = inputs[i].tagName.toLowerCase() === 'map-select';\n          inputs[i].getAttribute('value');\n          var min = inputs[i].getAttribute('min'),\n          max = inputs[i].getAttribute('max');\n        if (type === 'location' && units === 'tilematrix') {\n          switch (axis) {\n            case 'column':\n              col = {\n                name: name,\n                min: crs.crs.tilematrix.horizontal.min,\n                max: crs.crs.tilematrix.horizontal.max(crs.resolutions.length - 1)\n              };\n              if (!isNaN(Number.parseFloat(min))) {\n                col.min = Number.parseFloat(min);\n              }\n              if (!isNaN(Number.parseFloat(max))) {\n                col.max = Number.parseFloat(max);\n              }\n              break;\n            case 'row':\n              row = {\n                name: name,\n                min: crs.crs.tilematrix.vertical.min,\n                max: crs.crs.tilematrix.vertical.max(crs.resolutions.length - 1)\n              };\n              if (!isNaN(Number.parseFloat(min))) {\n                row.min = Number.parseFloat(min);\n              }\n              if (!isNaN(Number.parseFloat(max))) {\n                row.max = Number.parseFloat(max);\n              }\n              break;\n            case 'longitude':\n            case 'easting':\n              if (!east) {\n                east = {\n                  min: crs.crs.pcrs.horizontal.min,\n                  max: crs.crs.pcrs.horizontal.max\n                };\n              }\n              if (!isNaN(Number.parseFloat(min))) {\n                east.min = Number.parseFloat(min);\n              }\n              if (!isNaN(Number.parseFloat(max))) {\n                east.max = Number.parseFloat(max);\n              }\n              if (position) {\n                if (position.match(/.*?-left/i)) {\n                  east.left = name;\n                } else if (position.match(/.*?-right/i)) {\n                  east.right = name;\n                }\n              }\n              break;\n            case 'latitude':\n            case 'northing':\n              if (!north) {\n                north = {\n                  min: crs.crs.pcrs.vertical.min,\n                  max: crs.crs.pcrs.vertical.max\n                };\n              }\n              if (!isNaN(Number.parseFloat(min))) {\n                north.min = Number.parseFloat(min);\n              }\n              if (!isNaN(Number.parseFloat(max))) {\n                north.max = Number.parseFloat(max);\n              }\n              if (position) {\n                if (position.match(/top-.*?/i)) {\n                  north.top = name;\n                } else if (position.match(/bottom-.*?/i)) {\n                  north.bottom = name;\n                }\n              }\n              break;\n            // unsuportted axis value\n          }\n        } else if (select) {\n          /*jshint -W104 */\n          const parsedselect = inputs[i].htmlselect;\n          template.tile[name] = function () {\n            return parsedselect.value;\n          };\n        } else if (type === 'hidden') {\n          // needs to be a const otherwise it gets overwritten\n          /*jshint -W104 */\n          const input = inputs[i];\n          template.tile[name] = function () {\n            return input.getAttribute('value');\n          };\n        }\n      }\n      var transformation = this.options.crs.transformation,\n        tileSize = this.options.crs.options.crs.tile.bounds.max.x,\n        scale = L.bind(this.options.crs.scale, this.options.crs),\n        pcrs2tilematrix = function (c, zoom) {\n          return transformation\n            .transform(c, scale(zoom))\n            .divideBy(tileSize)\n            .floor();\n        };\n      if (east && north) {\n        template.pcrs = {};\n        template.pcrs.bounds = L.bounds(\n          [east.min, north.min],\n          [east.max, north.max]\n        );\n        template.pcrs.easting = east;\n        template.pcrs.northing = north;\n      } else if (col && row && !isNaN(template.zoom.initialValue)) {\n        // convert the tile bounds at this zoom to a pcrs bounds, then\n        // go through the zoom min/max and create a tile-based bounds\n        // at each zoom that applies to the col/row values that constrain what tiles\n        // will be requested so that we don't generate too many 404s\n        if (!template.pcrs) {\n          template.pcrs = {};\n          template.pcrs.easting = '';\n          template.pcrs.northing = '';\n        }\n\n        template.pcrs.bounds = M.boundsToPCRSBounds(\n          L.bounds(L.point([col.min, row.min]), L.point([col.max, row.max])),\n          template.zoom.initialValue,\n          this.options.crs,\n          M.axisToCS('column')\n        );\n\n        template.tilematrix = {};\n        template.tilematrix.col = col;\n        template.tilematrix.row = row;\n      }\n\n      if (!template.tilematrix) {\n        template.tilematrix = {};\n        template.tilematrix.col = {};\n        template.tilematrix.row = {};\n      }\n      template.tilematrix.bounds = [];\n      var pcrsBounds = template.pcrs.bounds;\n      // the template should _always_ have a zoom, because we force it to\n      // by first processing the extent to determine the zoom and if none, adding\n      // one and second by copying that zoom into the set of template variable inputs\n      // even if it is not referenced by one of the template's variable references\n      var zmin = this.options.minNativeZoom,\n        zmax = this.options.maxNativeZoom;\n      for (var z = 0; z <= zmax; z++) {\n        template.tilematrix.bounds[z] =\n          z >= zmin\n            ? L.bounds(\n                pcrs2tilematrix(pcrsBounds.min, z),\n                pcrs2tilematrix(pcrsBounds.max, z)\n              )\n            : L.bounds(L.point([-1, -1]), L.point([-1, -1]));\n      }\n    },\n    _clampZoom: function (zoom) {\n      let clamp = L.GridLayer.prototype._clampZoom.call(this, zoom);\n      if (this._template.step > this.options.maxNativeZoom)\n        this._template.step = this.options.maxNativeZoom;\n\n      if (zoom !== clamp) {\n        zoom = clamp;\n      } else {\n        if (zoom % this._template.step !== 0) {\n          zoom = Math.floor(zoom / this._template.step) * this._template.step;\n        }\n      }\n      return zoom;\n    }\n  });\n  var templatedTileLayer = function (template, options) {\n    return new TemplatedTileLayer(template, options);\n  };\n\n  var ExtentLayer = L.LayerGroup.extend({\n    initialize: function (options) {\n      // TODO: should invoke prototype.initialize to trigger the leaflet initialization for proper setup\n      //       otherwise the initialize we provide will override the init that leaflet provides\n      //       but we still need to create the container and the pane by ourselves\n      L.LayerGroup.prototype.initialize.call(this, null, options);\n      this._container = L.DomUtil.create('div', 'leaflet-layer');\n      this._extentEl = this.options.extentEl;\n      this.changeOpacity(this.options.opacity);\n      // TODO: need renaming ex. mapml-extentLayer-container\n      L.DomUtil.addClass(this._container, 'mapml-extentlayer-container');\n    },\n    getEvents: function () {\n      return {\n        zoomstart: this._onZoomStart\n      };\n    },\n    _onZoomStart: function () {\n      this.closePopup();\n    },\n    getContainer: function () {\n      return this._container;\n    },\n    onAdd: function (map) {\n      L.LayerGroup.prototype.onAdd.call(this, map);\n      let pane = this.options.extentEl.parentLayer._layer._container;\n      pane.appendChild(this._container);\n    },\n    redraw: function () {\n      this.eachLayer(function (layer) {\n        layer.redraw();\n      });\n    },\n    //addTo: function(map) {\n    //for(let i = 0; i < this._templates.length; i++){\n    //    this._templates[0].layer.addTo(map);\n    //}\n    //},\n    setZIndex: function (zIndex) {\n      this.options.zIndex = zIndex;\n      this._updateZIndex();\n\n      return this;\n    },\n    _updateZIndex: function () {\n      if (\n        this._container &&\n        this.options.zIndex !== undefined &&\n        this.options.zIndex !== null\n      ) {\n        this._container.style.zIndex = this.options.zIndex;\n      }\n    },\n    onRemove: function () {\n      L.LayerGroup.prototype.onRemove.call(this, this._map);\n      L.DomUtil.remove(this._container);\n    },\n\n    _previousFeature: function (e) {\n      if (this._count + -1 >= 0) {\n        this._count--;\n        this._map.fire('featurepagination', {\n          i: this._count,\n          popup: this\n        });\n      }\n    },\n\n    _nextFeature: function (e) {\n      if (this._count + 1 < this._source._totalFeatureCount) {\n        this._count++;\n        this._map.fire('featurepagination', {\n          i: this._count,\n          popup: this\n        });\n      }\n    },\n\n    changeOpacity: function (opacity) {\n      this._container.style.opacity = opacity;\n      this._extentEl._opacity = opacity;\n      if (this._extentEl._opacitySlider)\n        this._extentEl._opacitySlider.value = opacity;\n    },\n    appendStyleLink: function (mapLink) {\n      if (!mapLink.link) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapLink.link\n      );\n    },\n    _getStylePositionAndNode: function () {\n      return this._container.lastChild &&\n        (this._container.lastChild.nodeName.toUpperCase() === 'SVG' ||\n          this._container.lastChild.classList.contains('mapml-vector-container'))\n        ? { position: 'beforebegin', node: this._container.lastChild }\n        : this._container.lastChild\n        ? { position: 'afterend', node: this._container.lastChild }\n        : { position: 'afterbegin', node: this._container };\n    },\n    appendStyleElement: function (mapStyle) {\n      if (!mapStyle.styleElement) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapStyle.styleElement\n      );\n    }\n  });\n  var extentLayer = function (options) {\n    return new ExtentLayer(options);\n  };\n\n  var TemplatedFeaturesLayer = L.Layer.extend({\n    // this and M.ImageLayer could be merged or inherit from a common parent\n    initialize: function (template, options) {\n      this._template = template;\n      this._container = L.DomUtil.create('div', 'leaflet-layer');\n      L.DomUtil.addClass(this._container, 'mapml-features-container');\n      this.zoomBounds = options.zoomBounds;\n      this.extentBounds = options.extentBounds;\n      // get rid of duplicate info, it can be confusing\n      delete options.zoomBounds;\n      delete options.extentBounds;\n      this._linkEl = options.linkEl;\n      L.setOptions(\n        this,\n        L.extend(options, this._setUpFeaturesTemplateVars(template))\n      );\n    },\n\n    isVisible: function () {\n      let map = this._linkEl.getMapEl()._map;\n      let mapZoom = map.getZoom();\n      let mapBounds = M.pixelToPCRSBounds(\n        map.getPixelBounds(),\n        mapZoom,\n        map.options.projection\n      );\n      return (\n        mapZoom <= this.zoomBounds.maxZoom &&\n        mapZoom >= this.zoomBounds.minZoom &&\n        this.extentBounds.overlaps(mapBounds)\n      );\n    },\n\n    getEvents: function () {\n      var events = {\n        moveend: this._onMoveEnd\n      };\n      return events;\n    },\n    onAdd: function (map) {\n      this._map = map;\n      // this causes the layer (this._features) to actually render...\n      this.options.pane.appendChild(this._container);\n      var opacity = this.options.opacity || 1,\n        container = this._container;\n      if (!this._features) {\n        this._features = M.featureLayer(null, {\n          // pass the vector layer a renderer of its own, otherwise leaflet\n          // puts everything into the overlayPane\n          renderer: M.featureRenderer(),\n          // pass the vector layer the container for the parent into which\n          // it will append its own container for rendering into\n          pane: container,\n          // the bounds will be static, fixed, constant for the lifetime of the layer\n          layerBounds: this.extentBounds,\n          zoomBounds: this.zoomBounds,\n          opacity: opacity,\n          projection: map.options.projection,\n          mapEl: this._linkEl.getMapEl(),\n          onEachFeature: function (properties, geometry) {\n            // need to parse as HTML to preserve semantics and styles\n            var c = document.createElement('div');\n            c.classList.add('mapml-popup-content');\n            c.insertAdjacentHTML('afterbegin', properties.innerHTML);\n            geometry.bindPopup(c, { autoClose: false, minWidth: 108 });\n          }\n        });\n      } else {\n        this._features.eachLayer((layer) => layer.addTo(map));\n      }\n      this._onMoveEnd();\n    },\n    onRemove: function () {\n      if (this._features) this._features.eachLayer((layer) => layer.remove());\n      L.DomUtil.remove(this._container);\n    },\n    appendStyleLink: function (mapLink) {\n      if (!mapLink.link) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapLink.link\n      );\n    },\n    _getStylePositionAndNode: function () {\n      return this._container.lastChild &&\n        (this._container.lastChild.nodeName.toUpperCase() === 'SVG' ||\n          this._container.lastChild.classList.contains('mapml-vector-container'))\n        ? { position: 'beforebegin', node: this._container.lastChild }\n        : this._container.lastChild\n        ? { position: 'afterend', node: this._container.lastChild }\n        : { position: 'afterbegin', node: this._container };\n    },\n    appendStyleElement: function (mapStyle) {\n      if (!mapStyle.styleElement) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapStyle.styleElement\n      );\n    },\n    redraw: function () {\n      this._onMoveEnd();\n    },\n\n    _removeCSS: function () {\n      let toDelete = this._container.querySelectorAll(\n        'link[rel=stylesheet],style'\n      );\n      for (let i = 0; i < toDelete.length; i++) {\n        let parent = toDelete[i].parentNode;\n        parent.removeChild(toDelete[i]);\n      }\n    },\n\n    _onMoveEnd: function () {\n      let history = this._map.options.mapEl._history;\n      let current = history[history.length - 1];\n      let previous = history[history.length - 2] ?? current;\n      let step = this._template.step;\n      let mapZoom = this._map.getZoom();\n      let steppedZoom = mapZoom;\n      //If zooming out from one step interval into a lower one or panning, set the stepped zoom\n      if (\n        (step !== '1' &&\n          (mapZoom + 1) % step === 0 &&\n          current.zoom === previous.zoom - 1) ||\n        current.zoom === previous.zoom ||\n        Math.floor(mapZoom / step) * step !==\n          Math.floor(previous.zoom / step) * step\n      ) {\n        steppedZoom = Math.floor(mapZoom / step) * step;\n      }\n      //No request needed if in a step interval (unless panning)\n      else if (mapZoom % this._template.step !== 0) return;\n\n      let scaleBounds = this._map.getPixelBounds(\n        this._map.getCenter(),\n        steppedZoom\n      );\n\n      // should set this.isVisible properly BEFORE return, otherwise will cause layer-.validateDisabled not work properly\n      let url = this._getfeaturesUrl(steppedZoom, scaleBounds);\n      // No request needed if the current template url is the same as the url to request\n      if (url === this._url) return;\n\n      // do cleaning up for new request\n      this._features.clearLayers();\n      // shadow may has not yet attached to <map-extent> for the first-time rendering\n      if (this._linkEl.shadowRoot) {\n        this._linkEl.shadowRoot.innerHTML = '';\n      }\n      this._removeCSS();\n      //Leave the layers cleared if the layer is not visible\n      if (!this.isVisible() && steppedZoom === mapZoom) {\n        this._url = '';\n        return;\n      }\n\n      // TODO add preference with a bit less weight than that for text/mapml; 0.8 for application/geo+json; 0.6\n      var mapml,\n        headers = new Headers({\n          Accept: 'text/mapml;q=0.9,application/geo+json;q=0.8'\n        }),\n        parser = new DOMParser(),\n        featureLayer = this._features,\n        linkEl = this._linkEl,\n        map = this._map,\n        context = this,\n        MAX_PAGES = 10,\n        // TODO: Fetching logic should migrate to map-link\n        _pullFeatureFeed = function (url, limit) {\n          return fetch(url, { redirect: 'follow', headers: headers })\n            .then(function (response) {\n              return response.text();\n            })\n            .then(function (text) {\n              //TODO wrap this puppy in a try/catch/finally to parse application/geo+json if necessary\n              mapml = parser.parseFromString(text, 'application/xml');\n              var base = new URL(\n                mapml.querySelector('map-base')\n                  ? mapml.querySelector('map-base').getAttribute('href')\n                  : url\n              ).href;\n              url = mapml.querySelector('map-link[rel=next]')\n                ? mapml.querySelector('map-link[rel=next]').getAttribute('href')\n                : null;\n              url = url ? new URL(url, base).href : null;\n              let frag = document.createDocumentFragment();\n              let elements = mapml.querySelectorAll('map-head > *, map-body > *');\n              for (let i = 0; i < elements.length; i++) {\n                frag.appendChild(elements[i]);\n              }\n              linkEl.shadowRoot.appendChild(frag);\n              let features = linkEl.shadowRoot.querySelectorAll('map-feature');\n              let featuresReady = [];\n              for (let i = 0; i < features.length; i++) {\n                featuresReady.push(features[i].whenReady());\n              }\n              Promise.allSettled(featuresReady).then(() => {\n                for (let i = 0; i < features.length; i++) {\n                  features[i].addFeature(featureLayer);\n                }\n              });\n              if (url && --limit) {\n                return _pullFeatureFeed(url, limit);\n              }\n            });\n        };\n      this._url = url;\n      _pullFeatureFeed(url, MAX_PAGES)\n        .then(function () {\n          map.addLayer(featureLayer);\n          //Fires event for feature index overlay\n          map.fire('templatedfeatureslayeradd');\n          M.TemplatedFeaturesLayer.prototype._updateTabIndex(context);\n        })\n        .catch(function (error) {\n          console.log(error);\n        });\n    },\n    setZIndex: function (zIndex) {\n      this.options.zIndex = zIndex;\n      this._updateZIndex();\n      return this;\n    },\n    _updateTabIndex: function (context) {\n      let c = context || this;\n      for (let layerNum in c._features._layers) {\n        let layer = c._features._layers[layerNum];\n        if (layer._path) {\n          if (layer._path.getAttribute('d') !== 'M0 0') {\n            layer._path.setAttribute('tabindex', 0);\n          } else {\n            layer._path.removeAttribute('tabindex');\n          }\n          if (layer._path.childElementCount === 0) {\n            let title = document.createElement('title');\n            title.innerText = 'Feature';\n            layer._path.appendChild(title);\n          }\n        }\n      }\n    },\n    _updateZIndex: function () {\n      if (\n        this._container &&\n        this.options.zIndex !== undefined &&\n        this.options.zIndex !== null\n      ) {\n        this._container.style.zIndex = this.options.zIndex;\n      }\n    },\n    _getfeaturesUrl: function (zoom, bounds) {\n      if (zoom === undefined) zoom = this._map.getZoom();\n      if (bounds === undefined) bounds = this._map.getPixelBounds();\n      var obj = {};\n      if (this.options.feature.zoom) {\n        obj[this.options.feature.zoom] = zoom;\n      }\n      if (this.options.feature.width) {\n        obj[this.options.feature.width] = this._map.getSize().x;\n      }\n      if (this.options.feature.height) {\n        obj[this.options.feature.height] = this._map.getSize().y;\n      }\n      if (this.options.feature.bottom) {\n        obj[this.options.feature.bottom] = this._TCRSToPCRS(bounds.max, zoom).y;\n      }\n      if (this.options.feature.left) {\n        obj[this.options.feature.left] = this._TCRSToPCRS(bounds.min, zoom).x;\n      }\n      if (this.options.feature.top) {\n        obj[this.options.feature.top] = this._TCRSToPCRS(bounds.min, zoom).y;\n      }\n      if (this.options.feature.right) {\n        obj[this.options.feature.right] = this._TCRSToPCRS(bounds.max, zoom).x;\n      }\n      // hidden and other variables that may be associated\n      for (var v in this.options.feature) {\n        if (\n          ['width', 'height', 'left', 'right', 'top', 'bottom', 'zoom'].indexOf(\n            v\n          ) < 0\n        ) {\n          obj[v] = this.options.feature[v];\n        }\n      }\n      return L.Util.template(this._template.template, obj);\n    },\n    _TCRSToPCRS: function (coords, zoom) {\n      // TCRS pixel point to Projected CRS point (in meters, presumably)\n      var map = this._map,\n        crs = map.options.crs,\n        loc = crs.transformation.untransform(coords, crs.scale(zoom));\n      return loc;\n    },\n    _setUpFeaturesTemplateVars: function (template) {\n      // process the inputs and create an object named \"extent\"\n      // with member properties as follows:\n      // {width: {name: 'widthvarname'}, // value supplied by map if necessary\n      //  height: {name: 'heightvarname'}, // value supplied by map if necessary\n      //  left: {name: 'leftvarname', axis: 'leftaxisname'}, // axis name drives (coordinate system of) the value supplied by the map\n      //  right: {name: 'rightvarname', axis: 'rightaxisname'}, // axis name (coordinate system of) drives the value supplied by the map\n      //  top: {name: 'topvarname', axis: 'topaxisname'}, // axis name drives (coordinate system of) the value supplied by the map\n      //  bottom: {name: 'bottomvarname', axis: 'bottomaxisname'} // axis name drives (coordinate system of) the value supplied by the map\n      //  zoom: {name: 'zoomvarname'}\n      //  hidden: [{name: name, value: value}]}\n\n      var featuresVarNames = { feature: {} },\n        inputs = template.values;\n      featuresVarNames.feature.hidden = [];\n      for (var i = 0; i < inputs.length; i++) {\n        // this can be removed when the spec removes the deprecated inputs...\n        var type = inputs[i].getAttribute('type'),\n          units = inputs[i].getAttribute('units'),\n          axis = inputs[i].getAttribute('axis'),\n          name = inputs[i].getAttribute('name'),\n          position = inputs[i].getAttribute('position');\n          inputs[i].getAttribute('value');\n          var select = inputs[i].tagName.toLowerCase() === 'map-select';\n        if (type === 'width') {\n          featuresVarNames.feature.width = name;\n        } else if (type === 'height') {\n          featuresVarNames.feature.height = name;\n        } else if (type === 'zoom') {\n          featuresVarNames.feature.zoom = name;\n        } else if (\n          type === 'location' &&\n          (units === 'pcrs' || units === 'gcrs')\n        ) {\n          //<input name=\"...\" units=\"pcrs\" type=\"location\" position=\"top|bottom-left|right\" axis=\"northing|easting\">\n          switch (axis) {\n            case 'x':\n            case 'longitude':\n            case 'easting':\n              if (position) {\n                if (position.match(/.*?-left/i)) {\n                  featuresVarNames.feature.left = name;\n                } else if (position.match(/.*?-right/i)) {\n                  featuresVarNames.feature.right = name;\n                }\n              }\n              break;\n            case 'y':\n            case 'latitude':\n            case 'northing':\n              if (position) {\n                if (position.match(/top-.*?/i)) {\n                  featuresVarNames.feature.top = name;\n                } else if (position.match(/bottom-.*?/i)) {\n                  featuresVarNames.feature.bottom = name;\n                }\n              }\n              break;\n          }\n        } else if (select) {\n          /*jshint -W104 */\n          const parsedselect = inputs[i].htmlselect;\n          featuresVarNames.feature[name] = function () {\n            return parsedselect.value;\n          };\n          // projection is deprecated, make it hidden\n        } else {\n          /*jshint -W104 */\n          const input = inputs[i];\n          featuresVarNames.feature[name] = function () {\n            return input.getAttribute('value');\n          };\n        }\n      }\n      return featuresVarNames;\n    }\n  });\n  var templatedFeaturesLayer = function (template, options) {\n    return new TemplatedFeaturesLayer(template, options);\n  };\n\n  var TemplatedImageLayer = L.Layer.extend({\n    initialize: function (template, options) {\n      this._template = template;\n      this._container = L.DomUtil.create('div', 'leaflet-layer');\n      L.DomUtil.addClass(this._container, 'mapml-image-container');\n      this._linkEl = options.linkEl;\n      this.zoomBounds = options.zoomBounds;\n      this.extentBounds = options.extentBounds;\n      // get rid of unused duplicate information that can be confusing\n      delete options.zoomBounds;\n      delete options.extentBounds;\n      L.setOptions(\n        this,\n        L.extend(options, this._setUpExtentTemplateVars(template))\n      );\n    },\n    getEvents: function () {\n      var events = {\n        moveend: this._onMoveEnd,\n        zoomstart: this._clearLayer\n      };\n      return events;\n    },\n    onAdd: function (map) {\n      this._map = map;\n      // TODO: set this._map by ourselves\n      this.options.pane.appendChild(this._container);\n      this.setZIndex(this.options.zIndex);\n      this._onAdd();\n    },\n    redraw: function () {\n      this._onMoveEnd();\n    },\n    isVisible: function () {\n      let map = this._linkEl.getMapEl()._map;\n      let mapZoom = map.getZoom();\n      let mapBounds = M.pixelToPCRSBounds(\n        map.getPixelBounds(),\n        mapZoom,\n        map.options.projection\n      );\n      return (\n        mapZoom <= this.zoomBounds.maxZoom &&\n        mapZoom >= this.zoomBounds.minZoom &&\n        this.extentBounds.overlaps(mapBounds)\n      );\n    },\n    _clearLayer: function () {\n      let containerImages = this._container.querySelectorAll('img');\n      for (let i = 0; i < containerImages.length; i++) {\n        this._container.removeChild(containerImages[i]);\n      }\n    },\n\n    _addImage: function (bounds, zoom, loc) {\n      let map = this._map;\n      let overlayToRemove = this._imageOverlay;\n      let src = this.getImageUrl(bounds, zoom);\n      let size = map.getSize();\n      this._imageOverlay = M.imageLayer(src, loc, size, 0, this._container);\n      this._imageOverlay._step = this._template.step;\n      this._imageOverlay.addTo(map);\n      if (overlayToRemove) {\n        this._imageOverlay._overlayToRemove = overlayToRemove._url;\n        this._imageOverlay.on('load error', function () {\n          map.removeLayer(overlayToRemove);\n        });\n      }\n    },\n\n    _scaleImage: function (bounds, zoom) {\n      let obj = this;\n      setTimeout(function () {\n        if (!obj._map) return;\n        let step = obj._template.step;\n        let steppedZoom = Math.floor(zoom / step) * step;\n        let scale = obj._map.getZoomScale(zoom, steppedZoom);\n        let translate = bounds.min\n          .multiplyBy(scale)\n          .subtract(obj._map._getNewPixelOrigin(obj._map.getCenter(), zoom))\n          .round();\n        L.DomUtil.setTransform(obj._imageOverlay._image, translate, scale);\n      });\n    },\n\n    _onAdd: function () {\n      let zoom = this._map.getZoom();\n      let steppedZoom = zoom;\n      let step = this._template.step;\n\n      if (zoom % step !== 0) steppedZoom = Math.floor(zoom / step) * step;\n      let bounds = this._map.getPixelBounds(this._map.getCenter(), steppedZoom);\n      this._pixelOrigins = {};\n      this._pixelOrigins[steppedZoom] = bounds.min;\n      // if the map is panned before the new image layer is added,\n      // the location that the layer should be added to is no longer (0,0) but need to be calculated\n      let loc = this._map\n        .getPixelBounds()\n        .min.subtract(this._map.getPixelOrigin());\n      this._addImage(bounds, steppedZoom, loc);\n      if (zoom !== steppedZoom) {\n        this._scaleImage(bounds, zoom);\n      }\n    },\n\n    _onMoveEnd: function (e) {\n      let mapZoom = this._map.getZoom();\n      let history = this._map.options.mapEl._history;\n      let current = history[history.length - 1];\n      let previous = history[history.length - 2];\n      if (!previous) previous = current;\n      let step = this._template.step;\n      let steppedZoom = Math.floor(mapZoom / step) * step;\n      let bounds = this._map.getPixelBounds(this._map.getCenter(), steppedZoom);\n      //Zooming from one step increment into a lower one\n      if (\n        step !== '1' &&\n        (mapZoom + 1) % step === 0 &&\n        current.zoom === previous.zoom - 1\n      ) {\n        this._addImage(bounds, steppedZoom, L.point(0, 0));\n        this._scaleImage(bounds, mapZoom);\n        //Zooming or panning within a step increment\n      } else if (e && mapZoom % step !== 0) {\n        this._imageOverlay._overlayToRemove = this._imageOverlay._url;\n        if (current.zoom !== previous.zoom) {\n          //Zoomed from within one step increment into another\n          this._addImage(bounds, steppedZoom, L.point(0, 0));\n          this._pixelOrigins[steppedZoom] = bounds.min;\n          this._scaleImage(bounds, mapZoom);\n        } else {\n          // Panning within a step increment\n          let pixelOrigin = this._pixelOrigins[steppedZoom];\n          let loc = bounds.min.subtract(pixelOrigin);\n          if (this.getImageUrl(bounds, steppedZoom) === this._imageOverlay._url)\n            return;\n          this._addImage(bounds, steppedZoom, loc);\n          this._scaleImage(bounds, mapZoom);\n        }\n        // Zooming from one step decrement into a higher one\n        // OR panning when mapZoom % step === 0\n      } else {\n        if (!this.isVisible) {\n          this._clearLayer();\n          return;\n        }\n        var map = this._map,\n          loc = map.getPixelBounds().min.subtract(map.getPixelOrigin());\n        this._addImage(map.getPixelBounds(), mapZoom, loc);\n        this._pixelOrigins[mapZoom] = map.getPixelOrigin();\n      }\n    },\n    setZIndex: function (zIndex) {\n      this.options.zIndex = zIndex;\n      this._updateZIndex();\n\n      return this;\n    },\n    _updateZIndex: function () {\n      if (\n        this._container &&\n        this.options.zIndex !== undefined &&\n        this.options.zIndex !== null\n      ) {\n        this._container.style.zIndex = this.options.zIndex;\n      }\n    },\n    onRemove: function (map) {\n      L.DomUtil.remove(this._container);\n      this._clearLayer();\n    },\n    getImageUrl: function (pixelBounds, zoom) {\n      var obj = {};\n      obj[this.options.extent.width] = this._map.getSize().x;\n      obj[this.options.extent.height] = this._map.getSize().y;\n      obj[this.options.extent.bottom] = this._TCRSToPCRS(pixelBounds.max, zoom).y;\n      obj[this.options.extent.left] = this._TCRSToPCRS(pixelBounds.min, zoom).x;\n      obj[this.options.extent.top] = this._TCRSToPCRS(pixelBounds.min, zoom).y;\n      obj[this.options.extent.right] = this._TCRSToPCRS(pixelBounds.max, zoom).x;\n      // hidden and other variables that may be associated\n      for (var v in this.options.extent) {\n        if (\n          ['width', 'height', 'left', 'right', 'top', 'bottom'].indexOf(v) < 0\n        ) {\n          obj[v] = this.options.extent[v];\n        }\n      }\n      return L.Util.template(this._template.template, obj);\n    },\n    _TCRSToPCRS: function (coords, zoom) {\n      // TCRS pixel point to Projected CRS point (in meters, presumably)\n      var map = this._map,\n        crs = map.options.crs,\n        loc = crs.transformation.untransform(coords, crs.scale(zoom));\n      return loc;\n    },\n    _setUpExtentTemplateVars: function (template) {\n      // process the inputs associated to template and create an object named\n      // extent with member properties as follows:\n      // {width: 'widthvarname',\n      //  height: 'heightvarname',\n      //  left: 'leftvarname',\n      //  right: 'rightvarname',\n      //  top: 'topvarname',\n      //  bottom: 'bottomvarname'}\n\n      var extentVarNames = { extent: {} },\n        inputs = template.values;\n\n      for (var i = 0; i < template.values.length; i++) {\n        var type = inputs[i].getAttribute('type'),\n          units = inputs[i].getAttribute('units'),\n          axis = inputs[i].getAttribute('axis'),\n          name = inputs[i].getAttribute('name'),\n          position = inputs[i].getAttribute('position'),\n          select = inputs[i].tagName.toLowerCase() === 'map-select';\n        if (type === 'width') {\n          extentVarNames.extent.width = name;\n        } else if (type === 'height') {\n          extentVarNames.extent.height = name;\n        } else if (\n          type === 'location' &&\n          (units === 'pcrs' || units === 'gcrs')\n        ) {\n          //<input name=\"...\" units=\"pcrs\" type=\"location\" position=\"top|bottom-left|right\" axis=\"northing|easting|latitude|longitude\">\n          switch (axis) {\n            case 'longitude':\n            case 'easting':\n              if (position) {\n                if (position.match(/.*?-left/i)) {\n                  extentVarNames.extent.left = name;\n                } else if (position.match(/.*?-right/i)) {\n                  extentVarNames.extent.right = name;\n                }\n              }\n              break;\n            case 'latitude':\n            case 'northing':\n              if (position) {\n                if (position.match(/top-.*?/i)) {\n                  extentVarNames.extent.top = name;\n                } else if (position.match(/bottom-.*?/i)) {\n                  extentVarNames.extent.bottom = name;\n                }\n              }\n              break;\n          }\n        } else if (select) {\n          /*jshint -W104 */\n          const parsedselect = inputs[i].htmlselect;\n          extentVarNames.extent[name] = function () {\n            return parsedselect.value;\n          };\n        } else {\n          /*jshint -W104 */\n          const input = inputs[i];\n          extentVarNames.extent[name] = function () {\n            return input.getAttribute('value');\n          };\n        }\n      }\n      return extentVarNames;\n    }\n  });\n  var templatedImageLayer = function (template, options) {\n    return new TemplatedImageLayer(template, options);\n  };\n\n  /**\n   * A standalone point geometry with useful accessor, comparison, and\n   * modification methods.\n   *\n   * @class\n   * @param {number} x the x-coordinate. This could be longitude or screen pixels, or any other sort of unit.\n   * @param {number} y the y-coordinate. This could be latitude or screen pixels, or any other sort of unit.\n   *\n   * @example\n   * const point = new Point(-77, 38);\n   */\n  function Point(x, y) {\n      this.x = x;\n      this.y = y;\n  }\n\n  Point.prototype = {\n      /**\n       * Clone this point, returning a new point that can be modified\n       * without affecting the old one.\n       * @return {Point} the clone\n       */\n      clone() { return new Point(this.x, this.y); },\n\n      /**\n       * Add this point's x & y coordinates to another point,\n       * yielding a new point.\n       * @param {Point} p the other point\n       * @return {Point} output point\n       */\n      add(p) { return this.clone()._add(p); },\n\n      /**\n       * Subtract this point's x & y coordinates to from point,\n       * yielding a new point.\n       * @param {Point} p the other point\n       * @return {Point} output point\n       */\n      sub(p) { return this.clone()._sub(p); },\n\n      /**\n       * Multiply this point's x & y coordinates by point,\n       * yielding a new point.\n       * @param {Point} p the other point\n       * @return {Point} output point\n       */\n      multByPoint(p) { return this.clone()._multByPoint(p); },\n\n      /**\n       * Divide this point's x & y coordinates by point,\n       * yielding a new point.\n       * @param {Point} p the other point\n       * @return {Point} output point\n       */\n      divByPoint(p) { return this.clone()._divByPoint(p); },\n\n      /**\n       * Multiply this point's x & y coordinates by a factor,\n       * yielding a new point.\n       * @param {number} k factor\n       * @return {Point} output point\n       */\n      mult(k) { return this.clone()._mult(k); },\n\n      /**\n       * Divide this point's x & y coordinates by a factor,\n       * yielding a new point.\n       * @param {number} k factor\n       * @return {Point} output point\n       */\n      div(k) { return this.clone()._div(k); },\n\n      /**\n       * Rotate this point around the 0, 0 origin by an angle a,\n       * given in radians\n       * @param {number} a angle to rotate around, in radians\n       * @return {Point} output point\n       */\n      rotate(a) { return this.clone()._rotate(a); },\n\n      /**\n       * Rotate this point around p point by an angle a,\n       * given in radians\n       * @param {number} a angle to rotate around, in radians\n       * @param {Point} p Point to rotate around\n       * @return {Point} output point\n       */\n      rotateAround(a, p) { return this.clone()._rotateAround(a, p); },\n\n      /**\n       * Multiply this point by a 4x1 transformation matrix\n       * @param {[number, number, number, number]} m transformation matrix\n       * @return {Point} output point\n       */\n      matMult(m) { return this.clone()._matMult(m); },\n\n      /**\n       * Calculate this point but as a unit vector from 0, 0, meaning\n       * that the distance from the resulting point to the 0, 0\n       * coordinate will be equal to 1 and the angle from the resulting\n       * point to the 0, 0 coordinate will be the same as before.\n       * @return {Point} unit vector point\n       */\n      unit() { return this.clone()._unit(); },\n\n      /**\n       * Compute a perpendicular point, where the new y coordinate\n       * is the old x coordinate and the new x coordinate is the old y\n       * coordinate multiplied by -1\n       * @return {Point} perpendicular point\n       */\n      perp() { return this.clone()._perp(); },\n\n      /**\n       * Return a version of this point with the x & y coordinates\n       * rounded to integers.\n       * @return {Point} rounded point\n       */\n      round() { return this.clone()._round(); },\n\n      /**\n       * Return the magnitude of this point: this is the Euclidean\n       * distance from the 0, 0 coordinate to this point's x and y\n       * coordinates.\n       * @return {number} magnitude\n       */\n      mag() {\n          return Math.sqrt(this.x * this.x + this.y * this.y);\n      },\n\n      /**\n       * Judge whether this point is equal to another point, returning\n       * true or false.\n       * @param {Point} other the other point\n       * @return {boolean} whether the points are equal\n       */\n      equals(other) {\n          return this.x === other.x &&\n                 this.y === other.y;\n      },\n\n      /**\n       * Calculate the distance from this point to another point\n       * @param {Point} p the other point\n       * @return {number} distance\n       */\n      dist(p) {\n          return Math.sqrt(this.distSqr(p));\n      },\n\n      /**\n       * Calculate the distance from this point to another point,\n       * without the square root step. Useful if you're comparing\n       * relative distances.\n       * @param {Point} p the other point\n       * @return {number} distance\n       */\n      distSqr(p) {\n          const dx = p.x - this.x,\n              dy = p.y - this.y;\n          return dx * dx + dy * dy;\n      },\n\n      /**\n       * Get the angle from the 0, 0 coordinate to this point, in radians\n       * coordinates.\n       * @return {number} angle\n       */\n      angle() {\n          return Math.atan2(this.y, this.x);\n      },\n\n      /**\n       * Get the angle from this point to another point, in radians\n       * @param {Point} b the other point\n       * @return {number} angle\n       */\n      angleTo(b) {\n          return Math.atan2(this.y - b.y, this.x - b.x);\n      },\n\n      /**\n       * Get the angle between this point and another point, in radians\n       * @param {Point} b the other point\n       * @return {number} angle\n       */\n      angleWith(b) {\n          return this.angleWithSep(b.x, b.y);\n      },\n\n      /**\n       * Find the angle of the two vectors, solving the formula for\n       * the cross product a x b = |a||b|sin() for .\n       * @param {number} x the x-coordinate\n       * @param {number} y the y-coordinate\n       * @return {number} the angle in radians\n       */\n      angleWithSep(x, y) {\n          return Math.atan2(\n              this.x * y - this.y * x,\n              this.x * x + this.y * y);\n      },\n\n      /** @param {[number, number, number, number]} m */\n      _matMult(m) {\n          const x = m[0] * this.x + m[1] * this.y,\n              y = m[2] * this.x + m[3] * this.y;\n          this.x = x;\n          this.y = y;\n          return this;\n      },\n\n      /** @param {Point} p */\n      _add(p) {\n          this.x += p.x;\n          this.y += p.y;\n          return this;\n      },\n\n      /** @param {Point} p */\n      _sub(p) {\n          this.x -= p.x;\n          this.y -= p.y;\n          return this;\n      },\n\n      /** @param {number} k */\n      _mult(k) {\n          this.x *= k;\n          this.y *= k;\n          return this;\n      },\n\n      /** @param {number} k */\n      _div(k) {\n          this.x /= k;\n          this.y /= k;\n          return this;\n      },\n\n      /** @param {Point} p */\n      _multByPoint(p) {\n          this.x *= p.x;\n          this.y *= p.y;\n          return this;\n      },\n\n      /** @param {Point} p */\n      _divByPoint(p) {\n          this.x /= p.x;\n          this.y /= p.y;\n          return this;\n      },\n\n      _unit() {\n          this._div(this.mag());\n          return this;\n      },\n\n      _perp() {\n          const y = this.y;\n          this.y = this.x;\n          this.x = -y;\n          return this;\n      },\n\n      /** @param {number} angle */\n      _rotate(angle) {\n          const cos = Math.cos(angle),\n              sin = Math.sin(angle),\n              x = cos * this.x - sin * this.y,\n              y = sin * this.x + cos * this.y;\n          this.x = x;\n          this.y = y;\n          return this;\n      },\n\n      /**\n       * @param {number} angle\n       * @param {Point} p\n       */\n      _rotateAround(angle, p) {\n          const cos = Math.cos(angle),\n              sin = Math.sin(angle),\n              x = p.x + cos * (this.x - p.x) - sin * (this.y - p.y),\n              y = p.y + sin * (this.x - p.x) + cos * (this.y - p.y);\n          this.x = x;\n          this.y = y;\n          return this;\n      },\n\n      _round() {\n          this.x = Math.round(this.x);\n          this.y = Math.round(this.y);\n          return this;\n      },\n\n      constructor: Point\n  };\n\n  /**\n   * Construct a point from an array if necessary, otherwise if the input\n   * is already a Point, return it unchanged.\n   * @param {Point | [number, number] | {x: number, y: number}} p input value\n   * @return {Point} constructed point.\n   * @example\n   * // this\n   * var point = Point.convert([0, 1]);\n   * // is equivalent to\n   * var point = new Point(0, 1);\n   */\n  Point.convert = function (p) {\n      if (p instanceof Point) {\n          return /** @type {Point} */ (p);\n      }\n      if (Array.isArray(p)) {\n          return new Point(+p[0], +p[1]);\n      }\n      if (p.x !== undefined && p.y !== undefined) {\n          return new Point(+p.x, +p.y);\n      }\n      throw new Error('Expected [x, y] or {x, y} point format');\n  };\n\n  /**\n   * A simple guard function:\n   *\n   * ```js\n   * Math.min(Math.max(low, value), high)\n   * ```\n   */\n  function guard(low, high, value) {\n    return Math.min(Math.max(low, value), high);\n  }\n\n  class ColorError extends Error {\n    constructor(color) {\n      super(`Failed to parse color: \"${color}\"`);\n    }\n  }\n  var ColorError$1 = ColorError;\n\n  /**\n   * Parses a color into red, gree, blue, alpha parts\n   *\n   * @param color the input color. Can be a RGB, RBGA, HSL, HSLA, or named color\n   */\n  function parseToRgba(color) {\n    if (typeof color !== 'string') throw new ColorError$1(color);\n    if (color.trim().toLowerCase() === 'transparent') return [0, 0, 0, 0];\n    let normalizedColor = color.trim();\n    normalizedColor = namedColorRegex.test(color) ? nameToHex(color) : color;\n    const reducedHexMatch = reducedHexRegex.exec(normalizedColor);\n    if (reducedHexMatch) {\n      const arr = Array.from(reducedHexMatch).slice(1);\n      return [...arr.slice(0, 3).map(x => parseInt(r(x, 2), 16)), parseInt(r(arr[3] || 'f', 2), 16) / 255];\n    }\n    const hexMatch = hexRegex.exec(normalizedColor);\n    if (hexMatch) {\n      const arr = Array.from(hexMatch).slice(1);\n      return [...arr.slice(0, 3).map(x => parseInt(x, 16)), parseInt(arr[3] || 'ff', 16) / 255];\n    }\n    const rgbaMatch = rgbaRegex.exec(normalizedColor);\n    if (rgbaMatch) {\n      const arr = Array.from(rgbaMatch).slice(1);\n      return [...arr.slice(0, 3).map(x => parseInt(x, 10)), parseFloat(arr[3] || '1')];\n    }\n    const hslaMatch = hslaRegex.exec(normalizedColor);\n    if (hslaMatch) {\n      const [h, s, l, a] = Array.from(hslaMatch).slice(1).map(parseFloat);\n      if (guard(0, 100, s) !== s) throw new ColorError$1(color);\n      if (guard(0, 100, l) !== l) throw new ColorError$1(color);\n      return [...hslToRgb(h, s, l), Number.isNaN(a) ? 1 : a];\n    }\n    throw new ColorError$1(color);\n  }\n  function hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i) {\n      hash = hash * 33 ^ str.charCodeAt(--i);\n    }\n\n    /* JavaScript does bitwise operations (like XOR, above) on 32-bit signed\n     * integers. Since we want the results to be always positive, convert the\n     * signed int to an unsigned by doing an unsigned bitshift. */\n    return (hash >>> 0) % 2341;\n  }\n  const colorToInt = x => parseInt(x.replace(/_/g, ''), 36);\n  const compressedColorMap = '1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm'.split(' ').reduce((acc, next) => {\n    const key = colorToInt(next.substring(0, 3));\n    const hex = colorToInt(next.substring(3)).toString(16);\n\n    // NOTE: padStart could be used here but it breaks Node 6 compat\n    // https://github.com/ricokahler/color2k/issues/351\n    let prefix = '';\n    for (let i = 0; i < 6 - hex.length; i++) {\n      prefix += '0';\n    }\n    acc[key] = `${prefix}${hex}`;\n    return acc;\n  }, {});\n\n  /**\n   * Checks if a string is a CSS named color and returns its equivalent hex value, otherwise returns the original color.\n   */\n  function nameToHex(color) {\n    const normalizedColorName = color.toLowerCase().trim();\n    const result = compressedColorMap[hash(normalizedColorName)];\n    if (!result) throw new ColorError$1(color);\n    return `#${result}`;\n  }\n  const r = (str, amount) => Array.from(Array(amount)).map(() => str).join('');\n  const reducedHexRegex = new RegExp(`^#${r('([a-f0-9])', 3)}([a-f0-9])?$`, 'i');\n  const hexRegex = new RegExp(`^#${r('([a-f0-9]{2})', 3)}([a-f0-9]{2})?$`, 'i');\n  const rgbaRegex = new RegExp(`^rgba?\\\\(\\\\s*(\\\\d+)\\\\s*${r(',\\\\s*(\\\\d+)\\\\s*', 2)}(?:,\\\\s*([\\\\d.]+))?\\\\s*\\\\)$`, 'i');\n  const hslaRegex = /^hsla?\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)%\\s*,\\s*([\\d.]+)%(?:\\s*,\\s*([\\d.]+))?\\s*\\)$/i;\n  const namedColorRegex = /^[a-z]+$/i;\n  const roundColor = color => {\n    return Math.round(color * 255);\n  };\n  const hslToRgb = (hue, saturation, lightness) => {\n    let l = lightness / 100;\n    if (saturation === 0) {\n      // achromatic\n      return [l, l, l].map(roundColor);\n    }\n\n    // formulae from https://en.wikipedia.org/wiki/HSL_and_HSV\n    const huePrime = (hue % 360 + 360) % 360 / 60;\n    const chroma = (1 - Math.abs(2 * l - 1)) * (saturation / 100);\n    const secondComponent = chroma * (1 - Math.abs(huePrime % 2 - 1));\n    let red = 0;\n    let green = 0;\n    let blue = 0;\n    if (huePrime >= 0 && huePrime < 1) {\n      red = chroma;\n      green = secondComponent;\n    } else if (huePrime >= 1 && huePrime < 2) {\n      red = secondComponent;\n      green = chroma;\n    } else if (huePrime >= 2 && huePrime < 3) {\n      green = chroma;\n      blue = secondComponent;\n    } else if (huePrime >= 3 && huePrime < 4) {\n      green = secondComponent;\n      blue = chroma;\n    } else if (huePrime >= 4 && huePrime < 5) {\n      red = secondComponent;\n      blue = chroma;\n    } else if (huePrime >= 5 && huePrime < 6) {\n      red = chroma;\n      blue = secondComponent;\n    }\n    const lightnessModification = l - chroma / 2;\n    const finalRed = red + lightnessModification;\n    const finalGreen = green + lightnessModification;\n    const finalBlue = blue + lightnessModification;\n    return [finalRed, finalGreen, finalBlue].map(roundColor);\n  };\n\n  /**\n   * Takes in rgba parts and returns an rgba string\n   *\n   * @param red The amount of red in the red channel, given in a number between 0 and 255 inclusive\n   * @param green The amount of green in the red channel, given in a number between 0 and 255 inclusive\n   * @param blue The amount of blue in the red channel, given in a number between 0 and 255 inclusive\n   * @param alpha Percentage of opacity, given as a decimal between 0 and 1\n   */\n  function rgba(red, green, blue, alpha) {\n    return `rgba(${guard(0, 255, red).toFixed()}, ${guard(0, 255, green).toFixed()}, ${guard(0, 255, blue).toFixed()}, ${parseFloat(guard(0, 1, alpha).toFixed(3))})`;\n  }\n\n  /**\n   * Mixes two colors together. Taken from sass's implementation.\n   */\n  function mix(color1, color2, weight) {\n    const normalize = (n, index) =>\n    // 3rd index is alpha channel which is already normalized\n    index === 3 ? n : n / 255;\n    const [r1, g1, b1, a1] = parseToRgba(color1).map(normalize);\n    const [r2, g2, b2, a2] = parseToRgba(color2).map(normalize);\n\n    // The formula is copied from the original Sass implementation:\n    // http://sass-lang.com/documentation/Sass/Script/Functions.html#mix-instance_method\n    const alphaDelta = a2 - a1;\n    const normalizedWeight = weight * 2 - 1;\n    const combinedWeight = normalizedWeight * alphaDelta === -1 ? normalizedWeight : normalizedWeight + alphaDelta / (1 + normalizedWeight * alphaDelta);\n    const weight2 = (combinedWeight + 1) / 2;\n    const weight1 = 1 - weight2;\n    const r = (r1 * weight1 + r2 * weight2) * 255;\n    const g = (g1 * weight1 + g2 * weight2) * 255;\n    const b = (b1 * weight1 + b2 * weight2) * 255;\n    const a = a2 * weight + a1 * (1 - weight);\n    return rgba(r, g, b, a);\n  }\n\n  /** @import Pbf from 'pbf' */\n  /** @import {Feature} from 'geojson' */\n\n  class VectorTileFeature {\n      /**\n       * @param {Pbf} pbf\n       * @param {number} end\n       * @param {number} extent\n       * @param {string[]} keys\n       * @param {unknown[]} values\n       */\n      constructor(pbf, end, extent, keys, values) {\n          // Public\n\n          /** @type {Record<string, unknown>} */\n          this.properties = {};\n\n          this.extent = extent;\n          /** @type {0 | 1 | 2 | 3} */\n          this.type = 0;\n\n          /** @type {number | undefined} */\n          this.id = undefined;\n\n          this._pbf = pbf;\n          this._geometry = -1;\n          this._keys = keys;\n          this._values = values;\n\n          pbf.readFields(readFeature, this, end);\n      }\n\n      loadGeometry() {\n          const pbf = this._pbf;\n          pbf.pos = this._geometry;\n\n          const end = pbf.readVarint() + pbf.pos;\n\n          /** @type Point[][] */\n          const lines = [];\n\n          /** @type Point[] | undefined */\n          let line;\n\n          let cmd = 1;\n          let length = 0;\n          let x = 0;\n          let y = 0;\n\n          while (pbf.pos < end) {\n              if (length <= 0) {\n                  const cmdLen = pbf.readVarint();\n                  cmd = cmdLen & 0x7;\n                  length = cmdLen >> 3;\n              }\n\n              length--;\n\n              if (cmd === 1 || cmd === 2) {\n                  x += pbf.readSVarint();\n                  y += pbf.readSVarint();\n\n                  if (cmd === 1) { // moveTo\n                      if (line) lines.push(line);\n                      line = [];\n                  }\n\n                  if (line) line.push(new Point(x, y));\n\n              } else if (cmd === 7) {\n\n                  // Workaround for https://github.com/mapbox/mapnik-vector-tile/issues/90\n                  if (line) {\n                      line.push(line[0].clone()); // closePolygon\n                  }\n\n              } else {\n                  throw new Error(`unknown command ${cmd}`);\n              }\n          }\n\n          if (line) lines.push(line);\n\n          return lines;\n      }\n\n      bbox() {\n          const pbf = this._pbf;\n          pbf.pos = this._geometry;\n\n          const end = pbf.readVarint() + pbf.pos;\n          let cmd = 1,\n              length = 0,\n              x = 0,\n              y = 0,\n              x1 = Infinity,\n              x2 = -Infinity,\n              y1 = Infinity,\n              y2 = -Infinity;\n\n          while (pbf.pos < end) {\n              if (length <= 0) {\n                  const cmdLen = pbf.readVarint();\n                  cmd = cmdLen & 0x7;\n                  length = cmdLen >> 3;\n              }\n\n              length--;\n\n              if (cmd === 1 || cmd === 2) {\n                  x += pbf.readSVarint();\n                  y += pbf.readSVarint();\n                  if (x < x1) x1 = x;\n                  if (x > x2) x2 = x;\n                  if (y < y1) y1 = y;\n                  if (y > y2) y2 = y;\n\n              } else if (cmd !== 7) {\n                  throw new Error(`unknown command ${cmd}`);\n              }\n          }\n\n          return [x1, y1, x2, y2];\n      }\n\n      /**\n       * @param {number} x\n       * @param {number} y\n       * @param {number} z\n       * @return {Feature}\n       */\n      toGeoJSON(x, y, z) {\n          const size = this.extent * Math.pow(2, z),\n              x0 = this.extent * x,\n              y0 = this.extent * y,\n              vtCoords = this.loadGeometry();\n\n          /** @param {Point} p */\n          function projectPoint(p) {\n              return [\n                  (p.x + x0) * 360 / size - 180,\n                  360 / Math.PI * Math.atan(Math.exp((1 - (p.y + y0) * 2 / size) * Math.PI)) - 90\n              ];\n          }\n\n          /** @param {Point[]} line */\n          function projectLine(line) {\n              return line.map(projectPoint);\n          }\n\n          /** @type {Feature[\"geometry\"]} */\n          let geometry;\n\n          if (this.type === 1) {\n              const points = [];\n              for (const line of vtCoords) {\n                  points.push(line[0]);\n              }\n              const coordinates = projectLine(points);\n              geometry = points.length === 1 ?\n                  {type: 'Point', coordinates: coordinates[0]} :\n                  {type: 'MultiPoint', coordinates};\n\n          } else if (this.type === 2) {\n\n              const coordinates = vtCoords.map(projectLine);\n              geometry = coordinates.length === 1 ?\n                  {type: 'LineString', coordinates: coordinates[0]} :\n                  {type: 'MultiLineString', coordinates};\n\n          } else if (this.type === 3) {\n              const polygons = classifyRings(vtCoords);\n              const coordinates = [];\n              for (const polygon of polygons) {\n                  coordinates.push(polygon.map(projectLine));\n              }\n              geometry = coordinates.length === 1 ?\n                  {type: 'Polygon', coordinates: coordinates[0]} :\n                  {type: 'MultiPolygon', coordinates};\n          } else {\n\n              throw new Error('unknown feature type');\n          }\n\n          /** @type {Feature} */\n          const result = {\n              type: 'Feature',\n              geometry,\n              properties: this.properties\n          };\n\n          if (this.id != null) {\n              result.id = this.id;\n          }\n\n          return result;\n      }\n  }\n\n  /** @type {['Unknown', 'Point', 'LineString', 'Polygon']} */\n  VectorTileFeature.types = ['Unknown', 'Point', 'LineString', 'Polygon'];\n\n  /**\n   * @param {number} tag\n   * @param {VectorTileFeature} feature\n   * @param {Pbf} pbf\n   */\n  function readFeature(tag, feature, pbf) {\n      if (tag === 1) feature.id = pbf.readVarint();\n      else if (tag === 2) readTag(pbf, feature);\n      else if (tag === 3) feature.type = /** @type {0 | 1 | 2 | 3} */ (pbf.readVarint());\n      else if (tag === 4) feature._geometry = pbf.pos;\n  }\n\n  /**\n   * @param {Pbf} pbf\n   * @param {VectorTileFeature} feature\n   */\n  function readTag(pbf, feature) {\n      const end = pbf.readVarint() + pbf.pos;\n\n      while (pbf.pos < end) {\n          const key = feature._keys[pbf.readVarint()],\n              value = feature._values[pbf.readVarint()];\n          feature.properties[key] = value;\n      }\n  }\n\n  /** classifies an array of rings into polygons with outer rings and holes\n   * @param {Point[][]} rings\n   */\n  function classifyRings(rings) {\n      const len = rings.length;\n\n      if (len <= 1) return [rings];\n\n      const polygons = [];\n      let polygon, ccw;\n\n      for (let i = 0; i < len; i++) {\n          const area = signedArea(rings[i]);\n          if (area === 0) continue;\n\n          if (ccw === undefined) ccw = area < 0;\n\n          if (ccw === area < 0) {\n              if (polygon) polygons.push(polygon);\n              polygon = [rings[i]];\n\n          } else if (polygon) {\n              polygon.push(rings[i]);\n          }\n      }\n      if (polygon) polygons.push(polygon);\n\n      return polygons;\n  }\n\n  /** @param {Point[]} ring */\n  function signedArea(ring) {\n      let sum = 0;\n      for (let i = 0, len = ring.length, j = len - 1, p1, p2; i < len; j = i++) {\n          p1 = ring[i];\n          p2 = ring[j];\n          sum += (p2.x - p1.x) * (p1.y + p2.y);\n      }\n      return sum;\n  }\n\n  class VectorTileLayer {\n      /**\n       * @param {Pbf} pbf\n       * @param {number} [end]\n       */\n      constructor(pbf, end) {\n          // Public\n          this.version = 1;\n          this.name = '';\n          this.extent = 4096;\n          this.length = 0;\n\n          // Private\n          this._pbf = pbf;\n\n          /** @type {string[]} */\n          this._keys = [];\n\n          /** @type {unknown[]} */\n          this._values = [];\n\n          /** @type {number[]} */\n          this._features = [];\n\n          pbf.readFields(readLayer, this, end);\n\n          this.length = this._features.length;\n      }\n\n      /** return feature `i` from this layer as a `VectorTileFeature`\n       * @param {number} i\n       */\n      feature(i) {\n          if (i < 0 || i >= this._features.length) throw new Error('feature index out of bounds');\n\n          this._pbf.pos = this._features[i];\n\n          const end = this._pbf.readVarint() + this._pbf.pos;\n          return new VectorTileFeature(this._pbf, end, this.extent, this._keys, this._values);\n      }\n  }\n\n  /**\n   * @param {number} tag\n   * @param {VectorTileLayer} layer\n   * @param {Pbf} pbf\n   */\n  function readLayer(tag, layer, pbf) {\n      if (tag === 15) layer.version = pbf.readVarint();\n      else if (tag === 1) layer.name = pbf.readString();\n      else if (tag === 5) layer.extent = pbf.readVarint();\n      else if (tag === 2) layer._features.push(pbf.pos);\n      else if (tag === 3) layer._keys.push(pbf.readString());\n      else if (tag === 4) layer._values.push(readValueMessage(pbf));\n  }\n\n  /**\n   * @param {Pbf} pbf\n   */\n  function readValueMessage(pbf) {\n      let value = null;\n      const end = pbf.readVarint() + pbf.pos;\n\n      while (pbf.pos < end) {\n          const tag = pbf.readVarint() >> 3;\n\n          value = tag === 1 ? pbf.readString() :\n              tag === 2 ? pbf.readFloat() :\n              tag === 3 ? pbf.readDouble() :\n              tag === 4 ? pbf.readVarint64() :\n              tag === 5 ? pbf.readVarint() :\n              tag === 6 ? pbf.readSVarint() :\n              tag === 7 ? pbf.readBoolean() : null;\n      }\n\n      return value;\n  }\n\n  class VectorTile {\n      /**\n       * @param {Pbf} pbf\n       * @param {number} [end]\n       */\n      constructor(pbf, end) {\n          /** @type {Record<string, VectorTileLayer>} */\n          this.layers = pbf.readFields(readTile, {}, end);\n      }\n  }\n\n  /**\n   * @param {number} tag\n   * @param {Record<string, VectorTileLayer>} layers\n   * @param {Pbf} pbf\n   */\n  function readTile(tag, layers, pbf) {\n      if (tag === 3) {\n          const layer = new VectorTileLayer(pbf, pbf.readVarint() + pbf.pos);\n          if (layer.length) layers[layer.name] = layer;\n      }\n  }\n\n  const SHIFT_LEFT_32 = (1 << 16) * (1 << 16);\n  const SHIFT_RIGHT_32 = 1 / SHIFT_LEFT_32;\n\n  // Threshold chosen based on both benchmarking and knowledge about browser string\n  // data structures (which currently switch structure types at 12 bytes or more)\n  const TEXT_DECODER_MIN_LENGTH = 12;\n  const utf8TextDecoder = typeof TextDecoder === 'undefined' ? null : new TextDecoder('utf-8');\n\n  const PBF_VARINT  = 0; // varint: int32, int64, uint32, uint64, sint32, sint64, bool, enum\n  const PBF_FIXED64 = 1; // 64-bit: double, fixed64, sfixed64\n  const PBF_BYTES   = 2; // length-delimited: string, bytes, embedded messages, packed repeated fields\n  const PBF_FIXED32 = 5; // 32-bit: float, fixed32, sfixed32\n\n  class Pbf {\n      /**\n       * @param {Uint8Array | ArrayBuffer} [buf]\n       */\n      constructor(buf = new Uint8Array(16)) {\n          this.buf = ArrayBuffer.isView(buf) ? buf : new Uint8Array(buf);\n          this.dataView = new DataView(this.buf.buffer);\n          this.pos = 0;\n          this.type = 0;\n          this.length = this.buf.length;\n      }\n\n      // === READING =================================================================\n\n      /**\n       * @template T\n       * @param {(tag: number, result: T, pbf: Pbf) => void} readField\n       * @param {T} result\n       * @param {number} [end]\n       */\n      readFields(readField, result, end = this.length) {\n          while (this.pos < end) {\n              const val = this.readVarint(),\n                  tag = val >> 3,\n                  startPos = this.pos;\n\n              this.type = val & 0x7;\n              readField(tag, result, this);\n\n              if (this.pos === startPos) this.skip(val);\n          }\n          return result;\n      }\n\n      /**\n       * @template T\n       * @param {(tag: number, result: T, pbf: Pbf) => void} readField\n       * @param {T} result\n       */\n      readMessage(readField, result) {\n          return this.readFields(readField, result, this.readVarint() + this.pos);\n      }\n\n      readFixed32() {\n          const val = this.dataView.getUint32(this.pos, true);\n          this.pos += 4;\n          return val;\n      }\n\n      readSFixed32() {\n          const val = this.dataView.getInt32(this.pos, true);\n          this.pos += 4;\n          return val;\n      }\n\n      // 64-bit int handling is based on github.com/dpw/node-buffer-more-ints (MIT-licensed)\n\n      readFixed64() {\n          const val = this.dataView.getUint32(this.pos, true) + this.dataView.getUint32(this.pos + 4, true) * SHIFT_LEFT_32;\n          this.pos += 8;\n          return val;\n      }\n\n      readSFixed64() {\n          const val = this.dataView.getUint32(this.pos, true) + this.dataView.getInt32(this.pos + 4, true) * SHIFT_LEFT_32;\n          this.pos += 8;\n          return val;\n      }\n\n      readFloat() {\n          const val = this.dataView.getFloat32(this.pos, true);\n          this.pos += 4;\n          return val;\n      }\n\n      readDouble() {\n          const val = this.dataView.getFloat64(this.pos, true);\n          this.pos += 8;\n          return val;\n      }\n\n      /**\n       * @param {boolean} [isSigned]\n       */\n      readVarint(isSigned) {\n          const buf = this.buf;\n          let val, b;\n\n          b = buf[this.pos++]; val  =  b & 0x7f;        if (b < 0x80) return val;\n          b = buf[this.pos++]; val |= (b & 0x7f) << 7;  if (b < 0x80) return val;\n          b = buf[this.pos++]; val |= (b & 0x7f) << 14; if (b < 0x80) return val;\n          b = buf[this.pos++]; val |= (b & 0x7f) << 21; if (b < 0x80) return val;\n          b = buf[this.pos];   val |= (b & 0x0f) << 28;\n\n          return readVarintRemainder$1(val, isSigned, this);\n      }\n\n      readVarint64() { // for compatibility with v2.0.1\n          return this.readVarint(true);\n      }\n\n      readSVarint() {\n          const num = this.readVarint();\n          return num % 2 === 1 ? (num + 1) / -2 : num / 2; // zigzag encoding\n      }\n\n      readBoolean() {\n          return Boolean(this.readVarint());\n      }\n\n      readString() {\n          const end = this.readVarint() + this.pos;\n          const pos = this.pos;\n          this.pos = end;\n\n          if (end - pos >= TEXT_DECODER_MIN_LENGTH && utf8TextDecoder) {\n              // longer strings are fast with the built-in browser TextDecoder API\n              return utf8TextDecoder.decode(this.buf.subarray(pos, end));\n          }\n          // short strings are fast with our custom implementation\n          return readUtf8(this.buf, pos, end);\n      }\n\n      readBytes() {\n          const end = this.readVarint() + this.pos,\n              buffer = this.buf.subarray(this.pos, end);\n          this.pos = end;\n          return buffer;\n      }\n\n      // verbose for performance reasons; doesn't affect gzipped size\n\n      /**\n       * @param {number[]} [arr]\n       * @param {boolean} [isSigned]\n       */\n      readPackedVarint(arr = [], isSigned) {\n          const end = this.readPackedEnd();\n          while (this.pos < end) arr.push(this.readVarint(isSigned));\n          return arr;\n      }\n      /** @param {number[]} [arr] */\n      readPackedSVarint(arr = []) {\n          const end = this.readPackedEnd();\n          while (this.pos < end) arr.push(this.readSVarint());\n          return arr;\n      }\n      /** @param {boolean[]} [arr] */\n      readPackedBoolean(arr = []) {\n          const end = this.readPackedEnd();\n          while (this.pos < end) arr.push(this.readBoolean());\n          return arr;\n      }\n      /** @param {number[]} [arr] */\n      readPackedFloat(arr = []) {\n          const end = this.readPackedEnd();\n          while (this.pos < end) arr.push(this.readFloat());\n          return arr;\n      }\n      /** @param {number[]} [arr] */\n      readPackedDouble(arr = []) {\n          const end = this.readPackedEnd();\n          while (this.pos < end) arr.push(this.readDouble());\n          return arr;\n      }\n      /** @param {number[]} [arr] */\n      readPackedFixed32(arr = []) {\n          const end = this.readPackedEnd();\n          while (this.pos < end) arr.push(this.readFixed32());\n          return arr;\n      }\n      /** @param {number[]} [arr] */\n      readPackedSFixed32(arr = []) {\n          const end = this.readPackedEnd();\n          while (this.pos < end) arr.push(this.readSFixed32());\n          return arr;\n      }\n      /** @param {number[]} [arr] */\n      readPackedFixed64(arr = []) {\n          const end = this.readPackedEnd();\n          while (this.pos < end) arr.push(this.readFixed64());\n          return arr;\n      }\n      /** @param {number[]} [arr] */\n      readPackedSFixed64(arr = []) {\n          const end = this.readPackedEnd();\n          while (this.pos < end) arr.push(this.readSFixed64());\n          return arr;\n      }\n      readPackedEnd() {\n          return this.type === PBF_BYTES ? this.readVarint() + this.pos : this.pos + 1;\n      }\n\n      /** @param {number} val */\n      skip(val) {\n          const type = val & 0x7;\n          if (type === PBF_VARINT) while (this.buf[this.pos++] > 0x7f) {}\n          else if (type === PBF_BYTES) this.pos = this.readVarint() + this.pos;\n          else if (type === PBF_FIXED32) this.pos += 4;\n          else if (type === PBF_FIXED64) this.pos += 8;\n          else throw new Error(`Unimplemented type: ${type}`);\n      }\n\n      // === WRITING =================================================================\n\n      /**\n       * @param {number} tag\n       * @param {number} type\n       */\n      writeTag(tag, type) {\n          this.writeVarint((tag << 3) | type);\n      }\n\n      /** @param {number} min */\n      realloc(min) {\n          let length = this.length || 16;\n\n          while (length < this.pos + min) length *= 2;\n\n          if (length !== this.length) {\n              const buf = new Uint8Array(length);\n              buf.set(this.buf);\n              this.buf = buf;\n              this.dataView = new DataView(buf.buffer);\n              this.length = length;\n          }\n      }\n\n      finish() {\n          this.length = this.pos;\n          this.pos = 0;\n          return this.buf.subarray(0, this.length);\n      }\n\n      /** @param {number} val */\n      writeFixed32(val) {\n          this.realloc(4);\n          this.dataView.setInt32(this.pos, val, true);\n          this.pos += 4;\n      }\n\n      /** @param {number} val */\n      writeSFixed32(val) {\n          this.realloc(4);\n          this.dataView.setInt32(this.pos, val, true);\n          this.pos += 4;\n      }\n\n      /** @param {number} val */\n      writeFixed64(val) {\n          this.realloc(8);\n          this.dataView.setInt32(this.pos, val & -1, true);\n          this.dataView.setInt32(this.pos + 4, Math.floor(val * SHIFT_RIGHT_32), true);\n          this.pos += 8;\n      }\n\n      /** @param {number} val */\n      writeSFixed64(val) {\n          this.realloc(8);\n          this.dataView.setInt32(this.pos, val & -1, true);\n          this.dataView.setInt32(this.pos + 4, Math.floor(val * SHIFT_RIGHT_32), true);\n          this.pos += 8;\n      }\n\n      /** @param {number} val */\n      writeVarint(val) {\n          val = +val || 0;\n\n          if (val > 0xfffffff || val < 0) {\n              writeBigVarint(val, this);\n              return;\n          }\n\n          this.realloc(4);\n\n          this.buf[this.pos++] =           val & 0x7f  | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n          this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n          this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n          this.buf[this.pos++] =   (val >>> 7) & 0x7f;\n      }\n\n      /** @param {number} val */\n      writeSVarint(val) {\n          this.writeVarint(val < 0 ? -val * 2 - 1 : val * 2);\n      }\n\n      /** @param {boolean} val */\n      writeBoolean(val) {\n          this.writeVarint(+val);\n      }\n\n      /** @param {string} str */\n      writeString(str) {\n          str = String(str);\n          this.realloc(str.length * 4);\n\n          this.pos++; // reserve 1 byte for short string length\n\n          const startPos = this.pos;\n          // write the string directly to the buffer and see how much was written\n          this.pos = writeUtf8(this.buf, str, this.pos);\n          const len = this.pos - startPos;\n\n          if (len >= 0x80) makeRoomForExtraLength(startPos, len, this);\n\n          // finally, write the message length in the reserved place and restore the position\n          this.pos = startPos - 1;\n          this.writeVarint(len);\n          this.pos += len;\n      }\n\n      /** @param {number} val */\n      writeFloat(val) {\n          this.realloc(4);\n          this.dataView.setFloat32(this.pos, val, true);\n          this.pos += 4;\n      }\n\n      /** @param {number} val */\n      writeDouble(val) {\n          this.realloc(8);\n          this.dataView.setFloat64(this.pos, val, true);\n          this.pos += 8;\n      }\n\n      /** @param {Uint8Array} buffer */\n      writeBytes(buffer) {\n          const len = buffer.length;\n          this.writeVarint(len);\n          this.realloc(len);\n          for (let i = 0; i < len; i++) this.buf[this.pos++] = buffer[i];\n      }\n\n      /**\n       * @template T\n       * @param {(obj: T, pbf: Pbf) => void} fn\n       * @param {T} obj\n       */\n      writeRawMessage(fn, obj) {\n          this.pos++; // reserve 1 byte for short message length\n\n          // write the message directly to the buffer and see how much was written\n          const startPos = this.pos;\n          fn(obj, this);\n          const len = this.pos - startPos;\n\n          if (len >= 0x80) makeRoomForExtraLength(startPos, len, this);\n\n          // finally, write the message length in the reserved place and restore the position\n          this.pos = startPos - 1;\n          this.writeVarint(len);\n          this.pos += len;\n      }\n\n      /**\n       * @template T\n       * @param {number} tag\n       * @param {(obj: T, pbf: Pbf) => void} fn\n       * @param {T} obj\n       */\n      writeMessage(tag, fn, obj) {\n          this.writeTag(tag, PBF_BYTES);\n          this.writeRawMessage(fn, obj);\n      }\n\n      /**\n       * @param {number} tag\n       * @param {number[]} arr\n       */\n      writePackedVarint(tag, arr) {\n          if (arr.length) this.writeMessage(tag, writePackedVarint, arr);\n      }\n      /**\n       * @param {number} tag\n       * @param {number[]} arr\n       */\n      writePackedSVarint(tag, arr) {\n          if (arr.length) this.writeMessage(tag, writePackedSVarint, arr);\n      }\n      /**\n       * @param {number} tag\n       * @param {boolean[]} arr\n       */\n      writePackedBoolean(tag, arr) {\n          if (arr.length) this.writeMessage(tag, writePackedBoolean, arr);\n      }\n      /**\n       * @param {number} tag\n       * @param {number[]} arr\n       */\n      writePackedFloat(tag, arr) {\n          if (arr.length) this.writeMessage(tag, writePackedFloat, arr);\n      }\n      /**\n       * @param {number} tag\n       * @param {number[]} arr\n       */\n      writePackedDouble(tag, arr) {\n          if (arr.length) this.writeMessage(tag, writePackedDouble, arr);\n      }\n      /**\n       * @param {number} tag\n       * @param {number[]} arr\n       */\n      writePackedFixed32(tag, arr) {\n          if (arr.length) this.writeMessage(tag, writePackedFixed32, arr);\n      }\n      /**\n       * @param {number} tag\n       * @param {number[]} arr\n       */\n      writePackedSFixed32(tag, arr) {\n          if (arr.length) this.writeMessage(tag, writePackedSFixed32, arr);\n      }\n      /**\n       * @param {number} tag\n       * @param {number[]} arr\n       */\n      writePackedFixed64(tag, arr) {\n          if (arr.length) this.writeMessage(tag, writePackedFixed64, arr);\n      }\n      /**\n       * @param {number} tag\n       * @param {number[]} arr\n       */\n      writePackedSFixed64(tag, arr) {\n          if (arr.length) this.writeMessage(tag, writePackedSFixed64, arr);\n      }\n\n      /**\n       * @param {number} tag\n       * @param {Uint8Array} buffer\n       */\n      writeBytesField(tag, buffer) {\n          this.writeTag(tag, PBF_BYTES);\n          this.writeBytes(buffer);\n      }\n      /**\n       * @param {number} tag\n       * @param {number} val\n       */\n      writeFixed32Field(tag, val) {\n          this.writeTag(tag, PBF_FIXED32);\n          this.writeFixed32(val);\n      }\n      /**\n       * @param {number} tag\n       * @param {number} val\n       */\n      writeSFixed32Field(tag, val) {\n          this.writeTag(tag, PBF_FIXED32);\n          this.writeSFixed32(val);\n      }\n      /**\n       * @param {number} tag\n       * @param {number} val\n       */\n      writeFixed64Field(tag, val) {\n          this.writeTag(tag, PBF_FIXED64);\n          this.writeFixed64(val);\n      }\n      /**\n       * @param {number} tag\n       * @param {number} val\n       */\n      writeSFixed64Field(tag, val) {\n          this.writeTag(tag, PBF_FIXED64);\n          this.writeSFixed64(val);\n      }\n      /**\n       * @param {number} tag\n       * @param {number} val\n       */\n      writeVarintField(tag, val) {\n          this.writeTag(tag, PBF_VARINT);\n          this.writeVarint(val);\n      }\n      /**\n       * @param {number} tag\n       * @param {number} val\n       */\n      writeSVarintField(tag, val) {\n          this.writeTag(tag, PBF_VARINT);\n          this.writeSVarint(val);\n      }\n      /**\n       * @param {number} tag\n       * @param {string} str\n       */\n      writeStringField(tag, str) {\n          this.writeTag(tag, PBF_BYTES);\n          this.writeString(str);\n      }\n      /**\n       * @param {number} tag\n       * @param {number} val\n       */\n      writeFloatField(tag, val) {\n          this.writeTag(tag, PBF_FIXED32);\n          this.writeFloat(val);\n      }\n      /**\n       * @param {number} tag\n       * @param {number} val\n       */\n      writeDoubleField(tag, val) {\n          this.writeTag(tag, PBF_FIXED64);\n          this.writeDouble(val);\n      }\n      /**\n       * @param {number} tag\n       * @param {boolean} val\n       */\n      writeBooleanField(tag, val) {\n          this.writeVarintField(tag, +val);\n      }\n  }\n  /**\n   * @param {number} l\n   * @param {boolean | undefined} s\n   * @param {Pbf} p\n   */\n  function readVarintRemainder$1(l, s, p) {\n      const buf = p.buf;\n      let h, b;\n\n      b = buf[p.pos++]; h  = (b & 0x70) >> 4;  if (b < 0x80) return toNum$1(l, h, s);\n      b = buf[p.pos++]; h |= (b & 0x7f) << 3;  if (b < 0x80) return toNum$1(l, h, s);\n      b = buf[p.pos++]; h |= (b & 0x7f) << 10; if (b < 0x80) return toNum$1(l, h, s);\n      b = buf[p.pos++]; h |= (b & 0x7f) << 17; if (b < 0x80) return toNum$1(l, h, s);\n      b = buf[p.pos++]; h |= (b & 0x7f) << 24; if (b < 0x80) return toNum$1(l, h, s);\n      b = buf[p.pos++]; h |= (b & 0x01) << 31; if (b < 0x80) return toNum$1(l, h, s);\n\n      throw new Error('Expected varint not more than 10 bytes');\n  }\n\n  /**\n   * @param {number} low\n   * @param {number} high\n   * @param {boolean} [isSigned]\n   */\n  function toNum$1(low, high, isSigned) {\n      return isSigned ? high * 0x100000000 + (low >>> 0) : ((high >>> 0) * 0x100000000) + (low >>> 0);\n  }\n\n  /**\n   * @param {number} val\n   * @param {Pbf} pbf\n   */\n  function writeBigVarint(val, pbf) {\n      let low, high;\n\n      if (val >= 0) {\n          low  = (val % 0x100000000) | 0;\n          high = (val / 0x100000000) | 0;\n      } else {\n          low  = ~(-val % 0x100000000);\n          high = ~(-val / 0x100000000);\n\n          if (low ^ 0xffffffff) {\n              low = (low + 1) | 0;\n          } else {\n              low = 0;\n              high = (high + 1) | 0;\n          }\n      }\n\n      if (val >= 0x10000000000000000 || val < -0x10000000000000000) {\n          throw new Error('Given varint doesn\\'t fit into 10 bytes');\n      }\n\n      pbf.realloc(10);\n\n      writeBigVarintLow(low, high, pbf);\n      writeBigVarintHigh(high, pbf);\n  }\n\n  /**\n   * @param {number} high\n   * @param {number} low\n   * @param {Pbf} pbf\n   */\n  function writeBigVarintLow(low, high, pbf) {\n      pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n      pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n      pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n      pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n      pbf.buf[pbf.pos]   = low & 0x7f;\n  }\n\n  /**\n   * @param {number} high\n   * @param {Pbf} pbf\n   */\n  function writeBigVarintHigh(high, pbf) {\n      const lsb = (high & 0x07) << 4;\n\n      pbf.buf[pbf.pos++] |= lsb         | ((high >>>= 3) ? 0x80 : 0); if (!high) return;\n      pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n      pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n      pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n      pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n      pbf.buf[pbf.pos++]  = high & 0x7f;\n  }\n\n  /**\n   * @param {number} startPos\n   * @param {number} len\n   * @param {Pbf} pbf\n   */\n  function makeRoomForExtraLength(startPos, len, pbf) {\n      const extraLen =\n          len <= 0x3fff ? 1 :\n          len <= 0x1fffff ? 2 :\n          len <= 0xfffffff ? 3 : Math.floor(Math.log(len) / (Math.LN2 * 7));\n\n      // if 1 byte isn't enough for encoding message length, shift the data to the right\n      pbf.realloc(extraLen);\n      for (let i = pbf.pos - 1; i >= startPos; i--) pbf.buf[i + extraLen] = pbf.buf[i];\n  }\n\n  /**\n   * @param {number[]} arr\n   * @param {Pbf} pbf\n   */\n  function writePackedVarint(arr, pbf) {\n      for (let i = 0; i < arr.length; i++) pbf.writeVarint(arr[i]);\n  }\n  /**\n   * @param {number[]} arr\n   * @param {Pbf} pbf\n   */\n  function writePackedSVarint(arr, pbf) {\n      for (let i = 0; i < arr.length; i++) pbf.writeSVarint(arr[i]);\n  }\n  /**\n   * @param {number[]} arr\n   * @param {Pbf} pbf\n   */\n  function writePackedFloat(arr, pbf) {\n      for (let i = 0; i < arr.length; i++) pbf.writeFloat(arr[i]);\n  }\n  /**\n   * @param {number[]} arr\n   * @param {Pbf} pbf\n   */\n  function writePackedDouble(arr, pbf) {\n      for (let i = 0; i < arr.length; i++) pbf.writeDouble(arr[i]);\n  }\n  /**\n   * @param {boolean[]} arr\n   * @param {Pbf} pbf\n   */\n  function writePackedBoolean(arr, pbf) {\n      for (let i = 0; i < arr.length; i++) pbf.writeBoolean(arr[i]);\n  }\n  /**\n   * @param {number[]} arr\n   * @param {Pbf} pbf\n   */\n  function writePackedFixed32(arr, pbf) {\n      for (let i = 0; i < arr.length; i++) pbf.writeFixed32(arr[i]);\n  }\n  /**\n   * @param {number[]} arr\n   * @param {Pbf} pbf\n   */\n  function writePackedSFixed32(arr, pbf) {\n      for (let i = 0; i < arr.length; i++) pbf.writeSFixed32(arr[i]);\n  }\n  /**\n   * @param {number[]} arr\n   * @param {Pbf} pbf\n   */\n  function writePackedFixed64(arr, pbf) {\n      for (let i = 0; i < arr.length; i++) pbf.writeFixed64(arr[i]);\n  }\n  /**\n   * @param {number[]} arr\n   * @param {Pbf} pbf\n   */\n  function writePackedSFixed64(arr, pbf) {\n      for (let i = 0; i < arr.length; i++) pbf.writeSFixed64(arr[i]);\n  }\n\n  // Buffer code below from https://github.com/feross/buffer, MIT-licensed\n\n  /**\n   * @param {Uint8Array} buf\n   * @param {number} pos\n   * @param {number} end\n   */\n  function readUtf8(buf, pos, end) {\n      let str = '';\n      let i = pos;\n\n      while (i < end) {\n          const b0 = buf[i];\n          let c = null; // codepoint\n          let bytesPerSequence =\n              b0 > 0xEF ? 4 :\n              b0 > 0xDF ? 3 :\n              b0 > 0xBF ? 2 : 1;\n\n          if (i + bytesPerSequence > end) break;\n\n          let b1, b2, b3;\n\n          if (bytesPerSequence === 1) {\n              if (b0 < 0x80) {\n                  c = b0;\n              }\n          } else if (bytesPerSequence === 2) {\n              b1 = buf[i + 1];\n              if ((b1 & 0xC0) === 0x80) {\n                  c = (b0 & 0x1F) << 0x6 | (b1 & 0x3F);\n                  if (c <= 0x7F) {\n                      c = null;\n                  }\n              }\n          } else if (bytesPerSequence === 3) {\n              b1 = buf[i + 1];\n              b2 = buf[i + 2];\n              if ((b1 & 0xC0) === 0x80 && (b2 & 0xC0) === 0x80) {\n                  c = (b0 & 0xF) << 0xC | (b1 & 0x3F) << 0x6 | (b2 & 0x3F);\n                  if (c <= 0x7FF || (c >= 0xD800 && c <= 0xDFFF)) {\n                      c = null;\n                  }\n              }\n          } else if (bytesPerSequence === 4) {\n              b1 = buf[i + 1];\n              b2 = buf[i + 2];\n              b3 = buf[i + 3];\n              if ((b1 & 0xC0) === 0x80 && (b2 & 0xC0) === 0x80 && (b3 & 0xC0) === 0x80) {\n                  c = (b0 & 0xF) << 0x12 | (b1 & 0x3F) << 0xC | (b2 & 0x3F) << 0x6 | (b3 & 0x3F);\n                  if (c <= 0xFFFF || c >= 0x110000) {\n                      c = null;\n                  }\n              }\n          }\n\n          if (c === null) {\n              c = 0xFFFD;\n              bytesPerSequence = 1;\n\n          } else if (c > 0xFFFF) {\n              c -= 0x10000;\n              str += String.fromCharCode(c >>> 10 & 0x3FF | 0xD800);\n              c = 0xDC00 | c & 0x3FF;\n          }\n\n          str += String.fromCharCode(c);\n          i += bytesPerSequence;\n      }\n\n      return str;\n  }\n\n  /**\n   * @param {Uint8Array} buf\n   * @param {string} str\n   * @param {number} pos\n   */\n  function writeUtf8(buf, str, pos) {\n      for (let i = 0, c, lead; i < str.length; i++) {\n          c = str.charCodeAt(i); // code point\n\n          if (c > 0xD7FF && c < 0xE000) {\n              if (lead) {\n                  if (c < 0xDC00) {\n                      buf[pos++] = 0xEF;\n                      buf[pos++] = 0xBF;\n                      buf[pos++] = 0xBD;\n                      lead = c;\n                      continue;\n                  } else {\n                      c = lead - 0xD800 << 10 | c - 0xDC00 | 0x10000;\n                      lead = null;\n                  }\n              } else {\n                  if (c > 0xDBFF || (i + 1 === str.length)) {\n                      buf[pos++] = 0xEF;\n                      buf[pos++] = 0xBF;\n                      buf[pos++] = 0xBD;\n                  } else {\n                      lead = c;\n                  }\n                  continue;\n              }\n          } else if (lead) {\n              buf[pos++] = 0xEF;\n              buf[pos++] = 0xBF;\n              buf[pos++] = 0xBD;\n              lead = null;\n          }\n\n          if (c < 0x80) {\n              buf[pos++] = c;\n          } else {\n              if (c < 0x800) {\n                  buf[pos++] = c >> 0x6 | 0xC0;\n              } else {\n                  if (c < 0x10000) {\n                      buf[pos++] = c >> 0xC | 0xE0;\n                  } else {\n                      buf[pos++] = c >> 0x12 | 0xF0;\n                      buf[pos++] = c >> 0xC & 0x3F | 0x80;\n                  }\n                  buf[pos++] = c >> 0x6 & 0x3F | 0x80;\n              }\n              buf[pos++] = c & 0x3F | 0x80;\n          }\n      }\n      return pos;\n  }\n\n  var __pow$1 = Math.pow;\n  var __async$1 = (__this, __arguments, generator) => {\n    return new Promise((resolve, reject) => {\n      var fulfilled = (value) => {\n        try {\n          step(generator.next(value));\n        } catch (e) {\n          reject(e);\n        }\n      };\n      var rejected = (value) => {\n        try {\n          step(generator.throw(value));\n        } catch (e) {\n          reject(e);\n        }\n      };\n      var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n      step((generator = generator.apply(__this, __arguments)).next());\n    });\n  };\n\n  // node_modules/fflate/esm/browser.js\n  var u8 = Uint8Array;\n  var u16 = Uint16Array;\n  var i32 = Int32Array;\n  var fleb = new u8([\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    1,\n    1,\n    1,\n    1,\n    2,\n    2,\n    2,\n    2,\n    3,\n    3,\n    3,\n    3,\n    4,\n    4,\n    4,\n    4,\n    5,\n    5,\n    5,\n    5,\n    0,\n    /* unused */\n    0,\n    0,\n    /* impossible */\n    0\n  ]);\n  var fdeb = new u8([\n    0,\n    0,\n    0,\n    0,\n    1,\n    1,\n    2,\n    2,\n    3,\n    3,\n    4,\n    4,\n    5,\n    5,\n    6,\n    6,\n    7,\n    7,\n    8,\n    8,\n    9,\n    9,\n    10,\n    10,\n    11,\n    11,\n    12,\n    12,\n    13,\n    13,\n    /* unused */\n    0,\n    0\n  ]);\n  var clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n  var freb = function(eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n      b[i] = start += 1 << eb[i - 1];\n    }\n    var r = new i32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n      for (var j = b[i]; j < b[i + 1]; ++j) {\n        r[j] = j - b[i] << 5 | i;\n      }\n    }\n    return { b, r };\n  };\n  var _a = freb(fleb, 2);\n  var fl = _a.b;\n  var revfl = _a.r;\n  fl[28] = 258, revfl[258] = 28;\n  var _b = freb(fdeb, 0);\n  var fd = _b.b;\n  var rev = new u16(32768);\n  for (i = 0; i < 32768; ++i) {\n    x = (i & 43690) >> 1 | (i & 21845) << 1;\n    x = (x & 52428) >> 2 | (x & 13107) << 2;\n    x = (x & 61680) >> 4 | (x & 3855) << 4;\n    rev[i] = ((x & 65280) >> 8 | (x & 255) << 8) >> 1;\n  }\n  var x;\n  var i;\n  var hMap = function(cd, mb, r) {\n    var s = cd.length;\n    var i = 0;\n    var l = new u16(mb);\n    for (; i < s; ++i) {\n      if (cd[i])\n        ++l[cd[i] - 1];\n    }\n    var le = new u16(mb);\n    for (i = 1; i < mb; ++i) {\n      le[i] = le[i - 1] + l[i - 1] << 1;\n    }\n    var co;\n    if (r) {\n      co = new u16(1 << mb);\n      var rvb = 15 - mb;\n      for (i = 0; i < s; ++i) {\n        if (cd[i]) {\n          var sv = i << 4 | cd[i];\n          var r_1 = mb - cd[i];\n          var v = le[cd[i] - 1]++ << r_1;\n          for (var m = v | (1 << r_1) - 1; v <= m; ++v) {\n            co[rev[v] >> rvb] = sv;\n          }\n        }\n      }\n    } else {\n      co = new u16(s);\n      for (i = 0; i < s; ++i) {\n        if (cd[i]) {\n          co[i] = rev[le[cd[i] - 1]++] >> 15 - cd[i];\n        }\n      }\n    }\n    return co;\n  };\n  var flt = new u8(288);\n  for (i = 0; i < 144; ++i)\n    flt[i] = 8;\n  var i;\n  for (i = 144; i < 256; ++i)\n    flt[i] = 9;\n  var i;\n  for (i = 256; i < 280; ++i)\n    flt[i] = 7;\n  var i;\n  for (i = 280; i < 288; ++i)\n    flt[i] = 8;\n  var i;\n  var fdt = new u8(32);\n  for (i = 0; i < 32; ++i)\n    fdt[i] = 5;\n  var i;\n  var flrm = /* @__PURE__ */ hMap(flt, 9, 1);\n  var fdrm = /* @__PURE__ */ hMap(fdt, 5, 1);\n  var max = function(a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n      if (a[i] > m)\n        m = a[i];\n    }\n    return m;\n  };\n  var bits = function(d, p, m) {\n    var o = p / 8 | 0;\n    return (d[o] | d[o + 1] << 8) >> (p & 7) & m;\n  };\n  var bits16 = function(d, p) {\n    var o = p / 8 | 0;\n    return (d[o] | d[o + 1] << 8 | d[o + 2] << 16) >> (p & 7);\n  };\n  var shft = function(p) {\n    return (p + 7) / 8 | 0;\n  };\n  var slc = function(v, s, e) {\n    if (s == null || s < 0)\n      s = 0;\n    if (e == null || e > v.length)\n      e = v.length;\n    var n = new u8(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n  };\n  var ec = [\n    \"unexpected EOF\",\n    \"invalid block type\",\n    \"invalid length/literal\",\n    \"invalid distance\",\n    \"stream finished\",\n    \"no stream handler\",\n    ,\n    \"no callback\",\n    \"invalid UTF-8 data\",\n    \"extra field too long\",\n    \"date not in range 1980-2099\",\n    \"filename too long\",\n    \"stream finishing\",\n    \"invalid zip data\"\n    // determined by unknown compression method\n  ];\n  var err = function(ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n      Error.captureStackTrace(e, err);\n    if (!nt)\n      throw e;\n    return e;\n  };\n  var inflt = function(dat, st, buf, dict) {\n    var sl = dat.length, dl = dict ? dict.length : 0;\n    if (!sl || st.f && !st.l)\n      return buf || new u8(0);\n    var noBuf = !buf || st.i != 2;\n    var noSt = st.i;\n    if (!buf)\n      buf = new u8(sl * 3);\n    var cbuf = function(l2) {\n      var bl = buf.length;\n      if (l2 > bl) {\n        var nbuf = new u8(Math.max(bl * 2, l2));\n        nbuf.set(buf);\n        buf = nbuf;\n      }\n    };\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    var tbts = sl * 8;\n    do {\n      if (!lm) {\n        final = bits(dat, pos, 1);\n        var type = bits(dat, pos + 1, 3);\n        pos += 3;\n        if (!type) {\n          var s = shft(pos) + 4, l = dat[s - 4] | dat[s - 3] << 8, t = s + l;\n          if (t > sl) {\n            if (noSt)\n              err(0);\n            break;\n          }\n          if (noBuf)\n            cbuf(bt + l);\n          buf.set(dat.subarray(s, t), bt);\n          st.b = bt += l, st.p = pos = t * 8, st.f = final;\n          continue;\n        } else if (type == 1)\n          lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n        else if (type == 2) {\n          var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n          var tl = hLit + bits(dat, pos + 5, 31) + 1;\n          pos += 14;\n          var ldt = new u8(tl);\n          var clt = new u8(19);\n          for (var i = 0; i < hcLen; ++i) {\n            clt[clim[i]] = bits(dat, pos + i * 3, 7);\n          }\n          pos += hcLen * 3;\n          var clb = max(clt), clbmsk = (1 << clb) - 1;\n          var clm = hMap(clt, clb, 1);\n          for (var i = 0; i < tl; ) {\n            var r = clm[bits(dat, pos, clbmsk)];\n            pos += r & 15;\n            var s = r >> 4;\n            if (s < 16) {\n              ldt[i++] = s;\n            } else {\n              var c = 0, n = 0;\n              if (s == 16)\n                n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n              else if (s == 17)\n                n = 3 + bits(dat, pos, 7), pos += 3;\n              else if (s == 18)\n                n = 11 + bits(dat, pos, 127), pos += 7;\n              while (n--)\n                ldt[i++] = c;\n            }\n          }\n          var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n          lbt = max(lt);\n          dbt = max(dt);\n          lm = hMap(lt, lbt, 1);\n          dm = hMap(dt, dbt, 1);\n        } else\n          err(1);\n        if (pos > tbts) {\n          if (noSt)\n            err(0);\n          break;\n        }\n      }\n      if (noBuf)\n        cbuf(bt + 131072);\n      var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n      var lpos = pos;\n      for (; ; lpos = pos) {\n        var c = lm[bits16(dat, pos) & lms], sym = c >> 4;\n        pos += c & 15;\n        if (pos > tbts) {\n          if (noSt)\n            err(0);\n          break;\n        }\n        if (!c)\n          err(2);\n        if (sym < 256)\n          buf[bt++] = sym;\n        else if (sym == 256) {\n          lpos = pos, lm = null;\n          break;\n        } else {\n          var add = sym - 254;\n          if (sym > 264) {\n            var i = sym - 257, b = fleb[i];\n            add = bits(dat, pos, (1 << b) - 1) + fl[i];\n            pos += b;\n          }\n          var d = dm[bits16(dat, pos) & dms], dsym = d >> 4;\n          if (!d)\n            err(3);\n          pos += d & 15;\n          var dt = fd[dsym];\n          if (dsym > 3) {\n            var b = fdeb[dsym];\n            dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n          }\n          if (pos > tbts) {\n            if (noSt)\n              err(0);\n            break;\n          }\n          if (noBuf)\n            cbuf(bt + 131072);\n          var end = bt + add;\n          if (bt < dt) {\n            var shift2 = dl - dt, dend = Math.min(dt, end);\n            if (shift2 + bt < 0)\n              err(3);\n            for (; bt < dend; ++bt)\n              buf[bt] = dict[shift2 + bt];\n          }\n          for (; bt < end; bt += 4) {\n            buf[bt] = buf[bt - dt];\n            buf[bt + 1] = buf[bt + 1 - dt];\n            buf[bt + 2] = buf[bt + 2 - dt];\n            buf[bt + 3] = buf[bt + 3 - dt];\n          }\n          bt = end;\n        }\n      }\n      st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n      if (lm)\n        final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n  };\n  var et = /* @__PURE__ */ new u8(0);\n  var gzs = function(d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n      err(6, \"invalid gzip data\");\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n      st += (d[10] | d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n      ;\n    return st + (flg & 2);\n  };\n  var gzl = function(d) {\n    var l = d.length;\n    return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16 | d[l - 1] << 24) >>> 0;\n  };\n  var zls = function(d, dict) {\n    if ((d[0] & 15) != 8 || d[0] >> 4 > 7 || (d[0] << 8 | d[1]) % 31)\n      err(6, \"invalid zlib data\");\n    if ((d[1] >> 5 & 1) == +!dict)\n      err(6, \"invalid zlib data: \" + (d[1] & 32 ? \"need\" : \"unexpected\") + \" dictionary\");\n    return (d[1] >> 3 & 4) + 2;\n  };\n  function inflateSync(data, opts) {\n    return inflt(data, { i: 2 }, opts && opts.out, opts && opts.dictionary);\n  }\n  function gunzipSync(data, opts) {\n    var st = gzs(data);\n    if (st + 8 > data.length)\n      err(6, \"invalid gzip data\");\n    return inflt(data.subarray(st, -8), { i: 2 }, opts && opts.out || new u8(gzl(data)), opts && opts.dictionary);\n  }\n  function unzlibSync(data, opts) {\n    return inflt(data.subarray(zls(data, opts && opts.dictionary), -4), { i: 2 }, opts && opts.out, opts && opts.dictionary);\n  }\n  function decompressSync(data, opts) {\n    return data[0] == 31 && data[1] == 139 && data[2] == 8 ? gunzipSync(data, opts) : (data[0] & 15) != 8 || data[0] >> 4 > 7 || (data[0] << 8 | data[1]) % 31 ? inflateSync(data, opts) : unzlibSync(data, opts);\n  }\n  var td = typeof TextDecoder != \"undefined\" && /* @__PURE__ */ new TextDecoder();\n  var tds = 0;\n  try {\n    td.decode(et, { stream: true });\n    tds = 1;\n  } catch (e) {\n  }\n\n  // v2.ts\n  var shift = (n, shift2) => {\n    return n * __pow$1(2, shift2);\n  };\n  var unshift = (n, shift2) => {\n    return Math.floor(n / __pow$1(2, shift2));\n  };\n  var getUint24 = (view, pos) => {\n    return shift(view.getUint16(pos + 1, true), 8) + view.getUint8(pos);\n  };\n  var getUint48 = (view, pos) => {\n    return shift(view.getUint32(pos + 2, true), 16) + view.getUint16(pos, true);\n  };\n  var compare = (tz, tx, ty, view, i) => {\n    if (tz !== view.getUint8(i))\n      return tz - view.getUint8(i);\n    const x = getUint24(view, i + 1);\n    if (tx !== x)\n      return tx - x;\n    const y = getUint24(view, i + 4);\n    if (ty !== y)\n      return ty - y;\n    return 0;\n  };\n  var queryLeafdir = (view, z, x, y) => {\n    const offsetLen = queryView(view, z | 128, x, y);\n    if (offsetLen) {\n      return {\n        z,\n        x,\n        y,\n        offset: offsetLen[0],\n        length: offsetLen[1],\n        isDir: true\n      };\n    }\n    return null;\n  };\n  var queryTile = (view, z, x, y) => {\n    const offsetLen = queryView(view, z, x, y);\n    if (offsetLen) {\n      return {\n        z,\n        x,\n        y,\n        offset: offsetLen[0],\n        length: offsetLen[1],\n        isDir: false\n      };\n    }\n    return null;\n  };\n  var queryView = (view, z, x, y) => {\n    let m = 0;\n    let n = view.byteLength / 17 - 1;\n    while (m <= n) {\n      const k = n + m >> 1;\n      const cmp = compare(z, x, y, view, k * 17);\n      if (cmp > 0) {\n        m = k + 1;\n      } else if (cmp < 0) {\n        n = k - 1;\n      } else {\n        return [getUint48(view, k * 17 + 7), view.getUint32(k * 17 + 13, true)];\n      }\n    }\n    return null;\n  };\n  var entrySort = (a, b) => {\n    if (a.isDir && !b.isDir) {\n      return 1;\n    }\n    if (!a.isDir && b.isDir) {\n      return -1;\n    }\n    if (a.z !== b.z) {\n      return a.z - b.z;\n    }\n    if (a.x !== b.x) {\n      return a.x - b.x;\n    }\n    return a.y - b.y;\n  };\n  var parseEntry = (dataview, i) => {\n    const zRaw = dataview.getUint8(i * 17);\n    const z = zRaw & 127;\n    return {\n      z,\n      x: getUint24(dataview, i * 17 + 1),\n      y: getUint24(dataview, i * 17 + 4),\n      offset: getUint48(dataview, i * 17 + 7),\n      length: dataview.getUint32(i * 17 + 13, true),\n      isDir: zRaw >> 7 === 1\n    };\n  };\n  var sortDir = (a) => {\n    const entries = [];\n    const view = new DataView(a);\n    for (let i = 0; i < view.byteLength / 17; i++) {\n      entries.push(parseEntry(view, i));\n    }\n    return createDirectory(entries);\n  };\n  var createDirectory = (entries) => {\n    entries.sort(entrySort);\n    const buffer = new ArrayBuffer(17 * entries.length);\n    const arr = new Uint8Array(buffer);\n    for (let i = 0; i < entries.length; i++) {\n      const entry = entries[i];\n      let z = entry.z;\n      if (entry.isDir)\n        z = z | 128;\n      arr[i * 17] = z;\n      arr[i * 17 + 1] = entry.x & 255;\n      arr[i * 17 + 2] = entry.x >> 8 & 255;\n      arr[i * 17 + 3] = entry.x >> 16 & 255;\n      arr[i * 17 + 4] = entry.y & 255;\n      arr[i * 17 + 5] = entry.y >> 8 & 255;\n      arr[i * 17 + 6] = entry.y >> 16 & 255;\n      arr[i * 17 + 7] = entry.offset & 255;\n      arr[i * 17 + 8] = unshift(entry.offset, 8) & 255;\n      arr[i * 17 + 9] = unshift(entry.offset, 16) & 255;\n      arr[i * 17 + 10] = unshift(entry.offset, 24) & 255;\n      arr[i * 17 + 11] = unshift(entry.offset, 32) & 255;\n      arr[i * 17 + 12] = unshift(entry.offset, 48) & 255;\n      arr[i * 17 + 13] = entry.length & 255;\n      arr[i * 17 + 14] = entry.length >> 8 & 255;\n      arr[i * 17 + 15] = entry.length >> 16 & 255;\n      arr[i * 17 + 16] = entry.length >> 24 & 255;\n    }\n    return buffer;\n  };\n  var deriveLeaf = (view, tile) => {\n    if (view.byteLength < 17)\n      return null;\n    const numEntries = view.byteLength / 17;\n    const entry = parseEntry(view, numEntries - 1);\n    if (entry.isDir) {\n      const leafLevel = entry.z;\n      const levelDiff = tile.z - leafLevel;\n      const leafX = Math.trunc(tile.x / (1 << levelDiff));\n      const leafY = Math.trunc(tile.y / (1 << levelDiff));\n      return { z: leafLevel, x: leafX, y: leafY };\n    }\n    return null;\n  };\n  function getHeader(source) {\n    return __async$1(this, null, function* () {\n      const resp = yield source.getBytes(0, 512e3);\n      const dataview = new DataView(resp.data);\n      const jsonSize = dataview.getUint32(4, true);\n      const rootEntries = dataview.getUint16(8, true);\n      const dec = new TextDecoder(\"utf-8\");\n      const jsonMetadata = JSON.parse(\n        dec.decode(new DataView(resp.data, 10, jsonSize))\n      );\n      let tileCompression = 0 /* Unknown */;\n      if (jsonMetadata.compression === \"gzip\") {\n        tileCompression = 2 /* Gzip */;\n      }\n      let minzoom = 0;\n      if (\"minzoom\" in jsonMetadata) {\n        minzoom = +jsonMetadata.minzoom;\n      }\n      let maxzoom = 0;\n      if (\"maxzoom\" in jsonMetadata) {\n        maxzoom = +jsonMetadata.maxzoom;\n      }\n      let centerLon = 0;\n      let centerLat = 0;\n      let centerZoom = 0;\n      let minLon = -180;\n      let minLat = -85;\n      let maxLon = 180;\n      let maxLat = 85;\n      if (jsonMetadata.bounds) {\n        const split = jsonMetadata.bounds.split(\",\");\n        minLon = +split[0];\n        minLat = +split[1];\n        maxLon = +split[2];\n        maxLat = +split[3];\n      }\n      if (jsonMetadata.center) {\n        const split = jsonMetadata.center.split(\",\");\n        centerLon = +split[0];\n        centerLat = +split[1];\n        centerZoom = +split[2];\n      }\n      const header = {\n        specVersion: dataview.getUint16(2, true),\n        rootDirectoryOffset: 10 + jsonSize,\n        rootDirectoryLength: rootEntries * 17,\n        jsonMetadataOffset: 10,\n        jsonMetadataLength: jsonSize,\n        leafDirectoryOffset: 0,\n        leafDirectoryLength: void 0,\n        tileDataOffset: 0,\n        tileDataLength: void 0,\n        numAddressedTiles: 0,\n        numTileEntries: 0,\n        numTileContents: 0,\n        clustered: false,\n        internalCompression: 1 /* None */,\n        tileCompression,\n        tileType: 1 /* Mvt */,\n        minZoom: minzoom,\n        maxZoom: maxzoom,\n        minLon,\n        minLat,\n        maxLon,\n        maxLat,\n        centerZoom,\n        centerLon,\n        centerLat,\n        etag: resp.etag\n      };\n      return header;\n    });\n  }\n  function getZxy(header, source, cache, z, x, y, signal) {\n    return __async$1(this, null, function* () {\n      let rootDir = yield cache.getArrayBuffer(\n        source,\n        header.rootDirectoryOffset,\n        header.rootDirectoryLength,\n        header\n      );\n      if (header.specVersion === 1) {\n        rootDir = sortDir(rootDir);\n      }\n      const entry = queryTile(new DataView(rootDir), z, x, y);\n      if (entry) {\n        const resp = yield source.getBytes(entry.offset, entry.length, signal);\n        let tileData = resp.data;\n        const view = new DataView(tileData);\n        if (view.getUint8(0) === 31 && view.getUint8(1) === 139) {\n          tileData = decompressSync(new Uint8Array(tileData));\n        }\n        return {\n          data: tileData\n        };\n      }\n      const leafcoords = deriveLeaf(new DataView(rootDir), { z, x, y });\n      if (leafcoords) {\n        const leafdirEntry = queryLeafdir(\n          new DataView(rootDir),\n          leafcoords.z,\n          leafcoords.x,\n          leafcoords.y\n        );\n        if (leafdirEntry) {\n          let leafDir = yield cache.getArrayBuffer(\n            source,\n            leafdirEntry.offset,\n            leafdirEntry.length,\n            header\n          );\n          if (header.specVersion === 1) {\n            leafDir = sortDir(leafDir);\n          }\n          const tileEntry = queryTile(new DataView(leafDir), z, x, y);\n          if (tileEntry) {\n            const resp = yield source.getBytes(\n              tileEntry.offset,\n              tileEntry.length,\n              signal\n            );\n            let tileData = resp.data;\n            const view = new DataView(tileData);\n            if (view.getUint8(0) === 31 && view.getUint8(1) === 139) {\n              tileData = decompressSync(new Uint8Array(tileData));\n            }\n            return {\n              data: tileData\n            };\n          }\n        }\n      }\n      return void 0;\n    });\n  }\n  var v2_default = {\n    getHeader,\n    getZxy\n  };\n\n  // index.ts\n  function toNum(low, high) {\n    return (high >>> 0) * 4294967296 + (low >>> 0);\n  }\n  function readVarintRemainder(l, p) {\n    const buf = p.buf;\n    let b = buf[p.pos++];\n    let h = (b & 112) >> 4;\n    if (b < 128)\n      return toNum(l, h);\n    b = buf[p.pos++];\n    h |= (b & 127) << 3;\n    if (b < 128)\n      return toNum(l, h);\n    b = buf[p.pos++];\n    h |= (b & 127) << 10;\n    if (b < 128)\n      return toNum(l, h);\n    b = buf[p.pos++];\n    h |= (b & 127) << 17;\n    if (b < 128)\n      return toNum(l, h);\n    b = buf[p.pos++];\n    h |= (b & 127) << 24;\n    if (b < 128)\n      return toNum(l, h);\n    b = buf[p.pos++];\n    h |= (b & 1) << 31;\n    if (b < 128)\n      return toNum(l, h);\n    throw new Error(\"Expected varint not more than 10 bytes\");\n  }\n  function readVarint(p) {\n    const buf = p.buf;\n    let b = buf[p.pos++];\n    let val = b & 127;\n    if (b < 128)\n      return val;\n    b = buf[p.pos++];\n    val |= (b & 127) << 7;\n    if (b < 128)\n      return val;\n    b = buf[p.pos++];\n    val |= (b & 127) << 14;\n    if (b < 128)\n      return val;\n    b = buf[p.pos++];\n    val |= (b & 127) << 21;\n    if (b < 128)\n      return val;\n    b = buf[p.pos];\n    val |= (b & 15) << 28;\n    return readVarintRemainder(val, p);\n  }\n  function rotate(n, xy, rx, ry) {\n    if (ry === 0) {\n      if (rx === 1) {\n        xy[0] = n - 1 - xy[0];\n        xy[1] = n - 1 - xy[1];\n      }\n      const t = xy[0];\n      xy[0] = xy[1];\n      xy[1] = t;\n    }\n  }\n  var tzValues = [\n    0,\n    1,\n    5,\n    21,\n    85,\n    341,\n    1365,\n    5461,\n    21845,\n    87381,\n    349525,\n    1398101,\n    5592405,\n    22369621,\n    89478485,\n    357913941,\n    1431655765,\n    5726623061,\n    22906492245,\n    91625968981,\n    366503875925,\n    1466015503701,\n    5864062014805,\n    23456248059221,\n    93824992236885,\n    375299968947541,\n    1501199875790165\n  ];\n  function zxyToTileId(z, x, y) {\n    if (z > 26) {\n      throw Error(\"Tile zoom level exceeds max safe number limit (26)\");\n    }\n    if (x > __pow$1(2, z) - 1 || y > __pow$1(2, z) - 1) {\n      throw Error(\"tile x/y outside zoom level bounds\");\n    }\n    const acc = tzValues[z];\n    const n = __pow$1(2, z);\n    let rx = 0;\n    let ry = 0;\n    let d = 0;\n    const xy = [x, y];\n    let s = n / 2;\n    while (s > 0) {\n      rx = (xy[0] & s) > 0 ? 1 : 0;\n      ry = (xy[1] & s) > 0 ? 1 : 0;\n      d += s * s * (3 * rx ^ ry);\n      rotate(s, xy, rx, ry);\n      s = s / 2;\n    }\n    return acc + d;\n  }\n  function defaultDecompress(buf, compression) {\n    return __async$1(this, null, function* () {\n      if (compression === 1 /* None */ || compression === 0 /* Unknown */) {\n        return buf;\n      }\n      if (compression === 2 /* Gzip */) {\n        if (typeof globalThis.DecompressionStream === \"undefined\") {\n          return decompressSync(new Uint8Array(buf));\n        }\n        const stream = new Response(buf).body;\n        if (!stream) {\n          throw Error(\"Failed to read response stream\");\n        }\n        const result = stream.pipeThrough(\n          // biome-ignore lint: needed to detect DecompressionStream in browser+node+cloudflare workers\n          new globalThis.DecompressionStream(\"gzip\")\n        );\n        return new Response(result).arrayBuffer();\n      }\n      throw Error(\"Compression method not supported\");\n    });\n  }\n  var HEADER_SIZE_BYTES = 127;\n  function findTile(entries, tileId) {\n    let m = 0;\n    let n = entries.length - 1;\n    while (m <= n) {\n      const k = n + m >> 1;\n      const cmp = tileId - entries[k].tileId;\n      if (cmp > 0) {\n        m = k + 1;\n      } else if (cmp < 0) {\n        n = k - 1;\n      } else {\n        return entries[k];\n      }\n    }\n    if (n >= 0) {\n      if (entries[n].runLength === 0) {\n        return entries[n];\n      }\n      if (tileId - entries[n].tileId < entries[n].runLength) {\n        return entries[n];\n      }\n    }\n    return null;\n  }\n  var FetchSource = class {\n    constructor(url, customHeaders = new Headers()) {\n      this.url = url;\n      this.customHeaders = customHeaders;\n      this.mustReload = false;\n    }\n    getKey() {\n      return this.url;\n    }\n    setHeaders(customHeaders) {\n      this.customHeaders = customHeaders;\n    }\n    getBytes(offset, length, passedSignal, etag) {\n      return __async$1(this, null, function* () {\n        let controller;\n        let signal;\n        if (passedSignal) {\n          signal = passedSignal;\n        } else {\n          controller = new AbortController();\n          signal = controller.signal;\n        }\n        const requestHeaders = new Headers(this.customHeaders);\n        requestHeaders.set(\"range\", `bytes=${offset}-${offset + length - 1}`);\n        let cache;\n        if (this.mustReload) {\n          cache = \"reload\";\n        }\n        let resp = yield fetch(this.url, {\n          signal,\n          cache,\n          headers: requestHeaders\n          //biome-ignore lint: \"cache\" is incompatible between cloudflare workers and browser\n        });\n        if (offset === 0 && resp.status === 416) {\n          const contentRange = resp.headers.get(\"Content-Range\");\n          if (!contentRange || !contentRange.startsWith(\"bytes */\")) {\n            throw Error(\"Missing content-length on 416 response\");\n          }\n          const actualLength = +contentRange.substr(8);\n          resp = yield fetch(this.url, {\n            signal,\n            cache: \"reload\",\n            headers: { range: `bytes=0-${actualLength - 1}` }\n            //biome-ignore lint: \"cache\" is incompatible between cloudflare workers and browser\n          });\n        }\n        let newEtag = resp.headers.get(\"Etag\");\n        if (newEtag == null ? void 0 : newEtag.startsWith(\"W/\")) {\n          newEtag = null;\n        }\n        if (resp.status === 416 || etag && newEtag && newEtag !== etag) {\n          this.mustReload = true;\n          throw new EtagMismatch(\n            `Server returned non-matching ETag ${etag} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`\n          );\n        }\n        if (resp.status >= 300) {\n          throw Error(`Bad response code: ${resp.status}`);\n        }\n        const contentLength = resp.headers.get(\"Content-Length\");\n        if (resp.status === 200 && (!contentLength || +contentLength > length)) {\n          if (controller)\n            controller.abort();\n          throw Error(\n            \"Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.\"\n          );\n        }\n        const a = yield resp.arrayBuffer();\n        return {\n          data: a,\n          etag: newEtag || void 0,\n          cacheControl: resp.headers.get(\"Cache-Control\") || void 0,\n          expires: resp.headers.get(\"Expires\") || void 0\n        };\n      });\n    }\n  };\n  function getUint64(v, offset) {\n    const wh = v.getUint32(offset + 4, true);\n    const wl = v.getUint32(offset + 0, true);\n    return wh * __pow$1(2, 32) + wl;\n  }\n  function bytesToHeader(bytes, etag) {\n    const v = new DataView(bytes);\n    const specVersion = v.getUint8(7);\n    if (specVersion > 3) {\n      throw Error(\n        `Archive is spec version ${specVersion} but this library supports up to spec version 3`\n      );\n    }\n    return {\n      specVersion,\n      rootDirectoryOffset: getUint64(v, 8),\n      rootDirectoryLength: getUint64(v, 16),\n      jsonMetadataOffset: getUint64(v, 24),\n      jsonMetadataLength: getUint64(v, 32),\n      leafDirectoryOffset: getUint64(v, 40),\n      leafDirectoryLength: getUint64(v, 48),\n      tileDataOffset: getUint64(v, 56),\n      tileDataLength: getUint64(v, 64),\n      numAddressedTiles: getUint64(v, 72),\n      numTileEntries: getUint64(v, 80),\n      numTileContents: getUint64(v, 88),\n      clustered: v.getUint8(96) === 1,\n      internalCompression: v.getUint8(97),\n      tileCompression: v.getUint8(98),\n      tileType: v.getUint8(99),\n      minZoom: v.getUint8(100),\n      maxZoom: v.getUint8(101),\n      minLon: v.getInt32(102, true) / 1e7,\n      minLat: v.getInt32(106, true) / 1e7,\n      maxLon: v.getInt32(110, true) / 1e7,\n      maxLat: v.getInt32(114, true) / 1e7,\n      centerZoom: v.getUint8(118),\n      centerLon: v.getInt32(119, true) / 1e7,\n      centerLat: v.getInt32(123, true) / 1e7,\n      etag\n    };\n  }\n  function deserializeIndex(buffer) {\n    const p = { buf: new Uint8Array(buffer), pos: 0 };\n    const numEntries = readVarint(p);\n    const entries = [];\n    let lastId = 0;\n    for (let i = 0; i < numEntries; i++) {\n      const v = readVarint(p);\n      entries.push({ tileId: lastId + v, offset: 0, length: 0, runLength: 1 });\n      lastId += v;\n    }\n    for (let i = 0; i < numEntries; i++) {\n      entries[i].runLength = readVarint(p);\n    }\n    for (let i = 0; i < numEntries; i++) {\n      entries[i].length = readVarint(p);\n    }\n    for (let i = 0; i < numEntries; i++) {\n      const v = readVarint(p);\n      if (v === 0 && i > 0) {\n        entries[i].offset = entries[i - 1].offset + entries[i - 1].length;\n      } else {\n        entries[i].offset = v - 1;\n      }\n    }\n    return entries;\n  }\n  function detectVersion(a) {\n    const v = new DataView(a);\n    if (v.getUint16(2, true) === 2) {\n      console.warn(\n        \"PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade\"\n      );\n      return 2;\n    }\n    if (v.getUint16(2, true) === 1) {\n      console.warn(\n        \"PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade\"\n      );\n      return 1;\n    }\n    return 3;\n  }\n  var EtagMismatch = class extends Error {\n  };\n  function getHeaderAndRoot(source, decompress) {\n    return __async$1(this, null, function* () {\n      const resp = yield source.getBytes(0, 16384);\n      const v = new DataView(resp.data);\n      if (v.getUint16(0, true) !== 19792) {\n        throw new Error(\"Wrong magic number for PMTiles archive\");\n      }\n      if (detectVersion(resp.data) < 3) {\n        return [yield v2_default.getHeader(source)];\n      }\n      const headerData = resp.data.slice(0, HEADER_SIZE_BYTES);\n      const header = bytesToHeader(headerData, resp.etag);\n      const rootDirData = resp.data.slice(\n        header.rootDirectoryOffset,\n        header.rootDirectoryOffset + header.rootDirectoryLength\n      );\n      const dirKey = `${source.getKey()}|${header.etag || \"\"}|${header.rootDirectoryOffset}|${header.rootDirectoryLength}`;\n      const rootDir = deserializeIndex(\n        yield decompress(rootDirData, header.internalCompression)\n      );\n      return [header, [dirKey, rootDir.length, rootDir]];\n    });\n  }\n  function getDirectory(source, decompress, offset, length, header) {\n    return __async$1(this, null, function* () {\n      const resp = yield source.getBytes(offset, length, void 0, header.etag);\n      const data = yield decompress(resp.data, header.internalCompression);\n      const directory = deserializeIndex(data);\n      if (directory.length === 0) {\n        throw new Error(\"Empty directory is invalid\");\n      }\n      return directory;\n    });\n  }\n  var SharedPromiseCache = class {\n    constructor(maxCacheEntries = 100, prefetch = true, decompress = defaultDecompress) {\n      this.cache = /* @__PURE__ */ new Map();\n      this.invalidations = /* @__PURE__ */ new Map();\n      this.maxCacheEntries = maxCacheEntries;\n      this.counter = 1;\n      this.decompress = decompress;\n    }\n    getHeader(source) {\n      return __async$1(this, null, function* () {\n        const cacheKey = source.getKey();\n        const cacheValue = this.cache.get(cacheKey);\n        if (cacheValue) {\n          cacheValue.lastUsed = this.counter++;\n          const data = yield cacheValue.data;\n          return data;\n        }\n        const p = new Promise((resolve, reject) => {\n          getHeaderAndRoot(source, this.decompress).then((res) => {\n            if (res[1]) {\n              this.cache.set(res[1][0], {\n                lastUsed: this.counter++,\n                data: Promise.resolve(res[1][2])\n              });\n            }\n            resolve(res[0]);\n            this.prune();\n          }).catch((e) => {\n            reject(e);\n          });\n        });\n        this.cache.set(cacheKey, { lastUsed: this.counter++, data: p });\n        return p;\n      });\n    }\n    getDirectory(source, offset, length, header) {\n      return __async$1(this, null, function* () {\n        const cacheKey = `${source.getKey()}|${header.etag || \"\"}|${offset}|${length}`;\n        const cacheValue = this.cache.get(cacheKey);\n        if (cacheValue) {\n          cacheValue.lastUsed = this.counter++;\n          const data = yield cacheValue.data;\n          return data;\n        }\n        const p = new Promise((resolve, reject) => {\n          getDirectory(source, this.decompress, offset, length, header).then((directory) => {\n            resolve(directory);\n            this.prune();\n          }).catch((e) => {\n            reject(e);\n          });\n        });\n        this.cache.set(cacheKey, { lastUsed: this.counter++, data: p });\n        return p;\n      });\n    }\n    // for v2 backwards compatibility\n    getArrayBuffer(source, offset, length, header) {\n      return __async$1(this, null, function* () {\n        const cacheKey = `${source.getKey()}|${header.etag || \"\"}|${offset}|${length}`;\n        const cacheValue = this.cache.get(cacheKey);\n        if (cacheValue) {\n          cacheValue.lastUsed = this.counter++;\n          const data = yield cacheValue.data;\n          return data;\n        }\n        const p = new Promise((resolve, reject) => {\n          source.getBytes(offset, length, void 0, header.etag).then((resp) => {\n            resolve(resp.data);\n            if (this.cache.has(cacheKey)) ;\n            this.prune();\n          }).catch((e) => {\n            reject(e);\n          });\n        });\n        this.cache.set(cacheKey, { lastUsed: this.counter++, data: p });\n        return p;\n      });\n    }\n    prune() {\n      if (this.cache.size >= this.maxCacheEntries) {\n        let minUsed = Infinity;\n        let minKey = void 0;\n        this.cache.forEach((cacheValue, key) => {\n          if (cacheValue.lastUsed < minUsed) {\n            minUsed = cacheValue.lastUsed;\n            minKey = key;\n          }\n        });\n        if (minKey) {\n          this.cache.delete(minKey);\n        }\n      }\n    }\n    invalidate(source) {\n      return __async$1(this, null, function* () {\n        const key = source.getKey();\n        if (this.invalidations.get(key)) {\n          return yield this.invalidations.get(key);\n        }\n        this.cache.delete(source.getKey());\n        const p = new Promise((resolve, reject) => {\n          this.getHeader(source).then((h) => {\n            resolve();\n            this.invalidations.delete(key);\n          }).catch((e) => {\n            reject(e);\n          });\n        });\n        this.invalidations.set(key, p);\n      });\n    }\n  };\n  var PMTiles = class {\n    constructor(source, cache, decompress) {\n      if (typeof source === \"string\") {\n        this.source = new FetchSource(source);\n      } else {\n        this.source = source;\n      }\n      if (decompress) {\n        this.decompress = decompress;\n      } else {\n        this.decompress = defaultDecompress;\n      }\n      if (cache) {\n        this.cache = cache;\n      } else {\n        this.cache = new SharedPromiseCache();\n      }\n    }\n    /**\n     * Return the header of the archive,\n     * including information such as tile type, min/max zoom, bounds, and summary statistics.\n     */\n    getHeader() {\n      return __async$1(this, null, function* () {\n        return yield this.cache.getHeader(this.source);\n      });\n    }\n    /** @hidden */\n    getZxyAttempt(z, x, y, signal) {\n      return __async$1(this, null, function* () {\n        const tileId = zxyToTileId(z, x, y);\n        const header = yield this.cache.getHeader(this.source);\n        if (header.specVersion < 3) {\n          return v2_default.getZxy(header, this.source, this.cache, z, x, y, signal);\n        }\n        if (z < header.minZoom || z > header.maxZoom) {\n          return void 0;\n        }\n        let dO = header.rootDirectoryOffset;\n        let dL = header.rootDirectoryLength;\n        for (let depth = 0; depth <= 3; depth++) {\n          const directory = yield this.cache.getDirectory(\n            this.source,\n            dO,\n            dL,\n            header\n          );\n          const entry = findTile(directory, tileId);\n          if (entry) {\n            if (entry.runLength > 0) {\n              const resp = yield this.source.getBytes(\n                header.tileDataOffset + entry.offset,\n                entry.length,\n                signal,\n                header.etag\n              );\n              return {\n                data: yield this.decompress(resp.data, header.tileCompression),\n                cacheControl: resp.cacheControl,\n                expires: resp.expires\n              };\n            }\n            dO = header.leafDirectoryOffset + entry.offset;\n            dL = entry.length;\n          } else {\n            return void 0;\n          }\n        }\n        throw Error(\"Maximum directory depth exceeded\");\n      });\n    }\n    /**\n     * Primary method to get a single tile bytes from an archive.\n     *\n     * Returns undefined if the tile does not exist in the archive.\n     */\n    getZxy(z, x, y, signal) {\n      return __async$1(this, null, function* () {\n        try {\n          return yield this.getZxyAttempt(z, x, y, signal);\n        } catch (e) {\n          if (e instanceof EtagMismatch) {\n            this.cache.invalidate(this.source);\n            return yield this.getZxyAttempt(z, x, y, signal);\n          }\n          throw e;\n        }\n      });\n    }\n    /** @hidden */\n    getMetadataAttempt() {\n      return __async$1(this, null, function* () {\n        const header = yield this.cache.getHeader(this.source);\n        const resp = yield this.source.getBytes(\n          header.jsonMetadataOffset,\n          header.jsonMetadataLength,\n          void 0,\n          header.etag\n        );\n        const decompressed = yield this.decompress(\n          resp.data,\n          header.internalCompression\n        );\n        const dec = new TextDecoder(\"utf-8\");\n        return JSON.parse(dec.decode(decompressed));\n      });\n    }\n    /**\n     * Return the arbitrary JSON metadata of the archive.\n     */\n    getMetadata() {\n      return __async$1(this, null, function* () {\n        try {\n          return yield this.getMetadataAttempt();\n        } catch (e) {\n          if (e instanceof EtagMismatch) {\n            this.cache.invalidate(this.source);\n            return yield this.getMetadataAttempt();\n          }\n          throw e;\n        }\n      });\n    }\n  };\n\n  function quickselect(arr, k, left, right, compare) {\n      quickselectStep(arr, k, left || 0, right || (arr.length - 1), compare || defaultCompare);\n  }\n\n  function quickselectStep(arr, k, left, right, compare) {\n\n      while (right > left) {\n          if (right - left > 600) {\n              var n = right - left + 1;\n              var m = k - left + 1;\n              var z = Math.log(n);\n              var s = 0.5 * Math.exp(2 * z / 3);\n              var sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n              var newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n              var newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n              quickselectStep(arr, k, newLeft, newRight, compare);\n          }\n\n          var t = arr[k];\n          var i = left;\n          var j = right;\n\n          swap(arr, left, k);\n          if (compare(arr[right], t) > 0) swap(arr, left, right);\n\n          while (i < j) {\n              swap(arr, i, j);\n              i++;\n              j--;\n              while (compare(arr[i], t) < 0) i++;\n              while (compare(arr[j], t) > 0) j--;\n          }\n\n          if (compare(arr[left], t) === 0) swap(arr, left, j);\n          else {\n              j++;\n              swap(arr, j, right);\n          }\n\n          if (j <= k) left = j + 1;\n          if (k <= j) right = j - 1;\n      }\n  }\n\n  function swap(arr, i, j) {\n      var tmp = arr[i];\n      arr[i] = arr[j];\n      arr[j] = tmp;\n  }\n\n  function defaultCompare(a, b) {\n      return a < b ? -1 : a > b ? 1 : 0;\n  }\n\n  class RBush {\n      constructor(maxEntries = 9) {\n          // max entries in a node is 9 by default; min node fill is 40% for best performance\n          this._maxEntries = Math.max(4, maxEntries);\n          this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\n          this.clear();\n      }\n\n      all() {\n          return this._all(this.data, []);\n      }\n\n      search(bbox) {\n          let node = this.data;\n          const result = [];\n\n          if (!intersects(bbox, node)) return result;\n\n          const toBBox = this.toBBox;\n          const nodesToSearch = [];\n\n          while (node) {\n              for (let i = 0; i < node.children.length; i++) {\n                  const child = node.children[i];\n                  const childBBox = node.leaf ? toBBox(child) : child;\n\n                  if (intersects(bbox, childBBox)) {\n                      if (node.leaf) result.push(child);\n                      else if (contains(bbox, childBBox)) this._all(child, result);\n                      else nodesToSearch.push(child);\n                  }\n              }\n              node = nodesToSearch.pop();\n          }\n\n          return result;\n      }\n\n      collides(bbox) {\n          let node = this.data;\n\n          if (!intersects(bbox, node)) return false;\n\n          const nodesToSearch = [];\n          while (node) {\n              for (let i = 0; i < node.children.length; i++) {\n                  const child = node.children[i];\n                  const childBBox = node.leaf ? this.toBBox(child) : child;\n\n                  if (intersects(bbox, childBBox)) {\n                      if (node.leaf || contains(bbox, childBBox)) return true;\n                      nodesToSearch.push(child);\n                  }\n              }\n              node = nodesToSearch.pop();\n          }\n\n          return false;\n      }\n\n      load(data) {\n          if (!(data && data.length)) return this;\n\n          if (data.length < this._minEntries) {\n              for (let i = 0; i < data.length; i++) {\n                  this.insert(data[i]);\n              }\n              return this;\n          }\n\n          // recursively build the tree with the given data from scratch using OMT algorithm\n          let node = this._build(data.slice(), 0, data.length - 1, 0);\n\n          if (!this.data.children.length) {\n              // save as is if tree is empty\n              this.data = node;\n\n          } else if (this.data.height === node.height) {\n              // split root if trees have the same height\n              this._splitRoot(this.data, node);\n\n          } else {\n              if (this.data.height < node.height) {\n                  // swap trees if inserted one is bigger\n                  const tmpNode = this.data;\n                  this.data = node;\n                  node = tmpNode;\n              }\n\n              // insert the small tree into the large tree at appropriate level\n              this._insert(node, this.data.height - node.height - 1, true);\n          }\n\n          return this;\n      }\n\n      insert(item) {\n          if (item) this._insert(item, this.data.height - 1);\n          return this;\n      }\n\n      clear() {\n          this.data = createNode([]);\n          return this;\n      }\n\n      remove(item, equalsFn) {\n          if (!item) return this;\n\n          let node = this.data;\n          const bbox = this.toBBox(item);\n          const path = [];\n          const indexes = [];\n          let i, parent, goingUp;\n\n          // depth-first iterative tree traversal\n          while (node || path.length) {\n\n              if (!node) { // go up\n                  node = path.pop();\n                  parent = path[path.length - 1];\n                  i = indexes.pop();\n                  goingUp = true;\n              }\n\n              if (node.leaf) { // check current node\n                  const index = findItem(item, node.children, equalsFn);\n\n                  if (index !== -1) {\n                      // item found, remove the item and condense tree upwards\n                      node.children.splice(index, 1);\n                      path.push(node);\n                      this._condense(path);\n                      return this;\n                  }\n              }\n\n              if (!goingUp && !node.leaf && contains(node, bbox)) { // go down\n                  path.push(node);\n                  indexes.push(i);\n                  i = 0;\n                  parent = node;\n                  node = node.children[0];\n\n              } else if (parent) { // go right\n                  i++;\n                  node = parent.children[i];\n                  goingUp = false;\n\n              } else node = null; // nothing found\n          }\n\n          return this;\n      }\n\n      toBBox(item) { return item; }\n\n      compareMinX(a, b) { return a.minX - b.minX; }\n      compareMinY(a, b) { return a.minY - b.minY; }\n\n      toJSON() { return this.data; }\n\n      fromJSON(data) {\n          this.data = data;\n          return this;\n      }\n\n      _all(node, result) {\n          const nodesToSearch = [];\n          while (node) {\n              if (node.leaf) result.push(...node.children);\n              else nodesToSearch.push(...node.children);\n\n              node = nodesToSearch.pop();\n          }\n          return result;\n      }\n\n      _build(items, left, right, height) {\n\n          const N = right - left + 1;\n          let M = this._maxEntries;\n          let node;\n\n          if (N <= M) {\n              // reached leaf level; return leaf\n              node = createNode(items.slice(left, right + 1));\n              calcBBox(node, this.toBBox);\n              return node;\n          }\n\n          if (!height) {\n              // target height of the bulk-loaded tree\n              height = Math.ceil(Math.log(N) / Math.log(M));\n\n              // target number of root entries to maximize storage utilization\n              M = Math.ceil(N / Math.pow(M, height - 1));\n          }\n\n          node = createNode([]);\n          node.leaf = false;\n          node.height = height;\n\n          // split the items into M mostly square tiles\n\n          const N2 = Math.ceil(N / M);\n          const N1 = N2 * Math.ceil(Math.sqrt(M));\n\n          multiSelect(items, left, right, N1, this.compareMinX);\n\n          for (let i = left; i <= right; i += N1) {\n\n              const right2 = Math.min(i + N1 - 1, right);\n\n              multiSelect(items, i, right2, N2, this.compareMinY);\n\n              for (let j = i; j <= right2; j += N2) {\n\n                  const right3 = Math.min(j + N2 - 1, right2);\n\n                  // pack each entry recursively\n                  node.children.push(this._build(items, j, right3, height - 1));\n              }\n          }\n\n          calcBBox(node, this.toBBox);\n\n          return node;\n      }\n\n      _chooseSubtree(bbox, node, level, path) {\n          while (true) {\n              path.push(node);\n\n              if (node.leaf || path.length - 1 === level) break;\n\n              let minArea = Infinity;\n              let minEnlargement = Infinity;\n              let targetNode;\n\n              for (let i = 0; i < node.children.length; i++) {\n                  const child = node.children[i];\n                  const area = bboxArea(child);\n                  const enlargement = enlargedArea(bbox, child) - area;\n\n                  // choose entry with the least area enlargement\n                  if (enlargement < minEnlargement) {\n                      minEnlargement = enlargement;\n                      minArea = area < minArea ? area : minArea;\n                      targetNode = child;\n\n                  } else if (enlargement === minEnlargement) {\n                      // otherwise choose one with the smallest area\n                      if (area < minArea) {\n                          minArea = area;\n                          targetNode = child;\n                      }\n                  }\n              }\n\n              node = targetNode || node.children[0];\n          }\n\n          return node;\n      }\n\n      _insert(item, level, isNode) {\n          const bbox = isNode ? item : this.toBBox(item);\n          const insertPath = [];\n\n          // find the best node for accommodating the item, saving all nodes along the path too\n          const node = this._chooseSubtree(bbox, this.data, level, insertPath);\n\n          // put the item into the node\n          node.children.push(item);\n          extend(node, bbox);\n\n          // split on node overflow; propagate upwards if necessary\n          while (level >= 0) {\n              if (insertPath[level].children.length > this._maxEntries) {\n                  this._split(insertPath, level);\n                  level--;\n              } else break;\n          }\n\n          // adjust bboxes along the insertion path\n          this._adjustParentBBoxes(bbox, insertPath, level);\n      }\n\n      // split overflowed node into two\n      _split(insertPath, level) {\n          const node = insertPath[level];\n          const M = node.children.length;\n          const m = this._minEntries;\n\n          this._chooseSplitAxis(node, m, M);\n\n          const splitIndex = this._chooseSplitIndex(node, m, M);\n\n          const newNode = createNode(node.children.splice(splitIndex, node.children.length - splitIndex));\n          newNode.height = node.height;\n          newNode.leaf = node.leaf;\n\n          calcBBox(node, this.toBBox);\n          calcBBox(newNode, this.toBBox);\n\n          if (level) insertPath[level - 1].children.push(newNode);\n          else this._splitRoot(node, newNode);\n      }\n\n      _splitRoot(node, newNode) {\n          // split root node\n          this.data = createNode([node, newNode]);\n          this.data.height = node.height + 1;\n          this.data.leaf = false;\n          calcBBox(this.data, this.toBBox);\n      }\n\n      _chooseSplitIndex(node, m, M) {\n          let index;\n          let minOverlap = Infinity;\n          let minArea = Infinity;\n\n          for (let i = m; i <= M - m; i++) {\n              const bbox1 = distBBox(node, 0, i, this.toBBox);\n              const bbox2 = distBBox(node, i, M, this.toBBox);\n\n              const overlap = intersectionArea(bbox1, bbox2);\n              const area = bboxArea(bbox1) + bboxArea(bbox2);\n\n              // choose distribution with minimum overlap\n              if (overlap < minOverlap) {\n                  minOverlap = overlap;\n                  index = i;\n\n                  minArea = area < minArea ? area : minArea;\n\n              } else if (overlap === minOverlap) {\n                  // otherwise choose distribution with minimum area\n                  if (area < minArea) {\n                      minArea = area;\n                      index = i;\n                  }\n              }\n          }\n\n          return index || M - m;\n      }\n\n      // sorts node children by the best axis for split\n      _chooseSplitAxis(node, m, M) {\n          const compareMinX = node.leaf ? this.compareMinX : compareNodeMinX;\n          const compareMinY = node.leaf ? this.compareMinY : compareNodeMinY;\n          const xMargin = this._allDistMargin(node, m, M, compareMinX);\n          const yMargin = this._allDistMargin(node, m, M, compareMinY);\n\n          // if total distributions margin value is minimal for x, sort by minX,\n          // otherwise it's already sorted by minY\n          if (xMargin < yMargin) node.children.sort(compareMinX);\n      }\n\n      // total margin of all possible split distributions where each node is at least m full\n      _allDistMargin(node, m, M, compare) {\n          node.children.sort(compare);\n\n          const toBBox = this.toBBox;\n          const leftBBox = distBBox(node, 0, m, toBBox);\n          const rightBBox = distBBox(node, M - m, M, toBBox);\n          let margin = bboxMargin(leftBBox) + bboxMargin(rightBBox);\n\n          for (let i = m; i < M - m; i++) {\n              const child = node.children[i];\n              extend(leftBBox, node.leaf ? toBBox(child) : child);\n              margin += bboxMargin(leftBBox);\n          }\n\n          for (let i = M - m - 1; i >= m; i--) {\n              const child = node.children[i];\n              extend(rightBBox, node.leaf ? toBBox(child) : child);\n              margin += bboxMargin(rightBBox);\n          }\n\n          return margin;\n      }\n\n      _adjustParentBBoxes(bbox, path, level) {\n          // adjust bboxes along the given tree path\n          for (let i = level; i >= 0; i--) {\n              extend(path[i], bbox);\n          }\n      }\n\n      _condense(path) {\n          // go through the path, removing empty nodes and updating bboxes\n          for (let i = path.length - 1, siblings; i >= 0; i--) {\n              if (path[i].children.length === 0) {\n                  if (i > 0) {\n                      siblings = path[i - 1].children;\n                      siblings.splice(siblings.indexOf(path[i]), 1);\n\n                  } else this.clear();\n\n              } else calcBBox(path[i], this.toBBox);\n          }\n      }\n  }\n\n  function findItem(item, items, equalsFn) {\n      if (!equalsFn) return items.indexOf(item);\n\n      for (let i = 0; i < items.length; i++) {\n          if (equalsFn(item, items[i])) return i;\n      }\n      return -1;\n  }\n\n  // calculate node's bbox from bboxes of its children\n  function calcBBox(node, toBBox) {\n      distBBox(node, 0, node.children.length, toBBox, node);\n  }\n\n  // min bounding rectangle of node children from k to p-1\n  function distBBox(node, k, p, toBBox, destNode) {\n      if (!destNode) destNode = createNode(null);\n      destNode.minX = Infinity;\n      destNode.minY = Infinity;\n      destNode.maxX = -Infinity;\n      destNode.maxY = -Infinity;\n\n      for (let i = k; i < p; i++) {\n          const child = node.children[i];\n          extend(destNode, node.leaf ? toBBox(child) : child);\n      }\n\n      return destNode;\n  }\n\n  function extend(a, b) {\n      a.minX = Math.min(a.minX, b.minX);\n      a.minY = Math.min(a.minY, b.minY);\n      a.maxX = Math.max(a.maxX, b.maxX);\n      a.maxY = Math.max(a.maxY, b.maxY);\n      return a;\n  }\n\n  function compareNodeMinX(a, b) { return a.minX - b.minX; }\n  function compareNodeMinY(a, b) { return a.minY - b.minY; }\n\n  function bboxArea(a)   { return (a.maxX - a.minX) * (a.maxY - a.minY); }\n  function bboxMargin(a) { return (a.maxX - a.minX) + (a.maxY - a.minY); }\n\n  function enlargedArea(a, b) {\n      return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) *\n             (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\n  }\n\n  function intersectionArea(a, b) {\n      const minX = Math.max(a.minX, b.minX);\n      const minY = Math.max(a.minY, b.minY);\n      const maxX = Math.min(a.maxX, b.maxX);\n      const maxY = Math.min(a.maxY, b.maxY);\n\n      return Math.max(0, maxX - minX) *\n             Math.max(0, maxY - minY);\n  }\n\n  function contains(a, b) {\n      return a.minX <= b.minX &&\n             a.minY <= b.minY &&\n             b.maxX <= a.maxX &&\n             b.maxY <= a.maxY;\n  }\n\n  function intersects(a, b) {\n      return b.minX <= a.maxX &&\n             b.minY <= a.maxY &&\n             b.maxX >= a.minX &&\n             b.maxY >= a.minY;\n  }\n\n  function createNode(children) {\n      return {\n          children,\n          height: 1,\n          leaf: true,\n          minX: Infinity,\n          minY: Infinity,\n          maxX: -Infinity,\n          maxY: -Infinity\n      };\n  }\n\n  // sort an array so that items come in groups of n unsorted items, with groups sorted between each other;\n  // combines selection algorithm with binary divide & conquer approach\n\n  function multiSelect(arr, left, right, n, compare) {\n      const stack = [left, right];\n\n      while (stack.length) {\n          right = stack.pop();\n          left = stack.pop();\n\n          if (right - left <= n) continue;\n\n          const mid = left + Math.ceil((right - left) / n / 2) * n;\n          quickselect(arr, mid, left, right, compare);\n\n          stack.push(left, mid, mid, right);\n      }\n  }\n\n  function potpack(boxes) {\n\n      // calculate total box area and maximum box width\n      let area = 0;\n      let maxWidth = 0;\n\n      for (const box of boxes) {\n          area += box.w * box.h;\n          maxWidth = Math.max(maxWidth, box.w);\n      }\n\n      // sort the boxes for insertion by height, descending\n      boxes.sort((a, b) => b.h - a.h);\n\n      // aim for a squarish resulting container,\n      // slightly adjusted for sub-100% space utilization\n      const startWidth = Math.max(Math.ceil(Math.sqrt(area / 0.95)), maxWidth);\n\n      // start with a single empty space, unbounded at the bottom\n      const spaces = [{x: 0, y: 0, w: startWidth, h: Infinity}];\n\n      let width = 0;\n      let height = 0;\n\n      for (const box of boxes) {\n          // look through spaces backwards so that we check smaller spaces first\n          for (let i = spaces.length - 1; i >= 0; i--) {\n              const space = spaces[i];\n\n              // look for empty spaces that can accommodate the current box\n              if (box.w > space.w || box.h > space.h) continue;\n\n              // found the space; add the box to its top-left corner\n              // |-------|-------|\n              // |  box  |       |\n              // |_______|       |\n              // |         space |\n              // |_______________|\n              box.x = space.x;\n              box.y = space.y;\n\n              height = Math.max(height, box.y + box.h);\n              width = Math.max(width, box.x + box.w);\n\n              if (box.w === space.w && box.h === space.h) {\n                  // space matches the box exactly; remove it\n                  const last = spaces.pop();\n                  if (i < spaces.length) spaces[i] = last;\n\n              } else if (box.h === space.h) {\n                  // space matches the box height; update it accordingly\n                  // |-------|---------------|\n                  // |  box  | updated space |\n                  // |_______|_______________|\n                  space.x += box.w;\n                  space.w -= box.w;\n\n              } else if (box.w === space.w) {\n                  // space matches the box width; update it accordingly\n                  // |---------------|\n                  // |      box      |\n                  // |_______________|\n                  // | updated space |\n                  // |_______________|\n                  space.y += box.h;\n                  space.h -= box.h;\n\n              } else {\n                  // otherwise the box splits the space into two spaces\n                  // |-------|-----------|\n                  // |  box  | new space |\n                  // |_______|___________|\n                  // | updated space     |\n                  // |___________________|\n                  spaces.push({\n                      x: space.x + box.w,\n                      y: space.y,\n                      w: space.w - box.w,\n                      h: box.h\n                  });\n                  space.y += box.h;\n                  space.h -= box.h;\n              }\n              break;\n          }\n      }\n\n      return {\n          w: width, // container width\n          h: height, // container height\n          fill: (area / (width * height)) || 0 // space utilization\n      };\n  }\n\n  var __defProp = Object.defineProperty;\n  var __pow = Math.pow;\n  var __name = (target, value) => __defProp(target, \"name\", { value, configurable: true });\n  var __async = (__this, __arguments, generator) => {\n    return new Promise((resolve, reject) => {\n      var fulfilled = (value) => {\n        try {\n          step2(generator.next(value));\n        } catch (e) {\n          reject(e);\n        }\n      };\n      var rejected = (value) => {\n        try {\n          step2(generator.throw(value));\n        } catch (e) {\n          reject(e);\n        }\n      };\n      var step2 = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n      step2((generator = generator.apply(__this, __arguments)).next());\n    });\n  };\n\n  // src/attribute.ts\n  var _StringAttr = class _StringAttr {\n    constructor(c, defaultValue) {\n      this.str = c != null ? c : defaultValue;\n      this.perFeature = typeof this.str === \"function\" && this.str.length === 2;\n    }\n    get(z, f) {\n      if (typeof this.str === \"function\") {\n        return this.str(z, f);\n      }\n      return this.str;\n    }\n  };\n  __name(_StringAttr, \"StringAttr\");\n  var StringAttr = _StringAttr;\n  var _NumberAttr = class _NumberAttr {\n    constructor(c, defaultValue = 1) {\n      this.value = c != null ? c : defaultValue;\n      this.perFeature = typeof this.value === \"function\" && this.value.length === 2;\n    }\n    get(z, f) {\n      if (typeof this.value === \"function\") {\n        return this.value(z, f);\n      }\n      return this.value;\n    }\n  };\n  __name(_NumberAttr, \"NumberAttr\");\n  var NumberAttr = _NumberAttr;\n  var _TextAttr = class _TextAttr {\n    constructor(options) {\n      var _a;\n      this.labelProps = (_a = options == null ? void 0 : options.labelProps) != null ? _a : [\"name\"];\n      this.textTransform = options == null ? void 0 : options.textTransform;\n    }\n    get(z, f) {\n      let retval;\n      let labelProps;\n      if (typeof this.labelProps === \"function\") {\n        labelProps = this.labelProps(z, f);\n      } else {\n        labelProps = this.labelProps;\n      }\n      for (const property of labelProps) {\n        if (Object.prototype.hasOwnProperty.call(f.props, property) && typeof f.props[property] === \"string\") {\n          retval = f.props[property];\n          break;\n        }\n      }\n      let transform;\n      if (typeof this.textTransform === \"function\") {\n        transform = this.textTransform(z, f);\n      } else {\n        transform = this.textTransform;\n      }\n      if (retval && transform === \"uppercase\") retval = retval.toUpperCase();\n      else if (retval && transform === \"lowercase\") retval = retval.toLowerCase();\n      else if (retval && transform === \"capitalize\") {\n        const wordsArray = retval.toLowerCase().split(\" \");\n        const capsArray = wordsArray.map((word) => {\n          return word[0].toUpperCase() + word.slice(1);\n        });\n        retval = capsArray.join(\" \");\n      }\n      return retval;\n    }\n  };\n  __name(_TextAttr, \"TextAttr\");\n  var TextAttr = _TextAttr;\n  var _FontAttr = class _FontAttr {\n    constructor(options) {\n      var _a, _b;\n      if (options == null ? void 0 : options.font) {\n        this.font = options.font;\n      } else {\n        this.family = (_a = options == null ? void 0 : options.fontFamily) != null ? _a : \"sans-serif\";\n        this.size = (_b = options == null ? void 0 : options.fontSize) != null ? _b : 12;\n        this.weight = options == null ? void 0 : options.fontWeight;\n        this.style = options == null ? void 0 : options.fontStyle;\n      }\n    }\n    get(z, f) {\n      if (this.font) {\n        if (typeof this.font === \"function\") {\n          return this.font(z, f);\n        }\n        return this.font;\n      }\n      let style = \"\";\n      if (this.style) {\n        if (typeof this.style === \"function\") {\n          style = `${this.style(z, f)} `;\n        } else {\n          style = `${this.style} `;\n        }\n      }\n      let weight = \"\";\n      if (this.weight) {\n        if (typeof this.weight === \"function\") {\n          weight = `${this.weight(z, f)} `;\n        } else {\n          weight = `${this.weight} `;\n        }\n      }\n      let size;\n      if (typeof this.size === \"function\") {\n        size = this.size(z, f);\n      } else {\n        size = this.size;\n      }\n      let family;\n      if (typeof this.family === \"function\") {\n        family = this.family(z, f);\n      } else {\n        family = this.family;\n      }\n      return `${style}${weight}${size}px ${family}`;\n    }\n  };\n  __name(_FontAttr, \"FontAttr\");\n  var FontAttr = _FontAttr;\n  var _ArrayAttr = class _ArrayAttr {\n    constructor(c, defaultValue = []) {\n      this.value = c != null ? c : defaultValue;\n      this.perFeature = typeof this.value === \"function\" && this.value.length === 2;\n    }\n    get(z, f) {\n      if (typeof this.value === \"function\") {\n        return this.value(z, f);\n      }\n      return this.value;\n    }\n  };\n  __name(_ArrayAttr, \"ArrayAttr\");\n  var ArrayAttr = _ArrayAttr;\n  var linelabel = /* @__PURE__ */ __name((pts, maxAngleDelta, targetLen) => {\n    const chunks = [];\n    let a;\n    let b;\n    let c;\n    let i = 0;\n    let n = 0;\n    let d = 0;\n    let abmag = 0;\n    let bcmag = 0;\n    let abx = 0;\n    let aby = 0;\n    let bcx = 0;\n    let bcy = 0;\n    let dt = 0;\n    let iStart = 0;\n    let dStart = 0;\n    if (pts.length < 2) return [];\n    if (pts.length === 2) {\n      d = Math.sqrt(__pow(pts[1].x - pts[0].x, 2) + __pow(pts[1].y - pts[0].y, 2));\n      return [\n        {\n          length: d,\n          beginIndex: 0,\n          beginDistance: 0,\n          endIndex: 2,\n          endDistance: d\n        }\n      ];\n    }\n    abmag = Math.sqrt(__pow(pts[1].x - pts[0].x, 2) + __pow(pts[1].y - pts[0].y, 2));\n    for (i = 1, n = pts.length - 1; i < n; i++) {\n      a = pts[i - 1];\n      b = pts[i];\n      c = pts[i + 1];\n      abx = b.x - a.x;\n      aby = b.y - a.y;\n      bcx = c.x - b.x;\n      bcy = c.y - b.y;\n      bcmag = Math.sqrt(bcx * bcx + bcy * bcy);\n      d += abmag;\n      dt = Math.acos((abx * bcx + aby * bcy) / (abmag * bcmag));\n      if (dt > maxAngleDelta || d - dStart > targetLen) {\n        chunks.push({\n          length: d - dStart,\n          beginDistance: dStart,\n          beginIndex: iStart,\n          endIndex: i + 1,\n          endDistance: d\n        });\n        iStart = i;\n        dStart = d;\n      }\n      abmag = bcmag;\n    }\n    if (i - iStart > 0) {\n      chunks.push({\n        length: d - dStart + bcmag,\n        beginIndex: iStart,\n        beginDistance: dStart,\n        endIndex: i + 1,\n        endDistance: d + bcmag\n      });\n    }\n    return chunks;\n  }, \"linelabel\");\n  function simpleLabel(mls, minimum, repeatDistance, cellSize) {\n    const candidates = [];\n    for (const ls of mls) {\n      const segments = linelabel(ls, Math.PI / 45, minimum);\n      for (const segment of segments) {\n        if (segment.length >= minimum + cellSize) {\n          const start = new Point(\n            ls[segment.beginIndex].x,\n            ls[segment.beginIndex].y\n          );\n          const end = ls[segment.endIndex - 1];\n          const normalized = new Point(\n            (end.x - start.x) / segment.length,\n            (end.y - start.y) / segment.length\n          );\n          for (let i = cellSize; i < segment.length - minimum; i += repeatDistance) {\n            candidates.push({\n              start: start.add(normalized.mult(i)),\n              end: start.add(normalized.mult(i + minimum))\n            });\n          }\n        }\n      }\n    }\n    return candidates;\n  }\n  __name(simpleLabel, \"simpleLabel\");\n  function lineCells(a, b, length, spacing) {\n    const dx = b.x - a.x;\n    const dy = b.y - a.y;\n    const dist = Math.sqrt(__pow(b.x - a.x, 2) + __pow(b.y - a.y, 2));\n    const retval = [];\n    for (let i = 0; i < length + spacing; i += 2 * spacing) {\n      const factor = i * 1 / dist;\n      retval.push({ x: a.x + factor * dx, y: a.y + factor * dy });\n    }\n    return retval;\n  }\n  __name(lineCells, \"lineCells\");\n\n  // src/text.ts\n  function linebreak(str, maxUnits) {\n    if (str.length <= maxUnits) return [str];\n    const endIndex = maxUnits - 1;\n    const spaceBefore = str.lastIndexOf(\" \", endIndex);\n    const spaceAfter = str.indexOf(\" \", endIndex);\n    if (spaceBefore === -1 && spaceAfter === -1) {\n      return [str];\n    }\n    let first;\n    let after;\n    if (spaceAfter === -1 || spaceBefore >= 0 && endIndex - spaceBefore < spaceAfter - endIndex) {\n      first = str.substring(0, spaceBefore);\n      after = str.substring(spaceBefore + 1, str.length);\n    } else {\n      first = str.substring(0, spaceAfter);\n      after = str.substring(spaceAfter + 1, str.length);\n    }\n    return [first, ...linebreak(after, maxUnits)];\n  }\n  __name(linebreak, \"linebreak\");\n  var GeomType = /* @__PURE__ */ ((GeomType2) => {\n    GeomType2[GeomType2[\"Point\"] = 1] = \"Point\";\n    GeomType2[GeomType2[\"Line\"] = 2] = \"Line\";\n    GeomType2[GeomType2[\"Polygon\"] = 3] = \"Polygon\";\n    return GeomType2;\n  })(GeomType || {});\n  function toIndex(c) {\n    return `${c.x}:${c.y}:${c.z}`;\n  }\n  __name(toIndex, \"toIndex\");\n  var loadGeomAndBbox = /* @__PURE__ */ __name((pbf, geometry, scale) => {\n    pbf.pos = geometry;\n    const end = pbf.readVarint() + pbf.pos;\n    let cmd = 1;\n    let length = 0;\n    let x = 0;\n    let y = 0;\n    let x1 = Infinity;\n    let x2 = -Infinity;\n    let y1 = Infinity;\n    let y2 = -Infinity;\n    const lines = [];\n    let line = [];\n    while (pbf.pos < end) {\n      if (length <= 0) {\n        const cmdLen = pbf.readVarint();\n        cmd = cmdLen & 7;\n        length = cmdLen >> 3;\n      }\n      length--;\n      if (cmd === 1 || cmd === 2) {\n        x += pbf.readSVarint() * scale;\n        y += pbf.readSVarint() * scale;\n        if (x < x1) x1 = x;\n        if (x > x2) x2 = x;\n        if (y < y1) y1 = y;\n        if (y > y2) y2 = y;\n        if (cmd === 1) {\n          if (line.length > 0) lines.push(line);\n          line = [];\n        }\n        line.push(new Point(x, y));\n      } else if (cmd === 7) {\n        if (line) line.push(line[0].clone());\n      } else throw new Error(`unknown command ${cmd}`);\n    }\n    if (line) lines.push(line);\n    return { geom: lines, bbox: { minX: x1, minY: y1, maxX: x2, maxY: y2 } };\n  }, \"loadGeomAndBbox\");\n  function parseTile(buffer, tileSize) {\n    const v = new VectorTile(new Pbf(buffer));\n    const result = /* @__PURE__ */ new Map();\n    for (const [key, value] of Object.entries(v.layers)) {\n      const features = [];\n      const layer = value;\n      for (let i = 0; i < layer.length; i++) {\n        const loaded = loadGeomAndBbox(\n          layer.feature(i)._pbf,\n          layer.feature(i)._geometry,\n          tileSize / layer.extent\n        );\n        let numVertices = 0;\n        for (const part of loaded.geom) numVertices += part.length;\n        features.push({\n          id: layer.feature(i).id,\n          geomType: layer.feature(i).type,\n          geom: loaded.geom,\n          numVertices,\n          bbox: loaded.bbox,\n          props: layer.feature(i).properties\n        });\n      }\n      result.set(key, features);\n    }\n    return result;\n  }\n  __name(parseTile, \"parseTile\");\n  var _PmtilesSource = class _PmtilesSource {\n    constructor(url, shouldCancelZooms) {\n      if (typeof url === \"string\") {\n        this.p = new PMTiles(url);\n      } else {\n        this.p = url;\n      }\n      this.zoomaborts = [];\n      this.shouldCancelZooms = shouldCancelZooms;\n    }\n    get(c, tileSize) {\n      return __async(this, null, function* () {\n        if (this.shouldCancelZooms) {\n          this.zoomaborts = this.zoomaborts.filter((za) => {\n            if (za.z !== c.z) {\n              za.controller.abort();\n              return false;\n            }\n            return true;\n          });\n        }\n        const controller = new AbortController();\n        this.zoomaborts.push({ z: c.z, controller });\n        const signal = controller.signal;\n        const result = yield this.p.getZxy(c.z, c.x, c.y, signal);\n        if (result) {\n          return parseTile(result.data, tileSize);\n        }\n        return /* @__PURE__ */ new Map();\n      });\n    }\n  };\n  __name(_PmtilesSource, \"PmtilesSource\");\n  var PmtilesSource = _PmtilesSource;\n  var _ZxySource = class _ZxySource {\n    constructor(url, shouldCancelZooms) {\n      this.url = url;\n      this.zoomaborts = [];\n      this.shouldCancelZooms = shouldCancelZooms;\n    }\n    get(c, tileSize) {\n      return __async(this, null, function* () {\n        if (this.shouldCancelZooms) {\n          this.zoomaborts = this.zoomaborts.filter((za) => {\n            if (za.z !== c.z) {\n              za.controller.abort();\n              return false;\n            }\n            return true;\n          });\n        }\n        const url = this.url.replace(\"{z}\", c.z.toString()).replace(\"{x}\", c.x.toString()).replace(\"{y}\", c.y.toString());\n        const controller = new AbortController();\n        this.zoomaborts.push({ z: c.z, controller });\n        const signal = controller.signal;\n        return new Promise((resolve, reject) => {\n          fetch(url, { signal }).then((resp) => {\n            return resp.arrayBuffer();\n          }).then((buffer) => {\n            const result = parseTile(buffer, tileSize);\n            resolve(result);\n          }).catch((e) => {\n            reject(e);\n          });\n        });\n      });\n    }\n  };\n  __name(_ZxySource, \"ZxySource\");\n  var ZxySource = _ZxySource;\n  var R = 6378137;\n  var MAX_LATITUDE = 85.0511287798;\n  var MAXCOORD = R * Math.PI;\n  var project = /* @__PURE__ */ __name((latlng) => {\n    const d = Math.PI / 180;\n    const constrainedLat = Math.max(\n      Math.min(MAX_LATITUDE, latlng[0]),\n      -MAX_LATITUDE\n    );\n    const sin = Math.sin(constrainedLat * d);\n    return new Point(\n      R * latlng[1] * d,\n      R * Math.log((1 + sin) / (1 - sin)) / 2\n    );\n  }, \"project\");\n  function sqr(x) {\n    return x * x;\n  }\n  __name(sqr, \"sqr\");\n  function dist2(v, w) {\n    return sqr(v.x - w.x) + sqr(v.y - w.y);\n  }\n  __name(dist2, \"dist2\");\n  function distToSegmentSquared(p, v, w) {\n    const l2 = dist2(v, w);\n    if (l2 === 0) return dist2(p, v);\n    let t = ((p.x - v.x) * (w.x - v.x) + (p.y - v.y) * (w.y - v.y)) / l2;\n    t = Math.max(0, Math.min(1, t));\n    return dist2(p, new Point(v.x + t * (w.x - v.x), v.y + t * (w.y - v.y)));\n  }\n  __name(distToSegmentSquared, \"distToSegmentSquared\");\n  function isInRing(point, ring) {\n    let inside = false;\n    for (let i = 0, j = ring.length - 1; i < ring.length; j = i++) {\n      const xi = ring[i].x;\n      const yi = ring[i].y;\n      const xj = ring[j].x;\n      const yj = ring[j].y;\n      const intersect = yi > point.y !== yj > point.y && point.x < (xj - xi) * (point.y - yi) / (yj - yi) + xi;\n      if (intersect) inside = !inside;\n    }\n    return inside;\n  }\n  __name(isInRing, \"isInRing\");\n  function isCcw(ring) {\n    let area = 0;\n    for (let i = 0; i < ring.length; i++) {\n      const j = (i + 1) % ring.length;\n      area += ring[i].x * ring[j].y;\n      area -= ring[j].x * ring[i].y;\n    }\n    return area < 0;\n  }\n  __name(isCcw, \"isCcw\");\n  function pointInPolygon(point, geom) {\n    let isInCurrentExterior = false;\n    for (const ring of geom) {\n      if (isCcw(ring)) {\n        if (isInRing(point, ring)) isInCurrentExterior = false;\n      } else {\n        if (isInCurrentExterior) return true;\n        if (isInRing(point, ring)) isInCurrentExterior = true;\n      }\n    }\n    return isInCurrentExterior;\n  }\n  __name(pointInPolygon, \"pointInPolygon\");\n  function pointMinDistToPoints(point, geom) {\n    let min = Infinity;\n    for (const l of geom) {\n      const dist = Math.sqrt(dist2(point, l[0]));\n      if (dist < min) min = dist;\n    }\n    return min;\n  }\n  __name(pointMinDistToPoints, \"pointMinDistToPoints\");\n  function pointMinDistToLines(point, geom) {\n    let min = Infinity;\n    for (const l of geom) {\n      for (let i = 0; i < l.length - 1; i++) {\n        const dist = Math.sqrt(distToSegmentSquared(point, l[i], l[i + 1]));\n        if (dist < min) min = dist;\n      }\n    }\n    return min;\n  }\n  __name(pointMinDistToLines, \"pointMinDistToLines\");\n  var _TileCache = class _TileCache {\n    constructor(source, tileSize) {\n      this.source = source;\n      this.cache = /* @__PURE__ */ new Map();\n      this.inflight = /* @__PURE__ */ new Map();\n      this.tileSize = tileSize;\n    }\n    get(c) {\n      return __async(this, null, function* () {\n        const idx = toIndex(c);\n        return new Promise((resolve, reject) => {\n          const entry = this.cache.get(idx);\n          if (entry) {\n            entry.used = performance.now();\n            resolve(entry.data);\n          } else {\n            const ifentry = this.inflight.get(idx);\n            if (ifentry) {\n              ifentry.push({ resolve, reject });\n            } else {\n              this.inflight.set(idx, []);\n              this.source.get(c, this.tileSize).then((tile) => {\n                this.cache.set(idx, { used: performance.now(), data: tile });\n                const ifentry2 = this.inflight.get(idx);\n                if (ifentry2) {\n                  for (const f of ifentry2) {\n                    f.resolve(tile);\n                  }\n                }\n                this.inflight.delete(idx);\n                resolve(tile);\n                if (this.cache.size >= 64) {\n                  let minUsed = Infinity;\n                  let minKey = void 0;\n                  this.cache.forEach((value, key) => {\n                    if (value.used < minUsed) {\n                      minUsed = value.used;\n                      minKey = key;\n                    }\n                  });\n                  if (minKey) this.cache.delete(minKey);\n                }\n              }).catch((e) => {\n                const ifentry2 = this.inflight.get(idx);\n                if (ifentry2) {\n                  for (const f of ifentry2) {\n                    f.reject(e);\n                  }\n                }\n                this.inflight.delete(idx);\n                reject(e);\n              });\n            }\n          }\n        });\n      });\n    }\n    queryFeatures(lng, lat, zoom, brushSize) {\n      const projected = project([lat, lng]);\n      const normalized = new Point(\n        (projected.x + MAXCOORD) / (MAXCOORD * 2),\n        1 - (projected.y + MAXCOORD) / (MAXCOORD * 2)\n      );\n      if (normalized.x > 1)\n        normalized.x = normalized.x - Math.floor(normalized.x);\n      const onZoom = normalized.mult(1 << zoom);\n      const tileX = Math.floor(onZoom.x);\n      const tileY = Math.floor(onZoom.y);\n      const idx = toIndex({ z: zoom, x: tileX, y: tileY });\n      const retval = [];\n      const entry = this.cache.get(idx);\n      if (entry) {\n        const center = new Point(\n          (onZoom.x - tileX) * this.tileSize,\n          (onZoom.y - tileY) * this.tileSize\n        );\n        for (const [layerName, layerArr] of entry.data.entries()) {\n          for (const feature of layerArr) {\n            if (feature.geomType === 1 /* Point */) {\n              if (pointMinDistToPoints(center, feature.geom) < brushSize) {\n                retval.push({ feature, layerName });\n              }\n            } else if (feature.geomType === 2 /* Line */) {\n              if (pointMinDistToLines(center, feature.geom) < brushSize) {\n                retval.push({ feature, layerName });\n              }\n            } else {\n              if (pointInPolygon(center, feature.geom)) {\n                retval.push({ feature, layerName });\n              }\n            }\n          }\n        }\n      }\n      return retval;\n    }\n  };\n  __name(_TileCache, \"TileCache\");\n  var TileCache = _TileCache;\n\n  // src/symbolizer.ts\n  var Justify = /* @__PURE__ */ ((Justify2) => {\n    Justify2[Justify2[\"Left\"] = 1] = \"Left\";\n    Justify2[Justify2[\"Center\"] = 2] = \"Center\";\n    Justify2[Justify2[\"Right\"] = 3] = \"Right\";\n    return Justify2;\n  })(Justify || {});\n  var TextPlacements = /* @__PURE__ */ ((TextPlacements2) => {\n    TextPlacements2[TextPlacements2[\"N\"] = 1] = \"N\";\n    TextPlacements2[TextPlacements2[\"Ne\"] = 2] = \"Ne\";\n    TextPlacements2[TextPlacements2[\"E\"] = 3] = \"E\";\n    TextPlacements2[TextPlacements2[\"Se\"] = 4] = \"Se\";\n    TextPlacements2[TextPlacements2[\"S\"] = 5] = \"S\";\n    TextPlacements2[TextPlacements2[\"Sw\"] = 6] = \"Sw\";\n    TextPlacements2[TextPlacements2[\"W\"] = 7] = \"W\";\n    TextPlacements2[TextPlacements2[\"Nw\"] = 8] = \"Nw\";\n    return TextPlacements2;\n  })(TextPlacements || {});\n  var createPattern = /* @__PURE__ */ __name((width, height, fn) => {\n    const canvas = document.createElement(\"canvas\");\n    const ctx = canvas.getContext(\"2d\");\n    canvas.width = width;\n    canvas.height = height;\n    if (ctx !== null) fn(canvas, ctx);\n    return canvas;\n  }, \"createPattern\");\n  var _PolygonSymbolizer = class _PolygonSymbolizer {\n    constructor(options) {\n      var _a;\n      this.pattern = options.pattern;\n      this.fill = new StringAttr(options.fill, \"black\");\n      this.opacity = new NumberAttr(options.opacity, 1);\n      this.stroke = new StringAttr(options.stroke, \"black\");\n      this.width = new NumberAttr(options.width, 0);\n      this.perFeature = (_a = this.fill.perFeature || this.opacity.perFeature || this.stroke.perFeature || this.width.perFeature || options.perFeature) != null ? _a : false;\n      this.doStroke = false;\n    }\n    before(ctx, z) {\n      if (!this.perFeature) {\n        ctx.globalAlpha = this.opacity.get(z);\n        ctx.fillStyle = this.fill.get(z);\n        ctx.strokeStyle = this.stroke.get(z);\n        const width = this.width.get(z);\n        if (width > 0) this.doStroke = true;\n        ctx.lineWidth = width;\n      }\n      if (this.pattern) {\n        const patten = ctx.createPattern(this.pattern, \"repeat\");\n        if (patten) ctx.fillStyle = patten;\n      }\n    }\n    draw(ctx, geom, z, f) {\n      let doStroke = false;\n      if (this.perFeature) {\n        ctx.globalAlpha = this.opacity.get(z, f);\n        ctx.fillStyle = this.fill.get(z, f);\n        const width = this.width.get(z, f);\n        if (width) {\n          doStroke = true;\n          ctx.strokeStyle = this.stroke.get(z, f);\n          ctx.lineWidth = width;\n        }\n      }\n      const drawPath = /* @__PURE__ */ __name(() => {\n        ctx.fill();\n        if (doStroke || this.doStroke) {\n          ctx.stroke();\n        }\n      }, \"drawPath\");\n      ctx.beginPath();\n      for (const poly of geom) {\n        for (let p = 0; p < poly.length; p++) {\n          const pt = poly[p];\n          if (p === 0) ctx.moveTo(pt.x, pt.y);\n          else ctx.lineTo(pt.x, pt.y);\n        }\n      }\n      drawPath();\n    }\n  };\n  __name(_PolygonSymbolizer, \"PolygonSymbolizer\");\n  var PolygonSymbolizer = _PolygonSymbolizer;\n  function arr(base, a) {\n    return (z) => {\n      const b = z - base;\n      if (b >= 0 && b < a.length) {\n        return a[b];\n      }\n      return 0;\n    };\n  }\n  __name(arr, \"arr\");\n  function getStopIndex(input, stops) {\n    let idx = 0;\n    while (stops[idx + 1][0] < input) idx++;\n    return idx;\n  }\n  __name(getStopIndex, \"getStopIndex\");\n  function interpolate(factor, start, end) {\n    return factor * (end - start) + start;\n  }\n  __name(interpolate, \"interpolate\");\n  function computeInterpolationFactor(z, idx, base, stops) {\n    const difference = stops[idx + 1][0] - stops[idx][0];\n    const progress = z - stops[idx][0];\n    if (difference === 0) return 0;\n    if (base === 1) return progress / difference;\n    return (__pow(base, progress) - 1) / (__pow(base, difference) - 1);\n  }\n  __name(computeInterpolationFactor, \"computeInterpolationFactor\");\n  function exp(base, stops) {\n    return (z) => {\n      if (stops.length < 1) return 0;\n      if (z <= stops[0][0]) return stops[0][1];\n      if (z >= stops[stops.length - 1][0]) return stops[stops.length - 1][1];\n      const idx = getStopIndex(z, stops);\n      const factor = computeInterpolationFactor(z, idx, base, stops);\n      return interpolate(factor, stops[idx][1], stops[idx + 1][1]);\n    };\n  }\n  __name(exp, \"exp\");\n  function step(output0, stops) {\n    return (z) => {\n      if (stops.length < 1) return 0;\n      let retval = output0;\n      for (let i = 0; i < stops.length; i++) {\n        if (z >= stops[i][0]) retval = stops[i][1];\n      }\n      return retval;\n    };\n  }\n  __name(step, \"step\");\n  function linear(stops) {\n    return exp(1, stops);\n  }\n  __name(linear, \"linear\");\n  var _LineSymbolizer = class _LineSymbolizer {\n    constructor(options) {\n      var _a;\n      this.color = new StringAttr(options.color, \"black\");\n      this.width = new NumberAttr(options.width);\n      this.opacity = new NumberAttr(options.opacity);\n      this.dash = options.dash ? new ArrayAttr(options.dash) : null;\n      this.dashColor = new StringAttr(options.dashColor, \"black\");\n      this.dashWidth = new NumberAttr(options.dashWidth, 1);\n      this.lineCap = new StringAttr(options.lineCap, \"butt\");\n      this.lineJoin = new StringAttr(options.lineJoin, \"miter\");\n      this.skip = false;\n      this.perFeature = !!(((_a = this.dash) == null ? void 0 : _a.perFeature) || this.color.perFeature || this.opacity.perFeature || this.width.perFeature || this.lineCap.perFeature || this.lineJoin.perFeature || options.perFeature);\n    }\n    before(ctx, z) {\n      if (!this.perFeature) {\n        ctx.strokeStyle = this.color.get(z);\n        ctx.lineWidth = this.width.get(z);\n        ctx.globalAlpha = this.opacity.get(z);\n        ctx.lineCap = this.lineCap.get(z);\n        ctx.lineJoin = this.lineJoin.get(z);\n      }\n    }\n    draw(ctx, geom, z, f) {\n      if (this.skip) return;\n      const strokePath = /* @__PURE__ */ __name(() => {\n        if (this.perFeature) {\n          ctx.globalAlpha = this.opacity.get(z, f);\n          ctx.lineCap = this.lineCap.get(z, f);\n          ctx.lineJoin = this.lineJoin.get(z, f);\n        }\n        if (this.dash) {\n          ctx.save();\n          if (this.perFeature) {\n            ctx.lineWidth = this.dashWidth.get(z, f);\n            ctx.strokeStyle = this.dashColor.get(z, f);\n            ctx.setLineDash(this.dash.get(z, f));\n          } else {\n            ctx.setLineDash(this.dash.get(z));\n          }\n          ctx.stroke();\n          ctx.restore();\n        } else {\n          ctx.save();\n          if (this.perFeature) {\n            ctx.lineWidth = this.width.get(z, f);\n            ctx.strokeStyle = this.color.get(z, f);\n          }\n          ctx.stroke();\n          ctx.restore();\n        }\n      }, \"strokePath\");\n      ctx.beginPath();\n      for (const ls of geom) {\n        for (let p = 0; p < ls.length; p++) {\n          const pt = ls[p];\n          if (p === 0) ctx.moveTo(pt.x, pt.y);\n          else ctx.lineTo(pt.x, pt.y);\n        }\n      }\n      strokePath();\n    }\n  };\n  __name(_LineSymbolizer, \"LineSymbolizer\");\n  var LineSymbolizer = _LineSymbolizer;\n  var _IconSymbolizer = class _IconSymbolizer {\n    constructor(options) {\n      this.name = options.name;\n      this.sheet = options.sheet;\n      this.dpr = window.devicePixelRatio;\n    }\n    place(layout, geom, feature) {\n      geom[0];\n      const a = new Point(geom[0][0].x, geom[0][0].y);\n      const loc = this.sheet.get(this.name);\n      const width = loc.w / this.dpr;\n      const height = loc.h / this.dpr;\n      const bbox = {\n        minX: a.x - width / 2,\n        minY: a.y - height / 2,\n        maxX: a.x + width / 2,\n        maxY: a.y + height / 2\n      };\n      const draw = /* @__PURE__ */ __name((ctx) => {\n        ctx.globalAlpha = 1;\n        ctx.drawImage(\n          this.sheet.canvas,\n          loc.x,\n          loc.y,\n          loc.w,\n          loc.h,\n          -loc.w / 2 / this.dpr,\n          -loc.h / 2 / this.dpr,\n          loc.w / 2,\n          loc.h / 2\n        );\n      }, \"draw\");\n      return [{ anchor: a, bboxes: [bbox], draw }];\n    }\n  };\n  __name(_IconSymbolizer, \"IconSymbolizer\");\n  var IconSymbolizer = _IconSymbolizer;\n  var _CircleSymbolizer = class _CircleSymbolizer {\n    constructor(options) {\n      this.radius = new NumberAttr(options.radius, 3);\n      this.fill = new StringAttr(options.fill, \"black\");\n      this.stroke = new StringAttr(options.stroke, \"white\");\n      this.width = new NumberAttr(options.width, 0);\n      this.opacity = new NumberAttr(options.opacity);\n    }\n    draw(ctx, geom, z, f) {\n      ctx.globalAlpha = this.opacity.get(z, f);\n      const radius = this.radius.get(z, f);\n      const width = this.width.get(z, f);\n      if (width > 0) {\n        ctx.strokeStyle = this.stroke.get(z, f);\n        ctx.lineWidth = width;\n        ctx.beginPath();\n        ctx.arc(geom[0][0].x, geom[0][0].y, radius + width / 2, 0, 2 * Math.PI);\n        ctx.stroke();\n      }\n      ctx.fillStyle = this.fill.get(z, f);\n      ctx.beginPath();\n      ctx.arc(geom[0][0].x, geom[0][0].y, radius, 0, 2 * Math.PI);\n      ctx.fill();\n    }\n    place(layout, geom, feature) {\n      geom[0];\n      const a = new Point(geom[0][0].x, geom[0][0].y);\n      const radius = this.radius.get(layout.zoom, feature);\n      const bbox = {\n        minX: a.x - radius,\n        minY: a.y - radius,\n        maxX: a.x + radius,\n        maxY: a.y + radius\n      };\n      const draw = /* @__PURE__ */ __name((ctx) => {\n        this.draw(ctx, [[new Point(0, 0)]], layout.zoom, feature);\n      }, \"draw\");\n      return [{ anchor: a, bboxes: [bbox], draw }];\n    }\n  };\n  __name(_CircleSymbolizer, \"CircleSymbolizer\");\n  var CircleSymbolizer = _CircleSymbolizer;\n  var _ShieldSymbolizer = class _ShieldSymbolizer {\n    constructor(options) {\n      this.font = new FontAttr(options);\n      this.text = new TextAttr(options);\n      this.fill = new StringAttr(options.fill, \"black\");\n      this.background = new StringAttr(options.background, \"white\");\n      this.padding = new NumberAttr(options.padding, 0);\n    }\n    place(layout, geom, f) {\n      const property = this.text.get(layout.zoom, f);\n      if (!property) return void 0;\n      const font = this.font.get(layout.zoom, f);\n      layout.scratch.font = font;\n      const metrics = layout.scratch.measureText(property);\n      const width = metrics.width;\n      const ascent = metrics.actualBoundingBoxAscent;\n      const descent = metrics.actualBoundingBoxDescent;\n      geom[0];\n      const a = new Point(geom[0][0].x, geom[0][0].y);\n      const p = this.padding.get(layout.zoom, f);\n      const bbox = {\n        minX: a.x - width / 2 - p,\n        minY: a.y - ascent - p,\n        maxX: a.x + width / 2 + p,\n        maxY: a.y + descent + p\n      };\n      const draw = /* @__PURE__ */ __name((ctx) => {\n        ctx.globalAlpha = 1;\n        ctx.fillStyle = this.background.get(layout.zoom, f);\n        ctx.fillRect(\n          -width / 2 - p,\n          -ascent - p,\n          width + 2 * p,\n          ascent + descent + 2 * p\n        );\n        ctx.fillStyle = this.fill.get(layout.zoom, f);\n        ctx.font = font;\n        ctx.fillText(property, -width / 2, 0);\n      }, \"draw\");\n      return [{ anchor: a, bboxes: [bbox], draw }];\n    }\n  };\n  __name(_ShieldSymbolizer, \"ShieldSymbolizer\");\n  var ShieldSymbolizer = _ShieldSymbolizer;\n  var _FlexSymbolizer = class _FlexSymbolizer {\n    constructor(list) {\n      this.list = list;\n    }\n    place(layout, geom, feature) {\n      let labels = this.list[0].place(layout, geom, feature);\n      if (!labels) return void 0;\n      let label = labels[0];\n      const anchor = label.anchor;\n      let bbox = label.bboxes[0];\n      const height = bbox.maxY - bbox.minY;\n      const draws = [{ draw: label.draw, translate: { x: 0, y: 0 } }];\n      const newGeom = [[new Point(geom[0][0].x, geom[0][0].y + height)]];\n      for (let i = 1; i < this.list.length; i++) {\n        labels = this.list[i].place(layout, newGeom, feature);\n        if (labels) {\n          label = labels[0];\n          bbox = mergeBbox(bbox, label.bboxes[0]);\n          draws.push({ draw: label.draw, translate: { x: 0, y: height } });\n        }\n      }\n      const draw = /* @__PURE__ */ __name((ctx) => {\n        for (const sub of draws) {\n          ctx.save();\n          ctx.translate(sub.translate.x, sub.translate.y);\n          sub.draw(ctx);\n          ctx.restore();\n        }\n      }, \"draw\");\n      return [{ anchor, bboxes: [bbox], draw }];\n    }\n  };\n  __name(_FlexSymbolizer, \"FlexSymbolizer\");\n  var FlexSymbolizer = _FlexSymbolizer;\n  var mergeBbox = /* @__PURE__ */ __name((b1, b2) => {\n    return {\n      minX: Math.min(b1.minX, b2.minX),\n      minY: Math.min(b1.minY, b2.minY),\n      maxX: Math.max(b1.maxX, b2.maxX),\n      maxY: Math.max(b1.maxY, b2.maxY)\n    };\n  }, \"mergeBbox\");\n  var _GroupSymbolizer = class _GroupSymbolizer {\n    constructor(list) {\n      this.list = list;\n    }\n    place(layout, geom, feature) {\n      const first = this.list[0];\n      if (!first) return void 0;\n      let labels = first.place(layout, geom, feature);\n      if (!labels) return void 0;\n      let label = labels[0];\n      const anchor = label.anchor;\n      let bbox = label.bboxes[0];\n      const draws = [label.draw];\n      for (let i = 1; i < this.list.length; i++) {\n        labels = this.list[i].place(layout, geom, feature);\n        if (!labels) return void 0;\n        label = labels[0];\n        bbox = mergeBbox(bbox, label.bboxes[0]);\n        draws.push(label.draw);\n      }\n      const draw = /* @__PURE__ */ __name((ctx) => {\n        for (const d of draws) {\n          d(ctx);\n        }\n      }, \"draw\");\n      return [{ anchor, bboxes: [bbox], draw }];\n    }\n  };\n  __name(_GroupSymbolizer, \"GroupSymbolizer\");\n  var GroupSymbolizer = _GroupSymbolizer;\n  var _CenteredSymbolizer = class _CenteredSymbolizer {\n    constructor(symbolizer) {\n      this.symbolizer = symbolizer;\n    }\n    place(layout, geom, feature) {\n      const a = geom[0][0];\n      const placed = this.symbolizer.place(layout, [[new Point(0, 0)]], feature);\n      if (!placed || placed.length === 0) return void 0;\n      const firstLabel = placed[0];\n      const bbox = firstLabel.bboxes[0];\n      const width = bbox.maxX - bbox.minX;\n      const height = bbox.maxY - bbox.minY;\n      const centered = {\n        minX: a.x - width / 2,\n        maxX: a.x + width / 2,\n        minY: a.y - height / 2,\n        maxY: a.y + height / 2\n      };\n      const draw = /* @__PURE__ */ __name((ctx) => {\n        ctx.translate(-width / 2, height / 2 - bbox.maxY);\n        firstLabel.draw(ctx, { justify: 2 /* Center */ });\n      }, \"draw\");\n      return [{ anchor: a, bboxes: [centered], draw }];\n    }\n  };\n  __name(_CenteredSymbolizer, \"CenteredSymbolizer\");\n  var CenteredSymbolizer = _CenteredSymbolizer;\n  var _Padding = class _Padding {\n    constructor(padding, symbolizer) {\n      this.padding = new NumberAttr(padding, 0);\n      this.symbolizer = symbolizer;\n    }\n    place(layout, geom, feature) {\n      const placed = this.symbolizer.place(layout, geom, feature);\n      if (!placed || placed.length === 0) return void 0;\n      const padding = this.padding.get(layout.zoom, feature);\n      for (const label of placed) {\n        for (const bbox of label.bboxes) {\n          bbox.minX -= padding;\n          bbox.minY -= padding;\n          bbox.maxX += padding;\n          bbox.maxY += padding;\n        }\n      }\n      return placed;\n    }\n  };\n  __name(_Padding, \"Padding\");\n  var Padding = _Padding;\n  var _TextSymbolizer = class _TextSymbolizer {\n    constructor(options) {\n      this.font = new FontAttr(options);\n      this.text = new TextAttr(options);\n      this.fill = new StringAttr(options.fill, \"black\");\n      this.stroke = new StringAttr(options.stroke, \"black\");\n      this.width = new NumberAttr(options.width, 0);\n      this.lineHeight = new NumberAttr(options.lineHeight, 1);\n      this.letterSpacing = new NumberAttr(options.letterSpacing, 0);\n      this.maxLineCodeUnits = new NumberAttr(options.maxLineChars, 15);\n      this.justify = options.justify;\n    }\n    place(layout, geom, feature) {\n      const property = this.text.get(layout.zoom, feature);\n      if (!property) return void 0;\n      const font = this.font.get(layout.zoom, feature);\n      layout.scratch.font = font;\n      const letterSpacing = this.letterSpacing.get(layout.zoom, feature);\n      const lines = linebreak(\n        property,\n        this.maxLineCodeUnits.get(layout.zoom, feature)\n      );\n      let longestLine = \"\";\n      let longestLineLen = 0;\n      for (const line of lines) {\n        if (line.length > longestLineLen) {\n          longestLineLen = line.length;\n          longestLine = line;\n        }\n      }\n      const metrics = layout.scratch.measureText(longestLine);\n      const width = metrics.width + letterSpacing * (longestLineLen - 1);\n      const ascent = metrics.actualBoundingBoxAscent;\n      const descent = metrics.actualBoundingBoxDescent;\n      const lineHeight = (ascent + descent) * this.lineHeight.get(layout.zoom, feature);\n      const a = new Point(geom[0][0].x, geom[0][0].y);\n      const bbox = {\n        minX: a.x,\n        minY: a.y - ascent,\n        maxX: a.x + width,\n        maxY: a.y + descent + (lines.length - 1) * lineHeight\n      };\n      const draw = /* @__PURE__ */ __name((ctx, extra) => {\n        ctx.globalAlpha = 1;\n        ctx.font = font;\n        ctx.fillStyle = this.fill.get(layout.zoom, feature);\n        const textStrokeWidth = this.width.get(layout.zoom, feature);\n        let y = 0;\n        for (const line of lines) {\n          let startX = 0;\n          if (this.justify === 2 /* Center */ || extra && extra.justify === 2 /* Center */) {\n            startX = (width - ctx.measureText(line).width) / 2;\n          } else if (this.justify === 3 /* Right */ || extra && extra.justify === 3 /* Right */) {\n            startX = width - ctx.measureText(line).width;\n          }\n          if (textStrokeWidth) {\n            ctx.lineWidth = textStrokeWidth * 2;\n            ctx.strokeStyle = this.stroke.get(layout.zoom, feature);\n            if (letterSpacing > 0) {\n              let xPos = startX;\n              for (const letter of line) {\n                ctx.strokeText(letter, xPos, y);\n                xPos += ctx.measureText(letter).width + letterSpacing;\n              }\n            } else {\n              ctx.strokeText(line, startX, y);\n            }\n          }\n          if (letterSpacing > 0) {\n            let xPos = startX;\n            for (const letter of line) {\n              ctx.fillText(letter, xPos, y);\n              xPos += ctx.measureText(letter).width + letterSpacing;\n            }\n          } else {\n            ctx.fillText(line, startX, y);\n          }\n          y += lineHeight;\n        }\n      }, \"draw\");\n      return [{ anchor: a, bboxes: [bbox], draw }];\n    }\n  };\n  __name(_TextSymbolizer, \"TextSymbolizer\");\n  var TextSymbolizer = _TextSymbolizer;\n  var _CenteredTextSymbolizer = class _CenteredTextSymbolizer {\n    constructor(options) {\n      this.centered = new CenteredSymbolizer(new TextSymbolizer(options));\n    }\n    place(layout, geom, feature) {\n      return this.centered.place(layout, geom, feature);\n    }\n  };\n  __name(_CenteredTextSymbolizer, \"CenteredTextSymbolizer\");\n  var CenteredTextSymbolizer = _CenteredTextSymbolizer;\n  var _OffsetSymbolizer = class _OffsetSymbolizer {\n    constructor(symbolizer, options) {\n      var _a, _b, _c;\n      this.symbolizer = symbolizer;\n      this.offsetX = new NumberAttr(options.offsetX, 0);\n      this.offsetY = new NumberAttr(options.offsetY, 0);\n      this.justify = (_a = options.justify) != null ? _a : void 0;\n      this.placements = (_b = options.placements) != null ? _b : [\n        2 /* Ne */,\n        6 /* Sw */,\n        8 /* Nw */,\n        4 /* Se */,\n        1 /* N */,\n        3 /* E */,\n        5 /* S */,\n        7 /* W */\n      ];\n      this.ddValues = (_c = options.ddValues) != null ? _c : () => {\n        return {};\n      };\n    }\n    place(layout, geom, feature) {\n      if (feature.geomType !== 1 /* Point */) return void 0;\n      const anchor = geom[0][0];\n      const placed = this.symbolizer.place(layout, [[new Point(0, 0)]], feature);\n      if (!placed || placed.length === 0) return void 0;\n      const firstLabel = placed[0];\n      const fb = firstLabel.bboxes[0];\n      let offsetXvalue = this.offsetX;\n      let offsetYvalue = this.offsetY;\n      let justifyValue = this.justify;\n      let placements = this.placements;\n      const {\n        offsetX: ddOffsetX,\n        offsetY: ddOffsetY,\n        justify: ddJustify,\n        placements: ddPlacements\n      } = this.ddValues(layout.zoom, feature) || {};\n      if (ddOffsetX) offsetXvalue = new NumberAttr(ddOffsetX, 0);\n      if (ddOffsetY) offsetYvalue = new NumberAttr(ddOffsetY, 0);\n      if (ddJustify) justifyValue = ddJustify;\n      if (ddPlacements) placements = ddPlacements;\n      const offsetX = offsetXvalue.get(layout.zoom, feature);\n      const offsetY = offsetYvalue.get(layout.zoom, feature);\n      const getBbox = /* @__PURE__ */ __name((a, o) => {\n        return {\n          minX: a.x + o.x + fb.minX,\n          minY: a.y + o.y + fb.minY,\n          maxX: a.x + o.x + fb.maxX,\n          maxY: a.y + o.y + fb.maxY\n        };\n      }, \"getBbox\");\n      let origin = new Point(offsetX, offsetY);\n      let justify;\n      const draw = /* @__PURE__ */ __name((ctx) => {\n        ctx.translate(origin.x, origin.y);\n        firstLabel.draw(ctx, { justify });\n      }, \"draw\");\n      const placeLabelInPoint = /* @__PURE__ */ __name((a, o) => {\n        const bbox = getBbox(a, o);\n        if (!layout.index.bboxCollides(bbox, layout.order))\n          return [{ anchor, bboxes: [bbox], draw }];\n      }, \"placeLabelInPoint\");\n      for (const placement of placements) {\n        const xAxisOffset = this.computeXaxisOffset(offsetX, fb, placement);\n        const yAxisOffset = this.computeYaxisOffset(offsetY, fb, placement);\n        justify = this.computeJustify(justifyValue, placement);\n        origin = new Point(xAxisOffset, yAxisOffset);\n        return placeLabelInPoint(anchor, origin);\n      }\n      return void 0;\n    }\n    computeXaxisOffset(offsetX, fb, placement) {\n      const labelWidth = fb.maxX;\n      const labelHalfWidth = labelWidth / 2;\n      if ([1 /* N */, 5 /* S */].includes(placement))\n        return offsetX - labelHalfWidth;\n      if ([8 /* Nw */, 7 /* W */, 6 /* Sw */].includes(\n        placement\n      ))\n        return offsetX - labelWidth;\n      return offsetX;\n    }\n    computeYaxisOffset(offsetY, fb, placement) {\n      const labelHalfHeight = Math.abs(fb.minY);\n      const labelBottom = fb.maxY;\n      const labelCenterHeight = (fb.minY + fb.maxY) / 2;\n      if ([3 /* E */, 7 /* W */].includes(placement))\n        return offsetY - labelCenterHeight;\n      if ([8 /* Nw */, 2 /* Ne */, 1 /* N */].includes(\n        placement\n      ))\n        return offsetY - labelBottom;\n      if ([6 /* Sw */, 4 /* Se */, 5 /* S */].includes(\n        placement\n      ))\n        return offsetY + labelHalfHeight;\n      return offsetY;\n    }\n    computeJustify(fixedJustify, placement) {\n      if (fixedJustify) return fixedJustify;\n      if ([1 /* N */, 5 /* S */].includes(placement))\n        return 2 /* Center */;\n      if ([2 /* Ne */, 3 /* E */, 4 /* Se */].includes(\n        placement\n      ))\n        return 1 /* Left */;\n      return 3 /* Right */;\n    }\n  };\n  __name(_OffsetSymbolizer, \"OffsetSymbolizer\");\n  var OffsetSymbolizer = _OffsetSymbolizer;\n  var _OffsetTextSymbolizer = class _OffsetTextSymbolizer {\n    constructor(options) {\n      this.symbolizer = new OffsetSymbolizer(\n        new TextSymbolizer(options),\n        options\n      );\n    }\n    place(layout, geom, feature) {\n      return this.symbolizer.place(layout, geom, feature);\n    }\n  };\n  __name(_OffsetTextSymbolizer, \"OffsetTextSymbolizer\");\n  var OffsetTextSymbolizer = _OffsetTextSymbolizer;\n  var LineLabelPlacement = /* @__PURE__ */ ((LineLabelPlacement2) => {\n    LineLabelPlacement2[LineLabelPlacement2[\"Above\"] = 1] = \"Above\";\n    LineLabelPlacement2[LineLabelPlacement2[\"Center\"] = 2] = \"Center\";\n    LineLabelPlacement2[LineLabelPlacement2[\"Below\"] = 3] = \"Below\";\n    return LineLabelPlacement2;\n  })(LineLabelPlacement || {});\n  var _LineLabelSymbolizer = class _LineLabelSymbolizer {\n    constructor(options) {\n      var _a;\n      this.font = new FontAttr(options);\n      this.text = new TextAttr(options);\n      this.fill = new StringAttr(options.fill, \"black\");\n      this.stroke = new StringAttr(options.stroke, \"black\");\n      this.width = new NumberAttr(options.width, 0);\n      this.offset = new NumberAttr(options.offset, 0);\n      this.position = (_a = options.position) != null ? _a : 1 /* Above */;\n      this.maxLabelCodeUnits = new NumberAttr(options.maxLabelChars, 40);\n      this.repeatDistance = new NumberAttr(options.repeatDistance, 250);\n    }\n    place(layout, geom, feature) {\n      const name = this.text.get(layout.zoom, feature);\n      if (!name) return void 0;\n      if (name.length > this.maxLabelCodeUnits.get(layout.zoom, feature))\n        return void 0;\n      const minLabelableDim = 20;\n      const fbbox = feature.bbox;\n      if (fbbox.maxY - fbbox.minY < minLabelableDim && fbbox.maxX - fbbox.minX < minLabelableDim)\n        return void 0;\n      const font = this.font.get(layout.zoom, feature);\n      layout.scratch.font = font;\n      const metrics = layout.scratch.measureText(name);\n      const width = metrics.width;\n      const height = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n      let repeatDistance = this.repeatDistance.get(layout.zoom, feature);\n      if (layout.overzoom > 4) repeatDistance *= 1 << layout.overzoom - 4;\n      const cellSize = height * 2;\n      const labelCandidates = simpleLabel(geom, width, repeatDistance, cellSize);\n      if (labelCandidates.length === 0) return void 0;\n      const labels = [];\n      for (const candidate of labelCandidates) {\n        const dx = candidate.end.x - candidate.start.x;\n        const dy = candidate.end.y - candidate.start.y;\n        const cells = lineCells(\n          candidate.start,\n          candidate.end,\n          width,\n          cellSize / 2\n        );\n        const bboxes = cells.map((c) => {\n          return {\n            minX: c.x - cellSize / 2,\n            minY: c.y - cellSize / 2,\n            maxX: c.x + cellSize / 2,\n            maxY: c.y + cellSize / 2\n          };\n        });\n        const draw = /* @__PURE__ */ __name((ctx) => {\n          ctx.globalAlpha = 1;\n          ctx.rotate(Math.atan2(dy, dx));\n          if (dx < 0) {\n            ctx.scale(-1, -1);\n            ctx.translate(-width, 0);\n          }\n          let heightPlacement = 0;\n          if (this.position === 3 /* Below */)\n            heightPlacement += height;\n          else if (this.position === 2 /* Center */)\n            heightPlacement += height / 2;\n          ctx.translate(\n            0,\n            heightPlacement - this.offset.get(layout.zoom, feature)\n          );\n          ctx.font = font;\n          const lineWidth = this.width.get(layout.zoom, feature);\n          if (lineWidth) {\n            ctx.lineWidth = lineWidth;\n            ctx.strokeStyle = this.stroke.get(layout.zoom, feature);\n            ctx.strokeText(name, 0, 0);\n          }\n          ctx.fillStyle = this.fill.get(layout.zoom, feature);\n          ctx.fillText(name, 0, 0);\n        }, \"draw\");\n        labels.push({\n          anchor: candidate.start,\n          bboxes,\n          draw,\n          deduplicationKey: name,\n          deduplicationDistance: repeatDistance\n        });\n      }\n      return labels;\n    }\n  };\n  __name(_LineLabelSymbolizer, \"LineLabelSymbolizer\");\n  var LineLabelSymbolizer = _LineLabelSymbolizer;\n\n  // src/default_style/style.ts\n  var getString = /* @__PURE__ */ __name((props, key) => {\n    const val = props[key];\n    if (typeof val === \"string\") return val;\n    return \"\";\n  }, \"getString\");\n  var getNumber = /* @__PURE__ */ __name((props, key) => {\n    const val = props[key];\n    if (typeof val === \"number\") return val;\n    return 0;\n  }, \"getNumber\");\n  var paintRules = /* @__PURE__ */ __name((t) => {\n    return [\n      {\n        dataLayer: \"earth\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.earth\n        })\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: /* @__PURE__ */ __name((z, f) => {\n            return mix(t.park_a, t.park_b, Math.min(Math.max(z / 12, 12), 0));\n          }, \"fill\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"allotments\", \"village_green\", \"playground\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        // landuse_urban_green\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.park_b,\n          opacity: 0.7\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\n            \"national_park\",\n            \"park\",\n            \"cemetery\",\n            \"protected_area\",\n            \"nature_reserve\",\n            \"forest\",\n            \"golf_course\"\n          ].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.hospital\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"hospital\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.industrial\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"industrial\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.school\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"school\", \"university\", \"college\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.beach\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"beach\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.zoo\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"zoo\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.zoo\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"military\", \"naval_base\", \"airfield\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"natural\",\n        symbolizer: new PolygonSymbolizer({\n          fill: /* @__PURE__ */ __name((z, f) => {\n            return mix(t.wood_a, t.wood_b, Math.min(Math.max(z / 12, 12), 0));\n          }, \"fill\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"wood\", \"nature_reserve\", \"forest\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"natural\",\n        symbolizer: new PolygonSymbolizer({\n          fill: /* @__PURE__ */ __name((z, f) => {\n            return mix(t.scrub_a, t.scrub_b, Math.min(Math.max(z / 12, 12), 0));\n          }, \"fill\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"scrub\", \"grassland\", \"grass\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"natural\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.scrub_b\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"scrub\", \"grassland\", \"grass\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"natural\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.glacier\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"glacier\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"natural\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.sand\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"sand\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.aerodrome\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"aerodrome\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"water\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.water\n        })\n      },\n      {\n        // transit_runway\n        dataLayer: \"transit\",\n        symbolizer: new LineSymbolizer({\n          color: t.runway,\n          width: /* @__PURE__ */ __name((z, f) => {\n            return exp(1.6, [\n              [11, 0],\n              [13, 4],\n              [19, 30]\n            ])(z);\n          }, \"width\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind_detail\"] === \"runway\";\n        }, \"filter\")\n      },\n      {\n        // transit_taxiway\n        dataLayer: \"transit\",\n        symbolizer: new LineSymbolizer({\n          color: t.runway,\n          width: /* @__PURE__ */ __name((z, f) => {\n            return exp(1.6, [\n              [14, 0],\n              [14.5, 1],\n              [16, 6]\n            ])(z);\n          }, \"width\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind_detail\"] === \"taxiway\";\n        }, \"filter\")\n      },\n      {\n        // transit_pier\n        dataLayer: \"transit\",\n        symbolizer: new LineSymbolizer({\n          color: t.pier,\n          width: /* @__PURE__ */ __name((z, f) => {\n            return exp(1.6, [\n              [13, 0],\n              [13.5, 0, 5],\n              [21, 16]\n            ])(z);\n          }, \"width\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"pier\";\n        }, \"filter\")\n      },\n      {\n        // physical_line_river\n        dataLayer: \"physical_line\",\n        minzoom: 14,\n        symbolizer: new LineSymbolizer({\n          color: t.water,\n          width: /* @__PURE__ */ __name((z, f) => {\n            return exp(1.6, [\n              [9, 0],\n              [9.5, 1],\n              [18, 12]\n            ])(z);\n          }, \"width\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"river\";\n        }, \"filter\")\n      },\n      {\n        // physical_line_river\n        dataLayer: \"physical_line\",\n        minzoom: 14,\n        symbolizer: new LineSymbolizer({\n          color: t.water,\n          width: 0.5\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"stream\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.pedestrian\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"pedestrian\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"landuse\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.pier\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"pier\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"buildings\",\n        symbolizer: new PolygonSymbolizer({\n          fill: t.buildings,\n          opacity: 0.5\n        })\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineSymbolizer({\n          color: t.major,\n          width: /* @__PURE__ */ __name((z, f) => {\n            return exp(1.6, [\n              [14, 0],\n              [20, 7]\n            ])(z);\n          }, \"width\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"other\", \"path\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineSymbolizer({\n          color: t.major,\n          width: /* @__PURE__ */ __name((z, f) => {\n            return exp(1.6, [\n              [13, 0],\n              [18, 8]\n            ])(z);\n          }, \"width\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"minor_road\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineSymbolizer({\n          color: t.major,\n          width: /* @__PURE__ */ __name((z, f) => {\n            return exp(1.6, [\n              [7, 0],\n              [12, 1.2],\n              [15, 3],\n              [18, 13]\n            ])(z);\n          }, \"width\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"medium_road\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineSymbolizer({\n          color: t.major,\n          width: /* @__PURE__ */ __name((z, f) => {\n            return exp(1.6, [\n              [6, 0],\n              [12, 1.6],\n              [15, 3],\n              [18, 13]\n            ])(z);\n          }, \"width\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"major_road\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineSymbolizer({\n          color: t.major,\n          width: /* @__PURE__ */ __name((z, f) => {\n            return exp(1.6, [\n              [3, 0],\n              [6, 1.1],\n              [12, 1.6],\n              [15, 5],\n              [18, 15]\n            ])(z);\n          }, \"width\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"highway\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"boundaries\",\n        symbolizer: new LineSymbolizer({\n          dash: [3, 2],\n          color: t.boundaries,\n          width: 1\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const minAdminLevel = f.props[\"pmap:min_admin_level\"];\n          return typeof minAdminLevel === \"number\" && minAdminLevel <= 2;\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"transit\",\n        symbolizer: new LineSymbolizer({\n          dash: [0.3, 0.75],\n          color: t.railway,\n          dashWidth: /* @__PURE__ */ __name((z, f) => {\n            return exp(1.6, [\n              [4, 0],\n              [7, 0.15],\n              [19, 9]\n            ])(z);\n          }, \"dashWidth\"),\n          opacity: 0.5\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"rail\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"boundaries\",\n        symbolizer: new LineSymbolizer({\n          dash: [3, 2],\n          color: t.boundaries,\n          width: 0.5\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const minAdminLevel = f.props[\"pmap:min_admin_level\"];\n          return typeof minAdminLevel === \"number\" && minAdminLevel > 2;\n        }, \"filter\")\n      }\n    ];\n  }, \"paintRules\");\n  var labelRules = /* @__PURE__ */ __name((t) => {\n    const nametags = [\"name\"];\n    return [\n      // {\n      //   id: \"neighbourhood\",\n      //   dataLayer: \"places\",\n      //   symbolizer: languageStack(\n      //     new CenteredTextSymbolizer({\n      //       labelProps: nametags,\n      //       fill: params.neighbourhoodLabel,\n      //       font: \"500 10px sans-serif\",\n      //       textTransform: \"uppercase\",\n      //     }),\n      //     params.neighbourhoodLabel,\n      //   ),\n      //   filter: (z, f) => {\n      //     return f.props[\"pmap:kind\"] === \"neighbourhood\";\n      //   },\n      // },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineLabelSymbolizer({\n          labelProps: nametags,\n          fill: t.roads_label_minor,\n          font: \"400 12px sans-serif\",\n          width: 2,\n          stroke: t.roads_label_minor_halo\n        }),\n        // TODO: sort by minzoom\n        minzoom: 16,\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"minor_road\", \"other\", \"path\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineLabelSymbolizer({\n          labelProps: nametags,\n          fill: t.roads_label_major,\n          font: \"400 12px sans-serif\",\n          width: 2,\n          stroke: t.roads_label_major_halo\n        }),\n        // TODO: sort by minzoom\n        minzoom: 12,\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"highway\", \"major_road\", \"medium_road\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"roads\",\n        symbolizer: new LineLabelSymbolizer({\n          labelProps: nametags,\n          fill: t.roads_label_major,\n          font: \"400 12px sans-serif\",\n          width: 2,\n          stroke: t.roads_label_major_halo\n        }),\n        // TODO: sort by minzoom\n        minzoom: 12,\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"highway\", \"major_road\", \"medium_road\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"physical_point\",\n        symbolizer: new CenteredTextSymbolizer({\n          labelProps: nametags,\n          fill: t.ocean_label,\n          lineHeight: 1.5,\n          letterSpacing: 1,\n          font: /* @__PURE__ */ __name((z, f) => {\n            const size = linear([\n              [3, 10],\n              [10, 12]\n            ])(z);\n            return `400 ${size}px sans-serif`;\n          }, \"font\"),\n          textTransform: \"uppercase\"\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"ocean\", \"bay\", \"strait\", \"fjord\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"physical_point\",\n        symbolizer: new CenteredTextSymbolizer({\n          labelProps: nametags,\n          fill: t.ocean_label,\n          lineHeight: 1.5,\n          letterSpacing: 1,\n          font: /* @__PURE__ */ __name((z, f) => {\n            const size = linear([\n              [3, 0],\n              [6, 12],\n              [10, 12]\n            ])(z);\n            return `400 ${size}px sans-serif`;\n          }, \"font\")\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          const kind = getString(f.props, \"pmap:kind\");\n          return [\"sea\", \"lake\", \"water\"].includes(kind);\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"places\",\n        symbolizer: new CenteredTextSymbolizer({\n          labelProps: /* @__PURE__ */ __name((z, f) => {\n            if (z < 6) {\n              return [\"name:short\"];\n            }\n            return nametags;\n          }, \"labelProps\"),\n          fill: t.state_label,\n          stroke: t.state_label_halo,\n          width: 1,\n          lineHeight: 1.5,\n          font: /* @__PURE__ */ __name((z, f) => {\n            if (z < 6) return \"400 16px sans-serif\";\n            return \"400 12px sans-serif\";\n          }, \"font\"),\n          textTransform: \"uppercase\"\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"region\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"places\",\n        symbolizer: new CenteredTextSymbolizer({\n          labelProps: nametags,\n          fill: t.country_label,\n          lineHeight: 1.5,\n          font: /* @__PURE__ */ __name((z, f) => {\n            if (z < 6) return \"600 12px sans-serif\";\n            return \"600 12px sans-serif\";\n          }, \"font\"),\n          textTransform: \"uppercase\"\n        }),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"country\";\n        }, \"filter\")\n      },\n      {\n        // places_locality\n        dataLayer: \"places\",\n        minzoom: 9,\n        symbolizer: new CenteredTextSymbolizer({\n          labelProps: nametags,\n          fill: t.city_label,\n          lineHeight: 1.5,\n          font: /* @__PURE__ */ __name((z, f) => {\n            if (!f) return \"400 12px sans-serif\";\n            const minZoom = f.props[\"pmap:min_zoom\"];\n            let weight = 400;\n            if (minZoom && minZoom <= 5) {\n              weight = 600;\n            }\n            let size = 12;\n            const popRank = f.props[\"pmap:population_rank\"];\n            if (popRank && popRank > 9) {\n              size = 16;\n            }\n            return `${weight} ${size}px sans-serif`;\n          }, \"font\")\n        }),\n        sort: /* @__PURE__ */ __name((a, b) => {\n          const aRank = getNumber(a, \"pmap:population_rank\");\n          const bRank = getNumber(b, \"pmap:population_rank\");\n          return aRank - bRank;\n        }, \"sort\"),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"locality\";\n        }, \"filter\")\n      },\n      {\n        dataLayer: \"places\",\n        maxzoom: 8,\n        symbolizer: new GroupSymbolizer([\n          new CircleSymbolizer({\n            radius: 2,\n            fill: t.city_circle,\n            stroke: t.city_circle_stroke,\n            width: 1.5\n          }),\n          new OffsetTextSymbolizer({\n            labelProps: nametags,\n            fill: t.city_label,\n            stroke: t.city_label_halo,\n            width: 1,\n            offsetX: 6,\n            offsetY: 4.5,\n            font: /* @__PURE__ */ __name((z, f) => {\n              return \"400 12px sans-serif\";\n            }, \"font\")\n          })\n        ]),\n        filter: /* @__PURE__ */ __name((z, f) => {\n          return f.props[\"pmap:kind\"] === \"locality\";\n        }, \"filter\")\n      }\n    ];\n  }, \"labelRules\");\n\n  // src/default_style/themes.ts\n  var LIGHT = {\n    background: \"#cccccc\",\n    earth: \"#e0e0e0\",\n    park_a: \"#cfddd5\",\n    park_b: \"#9cd3b4\",\n    hospital: \"#e4dad9\",\n    industrial: \"#d1dde1\",\n    school: \"#e4ded7\",\n    wood_a: \"#d0ded0\",\n    wood_b: \"#a0d9a0\",\n    pedestrian: \"#e3e0d4\",\n    scrub_a: \"#cedcd7\",\n    scrub_b: \"#99d2bb\",\n    glacier: \"#e7e7e7\",\n    sand: \"#e2e0d7\",\n    beach: \"#e8e4d0\",\n    aerodrome: \"#dadbdf\",\n    runway: \"#e9e9ed\",\n    water: \"#80deea\",\n    pier: \"#e0e0e0\",\n    zoo: \"#c6dcdc\",\n    military: \"#dcdcdc\",\n    tunnel_other_casing: \"#e0e0e0\",\n    tunnel_minor_casing: \"#e0e0e0\",\n    tunnel_link_casing: \"#e0e0e0\",\n    tunnel_medium_casing: \"#e0e0e0\",\n    tunnel_major_casing: \"#e0e0e0\",\n    tunnel_highway_casing: \"#e0e0e0\",\n    tunnel_other: \"#d5d5d5\",\n    tunnel_minor: \"#d5d5d5\",\n    tunnel_link: \"#d5d5d5\",\n    tunnel_medium: \"#d5d5d5\",\n    tunnel_major: \"#d5d5d5\",\n    tunnel_highway: \"#d5d5d5\",\n    transit_pier: \"#e0e0e0\",\n    buildings: \"#cccccc\",\n    minor_service_casing: \"#e0e0e0\",\n    minor_casing: \"#e0e0e0\",\n    link_casing: \"#e0e0e0\",\n    medium_casing: \"#e0e0e0\",\n    major_casing_late: \"#e0e0e0\",\n    highway_casing_late: \"#e0e0e0\",\n    other: \"#ebebeb\",\n    minor_service: \"#ebebeb\",\n    minor_a: \"#ebebeb\",\n    minor_b: \"#ffffff\",\n    link: \"#ffffff\",\n    medium: \"#f5f5f5\",\n    major_casing_early: \"#e0e0e0\",\n    major: \"#ffffff\",\n    highway_casing_early: \"#e0e0e0\",\n    highway: \"#ffffff\",\n    railway: \"#a7b1b3\",\n    boundaries: \"#adadad\",\n    waterway_label: \"#ffffff\",\n    bridges_other_casing: \"#e0e0e0\",\n    bridges_minor_casing: \"#e0e0e0\",\n    bridges_link_casing: \"#e0e0e0\",\n    bridges_medium_casing: \"#e0e0e0\",\n    bridges_major_casing: \"#e0e0e0\",\n    bridges_highway_casing: \"#e0e0e0\",\n    bridges_other: \"#ebebeb\",\n    bridges_minor: \"#ffffff\",\n    bridges_link: \"#ffffff\",\n    bridges_medium: \"#f0eded\",\n    bridges_major: \"#f5f5f5\",\n    bridges_highway: \"#ffffff\",\n    roads_label_minor: \"#91888b\",\n    roads_label_minor_halo: \"#ffffff\",\n    roads_label_major: \"#938a8d\",\n    roads_label_major_halo: \"#ffffff\",\n    ocean_label: \"#ffffff\",\n    peak_label: \"#7e9aa0\",\n    subplace_label: \"#8f8f8f\",\n    subplace_label_halo: \"#e0e0e0\",\n    city_circle: \"#ffffff\",\n    city_circle_stroke: \"#a3a3a3\",\n    city_label: \"#5c5c5c\",\n    city_label_halo: \"#e0e0e0\",\n    state_label: \"#b3b3b3\",\n    state_label_halo: \"#e0e0e0\",\n    country_label: \"#a3a3a3\"\n  };\n  var DARK = {\n    background: \"#34373d\",\n    earth: \"#1f1f1f\",\n    park_a: \"#232325\",\n    park_b: \"#232325\",\n    hospital: \"#252424\",\n    industrial: \"#222222\",\n    school: \"#262323\",\n    wood_a: \"#202121\",\n    wood_b: \"#202121\",\n    pedestrian: \"#1e1e1e\",\n    scrub_a: \"#222323\",\n    scrub_b: \"#222323\",\n    glacier: \"#1c1c1c\",\n    sand: \"#212123\",\n    beach: \"#28282a\",\n    aerodrome: \"#1e1e1e\",\n    runway: \"#333333\",\n    water: \"#34373d\",\n    pier: \"#222222\",\n    zoo: \"#222323\",\n    military: \"#242323\",\n    tunnel_other_casing: \"#141414\",\n    tunnel_minor_casing: \"#141414\",\n    tunnel_link_casing: \"#141414\",\n    tunnel_medium_casing: \"#141414\",\n    tunnel_major_casing: \"#141414\",\n    tunnel_highway_casing: \"#141414\",\n    tunnel_other: \"#292929\",\n    tunnel_minor: \"#292929\",\n    tunnel_link: \"#292929\",\n    tunnel_medium: \"#292929\",\n    tunnel_major: \"#292929\",\n    tunnel_highway: \"#292929\",\n    transit_pier: \"#333333\",\n    buildings: \"#111111\",\n    minor_service_casing: \"#1f1f1f\",\n    minor_casing: \"#1f1f1f\",\n    link_casing: \"#1f1f1f\",\n    medium_casing: \"#1f1f1f\",\n    major_casing_late: \"#1f1f1f\",\n    highway_casing_late: \"#1f1f1f\",\n    other: \"#333333\",\n    minor_service: \"#333333\",\n    minor_a: \"#3d3d3d\",\n    minor_b: \"#333333\",\n    link: \"#3d3d3d\",\n    medium: \"#3d3d3d\",\n    major_casing_early: \"#1f1f1f\",\n    major: \"#3d3d3d\",\n    highway_casing_early: \"#1f1f1f\",\n    highway: \"#474747\",\n    railway: \"#000000\",\n    boundaries: \"#5b6374\",\n    waterway_label: \"#717784\",\n    bridges_other_casing: \"#2b2b2b\",\n    bridges_minor_casing: \"#1f1f1f\",\n    bridges_link_casing: \"#1f1f1f\",\n    bridges_medium_casing: \"#1f1f1f\",\n    bridges_major_casing: \"#1f1f1f\",\n    bridges_highway_casing: \"#1f1f1f\",\n    bridges_other: \"#333333\",\n    bridges_minor: \"#333333\",\n    bridges_link: \"#3d3d3d\",\n    bridges_medium: \"#3d3d3d\",\n    bridges_major: \"#3d3d3d\",\n    bridges_highway: \"#474747\",\n    roads_label_minor: \"#525252\",\n    roads_label_minor_halo: \"#1f1f1f\",\n    roads_label_major: \"#666666\",\n    roads_label_major_halo: \"#1f1f1f\",\n    ocean_label: \"#717784\",\n    peak_label: \"#898080\",\n    subplace_label: \"#525252\",\n    subplace_label_halo: \"#1f1f1f\",\n    city_circle: \"#000000\",\n    city_circle_stroke: \"#7a7a7a\",\n    city_label: \"#7a7a7a\",\n    city_label_halo: \"#212121\",\n    state_label: \"#3d3d3d\",\n    state_label_halo: \"#1f1f1f\",\n    country_label: \"#5c5c5c\"\n  };\n  var WHITE = {\n    background: \"#ffffff\",\n    earth: \"#ffffff\",\n    park_a: \"#fcfcfc\",\n    park_b: \"#fcfcfc\",\n    hospital: \"#f8f8f8\",\n    industrial: \"#fcfcfc\",\n    school: \"#f8f8f8\",\n    wood_a: \"#fafafa\",\n    wood_b: \"#fafafa\",\n    pedestrian: \"#fdfdfd\",\n    scrub_a: \"#fafafa\",\n    scrub_b: \"#fafafa\",\n    glacier: \"#fcfcfc\",\n    sand: \"#fafafa\",\n    beach: \"#f6f6f6\",\n    aerodrome: \"#fdfdfd\",\n    runway: \"#efefef\",\n    water: \"#dcdcdc\",\n    pier: \"#f5f5f5\",\n    zoo: \"#f7f7f7\",\n    military: \"#fcfcfc\",\n    tunnel_other_casing: \"#d6d6d6\",\n    tunnel_minor_casing: \"#fcfcfc\",\n    tunnel_link_casing: \"#fcfcfc\",\n    tunnel_medium_casing: \"#fcfcfc\",\n    tunnel_major_casing: \"#fcfcfc\",\n    tunnel_highway_casing: \"#fcfcfc\",\n    tunnel_other: \"#d6d6d6\",\n    tunnel_minor: \"#d6d6d6\",\n    tunnel_link: \"#d6d6d6\",\n    tunnel_medium: \"#d6d6d6\",\n    tunnel_major: \"#d6d6d6\",\n    tunnel_highway: \"#d6d6d6\",\n    transit_pier: \"#efefef\",\n    buildings: \"#efefef\",\n    minor_service_casing: \"#ffffff\",\n    minor_casing: \"#ffffff\",\n    link_casing: \"#ffffff\",\n    medium_casing: \"#ffffff\",\n    major_casing_late: \"#ffffff\",\n    highway_casing_late: \"#ffffff\",\n    other: \"#f5f5f5\",\n    minor_service: \"#f5f5f5\",\n    minor_a: \"#ebebeb\",\n    minor_b: \"#f5f5f5\",\n    link: \"#ebebeb\",\n    medium: \"#ebebeb\",\n    major_casing_early: \"#ffffff\",\n    major: \"#ebebeb\",\n    highway_casing_early: \"#ffffff\",\n    highway: \"#ebebeb\",\n    railway: \"#d6d6d6\",\n    boundaries: \"#adadad\",\n    waterway_label: \"#adadad\",\n    bridges_other_casing: \"#ffffff\",\n    bridges_minor_casing: \"#ffffff\",\n    bridges_link_casing: \"#ffffff\",\n    bridges_medium_casing: \"#ffffff\",\n    bridges_major_casing: \"#ffffff\",\n    bridges_highway_casing: \"#ffffff\",\n    bridges_other: \"#f5f5f5\",\n    bridges_minor: \"#f5f5f5\",\n    bridges_link: \"#ebebeb\",\n    bridges_medium: \"#ebebeb\",\n    bridges_major: \"#ebebeb\",\n    bridges_highway: \"#ebebeb\",\n    roads_label_minor: \"#adadad\",\n    roads_label_minor_halo: \"#ffffff\",\n    roads_label_major: \"#999999\",\n    roads_label_major_halo: \"#ffffff\",\n    ocean_label: \"#adadad\",\n    peak_label: \"#adadad\",\n    subplace_label: \"#8f8f8f\",\n    subplace_label_halo: \"#ffffff\",\n    city_circle: \"#ffffff\",\n    city_circle_stroke: \"#adadad\",\n    city_label: \"#5c5c5c\",\n    city_label_halo: \"#ffffff\",\n    state_label: \"#b3b3b3\",\n    state_label_halo: \"#ffffff\",\n    country_label: \"#b8b8b8\"\n  };\n  var GRAYSCALE = {\n    background: \"#a3a3a3\",\n    earth: \"#cccccc\",\n    park_a: \"#c2c2c2\",\n    park_b: \"#c2c2c2\",\n    hospital: \"#d0d0d0\",\n    industrial: \"#c6c6c6\",\n    school: \"#d0d0d0\",\n    wood_a: \"#c2c2c2\",\n    wood_b: \"#c2c2c2\",\n    pedestrian: \"#c4c4c4\",\n    scrub_a: \"#c2c2c2\",\n    scrub_b: \"#c2c2c2\",\n    glacier: \"#d2d2d2\",\n    sand: \"#d2d2d2\",\n    beach: \"#d2d2d2\",\n    aerodrome: \"#c9c9c9\",\n    runway: \"#f5f5f5\",\n    water: \"#a3a3a3\",\n    pier: \"#b8b8b8\",\n    zoo: \"#c7c7c7\",\n    military: \"#bfbfbf\",\n    tunnel_other_casing: \"#b8b8b8\",\n    tunnel_minor_casing: \"#b8b8b8\",\n    tunnel_link_casing: \"#b8b8b8\",\n    tunnel_medium_casing: \"#b8b8b8\",\n    tunnel_major_casing: \"#b8b8b8\",\n    tunnel_highway_casing: \"#b8b8b8\",\n    tunnel_other: \"#d6d6d6\",\n    tunnel_minor: \"#d6d6d6\",\n    tunnel_link: \"#d6d6d6\",\n    tunnel_medium: \"#d6d6d6\",\n    tunnel_major: \"#d6d6d6\",\n    tunnel_highway: \"#d6d6d6\",\n    transit_pier: \"#b8b8b8\",\n    buildings: \"#e0e0e0\",\n    minor_service_casing: \"#cccccc\",\n    minor_casing: \"#cccccc\",\n    link_casing: \"#cccccc\",\n    medium_casing: \"#cccccc\",\n    major_casing_late: \"#cccccc\",\n    highway_casing_late: \"#cccccc\",\n    other: \"#e0e0e0\",\n    minor_service: \"#e0e0e0\",\n    minor_a: \"#ebebeb\",\n    minor_b: \"#e0e0e0\",\n    link: \"#ebebeb\",\n    medium: \"#ebebeb\",\n    major_casing_early: \"#cccccc\",\n    major: \"#ebebeb\",\n    highway_casing_early: \"#cccccc\",\n    highway: \"#ebebeb\",\n    railway: \"#f5f5f5\",\n    boundaries: \"#5c5c5c\",\n    waterway_label: \"#7a7a7a\",\n    bridges_other_casing: \"#cccccc\",\n    bridges_minor_casing: \"#cccccc\",\n    bridges_link_casing: \"#cccccc\",\n    bridges_medium_casing: \"#cccccc\",\n    bridges_major_casing: \"#cccccc\",\n    bridges_highway_casing: \"#cccccc\",\n    bridges_other: \"#e0e0e0\",\n    bridges_minor: \"#e0e0e0\",\n    bridges_link: \"#ebebeb\",\n    bridges_medium: \"#ebebeb\",\n    bridges_major: \"#ebebeb\",\n    bridges_highway: \"#ebebeb\",\n    roads_label_minor: \"#999999\",\n    roads_label_minor_halo: \"#e0e0e0\",\n    roads_label_major: \"#8f8f8f\",\n    roads_label_major_halo: \"#ebebeb\",\n    ocean_label: \"#7a7a7a\",\n    peak_label: \"#5c5c5c\",\n    subplace_label: \"#7a7a7a\",\n    subplace_label_halo: \"#cccccc\",\n    city_circle: \"#c2c2c2\",\n    city_circle_stroke: \"#7a7a7a\",\n    city_label: \"#474747\",\n    city_label_halo: \"#cccccc\",\n    state_label: \"#999999\",\n    state_label_halo: \"#cccccc\",\n    country_label: \"#858585\"\n  };\n  var BLACK = {\n    background: \"#2b2b2b\",\n    earth: \"#141414\",\n    park_a: \"#181818\",\n    park_b: \"#181818\",\n    hospital: \"#1d1d1d\",\n    industrial: \"#101010\",\n    school: \"#111111\",\n    wood_a: \"#1a1a1a\",\n    wood_b: \"#1a1a1a\",\n    pedestrian: \"#191919\",\n    scrub_a: \"#1c1c1c\",\n    scrub_b: \"#1c1c1c\",\n    glacier: \"#191919\",\n    sand: \"#161616\",\n    beach: \"#1f1f1f\",\n    aerodrome: \"#191919\",\n    runway: \"#323232\",\n    water: \"#333333\",\n    pier: \"#0a0a0a\",\n    zoo: \"#191919\",\n    military: \"#121212\",\n    tunnel_other_casing: \"#101010\",\n    tunnel_minor_casing: \"#101010\",\n    tunnel_link_casing: \"#101010\",\n    tunnel_medium_casing: \"#101010\",\n    tunnel_major_casing: \"#101010\",\n    tunnel_highway_casing: \"#101010\",\n    tunnel_other: \"#292929\",\n    tunnel_minor: \"#292929\",\n    tunnel_link: \"#292929\",\n    tunnel_medium: \"#292929\",\n    tunnel_major: \"#292929\",\n    tunnel_highway: \"#292929\",\n    transit_pier: \"#0a0a0a\",\n    buildings: \"#0a0a0a\",\n    minor_service_casing: \"#141414\",\n    minor_casing: \"#141414\",\n    link_casing: \"#141414\",\n    medium_casing: \"#141414\",\n    major_casing_late: \"#141414\",\n    highway_casing_late: \"#141414\",\n    other: \"#1f1f1f\",\n    minor_service: \"#1f1f1f\",\n    minor_a: \"#292929\",\n    minor_b: \"#1f1f1f\",\n    link: \"#1f1f1f\",\n    medium: \"#292929\",\n    major_casing_early: \"#141414\",\n    major: \"#292929\",\n    highway_casing_early: \"#141414\",\n    highway: \"#292929\",\n    railway: \"#292929\",\n    boundaries: \"#707070\",\n    waterway_label: \"#707070\",\n    bridges_other_casing: \"#141414\",\n    bridges_minor_casing: \"#141414\",\n    bridges_link_casing: \"#141414\",\n    bridges_medium_casing: \"#141414\",\n    bridges_major_casing: \"#141414\",\n    bridges_highway_casing: \"#141414\",\n    bridges_other: \"#1f1f1f\",\n    bridges_minor: \"#1f1f1f\",\n    bridges_link: \"#292929\",\n    bridges_medium: \"#292929\",\n    bridges_major: \"#292929\",\n    bridges_highway: \"#292929\",\n    roads_label_minor: \"#525252\",\n    roads_label_minor_halo: \"#141414\",\n    roads_label_major: \"#5c5c5c\",\n    roads_label_major_halo: \"#141414\",\n    ocean_label: \"#707070\",\n    peak_label: \"#707070\",\n    subplace_label: \"#5c5c5c\",\n    subplace_label_halo: \"#141414\",\n    city_circle: \"#000000\",\n    city_circle_stroke: \"#666666\",\n    city_label: \"#999999\",\n    city_label_halo: \"#141414\",\n    state_label: \"#3d3d3d\",\n    state_label_halo: \"#141414\",\n    country_label: \"#707070\"\n  };\n  var themes = {\n    light: LIGHT,\n    dark: DARK,\n    white: WHITE,\n    grayscale: GRAYSCALE,\n    black: BLACK\n  };\n  var transformGeom = /* @__PURE__ */ __name((geom, scale, translate) => {\n    const retval = [];\n    for (const arr2 of geom) {\n      const loop = [];\n      for (const coord of arr2) {\n        loop.push(coord.clone().mult(scale).add(translate));\n      }\n      retval.push(loop);\n    }\n    return retval;\n  }, \"transformGeom\");\n  var wrap = /* @__PURE__ */ __name((val, z) => {\n    const dim = 1 << z;\n    if (val < 0) return dim + val;\n    if (val >= dim) return val % dim;\n    return val;\n  }, \"wrap\");\n  var _View = class _View {\n    constructor(tileCache, maxDataLevel, levelDiff) {\n      this.tileCache = tileCache;\n      this.maxDataLevel = maxDataLevel;\n      this.levelDiff = levelDiff;\n    }\n    dataTilesForBounds(displayZoom, bounds) {\n      const fractional = __pow(2, displayZoom) / __pow(2, Math.ceil(displayZoom));\n      const needed = [];\n      let scale = 1;\n      const dim = this.tileCache.tileSize;\n      if (displayZoom < this.levelDiff) {\n        scale = 1 / (1 << this.levelDiff - displayZoom) * fractional;\n        needed.push({\n          dataTile: { z: 0, x: 0, y: 0 },\n          origin: new Point(0, 0),\n          scale,\n          dim: dim * scale\n        });\n      } else if (displayZoom <= this.levelDiff + this.maxDataLevel) {\n        const f = 1 << this.levelDiff;\n        const basetileSize = 256 * fractional;\n        const dataZoom = Math.ceil(displayZoom) - this.levelDiff;\n        const mintileX = Math.floor(bounds.minX / f / basetileSize);\n        const mintileY = Math.floor(bounds.minY / f / basetileSize);\n        const maxtileX = Math.floor(bounds.maxX / f / basetileSize);\n        const maxtileY = Math.floor(bounds.maxY / f / basetileSize);\n        for (let tx = mintileX; tx <= maxtileX; tx++) {\n          for (let ty = mintileY; ty <= maxtileY; ty++) {\n            const origin = new Point(\n              tx * f * basetileSize,\n              ty * f * basetileSize\n            );\n            needed.push({\n              dataTile: {\n                z: dataZoom,\n                x: wrap(tx, dataZoom),\n                y: wrap(ty, dataZoom)\n              },\n              origin,\n              scale: fractional,\n              dim: dim * fractional\n            });\n          }\n        }\n      } else {\n        const f = 1 << this.levelDiff;\n        scale = (1 << Math.ceil(displayZoom) - this.maxDataLevel - this.levelDiff) * fractional;\n        const mintileX = Math.floor(bounds.minX / f / 256 / scale);\n        const mintileY = Math.floor(bounds.minY / f / 256 / scale);\n        const maxtileX = Math.floor(bounds.maxX / f / 256 / scale);\n        const maxtileY = Math.floor(bounds.maxY / f / 256 / scale);\n        for (let tx = mintileX; tx <= maxtileX; tx++) {\n          for (let ty = mintileY; ty <= maxtileY; ty++) {\n            const origin = new Point(tx * f * 256 * scale, ty * f * 256 * scale);\n            needed.push({\n              dataTile: {\n                z: this.maxDataLevel,\n                x: wrap(tx, this.maxDataLevel),\n                y: wrap(ty, this.maxDataLevel)\n              },\n              origin,\n              scale,\n              dim: dim * scale\n            });\n          }\n        }\n      }\n      return needed;\n    }\n    dataTileForDisplayTile(displayTile) {\n      let dataTile;\n      let scale = 1;\n      let dim = this.tileCache.tileSize;\n      let origin;\n      if (displayTile.z < this.levelDiff) {\n        dataTile = { z: 0, x: 0, y: 0 };\n        scale = 1 / (1 << this.levelDiff - displayTile.z);\n        origin = new Point(0, 0);\n        dim = dim * scale;\n      } else if (displayTile.z <= this.levelDiff + this.maxDataLevel) {\n        const f = 1 << this.levelDiff;\n        dataTile = {\n          z: displayTile.z - this.levelDiff,\n          x: Math.floor(displayTile.x / f),\n          y: Math.floor(displayTile.y / f)\n        };\n        origin = new Point(dataTile.x * f * 256, dataTile.y * f * 256);\n      } else {\n        scale = 1 << displayTile.z - this.maxDataLevel - this.levelDiff;\n        const f = 1 << this.levelDiff;\n        dataTile = {\n          z: this.maxDataLevel,\n          x: Math.floor(displayTile.x / f / scale),\n          y: Math.floor(displayTile.y / f / scale)\n        };\n        origin = new Point(\n          dataTile.x * f * scale * 256,\n          dataTile.y * f * scale * 256\n        );\n        dim = dim * scale;\n      }\n      return { dataTile, scale, origin, dim };\n    }\n    getBbox(displayZoom, bounds) {\n      return __async(this, null, function* () {\n        const needed = this.dataTilesForBounds(displayZoom, bounds);\n        const result = yield Promise.all(\n          needed.map((tt) => this.tileCache.get(tt.dataTile))\n        );\n        return result.map((data, i) => {\n          const tt = needed[i];\n          return {\n            data,\n            z: displayZoom,\n            dataTile: tt.dataTile,\n            scale: tt.scale,\n            dim: tt.dim,\n            origin: tt.origin\n          };\n        });\n      });\n    }\n    getDisplayTile(displayTile) {\n      return __async(this, null, function* () {\n        const tt = this.dataTileForDisplayTile(displayTile);\n        const data = yield this.tileCache.get(tt.dataTile);\n        return {\n          data,\n          z: displayTile.z,\n          dataTile: tt.dataTile,\n          scale: tt.scale,\n          origin: tt.origin,\n          dim: tt.dim\n        };\n      });\n    }\n    queryFeatures(lng, lat, displayZoom, brushSize) {\n      const roundedZoom = Math.round(displayZoom);\n      const dataZoom = Math.min(roundedZoom - this.levelDiff, this.maxDataLevel);\n      const brushSizeAtZoom = brushSize / (1 << roundedZoom - dataZoom);\n      return this.tileCache.queryFeatures(lng, lat, dataZoom, brushSizeAtZoom);\n    }\n  };\n  __name(_View, \"View\");\n  var View = _View;\n  var sourcesToViews = /* @__PURE__ */ __name((options) => {\n    const sourceToViews = /* @__PURE__ */ __name((o) => {\n      const levelDiff = o.levelDiff === void 0 ? 1 : o.levelDiff;\n      const maxDataZoom = o.maxDataZoom || 15;\n      let source;\n      if (typeof o.url === \"string\") {\n        if (new URL(o.url, \"http://example.com\").pathname.endsWith(\".pmtiles\")) {\n          source = new PmtilesSource(o.url, true);\n        } else {\n          source = new ZxySource(o.url, true);\n        }\n      } else if (o.url) {\n        source = new PmtilesSource(o.url, true);\n      } else {\n        throw new Error(`Invalid source ${o.url}`);\n      }\n      const cache = new TileCache(source, 256 * 1 << levelDiff);\n      return new View(cache, maxDataZoom, levelDiff);\n    }, \"sourceToViews\");\n    const sources = /* @__PURE__ */ new Map();\n    if (options.sources) {\n      for (const key in options.sources) {\n        sources.set(key, sourceToViews(options.sources[key]));\n      }\n    } else {\n      sources.set(\"\", sourceToViews(options));\n    }\n    return sources;\n  }, \"sourcesToViews\");\n\n  // src/labeler.ts\n  var covering = /* @__PURE__ */ __name((displayZoom, tileWidth, bbox) => {\n    const res = 256;\n    const f = tileWidth / res;\n    const minx = Math.floor(bbox.minX / res);\n    const miny = Math.floor(bbox.minY / res);\n    const maxx = Math.floor(bbox.maxX / res);\n    const maxy = Math.floor(bbox.maxY / res);\n    const leveldiff = Math.log2(f);\n    const retval = [];\n    for (let x = minx; x <= maxx; x++) {\n      const wrappedX = x % (1 << displayZoom);\n      for (let y = miny; y <= maxy; y++) {\n        retval.push({\n          display: toIndex({ z: displayZoom, x: wrappedX, y }),\n          key: toIndex({\n            z: displayZoom - leveldiff,\n            x: Math.floor(wrappedX / f),\n            y: Math.floor(y / f)\n          })\n        });\n      }\n    }\n    return retval;\n  }, \"covering\");\n  var _Index = class _Index {\n    constructor(dim, maxLabeledTiles) {\n      this.tree = new RBush();\n      this.current = /* @__PURE__ */ new Map();\n      this.dim = dim;\n      this.maxLabeledTiles = maxLabeledTiles;\n    }\n    hasPrefix(tileKey) {\n      for (const key of this.current.keys()) {\n        if (key.startsWith(tileKey)) return true;\n      }\n      return false;\n    }\n    has(tileKey) {\n      return this.current.has(tileKey);\n    }\n    size() {\n      return this.current.size;\n    }\n    keys() {\n      return this.current.keys();\n    }\n    searchBbox(bbox, order) {\n      const labels = /* @__PURE__ */ new Set();\n      for (const match of this.tree.search(bbox)) {\n        if (match.indexedLabel.order <= order) {\n          labels.add(match.indexedLabel);\n        }\n      }\n      return labels;\n    }\n    searchLabel(label, order) {\n      const labels = /* @__PURE__ */ new Set();\n      for (const bbox of label.bboxes) {\n        for (const match of this.tree.search(bbox)) {\n          if (match.indexedLabel.order <= order) {\n            labels.add(match.indexedLabel);\n          }\n        }\n      }\n      return labels;\n    }\n    bboxCollides(bbox, order) {\n      for (const match of this.tree.search(bbox)) {\n        if (match.indexedLabel.order <= order) return true;\n      }\n      return false;\n    }\n    labelCollides(label, order) {\n      for (const bbox of label.bboxes) {\n        for (const match of this.tree.search(bbox)) {\n          if (match.indexedLabel.order <= order) return true;\n        }\n      }\n      return false;\n    }\n    deduplicationCollides(label) {\n      if (!label.deduplicationKey || !label.deduplicationDistance) return false;\n      const dist = label.deduplicationDistance;\n      const testBbox = {\n        minX: label.anchor.x - dist,\n        minY: label.anchor.y - dist,\n        maxX: label.anchor.x + dist,\n        maxY: label.anchor.y + dist\n      };\n      for (const collision of this.tree.search(testBbox)) {\n        if (collision.indexedLabel.deduplicationKey === label.deduplicationKey) {\n          if (collision.indexedLabel.anchor.dist(label.anchor) < dist) {\n            return true;\n          }\n        }\n      }\n      return false;\n    }\n    makeEntry(tileKey) {\n      if (this.current.get(tileKey)) {\n        console.log(\"consistency error 1\");\n      }\n      const newSet = /* @__PURE__ */ new Set();\n      this.current.set(tileKey, newSet);\n    }\n    // can put in multiple due to antimeridian wrapping\n    insert(label, order, tileKey) {\n      const indexedLabel = {\n        anchor: label.anchor,\n        bboxes: label.bboxes,\n        draw: label.draw,\n        order,\n        tileKey,\n        deduplicationKey: label.deduplicationKey,\n        deduplicationDistance: label.deduplicationDistance\n      };\n      let entry = this.current.get(tileKey);\n      if (!entry) {\n        const newSet = /* @__PURE__ */ new Set();\n        this.current.set(tileKey, newSet);\n        entry = newSet;\n      }\n      entry.add(indexedLabel);\n      let wrapsLeft = false;\n      let wrapsRight = false;\n      for (const bbox of label.bboxes) {\n        this.tree.insert({\n          minX: bbox.minX,\n          minY: bbox.minY,\n          maxX: bbox.maxX,\n          maxY: bbox.maxY,\n          indexedLabel\n        });\n        if (bbox.minX < 0) wrapsLeft = true;\n        if (bbox.maxX > this.dim) wrapsRight = true;\n      }\n      if (wrapsLeft || wrapsRight) {\n        const shift = wrapsLeft ? this.dim : -this.dim;\n        const newBboxes = [];\n        for (const bbox of label.bboxes) {\n          newBboxes.push({\n            minX: bbox.minX + shift,\n            minY: bbox.minY,\n            maxX: bbox.maxX + shift,\n            maxY: bbox.maxY\n          });\n        }\n        const duplicateLabel = {\n          anchor: new Point(label.anchor.x + shift, label.anchor.y),\n          bboxes: newBboxes,\n          draw: label.draw,\n          order,\n          tileKey\n        };\n        const entry2 = this.current.get(tileKey);\n        if (entry2) entry2.add(duplicateLabel);\n        for (const bbox of newBboxes) {\n          this.tree.insert({\n            minX: bbox.minX,\n            minY: bbox.minY,\n            maxX: bbox.maxX,\n            maxY: bbox.maxY,\n            indexedLabel: duplicateLabel\n          });\n        }\n      }\n    }\n    pruneOrNoop(keyAdded) {\n      const added = keyAdded.split(\":\");\n      let maxKey = void 0;\n      let maxDist = 0;\n      let keysForDs = 0;\n      for (const existingKey of this.current.keys()) {\n        const existing = existingKey.split(\":\");\n        if (existing[3] === added[3]) {\n          keysForDs++;\n          const dist = Math.sqrt(\n            __pow(+existing[0] - +added[0], 2) + __pow(+existing[1] - +added[1], 2)\n          );\n          if (dist > maxDist) {\n            maxDist = dist;\n            maxKey = existingKey;\n          }\n        }\n        if (maxKey && keysForDs > this.maxLabeledTiles) {\n          this.pruneKey(maxKey);\n        }\n      }\n    }\n    pruneKey(keyToRemove) {\n      const indexedLabels = this.current.get(keyToRemove);\n      if (!indexedLabels) return;\n      const entriesToDelete = [];\n      for (const entry of this.tree.all()) {\n        if (indexedLabels.has(entry.indexedLabel)) {\n          entriesToDelete.push(entry);\n        }\n      }\n      for (const entry of entriesToDelete) {\n        this.tree.remove(entry);\n      }\n      this.current.delete(keyToRemove);\n    }\n    // NOTE: technically this is incorrect\n    // with antimeridian wrapping, since we should also remove\n    // the duplicate label; but i am having a hard time\n    // imagining where this will happen in practical usage\n    removeLabel(labelToRemove) {\n      const entriesToDelete = [];\n      for (const entry of this.tree.all()) {\n        if (labelToRemove === entry.indexedLabel) {\n          entriesToDelete.push(entry);\n        }\n      }\n      for (const entry of entriesToDelete) {\n        this.tree.remove(entry);\n      }\n      const c = this.current.get(labelToRemove.tileKey);\n      if (c) c.delete(labelToRemove);\n    }\n  };\n  __name(_Index, \"Index\");\n  var Index = _Index;\n  var _Labeler = class _Labeler {\n    constructor(z, scratch, labelRules2, maxLabeledTiles, callback) {\n      this.index = new Index(256 * 1 << z, maxLabeledTiles);\n      this.z = z;\n      this.scratch = scratch;\n      this.labelRules = labelRules2;\n      this.callback = callback;\n    }\n    layout(preparedTilemap) {\n      const start = performance.now();\n      const keysAdding = /* @__PURE__ */ new Set();\n      for (const [k, preparedTiles] of preparedTilemap) {\n        for (const preparedTile of preparedTiles) {\n          const key = `${toIndex(preparedTile.dataTile)}:${k}`;\n          if (!this.index.has(key)) {\n            this.index.makeEntry(key);\n            keysAdding.add(key);\n          }\n        }\n      }\n      const tilesInvalidated = /* @__PURE__ */ new Set();\n      for (const [order, rule] of this.labelRules.entries()) {\n        if (rule.visible === false) continue;\n        if (rule.minzoom && this.z < rule.minzoom) continue;\n        if (rule.maxzoom && this.z > rule.maxzoom) continue;\n        const dsName = rule.dataSource || \"\";\n        const preparedTiles = preparedTilemap.get(dsName);\n        if (!preparedTiles) continue;\n        for (const preparedTile of preparedTiles) {\n          const key = `${toIndex(preparedTile.dataTile)}:${dsName}`;\n          if (!keysAdding.has(key)) continue;\n          const layer = preparedTile.data.get(rule.dataLayer);\n          if (layer === void 0) continue;\n          const feats = layer;\n          if (rule.sort)\n            feats.sort((a, b) => {\n              if (rule.sort) {\n                return rule.sort(a.props, b.props);\n              }\n              return 0;\n            });\n          const layout = {\n            index: this.index,\n            zoom: this.z,\n            scratch: this.scratch,\n            order,\n            overzoom: this.z - preparedTile.dataTile.z\n          };\n          for (const feature of feats) {\n            if (rule.filter && !rule.filter(this.z, feature)) continue;\n            const transformed = transformGeom(\n              feature.geom,\n              preparedTile.scale,\n              preparedTile.origin\n            );\n            const labels = rule.symbolizer.place(layout, transformed, feature);\n            if (!labels) continue;\n            for (const label of labels) {\n              let labelAdded = false;\n              if (label.deduplicationKey && this.index.deduplicationCollides(label)) {\n                continue;\n              }\n              if (this.index.labelCollides(label, Infinity)) {\n                if (!this.index.labelCollides(label, order)) {\n                  const conflicts = this.index.searchLabel(label, Infinity);\n                  for (const conflict of conflicts) {\n                    this.index.removeLabel(conflict);\n                    for (const bbox of conflict.bboxes) {\n                      this.findInvalidatedTiles(\n                        tilesInvalidated,\n                        preparedTile.dim,\n                        bbox,\n                        key\n                      );\n                    }\n                  }\n                  this.index.insert(label, order, key);\n                  labelAdded = true;\n                }\n              } else {\n                this.index.insert(label, order, key);\n                labelAdded = true;\n              }\n              if (labelAdded) {\n                for (const bbox of label.bboxes) {\n                  if (bbox.maxX > preparedTile.origin.x + preparedTile.dim || bbox.minX < preparedTile.origin.x || bbox.minY < preparedTile.origin.y || bbox.maxY > preparedTile.origin.y + preparedTile.dim) {\n                    this.findInvalidatedTiles(\n                      tilesInvalidated,\n                      preparedTile.dim,\n                      bbox,\n                      key\n                    );\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n      for (const key of keysAdding) {\n        this.index.pruneOrNoop(key);\n      }\n      if (tilesInvalidated.size > 0 && this.callback) {\n        this.callback(tilesInvalidated);\n      }\n      return performance.now() - start;\n    }\n    findInvalidatedTiles(tilesInvalidated, dim, bbox, key) {\n      const touched = covering(this.z, dim, bbox);\n      for (const s of touched) {\n        if (s.key !== key && this.index.hasPrefix(s.key)) {\n          tilesInvalidated.add(s.display);\n        }\n      }\n    }\n    add(preparedTilemap) {\n      let allAdded = true;\n      for (const [k, preparedTiles] of preparedTilemap) {\n        for (const preparedTile of preparedTiles) {\n          if (!this.index.has(`${toIndex(preparedTile.dataTile)}:${k}`))\n            allAdded = false;\n        }\n      }\n      if (allAdded) {\n        return 0;\n      }\n      const timing = this.layout(preparedTilemap);\n      return timing;\n    }\n  };\n  __name(_Labeler, \"Labeler\");\n  var Labeler = _Labeler;\n  var _Labelers = class _Labelers {\n    constructor(scratch, labelRules2, maxLabeledTiles, callback) {\n      this.labelers = /* @__PURE__ */ new Map();\n      this.scratch = scratch;\n      this.labelRules = labelRules2;\n      this.maxLabeledTiles = maxLabeledTiles;\n      this.callback = callback;\n    }\n    add(z, preparedTilemap) {\n      let labeler = this.labelers.get(z);\n      if (labeler) {\n        return labeler.add(preparedTilemap);\n      }\n      labeler = new Labeler(\n        z,\n        this.scratch,\n        this.labelRules,\n        this.maxLabeledTiles,\n        this.callback\n      );\n      this.labelers.set(z, labeler);\n      return labeler.add(preparedTilemap);\n    }\n    getIndex(z) {\n      const labeler = this.labelers.get(z);\n      if (labeler) return labeler.index;\n    }\n  };\n  __name(_Labelers, \"Labelers\");\n  var Labelers = _Labelers;\n  function paint(ctx, z, preparedTilemap, labelData, rules, bbox, origin, clip, debug) {\n    const start = performance.now();\n    ctx.save();\n    ctx.miterLimit = 2;\n    for (const rule of rules) {\n      if (rule.minzoom && z < rule.minzoom) continue;\n      if (rule.maxzoom && z > rule.maxzoom) continue;\n      const preparedTiles = preparedTilemap.get(rule.dataSource || \"\");\n      if (!preparedTiles) continue;\n      for (const preparedTile of preparedTiles) {\n        const layer = preparedTile.data.get(rule.dataLayer);\n        if (layer === void 0) continue;\n        if (rule.symbolizer.before) rule.symbolizer.before(ctx, preparedTile.z);\n        const po = preparedTile.origin;\n        const dim = preparedTile.dim;\n        const ps = preparedTile.scale;\n        ctx.save();\n        if (clip) {\n          ctx.beginPath();\n          const minX = Math.max(po.x - origin.x, bbox.minX - origin.x);\n          const minY = Math.max(po.y - origin.y, bbox.minY - origin.y);\n          const maxX = Math.min(po.x - origin.x + dim, bbox.maxX - origin.x);\n          const maxY = Math.min(po.y - origin.y + dim, bbox.maxY - origin.y);\n          ctx.rect(minX, minY, maxX - minX, maxY - minY);\n          ctx.clip();\n        }\n        ctx.translate(po.x - origin.x, po.y - origin.y);\n        for (const feature of layer) {\n          let geom = feature.geom;\n          const fbox = feature.bbox;\n          if (fbox.maxX * ps + po.x < bbox.minX || fbox.minX * ps + po.x > bbox.maxX || fbox.minY * ps + po.y > bbox.maxY || fbox.maxY * ps + po.y < bbox.minY) {\n            continue;\n          }\n          if (rule.filter && !rule.filter(preparedTile.z, feature)) continue;\n          if (ps !== 1) {\n            geom = transformGeom(geom, ps, new Point(0, 0));\n          }\n          rule.symbolizer.draw(ctx, geom, preparedTile.z, feature);\n        }\n        ctx.restore();\n      }\n    }\n    if (clip) {\n      ctx.beginPath();\n      ctx.rect(\n        bbox.minX - origin.x,\n        bbox.minY - origin.y,\n        bbox.maxX - bbox.minX,\n        bbox.maxY - bbox.minY\n      );\n      ctx.clip();\n    }\n    if (labelData) {\n      const matches = labelData.searchBbox(bbox, Infinity);\n      for (const label of matches) {\n        ctx.save();\n        ctx.translate(label.anchor.x - origin.x, label.anchor.y - origin.y);\n        label.draw(ctx);\n        ctx.restore();\n        if (debug) {\n          ctx.lineWidth = 0.5;\n          ctx.strokeStyle = debug;\n          ctx.fillStyle = debug;\n          ctx.globalAlpha = 1;\n          ctx.fillRect(\n            label.anchor.x - origin.x - 2,\n            label.anchor.y - origin.y - 2,\n            4,\n            4\n          );\n          for (const bbox2 of label.bboxes) {\n            ctx.strokeRect(\n              bbox2.minX - origin.x,\n              bbox2.minY - origin.y,\n              bbox2.maxX - bbox2.minX,\n              bbox2.maxY - bbox2.minY\n            );\n          }\n        }\n      }\n    }\n    ctx.restore();\n    return performance.now() - start;\n  }\n  __name(paint, \"paint\");\n\n  // src/frontends/static.ts\n  var R2 = 6378137;\n  var MAX_LATITUDE2 = 85.0511287798;\n  var MAXCOORD2 = R2 * Math.PI;\n  var project2 = /* @__PURE__ */ __name((latlng) => {\n    const d = Math.PI / 180;\n    const constrainedLat = Math.max(\n      Math.min(MAX_LATITUDE2, latlng.y),\n      -MAX_LATITUDE2\n    );\n    const sin = Math.sin(constrainedLat * d);\n    return new Point(R2 * latlng.x * d, R2 * Math.log((1 + sin) / (1 - sin)) / 2);\n  }, \"project\");\n  var unproject = /* @__PURE__ */ __name((point) => {\n    const d = 180 / Math.PI;\n    return {\n      lat: (2 * Math.atan(Math.exp(point.y / R2)) - Math.PI / 2) * d,\n      lng: point.x * d / R2\n    };\n  }, \"unproject\");\n  var instancedProject = /* @__PURE__ */ __name((origin, displayZoom) => {\n    return (latlng) => {\n      const projected = project2(latlng);\n      const normalized = new Point(\n        (projected.x + MAXCOORD2) / (MAXCOORD2 * 2),\n        1 - (projected.y + MAXCOORD2) / (MAXCOORD2 * 2)\n      );\n      return normalized.mult((1 << displayZoom) * 256).sub(origin);\n    };\n  }, \"instancedProject\");\n  var instancedUnproject = /* @__PURE__ */ __name((origin, displayZoom) => {\n    return (point) => {\n      const normalized = new Point(point.x, point.y).add(origin).div((1 << displayZoom) * 256);\n      const projected = new Point(\n        normalized.x * (MAXCOORD2 * 2) - MAXCOORD2,\n        (1 - normalized.y) * (MAXCOORD2 * 2) - MAXCOORD2\n      );\n      return unproject(projected);\n    };\n  }, \"instancedUnproject\");\n  var getZoom = /* @__PURE__ */ __name((degreesLng, cssPixels) => {\n    const d = cssPixels * (360 / degreesLng);\n    return Math.log2(d / 256);\n  }, \"getZoom\");\n  var _Static = class _Static {\n    constructor(options) {\n      if (options.theme) {\n        const theme = themes[options.theme];\n        this.paintRules = paintRules(theme);\n        this.labelRules = labelRules(theme);\n        this.backgroundColor = theme.background;\n      } else {\n        this.paintRules = options.paintRules || [];\n        this.labelRules = options.labelRules || [];\n        this.backgroundColor = options.backgroundColor;\n      }\n      this.views = sourcesToViews(options);\n      this.debug = options.debug || \"\";\n    }\n    drawContext(ctx, width, height, latlng, displayZoom) {\n      return __async(this, null, function* () {\n        const center = project2(latlng);\n        const normalizedCenter = new Point(\n          (center.x + MAXCOORD2) / (MAXCOORD2 * 2),\n          1 - (center.y + MAXCOORD2) / (MAXCOORD2 * 2)\n        );\n        const origin = normalizedCenter.clone().mult(__pow(2, displayZoom) * 256).sub(new Point(width / 2, height / 2));\n        const bbox = {\n          minX: origin.x,\n          minY: origin.y,\n          maxX: origin.x + width,\n          maxY: origin.y + height\n        };\n        const promises = [];\n        for (const [k, v] of this.views) {\n          const promise = v.getBbox(displayZoom, bbox);\n          promises.push({ key: k, promise });\n        }\n        const tileResponses = yield Promise.all(\n          promises.map((o) => {\n            return o.promise.then(\n              (v) => {\n                return { status: \"fulfilled\", value: v, key: o.key };\n              },\n              (error) => {\n                return { status: \"rejected\", value: [], reason: error, key: o.key };\n              }\n            );\n          })\n        );\n        const preparedTilemap = /* @__PURE__ */ new Map();\n        for (const tileResponse of tileResponses) {\n          if (tileResponse.status === \"fulfilled\") {\n            preparedTilemap.set(tileResponse.key, tileResponse.value);\n          }\n        }\n        const start = performance.now();\n        const labeler = new Labeler(\n          displayZoom,\n          ctx,\n          this.labelRules,\n          16,\n          void 0\n        );\n        labeler.add(preparedTilemap);\n        if (this.backgroundColor) {\n          ctx.save();\n          ctx.fillStyle = this.backgroundColor;\n          ctx.fillRect(0, 0, width, height);\n          ctx.restore();\n        }\n        const paintRules2 = this.paintRules;\n        paint(\n          ctx,\n          displayZoom,\n          preparedTilemap,\n          labeler.index,\n          paintRules2,\n          bbox,\n          origin,\n          true,\n          this.debug\n        );\n        if (this.debug) {\n          ctx.save();\n          ctx.translate(-origin.x, -origin.y);\n          ctx.strokeStyle = this.debug;\n          ctx.fillStyle = this.debug;\n          ctx.font = \"12px sans-serif\";\n          let idx = 0;\n          for (const [k, v] of preparedTilemap) {\n            for (const preparedTile of v) {\n              ctx.strokeRect(\n                preparedTile.origin.x,\n                preparedTile.origin.y,\n                preparedTile.dim,\n                preparedTile.dim\n              );\n              const dt = preparedTile.dataTile;\n              ctx.fillText(\n                `${k + (k ? \" \" : \"\") + dt.z} ${dt.x} ${dt.y}`,\n                preparedTile.origin.x + 4,\n                preparedTile.origin.y + 14 * (1 + idx)\n              );\n            }\n            idx++;\n          }\n          ctx.restore();\n        }\n        return {\n          elapsed: performance.now() - start,\n          project: instancedProject(origin, displayZoom),\n          unproject: instancedUnproject(origin, displayZoom)\n        };\n      });\n    }\n    drawCanvas(_0, _1, _2) {\n      return __async(this, arguments, function* (canvas, latlng, displayZoom, options = {}) {\n        const dpr = window.devicePixelRatio;\n        const width = canvas.clientWidth;\n        const height = canvas.clientHeight;\n        if (!(canvas.width === width * dpr && canvas.height === height * dpr)) {\n          canvas.width = width * dpr;\n          canvas.height = height * dpr;\n        }\n        if (options.lang) canvas.lang = options.lang;\n        const ctx = canvas.getContext(\"2d\");\n        if (!ctx) {\n          console.error(\"Failed to initialize canvas2d context.\");\n          return;\n        }\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n        return this.drawContext(ctx, width, height, latlng, displayZoom);\n      });\n    }\n    drawContextBounds(ctx, topLeft, bottomRight, width, height) {\n      return __async(this, null, function* () {\n        const deltaDegrees = bottomRight.x - topLeft.x;\n        const center = new Point(\n          (topLeft.x + bottomRight.x) / 2,\n          (topLeft.y + bottomRight.y) / 2\n        );\n        return this.drawContext(\n          ctx,\n          width,\n          height,\n          center,\n          getZoom(deltaDegrees, width)\n        );\n      });\n    }\n    drawCanvasBounds(_0, _1, _2, _3) {\n      return __async(this, arguments, function* (canvas, topLeft, bottomRight, width, options = {}) {\n        const deltaDegrees = bottomRight.x - topLeft.x;\n        const center = new Point(\n          (topLeft.x + bottomRight.x) / 2,\n          (topLeft.y + bottomRight.y) / 2\n        );\n        return this.drawCanvas(\n          canvas,\n          center,\n          getZoom(deltaDegrees, width),\n          options\n        );\n      });\n    }\n  };\n  __name(_Static, \"Static\");\n  var Static = _Static;\n  var timer = /* @__PURE__ */ __name((duration) => {\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        resolve();\n      }, duration);\n    });\n  }, \"timer\");\n  var reflect = /* @__PURE__ */ __name((promise) => {\n    return promise.then(\n      (v) => {\n        return { status: \"fulfilled\", value: v };\n      },\n      (error) => {\n        return { status: \"rejected\", reason: error };\n      }\n    );\n  }, \"reflect\");\n  var leafletLayer = /* @__PURE__ */ __name((options = {}) => {\n    const _LeafletLayer = class _LeafletLayer extends L.GridLayer {\n      constructor(options2 = {}) {\n        if (options2.noWrap && !options2.bounds)\n          options2.bounds = [\n            [-90, -180],\n            [90, 180]\n          ];\n        if (options2.attribution == null)\n          options2.attribution = '<a href=\"https://protomaps.com\">Protomaps</a> \\xA9 <a href=\"https://openstreetmap.org/copyright\">OpenStreetMap</a>';\n        super(options2);\n        if (options2.theme) {\n          const theme = themes[options2.theme];\n          this.paintRules = paintRules(theme);\n          this.labelRules = labelRules(theme);\n          this.backgroundColor = theme.background;\n        } else {\n          this.paintRules = options2.paintRules || [];\n          this.labelRules = options2.labelRules || [];\n          this.backgroundColor = options2.backgroundColor;\n        }\n        this.lastRequestedZ = void 0;\n        this.tasks = options2.tasks || [];\n        this.views = sourcesToViews(options2);\n        this.debug = options2.debug;\n        const scratch = document.createElement(\"canvas\").getContext(\"2d\");\n        this.scratch = scratch;\n        this.onTilesInvalidated = (tiles) => {\n          for (const t of tiles) {\n            this.rerenderTile(t);\n          }\n        };\n        this.labelers = new Labelers(\n          this.scratch,\n          this.labelRules,\n          16,\n          this.onTilesInvalidated\n        );\n        this.tileSize = 256 * window.devicePixelRatio;\n        this.tileDelay = options2.tileDelay || 3;\n        this.lang = options2.lang;\n      }\n      renderTile(coords, element, key, done = () => {\n      }) {\n        return __async(this, null, function* () {\n          this.lastRequestedZ = coords.z;\n          const promises = [];\n          for (const [k, v] of this.views) {\n            const promise = v.getDisplayTile(coords);\n            promises.push({ key: k, promise });\n          }\n          const tileResponses = yield Promise.all(\n            promises.map((o) => {\n              return o.promise.then(\n                (v) => {\n                  return { status: \"fulfilled\", value: v, key: o.key };\n                },\n                (error) => {\n                  return { status: \"rejected\", reason: error, key: o.key };\n                }\n              );\n            })\n          );\n          const preparedTilemap = /* @__PURE__ */ new Map();\n          for (const tileResponse of tileResponses) {\n            if (tileResponse.status === \"fulfilled\") {\n              preparedTilemap.set(tileResponse.key, [tileResponse.value]);\n            } else {\n              if (tileResponse.reason.name === \"AbortError\") ; else {\n                console.error(tileResponse.reason);\n              }\n            }\n          }\n          if (element.key !== key) return;\n          if (this.lastRequestedZ !== coords.z) return;\n          yield Promise.all(this.tasks.map(reflect));\n          if (element.key !== key) return;\n          if (this.lastRequestedZ !== coords.z) return;\n          const layoutTime = this.labelers.add(coords.z, preparedTilemap);\n          if (element.key !== key) return;\n          if (this.lastRequestedZ !== coords.z) return;\n          const labelData = this.labelers.getIndex(coords.z);\n          if (!this._map) return;\n          const center = this._map.getCenter().wrap();\n          const pixelBounds = this._getTiledPixelBounds(center);\n          const tileRange = this._pxBoundsToTileRange(pixelBounds);\n          const tileCenter = tileRange.getCenter();\n          const priority = coords.distanceTo(tileCenter) * this.tileDelay;\n          yield timer(priority);\n          if (element.key !== key) return;\n          if (this.lastRequestedZ !== coords.z) return;\n          const buf = 16;\n          const bbox = {\n            minX: 256 * coords.x - buf,\n            minY: 256 * coords.y - buf,\n            maxX: 256 * (coords.x + 1) + buf,\n            maxY: 256 * (coords.y + 1) + buf\n          };\n          const origin = new Point(256 * coords.x, 256 * coords.y);\n          element.width = this.tileSize;\n          element.height = this.tileSize;\n          const ctx = element.getContext(\"2d\");\n          if (!ctx) {\n            console.error(\"Failed to get Canvas context\");\n            return;\n          }\n          ctx.setTransform(this.tileSize / 256, 0, 0, this.tileSize / 256, 0, 0);\n          ctx.clearRect(0, 0, 256, 256);\n          if (this.backgroundColor) {\n            ctx.save();\n            ctx.fillStyle = this.backgroundColor;\n            ctx.fillRect(0, 0, 256, 256);\n            ctx.restore();\n          }\n          let paintingTime = 0;\n          const paintRules2 = this.paintRules;\n          paintingTime = paint(\n            ctx,\n            coords.z,\n            preparedTilemap,\n            this.xray ? null : labelData,\n            paintRules2,\n            bbox,\n            origin,\n            false,\n            this.debug\n          );\n          if (this.debug) {\n            ctx.save();\n            ctx.fillStyle = this.debug;\n            ctx.font = \"600 12px sans-serif\";\n            ctx.fillText(`${coords.z} ${coords.x} ${coords.y}`, 4, 14);\n            ctx.font = \"12px sans-serif\";\n            let ypos = 28;\n            for (const [k, v] of preparedTilemap) {\n              const dt = v[0].dataTile;\n              ctx.fillText(`${k + (k ? \" \" : \"\") + dt.z} ${dt.x} ${dt.y}`, 4, ypos);\n              ypos += 14;\n            }\n            ctx.font = \"600 10px sans-serif\";\n            if (paintingTime > 8) {\n              ctx.fillText(`${paintingTime.toFixed()} ms paint`, 4, ypos);\n              ypos += 14;\n            }\n            if (layoutTime > 8) {\n              ctx.fillText(`${layoutTime.toFixed()} ms layout`, 4, ypos);\n            }\n            ctx.strokeStyle = this.debug;\n            ctx.lineWidth = 0.5;\n            ctx.beginPath();\n            ctx.moveTo(0, 0);\n            ctx.lineTo(0, 256);\n            ctx.stroke();\n            ctx.lineWidth = 0.5;\n            ctx.beginPath();\n            ctx.moveTo(0, 0);\n            ctx.lineTo(256, 0);\n            ctx.stroke();\n            ctx.restore();\n          }\n          done();\n        });\n      }\n      rerenderTile(key) {\n        for (const unwrappedK in this._tiles) {\n          const wrappedCoord = this._wrapCoords(\n            this._keyToTileCoords(unwrappedK)\n          );\n          if (key === this._tileCoordsToKey(wrappedCoord)) {\n            this.renderTile(wrappedCoord, this._tiles[unwrappedK].el, key);\n          }\n        }\n      }\n      // a primitive way to check the features at a certain point.\n      // it does not support hover states, cursor changes, or changing the style of the selected feature,\n      // so is only appropriate for debuggging or very basic use cases.\n      // those features are outside of the scope of this library:\n      // for fully pickable, interactive features, use MapLibre GL JS instead.\n      queryTileFeaturesDebug(lng, lat, brushSize = 16) {\n        const featuresBySourceName = /* @__PURE__ */ new Map();\n        for (const [sourceName, view] of this.views) {\n          featuresBySourceName.set(\n            sourceName,\n            view.queryFeatures(lng, lat, this._map.getZoom(), brushSize)\n          );\n        }\n        return featuresBySourceName;\n      }\n      clearLayout() {\n        this.labelers = new Labelers(\n          this.scratch,\n          this.labelRules,\n          16,\n          this.onTilesInvalidated\n        );\n      }\n      rerenderTiles() {\n        for (const unwrappedK in this._tiles) {\n          const wrappedCoord = this._wrapCoords(\n            this._keyToTileCoords(unwrappedK)\n          );\n          const key = this._tileCoordsToKey(wrappedCoord);\n          this.renderTile(wrappedCoord, this._tiles[unwrappedK].el, key);\n        }\n      }\n      createTile(coords, showTile) {\n        const element = L.DomUtil.create(\"canvas\", \"leaflet-tile\");\n        element.lang = this.lang;\n        const key = this._tileCoordsToKey(coords);\n        element.key = key;\n        this.renderTile(coords, element, key, () => {\n          showTile(void 0, element);\n        });\n        return element;\n      }\n      _removeTile(key) {\n        const tile = this._tiles[key];\n        if (!tile) {\n          return;\n        }\n        tile.el.removed = true;\n        tile.el.key = void 0;\n        L.DomUtil.removeClass(tile.el, \"leaflet-tile-loaded\");\n        tile.el.width = tile.el.height = 0;\n        L.DomUtil.remove(tile.el);\n        delete this._tiles[key];\n        this.fire(\"tileunload\", {\n          tile: tile.el,\n          coords: this._keyToTileCoords(key)\n        });\n      }\n    };\n    __name(_LeafletLayer, \"LeafletLayer\");\n    let LeafletLayer = _LeafletLayer;\n    return new LeafletLayer(options);\n  }, \"leafletLayer\");\n  var Font = /* @__PURE__ */ __name((name, url, weight) => {\n    const ff = new FontFace(name, `url(${url})`, { weight });\n    document.fonts.add(ff);\n    return ff.load();\n  }, \"Font\");\n  var mkimg = /* @__PURE__ */ __name((src) => __async(void 0, null, function* () {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      img.onload = () => resolve(img);\n      img.onerror = () => reject(\"Invalid SVG\");\n      img.src = src;\n    });\n  }), \"mkimg\");\n  var MISSING = `\n<svg width=\"20px\" height=\"20px\" viewBox=\"0 0 50 50\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n    <rect width=\"50\" height=\"50\" fill=\"#cccccc\"/>\n    <g transform=\"translate(5,5)\">\n        <path fill=\"none\" stroke=\"#666666\" stroke-width=\"7\" d=\"m11,12a8.5,8 0 1,1 17,0q0,4-4,6t-4.5,4.5-.4,4v.2m0,3v7\"/>\n    </g>\n</svg>\n`;\n  var _Sheet = class _Sheet {\n    constructor(src) {\n      this.src = src;\n      this.canvas = document.createElement(\"canvas\");\n      this.mapping = /* @__PURE__ */ new Map();\n      this.missingBox = { x: 0, y: 0, w: 0, h: 0 };\n    }\n    load() {\n      return __async(this, null, function* () {\n        let src = this.src;\n        const scale = window.devicePixelRatio;\n        if (src.endsWith(\".html\")) {\n          const c = yield fetch(src);\n          src = yield c.text();\n        }\n        const tree = new window.DOMParser().parseFromString(src, \"text/html\");\n        const icons = Array.from(tree.body.children);\n        const missingImg = yield mkimg(\n          `data:image/svg+xml;base64,${btoa(MISSING)}`\n        );\n        const boxes = [\n          {\n            w: missingImg.width * scale,\n            h: missingImg.height * scale,\n            img: missingImg,\n            id: \"\"\n          }\n        ];\n        const serializer = new XMLSerializer();\n        for (const ps of icons) {\n          const svg64 = btoa(serializer.serializeToString(ps));\n          const image64 = `data:image/svg+xml;base64,${svg64}`;\n          const img = yield mkimg(image64);\n          boxes.push({\n            w: img.width * scale,\n            h: img.height * scale,\n            img,\n            id: ps.id\n          });\n        }\n        const packresult = potpack(boxes);\n        this.canvas.width = packresult.w;\n        this.canvas.height = packresult.h;\n        const ctx = this.canvas.getContext(\"2d\");\n        if (ctx) {\n          for (const box of boxes) {\n            if (box.x !== void 0 && box.y !== void 0) {\n              ctx.drawImage(box.img, box.x, box.y, box.w, box.h);\n              if (box.id)\n                this.mapping.set(box.id, {\n                  x: box.x,\n                  y: box.y,\n                  w: box.w,\n                  h: box.h\n                });\n              else this.missingBox = { x: box.x, y: box.y, w: box.w, h: box.h };\n            }\n          }\n        }\n        return this;\n      });\n    }\n    get(name) {\n      let result = this.mapping.get(name);\n      if (!result) result = this.missingBox;\n      return result;\n    }\n  };\n  __name(_Sheet, \"Sheet\");\n  var Sheet = _Sheet;\n\n  var protomapsL = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    CenteredSymbolizer: CenteredSymbolizer,\n    CenteredTextSymbolizer: CenteredTextSymbolizer,\n    CircleSymbolizer: CircleSymbolizer,\n    FlexSymbolizer: FlexSymbolizer,\n    Font: Font,\n    GeomType: GeomType,\n    GroupSymbolizer: GroupSymbolizer,\n    IconSymbolizer: IconSymbolizer,\n    Index: Index,\n    Justify: Justify,\n    Labeler: Labeler,\n    Labelers: Labelers,\n    LineLabelPlacement: LineLabelPlacement,\n    LineLabelSymbolizer: LineLabelSymbolizer,\n    LineSymbolizer: LineSymbolizer,\n    OffsetSymbolizer: OffsetSymbolizer,\n    OffsetTextSymbolizer: OffsetTextSymbolizer,\n    Padding: Padding,\n    PmtilesSource: PmtilesSource,\n    PolygonSymbolizer: PolygonSymbolizer,\n    Sheet: Sheet,\n    ShieldSymbolizer: ShieldSymbolizer,\n    Static: Static,\n    TextPlacements: TextPlacements,\n    TextSymbolizer: TextSymbolizer,\n    TileCache: TileCache,\n    View: View,\n    ZxySource: ZxySource,\n    arr: arr,\n    covering: covering,\n    createPattern: createPattern,\n    exp: exp,\n    getZoom: getZoom,\n    isCcw: isCcw,\n    isInRing: isInRing,\n    labelRules: labelRules,\n    leafletLayer: leafletLayer,\n    linear: linear,\n    paint: paint,\n    paintRules: paintRules,\n    pointInPolygon: pointInPolygon,\n    pointMinDistToLines: pointMinDistToLines,\n    pointMinDistToPoints: pointMinDistToPoints,\n    sourcesToViews: sourcesToViews,\n    step: step,\n    toIndex: toIndex,\n    transformGeom: transformGeom,\n    wrap: wrap\n  });\n\n  var TemplatedPMTilesLayer = L.Layer.extend({\n    initialize: function (template, options) {\n      this._template = template;\n      /* structure of this._template:\n        {\n          template: decodeURI(new URL(template, this.getBase())),\n          linkEl: (map-link),\n          rel: (map-link@rel),\n          type: (map-link@type),\n          values: [map-input],\n          inputsReady: Promise.allSettled(inputsReady),\n          zoom: (map-input@type=zoom),\n          projection: (map-extent@units),\n          tms: true/false,\n          step: step\n        }\n      */\n      this._container = L.DomUtil.create('div', 'leaflet-layer');\n      L.DomUtil.addClass(this._container, 'mapml-pmtiles-container');\n      this.zoomBounds = options.zoomBounds;\n      this.extentBounds = options.extentBounds;\n      // get rid of duplicate info, it can be confusing\n      delete options.zoomBounds;\n      delete options.extentBounds;\n      this._linkEl = options.linkEl;\n      L.setOptions(this, options);\n      //    L.setOptions(\n      //      this,\n      //      L.extend(options, this._setUpTemplateVars(template))\n      //    );\n    },\n    onAdd: function (map) {\n      this._map = map;\n      this.options.pane.appendChild(this._container);\n      this.setZIndex(this.options.zIndex);\n      let pmtilesOptions = {\n        url: this._template.template,\n        pane: this._container\n      };\n      // unfortunately need to fool rollup into not trying to resolve this\n      // at build by creating a variable for the module specifier\n      const pmtilesStyles = './pmtilesRules.js';\n      import(pmtilesStyles)\n        .then((module) => {\n          let pmtilesRules = module.pmtilesRules;\n          let paintRules = pmtilesRules.get(this._template.template);\n          if (paintRules && paintRules.rules) {\n            pmtilesOptions.paintRules = paintRules.rules.PAINT_RULES;\n            pmtilesOptions.labelRules = paintRules.rules.LABEL_RULES;\n          } else if (paintRules && paintRules.theme?.theme) {\n            pmtilesOptions.theme = paintRules.theme.theme;\n          }\n          this._pmtilesLayer = M.protomapsL\n            .leafletLayer(pmtilesOptions)\n            .addTo(map);\n        })\n        .catch((reason) => {\n          console.log(\n            'Error importing pmtiles symbolizer rules or theme: \\n' + reason\n          );\n        });\n    },\n    onRemove: function (map) {\n      this._pmtilesLayer.remove();\n      L.DomUtil.remove(this._container);\n    },\n    isVisible: function () {\n      let map = this._linkEl.getMapEl()._map;\n      let mapZoom = map.getZoom();\n      let mapBounds = M.pixelToPCRSBounds(\n        map.getPixelBounds(),\n        mapZoom,\n        map.options.projection\n      );\n      return (\n        mapZoom <= this.zoomBounds.maxZoom &&\n        mapZoom >= this.zoomBounds.minZoom &&\n        this.extentBounds.overlaps(mapBounds)\n      );\n    },\n    setZIndex: function (zIndex) {\n      this.options.zIndex = zIndex;\n      if (\n        this._container &&\n        this.options.zIndex !== undefined &&\n        this.options.zIndex !== null\n      ) {\n        this._container.style.zIndex = this.options.zIndex;\n      }\n      return this;\n    }\n  });\n  var templatedPMTilesLayer = function (template, options) {\n    return new TemplatedPMTilesLayer(template, options);\n  };\n\n  var ImageLayer = L.ImageOverlay.extend({\n    initialize: function (url, location, size, angle, container, options) {\n      // (String, Point, Point, Number, Element, Object)\n      this._container = container;\n      this._url = url;\n      // instead of calculating where the image goes, put it at 0,0\n      //this._location = L.point(location);\n      // the location for WMS requests will be the upper left hand\n      // corner of the map.  When the map is initialized, that is 0,0,\n      // but as the user pans, of course the\n      this._location = location;\n      this._size = L.point(size);\n      this._angle = angle;\n\n      L.setOptions(this, options);\n    },\n    getEvents: function () {\n      var events = {\n        viewreset: this._reset\n      };\n\n      if (this._zoomAnimated && this._step <= 1) {\n        events.zoomanim = this._animateZoom;\n      }\n\n      return events;\n    },\n    onAdd: function (map) {\n      this.on({\n        load: this._onImageLoad\n      });\n\n      if (!this._image) {\n        this._initImage();\n      }\n\n      if (this.options.interactive) {\n        L.DomUtil.addClass(this._image, 'leaflet-interactive');\n        this.addInteractiveTarget(this._image);\n      }\n\n      this._container.appendChild(this._image);\n      this._reset();\n    },\n    onRemove: function () {\n      L.DomUtil.remove(this._image);\n      if (this.options.interactive) {\n        this.removeInteractiveTarget(this._image);\n      }\n    },\n    _onImageLoad: function () {\n      if (!this._image) {\n        return;\n      }\n      this._image.loaded = +new Date();\n      this._updateOpacity();\n    },\n    _animateZoom: function (e) {\n      var scale = this._map.getZoomScale(e.zoom),\n        translate = this._map\n          .getPixelOrigin()\n          .add(this._location)\n          .multiplyBy(scale)\n          .subtract(this._map._getNewPixelOrigin(e.center, e.zoom))\n          .round();\n\n      if (L.Browser.any3d) {\n        L.DomUtil.setTransform(this._image, translate, scale);\n      } else {\n        L.DomUtil.setPosition(this._image, translate);\n      }\n    },\n    _reset: function (e) {\n      var image = this._image,\n        location = this._location,\n        size = this._size;\n      // TBD use the angle to establish the image rotation in CSS\n\n      if (\n        e &&\n        this._step > 1 &&\n        (this._overlayToRemove === undefined ||\n          this._url === this._overlayToRemove)\n      ) {\n        return;\n      }\n      L.DomUtil.setPosition(image, location);\n\n      image.style.width = size.x + 'px';\n      image.style.height = size.y + 'px';\n    },\n    _updateOpacity: function () {\n      if (!this._map) {\n        return;\n      }\n\n      //L.DomUtil.setOpacity(this._image, this.options.opacity);\n\n      var now = +new Date(),\n        nextFrame = false;\n\n      var image = this._image;\n\n      var fade = Math.min(1, (now - image.loaded) / 200);\n\n      L.DomUtil.setOpacity(image, fade);\n      if (fade < 1) {\n        nextFrame = true;\n      }\n      if (nextFrame) {\n        L.Util.cancelAnimFrame(this._fadeFrame);\n        this._fadeFrame = L.Util.requestAnimFrame(this._updateOpacity, this);\n      }\n      L.DomUtil.addClass(image, 'leaflet-image-loaded');\n    }\n  });\n  var imageLayer = function (\n    url,\n    location,\n    size,\n    angle,\n    container,\n    options\n  ) {\n    return new ImageLayer(url, location, size, angle, container, options);\n  };\n\n  var MapMLLayer = L.LayerGroup.extend({\n    options: {\n      zIndex: 0,\n      opacity: '1.0'\n    },\n    // initialize is executed before the layer is added to a map\n    initialize: function (href, layerEl, options) {\n      // in the custom element, the attribute is actually 'src'\n      // the _href version is the URL received from layer-@src\n      L.LayerGroup.prototype.initialize.call(this, null, options);\n      if (href) {\n        this._href = href;\n      }\n      this._layerEl = layerEl;\n      this._content = layerEl.src ? layerEl.shadowRoot : layerEl;\n      L.setOptions(this, options);\n      this._container = L.DomUtil.create('div', 'leaflet-layer');\n      this.changeOpacity(this.options.opacity);\n      L.DomUtil.addClass(this._container, 'mapml-layer');\n\n      // this layer 'owns' a mapmlTileLayer, which is a subclass of L.GridLayer\n      // it 'passes' what tiles to load via the content of this._mapmlTileContainer\n      this._mapmlTileContainer = L.DomUtil.create(\n        'div',\n        'mapml-tile-container',\n        this._container\n      );\n      // hit the service to determine what its extent might be\n      // OR use the extent of the content provided\n\n      this._initialize(this._content);\n    },\n    setZIndex: function (zIndex) {\n      this.options.zIndex = zIndex;\n      this._updateZIndex();\n\n      return this;\n    },\n    getHref: function () {\n      return this._href ?? '';\n    },\n    _updateZIndex: function () {\n      if (\n        this._container &&\n        this.options.zIndex !== undefined &&\n        this.options.zIndex !== null\n      ) {\n        this._container.style.zIndex = this.options.zIndex;\n      }\n    },\n    changeOpacity: function (opacity) {\n      this._container.style.opacity = opacity;\n      this._layerEl._opacity = opacity;\n      if (this._layerEl._opacitySlider)\n        this._layerEl._opacitySlider.value = opacity;\n    },\n    titleIsReadOnly() {\n      return !!this._titleIsReadOnly;\n    },\n    setName(newName) {\n      // a layer's accessible name is set by the <map-title>, if present\n      // if it's not available the <layer- label=\"accessible-name\"> attribute\n      // can be used\n      if (!this.titleIsReadOnly()) {\n        this._title = newName;\n        this._layerEl._layerControlHTML.querySelector(\n          '.mapml-layer-item-name'\n        ).innerHTML = newName;\n      }\n    },\n    getName() {\n      return this._title;\n    },\n\n    onAdd: function (map) {\n      L.LayerGroup.prototype.onAdd.call(this, map);\n      this.getPane().appendChild(this._container);\n\n      //only add the layer if there are tiles to be rendered\n      if (this._staticTileLayer) {\n        this.addLayer(this._staticTileLayer);\n      }\n      this.setZIndex(this.options.zIndex);\n      map.on('popupopen', this._attachSkipButtons, this);\n    },\n\n    _calculateBounds: function () {\n      delete this.bounds;\n      delete this.zoomBounds;\n      let bounds, zoomBounds;\n      let layerTypes = ['_staticTileLayer', '_mapmlvectors', '_extentLayer'];\n      bounds =\n        this._layerEl.src &&\n        this._layerEl.shadowRoot.querySelector(\n          ':host > map-meta[name=extent][content]'\n        )\n          ? M.getBoundsFromMeta(this._layerEl.shadowRoot)\n          : this._layerEl.querySelector(':scope > map-meta[name=extent][content]')\n          ? M.getBoundsFromMeta(this._layerEl)\n          : undefined;\n      zoomBounds =\n        this._layerEl.src &&\n        this._layerEl.shadowRoot.querySelector(\n          ':host > map-meta[name=zoom][content]'\n        )\n          ? M.getZoomBoundsFromMeta(this._layerEl.shadowRoot)\n          : this._layerEl.querySelector(':scope > map-meta[name=zoom][content]')\n          ? M.getZoomBoundsFromMeta(this._layerEl)\n          : undefined;\n      const mapExtents = this._layerEl.src\n        ? this._layerEl.shadowRoot.querySelectorAll('map-extent')\n        : this._layerEl.querySelectorAll('map-extent');\n      layerTypes.forEach((type) => {\n        let zoomMax, zoomMin, minNativeZoom, maxNativeZoom;\n        if (zoomBounds) {\n          zoomMax = zoomBounds.maxZoom;\n          zoomMin = zoomBounds.minZoom;\n          maxNativeZoom = zoomBounds.maxNativeZoom\n            ? zoomBounds.maxNativeZoom\n            : -Infinity;\n          minNativeZoom = zoomBounds.minNativeZoom\n            ? zoomBounds.minNativeZoom\n            : Infinity;\n        }\n        if (type === '_extentLayer' && mapExtents.length) {\n          for (let i = 0; i < mapExtents.length; i++) {\n            if (mapExtents[i]._extentLayer.bounds) {\n              let mapExtentLayer = mapExtents[i]._extentLayer;\n              if (!bounds) {\n                bounds = L.bounds(\n                  mapExtentLayer.bounds.min,\n                  mapExtentLayer.bounds.max\n                );\n              } else {\n                bounds.extend(mapExtentLayer.bounds);\n              }\n              if (mapExtentLayer.zoomBounds) {\n                if (!zoomBounds) {\n                  zoomBounds = mapExtentLayer.zoomBounds;\n                } else {\n                  // Extend layer zoombounds\n                  zoomMax = Math.max(zoomMax, mapExtentLayer.zoomBounds.maxZoom);\n                  zoomMin = Math.min(zoomMin, mapExtentLayer.zoomBounds.minZoom);\n                  maxNativeZoom = Math.max(\n                    maxNativeZoom,\n                    mapExtentLayer.zoomBounds.maxNativeZoom\n                  );\n                  minNativeZoom = Math.min(\n                    minNativeZoom,\n                    mapExtentLayer.zoomBounds.minNativeZoom\n                  );\n                  zoomBounds.minZoom = zoomMin;\n                  zoomBounds.maxZoom = zoomMax;\n                  zoomBounds.minNativeZoom = minNativeZoom;\n                  zoomBounds.maxNativeZoom = maxNativeZoom;\n                }\n              }\n            }\n          }\n        } else if (\n          type === '_mapmlvectors' ||\n          (type === '_staticTileLayer' && this._staticTileLayer)\n        ) {\n          if (this[type].layerBounds) {\n            if (!bounds) {\n              bounds = this[type].layerBounds;\n            } else {\n              bounds.extend(this[type].layerBounds);\n            }\n          }\n          if (this[type].zoomBounds) {\n            if (!zoomBounds) {\n              zoomBounds = this[type].zoomBounds;\n            } else {\n              // Extend layer zoombounds\n              zoomMax = Math.max(zoomMax, this[type].zoomBounds.maxZoom);\n              zoomMin = Math.min(zoomMin, this[type].zoomBounds.minZoom);\n              maxNativeZoom = Math.max(\n                maxNativeZoom,\n                this[type].zoomBounds.maxNativeZoom\n              );\n              minNativeZoom = Math.min(\n                minNativeZoom,\n                this[type].zoomBounds.minNativeZoom\n              );\n              zoomBounds.minZoom = zoomMin;\n              zoomBounds.maxZoom = zoomMax;\n              zoomBounds.minNativeZoom = minNativeZoom;\n              zoomBounds.maxNativeZoom = maxNativeZoom;\n            }\n          }\n        }\n      });\n      if (bounds) {\n        this.bounds = bounds;\n      } else {\n        let projectionBounds = M[this.options.projection].options.bounds;\n        this.bounds = L.bounds(projectionBounds.min, projectionBounds.max);\n      }\n      // we could get here and zoomBounds might still not be defined (empty layer)\n      if (!zoomBounds) zoomBounds = {};\n      if (!zoomBounds.minZoom) {\n        zoomBounds.minZoom = 0;\n      }\n      if (!zoomBounds.maxZoom) {\n        zoomBounds.maxZoom =\n          M[this.options.projection].options.resolutions.length - 1;\n      }\n      if (zoomBounds.minNativeZoom === Infinity) {\n        zoomBounds.minNativeZoom = zoomBounds.minZoom;\n      }\n      if (zoomBounds.maxNativeZoom === -Infinity) {\n        zoomBounds.maxNativeZoom = zoomBounds.maxZoom;\n      }\n      this.zoomBounds = zoomBounds;\n    },\n\n    onRemove: function (map) {\n      L.LayerGroup.prototype.onRemove.call(this, map);\n      L.DomUtil.remove(this._container);\n      map.off('popupopen', this._attachSkipButtons);\n    },\n    getAttribution: function () {\n      return this.options.attribution;\n    },\n    getBase: function () {\n      return new URL(\n        this._content.querySelector('map-base')\n          ? this._content.querySelector('map-base').getAttribute('href')\n          : this._content.nodeName === 'LAYER-'\n          ? this._content.baseURI\n          : this._href,\n        this._href\n      ).href;\n    },\n    appendStyleLink: function (mapLink) {\n      if (!mapLink.link) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapLink.link\n      );\n    },\n    _getStylePositionAndNode: function () {\n      return this._container.lastChild &&\n        (this._container.lastChild.nodeName.toUpperCase() === 'SVG' ||\n          this._container.lastChild.classList.contains('mapml-vector-container'))\n        ? { position: 'beforebegin', node: this._container.lastChild }\n        : this._container.lastChild\n        ? { position: 'afterend', node: this._container.lastChild }\n        : { position: 'afterbegin', node: this._container };\n    },\n    appendStyleElement: function (mapStyle) {\n      if (!mapStyle.styleElement) return;\n      let positionAndNode = this._getStylePositionAndNode();\n      positionAndNode.node.insertAdjacentElement(\n        positionAndNode.position,\n        mapStyle.styleElement\n      );\n    },\n    _initialize: function () {\n      var layer = this;\n      layer.getBase();\n        var mapml = this._content;\n      parseLicenseAndLegend();\n      setLayerTitle();\n      // crs is only set if the layer has the same projection as the map\n      if (M[layer.options.projection]) processTiles();\n      processFeatures();\n      // update controls if needed based on mapml-viewer controls/controlslist attribute\n      if (layer._layerEl.parentElement) {\n        // if layer does not have a parent Element, do not need to set Controls\n        layer._layerEl.parentElement._toggleControls();\n      }\n      // local functions\n      // determine if, where there's no match of the current layer's projection\n      // and that of the map, if there is a linked alternate text/mapml\n      // resource that matches the map's projection\n      function processFeatures() {\n        let native = M.getNativeVariables(layer._content);\n        layer._mapmlvectors = M.featureLayer(null, {\n          // pass the vector layer a renderer of its own, otherwise leaflet\n          // puts everything into the overlayPane\n          renderer: M.featureRenderer(),\n          // pass the vector layer the container for the parent into which\n          // it will append its own container for rendering into\n          pane: layer._container,\n          opacity: layer.options.opacity,\n          projection: layer.options.projection,\n          // by NOT passing options.extent, we are asking the FeatureLayer\n          // to dynamically update its .layerBounds property as features are\n          // added or removed from it\n          native: native,\n          // each owned child layer gets a reference to the root layer\n          _leafletLayer: layer,\n          mapEl: layer._layerEl.parentElement,\n          onEachFeature: function (properties, geometry) {\n            // need to parse as HTML to preserve semantics and styles\n            if (properties) {\n              var c = document.createElement('div');\n              c.classList.add('mapml-popup-content');\n              c.insertAdjacentHTML('afterbegin', properties.innerHTML);\n              geometry.bindPopup(c, { autoClose: false, minWidth: 165 });\n            }\n          }\n        }).addTo(layer);\n      }\n      function processTiles() {\n        if (mapml.querySelector('map-tile')) {\n          var tiles = document.createElement('map-tiles'),\n            zoom =\n              mapml.querySelector('map-meta[name=zoom][content]') ||\n              mapml.querySelector('map-input[type=zoom][value]');\n          tiles.setAttribute(\n            'zoom',\n            (zoom && zoom.getAttribute('content')) ||\n              (zoom && zoom.getAttribute('value')) ||\n              '0'\n          );\n          var newTiles = mapml.getElementsByTagName('map-tile');\n          for (var nt = 0; nt < newTiles.length; nt++) {\n            tiles.appendChild(document.importNode(newTiles[nt], true));\n          }\n          layer._mapmlTileContainer.appendChild(tiles);\n          layer._staticTileLayer = M.staticTileLayer({\n            pane: layer._container,\n            _leafletLayer: layer,\n            projection: layer.options.projection,\n            className: 'mapml-static-tile-layer',\n            tileContainer: layer._mapmlTileContainer,\n            maxZoomBound:\n              M[layer.options.projection].options.resolutions.length - 1,\n            tileSize: M[layer.options.projection].options.crs.tile.bounds.max.x\n          });\n        }\n      }\n      function setLayerTitle() {\n        if (mapml.querySelector('map-title')) {\n          layer._title = mapml.querySelector('map-title').textContent.trim();\n          layer._titleIsReadOnly = true;\n        } else if (layer._layerEl && layer._layerEl.hasAttribute('label')) {\n          layer._title = layer._layerEl.getAttribute('label').trim();\n        }\n      }\n      function parseLicenseAndLegend() {\n        var licenseLink = mapml.querySelector('map-link[rel=license]'),\n          licenseTitle,\n          licenseUrl,\n          attText;\n        if (licenseLink) {\n          licenseTitle = licenseLink.getAttribute('title');\n          licenseUrl = licenseLink.getAttribute('href');\n          attText =\n            '<a href=\"' +\n            licenseUrl +\n            '\" title=\"' +\n            licenseTitle +\n            '\">' +\n            licenseTitle +\n            '</a>';\n        }\n        L.setOptions(layer, { attribution: attText });\n        var legendLink = mapml.querySelector('map-link[rel=legend]');\n        if (legendLink) {\n          layer._legendUrl = legendLink.getAttribute('href');\n        }\n        if (layer._map) {\n          // if the layer is checked in the layer control, force the addition\n          // of the attribution just received\n          if (layer._map.hasLayer(layer)) {\n            layer._map.attributionControl.addAttribution(layer.getAttribution());\n          }\n        }\n      }\n    },\n    getQueryTemplates: function (location, zoom) {\n      const queryLinks = this._layerEl.querySelectorAll(\n        'map-extent[checked] map-link[rel=query]'\n      ).length\n        ? this._layerEl.querySelectorAll(\n            'map-extent[checked] map-link[rel=query]'\n          )\n        : this._layerEl.shadowRoot.querySelectorAll(\n            'map-extent[checked] map-link[rel=query]'\n          ).length\n        ? this._layerEl.shadowRoot.querySelectorAll(\n            'map-extent[checked] map-link[rel=query]'\n          )\n        : null;\n      if (queryLinks) {\n        var templates = [];\n        for (let i = 0; i < queryLinks.length; i++) {\n          const minZoom = queryLinks[i].extent.zoom.minZoom,\n            maxZoom = queryLinks[i].extent.zoom.maxZoom,\n            withinZoomBounds = (z) => {\n              return minZoom <= z && z <= maxZoom;\n            },\n            bounds = queryLinks[i].getBounds();\n\n          if (bounds.contains(location) && withinZoomBounds(zoom)) {\n            templates.push(queryLinks[i]._templateVars);\n          }\n        }\n        return templates;\n      }\n    },\n    _attachSkipButtons: function (e) {\n      let popup = e.popup,\n        map = e.target,\n        layer,\n        group,\n        content = popup._container.getElementsByClassName(\n          'mapml-popup-content'\n        )[0];\n\n      popup._container.setAttribute('role', 'dialog');\n      content.setAttribute('tabindex', '-1');\n      // https://github.com/Maps4HTML/Web-Map-Custom-Element/pull/467#issuecomment-844307818\n      content.setAttribute('role', 'document');\n      popup._count = 0; // used for feature pagination\n\n      if (popup._source._eventParents) {\n        // check if the popup is for a feature or query\n        layer =\n          popup._source._eventParents[\n            Object.keys(popup._source._eventParents)[0]\n          ]; // get first parent of feature, there should only be one\n        group = popup._source.group;\n        // if the popup is for a static / templated feature, the \"zoom to here\" link can be attached once the popup opens\n        attachZoomLink.call(popup);\n      } else {\n        // getting access to the first map-extent to get access to _extentLayer to use it's (possibly) generic _previousFeature + _nextFeature methods.\n        const mapExtent =\n          popup._source._layerEl.querySelector('map-extent') ||\n          popup._source._layerEl.shadowRoot.querySelector('map-extent');\n        layer = mapExtent._extentLayer;\n        // if the popup is for a query, the \"zoom to here\" link should be re-attached every time new pagination features are displayed\n        map.on('attachZoomLink', attachZoomLink, popup);\n      }\n\n      if (popup._container.querySelector('nav[class=\"mapml-focus-buttons\"]')) {\n        L.DomUtil.remove(\n          popup._container.querySelector('nav[class=\"mapml-focus-buttons\"]')\n        );\n        L.DomUtil.remove(popup._container.querySelector('hr'));\n      }\n      //add when popopen event happens instead\n      let div = L.DomUtil.create('nav', 'mapml-focus-buttons');\n\n      // creates |< button, focuses map\n      let mapFocusButton = L.DomUtil.create('button', 'mapml-popup-button', div);\n      mapFocusButton.type = 'button';\n      mapFocusButton.title = 'Focus Map';\n      mapFocusButton.innerHTML = \"<span aria-hidden='true'>|&#10094;</span>\";\n      L.DomEvent.on(\n        mapFocusButton,\n        'click',\n        (e) => {\n          L.DomEvent.stop(e);\n          map.featureIndex._sortIndex();\n          map.closePopup();\n          map._container.focus();\n        },\n        popup\n      );\n\n      // creates < button, focuses previous feature, if none exists focuses the current feature\n      let previousButton = L.DomUtil.create('button', 'mapml-popup-button', div);\n      previousButton.type = 'button';\n      previousButton.title = 'Previous Feature';\n      previousButton.innerHTML = \"<span aria-hidden='true'>&#10094;</span>\";\n      L.DomEvent.on(previousButton, 'click', layer._previousFeature, popup);\n\n      // static feature counter that 1/1\n      let featureCount = L.DomUtil.create('p', 'mapml-feature-count', div),\n        totalFeatures = this._totalFeatureCount ? this._totalFeatureCount : 1;\n      featureCount.innerText = popup._count + 1 + '/' + totalFeatures;\n\n      // creates > button, focuses next feature, if none exists focuses the current feature\n      let nextButton = L.DomUtil.create('button', 'mapml-popup-button', div);\n      nextButton.type = 'button';\n      nextButton.title = 'Next Feature';\n      nextButton.innerHTML = \"<span aria-hidden='true'>&#10095;</span>\";\n      L.DomEvent.on(nextButton, 'click', layer._nextFeature, popup);\n\n      // creates >| button, focuses map controls\n      let controlFocusButton = L.DomUtil.create(\n        'button',\n        'mapml-popup-button',\n        div\n      );\n      controlFocusButton.type = 'button';\n      controlFocusButton.title = 'Focus Controls';\n      controlFocusButton.innerHTML = \"<span aria-hidden='true'>&#10095;|</span>\";\n      L.DomEvent.on(\n        controlFocusButton,\n        'click',\n        (e) => {\n          map.featureIndex._sortIndex();\n          map.featureIndex.currentIndex =\n            map.featureIndex.inBoundFeatures.length - 1;\n          map.featureIndex.inBoundFeatures[0]?.path.setAttribute('tabindex', -1);\n          map.featureIndex.inBoundFeatures[\n            map.featureIndex.currentIndex\n          ]?.path.setAttribute('tabindex', 0);\n          L.DomEvent.stop(e);\n          map.closePopup();\n          map._controlContainer.querySelector('A:not([hidden])').focus();\n        },\n        popup\n      );\n\n      let divider = L.DomUtil.create('hr', 'mapml-popup-divider');\n\n      popup._navigationBar = div;\n      popup._content.appendChild(divider);\n      popup._content.appendChild(div);\n\n      content.focus();\n\n      if (group && !M.options.featureIndexOverlayOption) {\n        // e.target = this._map\n        // Looks for keydown, more specifically tab and shift tab\n        group.setAttribute('aria-expanded', 'true');\n        map.on('keydown', focusFeature);\n      } else {\n        map.on('keydown', focusMap);\n      }\n      // When popup is open, what gets focused with tab needs to be done using JS as the DOM order is not in an accessibility friendly manner\n      function focusFeature(focusEvent) {\n        let path =\n          focusEvent.originalEvent.path ||\n          focusEvent.originalEvent.composedPath();\n        let isTab = focusEvent.originalEvent.keyCode === 9,\n          shiftPressed = focusEvent.originalEvent.shiftKey;\n        if (\n          (path[0].classList.contains('leaflet-popup-close-button') &&\n            isTab &&\n            !shiftPressed) ||\n          focusEvent.originalEvent.keyCode === 27 ||\n          (path[0].classList.contains('leaflet-popup-close-button') &&\n            focusEvent.originalEvent.keyCode === 13)\n        ) {\n          setTimeout(() => {\n            map.closePopup(popup);\n            group.focus();\n            L.DomEvent.stop(focusEvent);\n          }, 0);\n        } else if (\n          path[0].classList.contains('mapml-popup-content') &&\n          isTab &&\n          shiftPressed\n        ) {\n          setTimeout(() => {\n            //timeout needed so focus of the feature is done even after the keypressup event occurs\n            map.closePopup(popup);\n            group.focus();\n            L.DomEvent.stop(focusEvent);\n          }, 0);\n        } else if (\n          path[0] === popup._content.querySelector('a') &&\n          isTab &&\n          shiftPressed\n        ) {\n          setTimeout(() => {\n            map.closePopup(popup);\n            group.focus();\n            L.DomEvent.stop(focusEvent);\n          }, 0);\n        }\n      }\n\n      function focusMap(focusEvent) {\n        let path =\n          focusEvent.originalEvent.path ||\n          focusEvent.originalEvent.composedPath();\n        let isTab = focusEvent.originalEvent.keyCode === 9,\n          shiftPressed = focusEvent.originalEvent.shiftKey;\n\n        if (\n          (focusEvent.originalEvent.keyCode === 13 &&\n            path[0].classList.contains('leaflet-popup-close-button')) ||\n          focusEvent.originalEvent.keyCode === 27\n        ) {\n          L.DomEvent.stopPropagation(focusEvent);\n          map.closePopup(popup);\n          map._container.focus();\n          if (focusEvent.originalEvent.keyCode !== 27) map._popupClosed = true;\n        } else if (\n          isTab &&\n          path[0].classList.contains('leaflet-popup-close-button')\n        ) {\n          map.closePopup(popup);\n        } else if (\n          path[0].classList.contains('mapml-popup-content') &&\n          isTab &&\n          shiftPressed\n        ) {\n          map.closePopup(popup);\n          setTimeout(() => {\n            //timeout needed so focus of the feature is done even after the keypressup event occurs\n            L.DomEvent.stop(focusEvent);\n            map._container.focus();\n          }, 0);\n        } else if (\n          path[0] === popup._content.querySelector('a') &&\n          isTab &&\n          shiftPressed\n        ) {\n          map.closePopup(popup);\n          setTimeout(() => {\n            L.DomEvent.stop(focusEvent);\n            map.getContainer.focus();\n          }, 0);\n        }\n      }\n\n      function attachZoomLink(e) {\n        // this === popup\n        let content = this._content,\n          featureEl = e ? e.currFeature : this._source._groupLayer._featureEl;\n        if (content.querySelector('a.mapml-zoom-link')) {\n          content.querySelector('a.mapml-zoom-link').remove();\n        }\n        if (!featureEl.querySelector('map-geometry')) return;\n        let tL = featureEl.extent.topLeft.gcrs,\n          bR = featureEl.extent.bottomRight.gcrs,\n          center = L.latLngBounds(\n            L.latLng(tL.horizontal, tL.vertical),\n            L.latLng(bR.horizontal, bR.vertical)\n          ).getCenter(true);\n        let zoomLink = document.createElement('a');\n        zoomLink.href = `#${featureEl.getZoomToZoom()},${center.lng},${\n        center.lat\n      }`;\n        zoomLink.innerHTML = `${M.options.locale.popupZoom}`;\n        zoomLink.className = 'mapml-zoom-link';\n        zoomLink.onclick = zoomLink.onkeydown = function (e) {\n          if (!(e instanceof MouseEvent) && e.keyCode !== 13) return;\n          e.preventDefault();\n          featureEl.zoomTo();\n          map.closePopup();\n          map.getContainer().focus();\n        };\n        // we found that the popupopen event is fired as many times as there\n        // are layers on the map (<layer-> elements / MapMLLayers that is).\n        // In each case the target layer is always this layer, so we can't\n        // detect and conditionally add the zoomLink if the target is not this.\n        // so, like Ahmad, we are taking a 'delete everyting each time'\n        // approach (see _attachSkipButtons for this approach taken with\n        // feature navigation buttons); obviously he dealt with this leaflet bug\n        // this way some time ago, and we can't figure out how to get around it\n        // apart from this slightly non-optimal method. Revisit sometime!\n        let link = content.querySelector('.mapml-zoom-link');\n        if (link) link.remove();\n        content.insertBefore(\n          zoomLink,\n          content.querySelector('hr.mapml-popup-divider')\n        );\n      }\n\n      // if popup closes then the focusFeature handler can be removed\n      map.on('popupclose', removeHandlers);\n      function removeHandlers(removeEvent) {\n        if (removeEvent.popup === popup) {\n          map.off('keydown', focusFeature);\n          map.off('keydown', focusMap);\n          map.off('popupopen', attachZoomLink);\n          map.off('popupclose', removeHandlers);\n          if (group) group.setAttribute('aria-expanded', 'false');\n        }\n      }\n    }\n  });\n  var mapMLLayer = function (url, node, options) {\n    if (!url && !node) return null;\n    return new MapMLLayer(url, node, options);\n  };\n\n  var DebugOverlay = L.Layer.extend({\n    onAdd: function (map) {\n      let mapSize = map.getSize();\n\n      //conditionally show container for debug panel/banner only when the map has enough space for it\n      if (mapSize.x > 400 || mapSize.y > 300) {\n        this._container = L.DomUtil.create(\n          'table',\n          'mapml-debug',\n          map._container\n        );\n\n        this._panel = debugPanel({\n          className: 'mapml-debug-panel',\n          pane: this._container\n        });\n        map.addLayer(this._panel);\n      }\n\n      this._grid = debugGrid({\n        className: 'mapml-debug-grid',\n        pane: map._panes.mapPane,\n        zIndex: 400,\n        tileSize: map.options.crs.options.crs.tile.bounds.max.x\n      });\n      map.addLayer(this._grid);\n\n      this._vectors = debugVectors({\n        className: 'mapml-debug-vectors',\n        pane: map._panes.mapPane,\n        toolPane: this._container\n      });\n      map.addLayer(this._vectors);\n    },\n\n    onRemove: function (map) {\n      map.removeLayer(this._grid);\n      map.removeLayer(this._vectors);\n      if (this._panel) {\n        //conditionally remove the panel, as it's not always added\n        map.removeLayer(this._panel);\n        L.DomUtil.remove(this._container);\n      }\n    }\n  });\n\n  var debugOverlay = function () {\n    return new DebugOverlay();\n  };\n\n  var DebugPanel = L.Layer.extend({\n    initialize: function (options) {\n      L.setOptions(this, options);\n    },\n\n    onAdd: function (map) {\n      this._title = L.DomUtil.create(\n        'caption',\n        'mapml-debug-banner',\n        this.options.pane\n      );\n      this._title.innerHTML = 'Debug mode';\n\n      map.debug = {};\n      map.debug._infoContainer = this._debugContainer = L.DomUtil.create(\n        'tbody',\n        'mapml-debug-panel',\n        this.options.pane\n      );\n\n      let infoContainer = map.debug._infoContainer;\n\n      map.debug._tileCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n      map.debug._tileMatrixCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n      map.debug._mapCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n      map.debug._tcrsCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n      map.debug._pcrsCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n      map.debug._gcrsCoord = L.DomUtil.create(\n        'tr',\n        'mapml-debug-coordinates',\n        infoContainer\n      );\n\n      this._map.on('mousemove', this._updateCoords);\n    },\n    onRemove: function () {\n      L.DomUtil.remove(this._title);\n      if (this._debugContainer) {\n        L.DomUtil.remove(this._debugContainer);\n        this._map.off('mousemove', this._updateCoords);\n      }\n    },\n    _updateCoords: function (e) {\n      if (this.contextMenu._visible) return;\n      let mapEl = this.options.mapEl,\n        point = mapEl._map.project(e.latlng),\n        scale = mapEl._map.options.crs.scale(+mapEl.zoom),\n        pcrs = mapEl._map.options.crs.transformation.untransform(point, scale),\n        tileSize = mapEl._map.options.crs.options.crs.tile.bounds.max.x,\n        pointI = point.x % tileSize,\n        pointJ = point.y % tileSize;\n\n      if (pointI < 0) pointI += tileSize;\n      if (pointJ < 0) pointJ += tileSize;\n\n      this.debug._tileCoord.innerHTML = `\n      <th scope=\"row\">tile: </th>\n      <td>i: ${Math.trunc(pointI)}, </td>\n      <td>j: ${Math.trunc(pointJ)}</td>\n      `;\n      this.debug._mapCoord.innerHTML = `\n      <th scope=\"row\">map: </th>\n      <td>i: ${Math.trunc(e.containerPoint.x)}, </td>\n      <td>j: ${Math.trunc(e.containerPoint.y)}</td>\n      `;\n      this.debug._gcrsCoord.innerHTML = `\n      <th scope=\"row\">gcrs: </th>\n      <td>lon: ${e.latlng.lng.toFixed(6)}, </td>\n      <td>lat: ${e.latlng.lat.toFixed(6)}</td>\n      `;\n      this.debug._tcrsCoord.innerHTML = `\n      <th scope=\"row\">tcrs: </th>\n      <td>x: ${Math.trunc(point.x)}, </td>\n      <td>y: ${Math.trunc(point.y)}</td>\n      `;\n      this.debug._tileMatrixCoord.innerHTML = `\n      <th scope=\"row\">tilematrix: </th>\n      <td>column: ${Math.trunc(point.x / tileSize)}, </td>\n      <td>row: ${Math.trunc(point.y / tileSize)}</td>\n      `;\n      this.debug._pcrsCoord.innerHTML = `\n      <th scope=\"row\">pcrs: </th>\n      <td>easting: ${pcrs.x.toFixed(2)}, </td>\n      <td>northing: ${pcrs.y.toFixed(2)}</td>\n      `;\n    }\n  });\n\n  var debugPanel = function (options) {\n    return new DebugPanel(options);\n  };\n\n  var DebugGrid = L.GridLayer.extend({\n    initialize: function (options) {\n      L.setOptions(this, options);\n      L.GridLayer.prototype.initialize.call(this, this._map);\n    },\n\n    createTile: function (coords) {\n      let tile = L.DomUtil.create('div', 'mapml-debug-tile');\n      tile.setAttribute('col', coords.x);\n      tile.setAttribute('row', coords.y);\n      tile.setAttribute('zoom', coords.z);\n      tile.innerHTML = [\n        `col: ${coords.x}`,\n        `row: ${coords.y}`,\n        `zoom: ${coords.z}`\n      ].join(', ');\n\n      tile.style.outline = '1px dashed red';\n      return tile;\n    }\n  });\n\n  var debugGrid = function (options) {\n    return new DebugGrid(options);\n  };\n\n  var DebugVectors = L.LayerGroup.extend({\n    initialize: function (options) {\n      L.setOptions(this, options);\n      L.LayerGroup.prototype.initialize.call(this, this._map, options);\n    },\n    onAdd: function (map) {\n      map.on('overlayremove', this._mapLayerUpdate, this);\n      map.on('overlayadd', this._mapLayerUpdate, this);\n      let center = map.options.crs.transformation.transform(\n        L.point(0, 0),\n        map.options.crs.scale(0)\n      );\n      this._centerVector = L.circle(map.options.crs.pointToLatLng(center, 0), {\n        radius: 250,\n        className: 'mapml-debug-vectors projection-centre'\n      });\n      this._centerVector.bindTooltip('Projection Center');\n\n      this._addBounds(map);\n    },\n    onRemove: function (map) {\n      this.clearLayers();\n    },\n\n    _addBounds: function (map) {\n      // to delay the addBounds to wait for the layer.extentbounds / layer.layerbounds to be ready when the layer- checked attribute is changed\n      setTimeout(() => {\n        let id = Object.keys(map._layers),\n          layers = map._layers,\n          colors = ['#FF5733', '#8DFF33', '#3397FF', '#E433FF', '#F3FF33'],\n          j = 0;\n\n        this.addLayer(this._centerVector);\n\n        for (let i of id) {\n          if (layers[i].layerBounds || layers[i].extentBounds) {\n            let boundsArray;\n            if (layers[i].layerBounds) {\n              boundsArray = [\n                layers[i].layerBounds.min,\n                L.point(layers[i].layerBounds.max.x, layers[i].layerBounds.min.y),\n                layers[i].layerBounds.max,\n                L.point(layers[i].layerBounds.min.x, layers[i].layerBounds.max.y)\n              ];\n            } else {\n              boundsArray = [\n                layers[i].extentBounds.min,\n                L.point(\n                  layers[i].extentBounds.max.x,\n                  layers[i].extentBounds.min.y\n                ),\n                layers[i].extentBounds.max,\n                L.point(\n                  layers[i].extentBounds.min.x,\n                  layers[i].extentBounds.max.y\n                )\n              ];\n            }\n\n            // boundsTestTag adds the value of from the <layer-@data-testid> element\n            // if it exists. this simplifies debugging because the svg path will be\n            // tagged with the layer it came from\n            let boundsTestTag =\n              layers[i].extentBounds &&\n              layers[i].options.linkEl.getLayerEl().hasAttribute('data-testid')\n                ? layers[i].options.linkEl\n                    .getLayerEl()\n                    .getAttribute('data-testid')\n                : layers[i].layerBounds &&\n                  layers[i].options?._leafletLayer?._layerEl.hasAttribute(\n                    'data-testid'\n                  )\n                ? layers[i].options._leafletLayer._layerEl.getAttribute(\n                    'data-testid'\n                  )\n                : '';\n            let boundsRect = projectedExtent(boundsArray, {\n              className: this.options.className.concat(' ', boundsTestTag),\n              color: colors[j % colors.length],\n              weight: 2,\n              opacity: 1,\n              fillOpacity: 0.01,\n              fill: true\n            });\n            if (layers[i].options._leafletLayer)\n              boundsRect.bindTooltip(layers[i].options._leafletLayer._title, {\n                sticky: true\n              });\n            this.addLayer(boundsRect);\n            j++;\n          }\n        }\n\n        if (map.totalLayerBounds) {\n          let totalBoundsArray = [\n            map.totalLayerBounds.min,\n            L.point(map.totalLayerBounds.max.x, map.totalLayerBounds.min.y),\n            map.totalLayerBounds.max,\n            L.point(map.totalLayerBounds.min.x, map.totalLayerBounds.max.y)\n          ];\n\n          let totalBounds = projectedExtent(totalBoundsArray, {\n            className: 'mapml-debug-vectors mapml-total-bounds',\n            color: '#808080',\n            weight: 5,\n            opacity: 0.5,\n            fill: false\n          });\n          this.addLayer(totalBounds);\n        }\n      }, 0);\n    },\n\n    _mapLayerUpdate: function (e) {\n      this.clearLayers();\n      this._addBounds(e.target);\n    }\n  });\n\n  var debugVectors = function (options) {\n    return new DebugVectors(options);\n  };\n\n  var ProjectedExtent = L.Path.extend({\n    getCenter: function (round) {\n      let crs = this._map.options.crs;\n      return crs.unproject(L.bounds(this._locations).getCenter());\n    },\n\n    options: {\n      className: 'mapml-debug-extent'\n    },\n    initialize: function (locations, options) {\n      //locations passed in as pcrs coordinates\n      this._locations = locations;\n      L.setOptions(this, options);\n    },\n\n    _project: function () {\n      this._rings = [];\n      let scale = this._map.options.crs.scale(this._map.getZoom()),\n        map = this._map;\n      for (let i = 0; i < this._locations.length; i++) {\n        let point = map.options.crs.transformation.transform(\n          this._locations[i],\n          scale\n        );\n        //substract the pixel origin from the pixel coordinates to get the location relative to map viewport\n        this._rings.push(\n          L.point(point.x, point.y)._subtract(map.getPixelOrigin())\n        );\n      }\n      //leaflet SVG renderer looks for and array of arrays to build polygons,\n      //in this case it only deals with a rectangle so one closed array or points\n      this._parts = [this._rings];\n    },\n\n    _update: function () {\n      if (!this._map) return;\n      this._renderer._updatePoly(this, true); //passing true creates a closed path i.e. a rectangle\n    }\n  });\n\n  var projectedExtent = function (locations, options) {\n    return new ProjectedExtent(locations, options);\n  };\n\n  var QueryHandler = L.Handler.extend({\n    addHooks: function () {\n      // get a reference to the actual <map> element, so we can\n      // use its layers property to iterate the layers from top down\n      // evaluating if they are 'on the map' (enabled)\n      L.setOptions(this, { mapEl: this._map.options.mapEl });\n      L.DomEvent.on(this._map, 'click', this._queryTopLayer, this);\n      L.DomEvent.on(this._map, 'keypress', this._queryTopLayerAtMapCenter, this);\n    },\n    removeHooks: function () {\n      L.DomEvent.off(this._map, 'click', this._queryTopLayer, this);\n      L.DomEvent.on(this._map, 'keypress', this._queryTopLayerAtMapCenter, this);\n    },\n    _getTopQueryableLayer: function () {\n      var layers = this.options.mapEl.layers;\n      // work backwards in document order (top down)\n      for (var l = layers.length - 1; l >= 0; l--) {\n        if (layers[l].queryable()) {\n          return layers[l]._layer;\n        }\n      }\n    },\n    _queryTopLayerAtMapCenter: function (event) {\n      setTimeout(() => {\n        if (\n          this._map.isFocused &&\n          !this._map._popupClosed &&\n          (event.originalEvent.key === ' ' || +event.originalEvent.keyCode === 13)\n        ) {\n          this._map.fire('click', {\n            latlng: this._map.getCenter(),\n            layerPoint: this._map.latLngToLayerPoint(this._map.getCenter()),\n            containerPoint: this._map.latLngToContainerPoint(\n              this._map.getCenter()\n            )\n          });\n        } else {\n          delete this._map._popupClosed;\n        }\n      }, 0);\n    },\n    _queryTopLayer: function (event) {\n      var layer = this._getTopQueryableLayer();\n      if (layer) {\n        if (layer._mapmlFeatures) delete layer._mapmlFeatures;\n        this._query(event, layer);\n      }\n    },\n    _query(e, layer) {\n      var zoom = e.target.getZoom(),\n        map = this._map,\n        crs = M[layer.options.projection], // the crs for each extent would be the same\n        tileSize = map.options.crs.options.crs.tile.bounds.max.x,\n        container = layer._container,\n        popupOptions = {\n          autoClose: false,\n          autoPan: true,\n          maxHeight: map.getSize().y * 0.5 - 50\n        },\n        tcrs2pcrs = function (c) {\n          return crs.transformation.untransform(c, crs.scale(zoom));\n        },\n        tcrs2gcrs = function (c) {\n          return crs.unproject(\n            crs.transformation.untransform(c, crs.scale(zoom)),\n            zoom\n          );\n        };\n      var tcrsClickLoc = crs.latLngToPoint(e.latlng, zoom),\n        tileMatrixClickLoc = tcrsClickLoc.divideBy(tileSize).floor(),\n        tileBounds = new L.Bounds(\n          tcrsClickLoc.divideBy(tileSize).floor().multiplyBy(tileSize),\n          tcrsClickLoc.divideBy(tileSize).ceil().multiplyBy(tileSize)\n        );\n\n      let point = this._map.project(e.latlng),\n        scale = this._map.options.crs.scale(this._map.getZoom()),\n        pcrsClick = this._map.options.crs.transformation.untransform(\n          point,\n          scale\n        );\n      let templates = layer.getQueryTemplates(pcrsClick, zoom);\n\n      let fetches = [];\n\n      var fetchFeatures = function (template, obj) {\n        const parser = new DOMParser();\n        return fetch(L.Util.template(template.template, obj), {\n          redirect: 'follow'\n        })\n          .then((response) => {\n            if (response.status >= 200 && response.status < 300) {\n              return response.text().then((text) => {\n                return {\n                  contenttype: response.headers.get('Content-Type'),\n                  text: text\n                };\n              });\n            } else {\n              throw new Error(response.status);\n            }\n          })\n          .then((response) => {\n            let features = [];\n            let queryMetas = [];\n            let geom =\n              \"<map-geometry cs='gcrs'><map-point><map-coordinates>\" +\n              e.latlng.lng +\n              ' ' +\n              e.latlng.lat +\n              '</map-coordinates></map-point></map-geometry>';\n            if (response.contenttype.startsWith('text/mapml')) {\n              // the mapmldoc could have <map-meta> elements that are important, perhaps\n              // also, the mapmldoc can have many features\n              let mapmldoc = parser.parseFromString(\n                response.text,\n                'application/xml'\n              );\n              let geometrylessFeatures = mapmldoc.querySelectorAll(\n                'map-feature:not(:has(map-geometry))'\n              );\n              if (geometrylessFeatures.length) {\n                let g = parser.parseFromString(geom, 'application/xml');\n                for (let i = 0; i < geometrylessFeatures.length; i++) {\n                  let f = geometrylessFeatures[i];\n                  f.appendChild(g.firstElementChild.cloneNode(true));\n                }\n              }\n              features = Array.prototype.slice.call(\n                mapmldoc.querySelectorAll('map-feature')\n              );\n              // <map-meta> elements for this query\n              queryMetas = Array.prototype.slice.call(\n                mapmldoc.querySelectorAll(\n                  'map-meta[name=cs], map-meta[name=zoom], map-meta[name=projection]'\n                )\n              );\n              if (queryMetas.length)\n                features.forEach((f) => (f.meta = queryMetas));\n            } else {\n              try {\n                let featureDocument = parser.parseFromString(\n                  response.text,\n                  'application/xml'\n                );\n                let featureCollection =\n                  featureDocument.querySelectorAll('map-feature');\n                if (\n                  featureDocument.querySelector('parsererror') ||\n                  featureCollection.length === 0\n                ) {\n                  throw new Error('parsererror');\n                }\n                let g = parser.parseFromString(geom, 'application/xml');\n                queryMetas = Array.prototype.slice.call(\n                  featureDocument.querySelectorAll(\n                    'map-meta[name=cs], map-meta[name=zoom], map-meta[name=projection]'\n                  )\n                );\n                for (let feature of featureCollection) {\n                  if (!feature.querySelector('map-geometry')) {\n                    feature.appendChild(g.firstElementChild.cloneNode(true));\n                  }\n                  feature.meta = queryMetas;\n                  features.push(feature);\n                }\n              } catch (err) {\n                // try the html parser; script elements are marked as non-functional\n                // by that api, which hopefully works!\n                let html = parser.parseFromString(response.text, 'text/html');\n\n                // synthesize a single feature from text or html content\n                let featureDoc = parser.parseFromString(\n                  '<map-feature><map-properties>' +\n                    '</map-properties>' +\n                    geom +\n                    '</map-feature>',\n                  'text/html'\n                );\n                if (html.body) {\n                  featureDoc\n                    .querySelector('map-properties')\n                    .appendChild(html.querySelector('html'));\n                } else {\n                  featureDoc\n                    .querySelector('map-properties')\n                    .append(response.text);\n                }\n                features.push(featureDoc.querySelector('map-feature'));\n              }\n            }\n            return { features: features, template: template };\n          })\n          .catch((err) => {\n            console.log('Looks like there was a problem. Status: ' + err.message);\n          });\n      };\n\n      for (let i = 0; i < templates.length; i++) {\n        var obj = {},\n          template = templates[i];\n\n        // all of the following are locations that might be used in a query, I think.\n        obj[template.query.tilei] =\n          tcrsClickLoc.x.toFixed() - tileMatrixClickLoc.x * tileSize;\n        obj[template.query.tilej] =\n          tcrsClickLoc.y.toFixed() - tileMatrixClickLoc.y * tileSize;\n\n        // this forces the click to the centre of the map extent in the layer crs\n        obj[template.query.mapi] = map.getSize().divideBy(2).x.toFixed();\n        obj[template.query.mapj] = map.getSize().divideBy(2).y.toFixed();\n\n        obj[template.query.pixelleft] = crs.pointToLatLng(tcrsClickLoc, zoom).lng;\n        obj[template.query.pixeltop] = crs.pointToLatLng(tcrsClickLoc, zoom).lat;\n        obj[template.query.pixelright] = crs.pointToLatLng(\n          tcrsClickLoc.add([1, 1]),\n          zoom\n        ).lng;\n        obj[template.query.pixelbottom] = crs.pointToLatLng(\n          tcrsClickLoc.add([1, 1]),\n          zoom\n        ).lat;\n\n        obj[template.query.column] = tileMatrixClickLoc.x;\n        obj[template.query.row] = tileMatrixClickLoc.y;\n        obj[template.query.x] = tcrsClickLoc.x.toFixed();\n        obj[template.query.y] = tcrsClickLoc.y.toFixed();\n\n        // whereas the layerPoint is calculated relative to the origin plus / minus any\n        // pan movements so is equal to containerPoint at first before any pans, but\n        // changes as the map pans.\n        obj[template.query.easting] = tcrs2pcrs(tcrsClickLoc).x;\n        obj[template.query.northing] = tcrs2pcrs(tcrsClickLoc).y;\n        obj[template.query.longitude] = tcrs2gcrs(tcrsClickLoc).lng;\n        obj[template.query.latitude] = tcrs2gcrs(tcrsClickLoc).lat;\n        obj[template.query.zoom] = zoom;\n        obj[template.query.width] = map.getSize().x;\n        obj[template.query.height] = map.getSize().y;\n        // assumes the click is at the centre of the map, per template.query.mapi, mapj above\n        obj[template.query.mapbottom] = tcrs2pcrs(\n          tcrsClickLoc.add(map.getSize().divideBy(2))\n        ).y;\n        obj[template.query.mapleft] = tcrs2pcrs(\n          tcrsClickLoc.subtract(map.getSize().divideBy(2))\n        ).x;\n        obj[template.query.maptop] = tcrs2pcrs(\n          tcrsClickLoc.subtract(map.getSize().divideBy(2))\n        ).y;\n        obj[template.query.mapright] = tcrs2pcrs(\n          tcrsClickLoc.add(map.getSize().divideBy(2))\n        ).x;\n\n        obj[template.query.tilebottom] = tcrs2pcrs(tileBounds.max).y;\n        obj[template.query.tileleft] = tcrs2pcrs(tileBounds.min).x;\n        obj[template.query.tiletop] = tcrs2pcrs(tileBounds.min).y;\n        obj[template.query.tileright] = tcrs2pcrs(tileBounds.max).x;\n        // add hidden or other variables that may be present into the values to\n        // be processed by L.Util.template below.\n        for (var v in template.query) {\n          if (\n            [\n              'mapi',\n              'mapj',\n              'tilei',\n              'tilej',\n              'row',\n              'col',\n              'x',\n              'y',\n              'easting',\n              'northing',\n              'longitude',\n              'latitude',\n              'width',\n              'height',\n              'zoom',\n              'mapleft',\n              'mapright',\n              ',maptop',\n              'mapbottom',\n              'tileleft',\n              'tileright',\n              'tiletop',\n              'tilebottom',\n              'pixeltop',\n              'pixelbottom',\n              'pixelleft',\n              'pixelright'\n            ].indexOf(v) < 0\n          ) {\n            obj[v] = template.query[v];\n          }\n        }\n        fetches.push(fetchFeatures(template, obj));\n      }\n      Promise.allSettled(fetches).then((results) => {\n        layer._mapmlFeatures = [];\n        // f is an array of {features[], template}\n\n        for (let f of results) {\n          if (f.status === 'fulfilled') {\n            // create connection between queried <map-feature> and its parent <map-link>\n            for (let feature of f.value.features) {\n              feature._linkEl = f.value.template.linkEl;\n            }\n            layer._mapmlFeatures = layer._mapmlFeatures.concat(f.value.features);\n          }\n        }\n        if (layer._mapmlFeatures.length > 0)\n          displayFeaturesPopup(layer._mapmlFeatures, e.latlng);\n      });\n\n      function displayFeaturesPopup(features, loc) {\n        if (features.length === 0) return;\n        let f = M.featureLayer(features, {\n          // pass the vector layer a renderer of its own, otherwise leaflet\n          // puts everything into the overlayPane\n          renderer: M.featureRenderer(),\n          // pass the vector layer the container for the parent into which\n          // it will append its own container for rendering into\n          pane: container,\n          //color: 'yellow',\n          // instead of unprojecting and then projecting and scaling,\n          // a much smarter approach would be to scale at the current\n          // zoom\n          projection: map.options.projection,\n          _leafletLayer: layer,\n          query: true,\n          mapEl: layer.options.mapEl\n        });\n\n        f.addTo(layer);\n\n        let div = L.DomUtil.create('div', 'mapml-popup-content'),\n          c = L.DomUtil.create('iframe');\n        c.style = 'border: none';\n        c.srcdoc = features[0].querySelector(\n          'map-feature map-properties'\n        ).innerHTML;\n        c.setAttribute('sandbox', 'allow-same-origin allow-forms');\n        div.appendChild(c);\n        // passing a latlng to the popup is necessary for when there is no\n        // geometry / null geometry\n        layer._totalFeatureCount = features.length;\n        layer.bindPopup(div, popupOptions).openPopup(loc);\n        layer.on('popupclose', function () {\n          layer.removeLayer(f);\n        });\n        f.showPaginationFeature({\n          i: 0,\n          popup: layer._popup\n        });\n      }\n    }\n  });\n\n  /*\n  MIT License related to portions of M.ContextMenu \n  Copyright (c) 2017 adam.ratcliffe@gmail.com\n  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the Software), \n  to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, \n  and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n  */\n  /* global M, KeyboardEvent */\n\n  var ContextMenu = L.Handler.extend({\n    _touchstart: L.Browser.msPointer\n      ? 'MSPointerDown'\n      : L.Browser.pointer\n      ? 'pointerdown'\n      : 'touchstart',\n\n    initialize: function (map) {\n      L.Handler.prototype.initialize.call(this, map);\n      this.activeIndex = 0; //current fous index on menu\n      this.excludedIndices = [4, 7]; //menu indexes that are --------\n      this.isRunned = false; //variable for tracking edge case\n      //setting the items in the context menu and their callback functions\n      this._menuItems = {};\n\n      const CTXBACK = 0,\n        CTXFWD = 1,\n        CTXRELOAD = 2,\n        CTXFULLSCR = 3,\n        CTXSPACER1 = 4,\n        CTXCOPY = 5,\n        CTXPASTE = 6,\n        CTXSPACER2 = 7,\n        CTXCNTRLS = 8,\n        CTXDEBUG = 9,\n        CTXVWSRC = 10;\n      this._menuItems.CTXBACK = CTXBACK;\n      this._menuItems.CTXFWD = CTXFWD;\n      this._menuItems.CTXRELOAD = CTXRELOAD;\n      this._menuItems.CTXFULLSCR = CTXFULLSCR;\n      this._menuItems.CTXSPACER1 = CTXSPACER1;\n      this._menuItems.CTXCOPY = CTXCOPY;\n      this._menuItems.CTXPASTE = CTXPASTE;\n      this._menuItems.CTXSPACER2 = CTXSPACER2;\n      this._menuItems.CTXCNTRLS = CTXCNTRLS;\n      this._menuItems.CTXDEBUG = CTXDEBUG;\n      this._menuItems.CTXVWSRC = CTXVWSRC;\n\n      this._items = [\n        {\n          // 0\n          text: M.options.locale.cmBack + ' (<kbd>Alt+Left Arrow</kbd>)',\n          callback: this._goBack\n        },\n        {\n          // 1\n          text: M.options.locale.cmForward + ' (<kbd>Alt+Right Arrow</kbd>)',\n          callback: this._goForward\n        },\n        {\n          // 2\n          text: M.options.locale.cmReload + ' (<kbd>Ctrl+R</kbd>)',\n          callback: this._reload\n        },\n        {\n          // 3\n          text: M.options.locale.btnFullScreen + ' (<kbd>F</kbd>)',\n          callback: this._toggleFullScreen\n        },\n        {\n          // 4\n          spacer: '-'\n        },\n        {\n          // 5\n          text: M.options.locale.cmCopyCoords + ' (<kbd>C</kbd>)<span></span>',\n          callback: this._copyCoords,\n          hideOnSelect: false,\n          popup: true,\n          submenu: [\n            {\n              // 5.0\n              text: M.options.locale.cmCopyMapML,\n              callback: this._copyMapML\n            },\n            {\n              // 5.1\n              text: M.options.locale.cmCopyExtent,\n              callback: this._copyExtent\n            },\n            {\n              // 5.2\n              text: M.options.locale.cmCopyLocation,\n              callback: this._copyLocation\n            }\n          ]\n        },\n        {\n          // 6\n          text: M.options.locale.cmPasteLayer + ' (<kbd>P</kbd>)',\n          callback: this._paste\n        },\n        {\n          // 7\n          spacer: '-'\n        },\n        {\n          // 8\n          text: M.options.locale.cmToggleControls + ' (<kbd>T</kbd>)',\n          callback: this._toggleControls\n        },\n        {\n          // 9\n          text: M.options.locale.cmToggleDebug + ' (<kbd>D</kbd>)',\n          callback: this._toggleDebug\n        },\n        {\n          // 10\n          text: M.options.locale.cmViewSource + ' (<kbd>V</kbd>)',\n          callback: this._viewSource\n        }\n      ];\n\n      // setting the default cs for copying location and extent\n      // should be public as they are used in tests\n      this.defExtCS = M.options.defaultExtCoor;\n      this.defLocCS = M.options.defaultLocCoor;\n\n      // Used for layer and map-extent contextmenu\n      const LYRZOOMTO = 0,\n        LYRCOPY = 1;\n      this._menuItems.LYRZOOMTO = LYRZOOMTO;\n      this._menuItems.LYRCOPY = LYRCOPY;\n\n      this._layerItems = [\n        {\n          // 0\n          text: M.options.locale.lmZoomToLayer + ' (<kbd>Z</kbd>)',\n          callback: this._zoomToLayer\n        },\n        {\n          // 1\n          text: M.options.locale.lmCopyLayer + ' (<kbd>L</kbd>)',\n          callback: this._copyLayer\n        }\n      ];\n\n      this._extentLayerItems = [\n        {\n          // 0\n          text: M.options.locale.lmZoomToExtent + ' (<kbd>Z</kbd>)',\n          callback: this._zoomToMapExtent\n        },\n        {\n          // 1\n          text: M.options.locale.lmCopyExtent + ' (<kbd>L</kbd>)',\n          callback: this._copyMapExtent\n        }\n      ];\n      this._mapMenuVisible = false;\n      this._keyboardEvent = false;\n\n      this._container = L.DomUtil.create(\n        'div',\n        'mapml-contextmenu',\n        map.getContainer()\n      );\n      this._container.setAttribute('hidden', '');\n\n      this._items[CTXBACK].el = this._createItem(\n        this._container,\n        this._items[CTXBACK]\n      );\n      this._items[CTXFWD].el = this._createItem(\n        this._container,\n        this._items[CTXFWD]\n      );\n      this._items[CTXRELOAD].el = this._createItem(\n        this._container,\n        this._items[CTXRELOAD]\n      );\n      this._items[CTXFULLSCR].el = this._createItem(\n        this._container,\n        this._items[CTXFULLSCR]\n      );\n      this._items[CTXSPACER1].el = this._createItem(\n        this._container,\n        this._items[CTXSPACER1]\n      );\n      this._items[CTXCOPY].el = this._createItem(\n        this._container,\n        this._items[CTXCOPY]\n      );\n\n      this._copySubMenu = L.DomUtil.create(\n        'div',\n        'mapml-contextmenu mapml-submenu',\n        this._container\n      );\n      this._copySubMenu.id = 'mapml-copy-submenu';\n      this._copySubMenu.setAttribute('hidden', '');\n\n      this._clickEvent = null;\n\n      const CPYMENUMAP = 0,\n        CPYMENUEXTENT = 1,\n        CPYMENULOC = 2;\n      this._menuItems.CPYMENUMAP = CPYMENUMAP;\n      this._menuItems.CPYMENUEXTENT = CPYMENUEXTENT;\n      this._menuItems.CPYMENULOC = CPYMENULOC;\n      this._createItem(\n        this._copySubMenu,\n        this._items[CTXCOPY].submenu[CPYMENUMAP],\n        CPYMENUMAP\n      );\n      this._createItem(\n        this._copySubMenu,\n        this._items[CTXCOPY].submenu[CPYMENUEXTENT],\n        CPYMENUEXTENT\n      );\n      this._createItem(\n        this._copySubMenu,\n        this._items[CTXCOPY].submenu[CPYMENULOC],\n        CPYMENULOC\n      );\n\n      this._items[CTXPASTE].el = this._createItem(\n        this._container,\n        this._items[CTXPASTE]\n      );\n      this._items[CTXSPACER2].el = this._createItem(\n        this._container,\n        this._items[CTXSPACER2]\n      );\n      this._items[CTXCNTRLS].el = this._createItem(\n        this._container,\n        this._items[CTXCNTRLS]\n      );\n      this._items[CTXDEBUG].el = this._createItem(\n        this._container,\n        this._items[CTXDEBUG]\n      );\n      this._items[CTXVWSRC].el = this._createItem(\n        this._container,\n        this._items[CTXVWSRC]\n      );\n\n      this._layerMenu = L.DomUtil.create(\n        'div',\n        'mapml-contextmenu mapml-layer-menu',\n        map.getContainer()\n      );\n      this._layerMenu.setAttribute('hidden', '');\n      this._createItem(this._layerMenu, this._layerItems[LYRZOOMTO]);\n      this._createItem(this._layerMenu, this._layerItems[LYRCOPY]);\n\n      this._extentLayerMenu = L.DomUtil.create(\n        'div',\n        'mapml-contextmenu mapml-extent-menu',\n        map.getContainer()\n      );\n      this._extentLayerMenu.setAttribute('hidden', '');\n      this._createItem(this._extentLayerMenu, this._extentLayerItems[LYRZOOMTO]);\n      this._createItem(this._extentLayerMenu, this._extentLayerItems[LYRCOPY]);\n\n      L.DomEvent.on(this._container, 'click', L.DomEvent.stop)\n        .on(this._container, 'mousedown', L.DomEvent.stop)\n        .on(this._container, 'dblclick', L.DomEvent.stop)\n        .on(this._container, 'contextmenu', L.DomEvent.stop)\n        .on(this._layerMenu, 'click', L.DomEvent.stop)\n        .on(this._layerMenu, 'mousedown', L.DomEvent.stop)\n        .on(this._layerMenu, 'dblclick', L.DomEvent.stop)\n        .on(this._layerMenu, 'contextmenu', L.DomEvent.stop)\n        .on(this._extentLayerMenu, 'click', L.DomEvent.stop)\n        .on(this._extentLayerMenu, 'mousedown', L.DomEvent.stop)\n        .on(this._extentLayerMenu, 'dblclick', L.DomEvent.stop)\n        .on(this._extentLayerMenu, 'contextmenu', L.DomEvent.stop);\n\n      this.t = document.createElement('template');\n      this.t.innerHTML = `<map-feature zoom=\"\">\n        <map-featurecaption></map-featurecaption>\n        <map-properties>\n            <h2></h2>\n            <div style=\"text-align:center\"></div>\n        </map-properties>\n        <map-geometry cs=\"\">\n          <map-point>\n            <map-coordinates></map-coordinates>\n          </map-point>\n        </map-geometry>\n      </map-feature>`;\n    },\n\n    addHooks: function () {\n      var container = this._map.getContainer();\n\n      L.DomEvent.on(container, 'mouseleave', this._hide, this).on(\n        document,\n        'keydown',\n        this._onKeyDown,\n        this\n      );\n\n      if (L.Browser.touch) {\n        L.DomEvent.on(document, this._touchstart, this._hide, this);\n      }\n\n      this._map.on(\n        {\n          contextmenu: this._show,\n          mousedown: this._hide,\n          zoomstart: this._hide\n        },\n        this\n      );\n    },\n\n    removeHooks: function () {\n      var container = this._map.getContainer();\n\n      L.DomEvent.off(container, 'mouseleave', this._hide, this).off(\n        document,\n        'keydown',\n        this._onKeyDown,\n        this\n      );\n\n      if (L.Browser.touch) {\n        L.DomEvent.off(document, this._touchstart, this._hide, this);\n      }\n\n      this._map.off(\n        {\n          contextmenu: this._show,\n          mousedown: this._hide,\n          zoomstart: this._hide\n        },\n        this\n      );\n    },\n\n    _updateCS: function () {\n      if (\n        this.defExtCS !== M.options.defaultExtCoor ||\n        this.defLocCS !== M.options.defaultLocCoor\n      ) {\n        this.defExtCS = M.options.defaultExtCoor;\n        this.defLocCS = M.options.defaultLocCoor;\n      }\n    },\n\n    _copyExtent: function (e) {\n      let context =\n          e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu,\n        coord = context.defExtCS ? context.defExtCS.toLowerCase() : 'pcrs',\n        tL =\n          e instanceof KeyboardEvent\n            ? this.extent.topLeft[coord]\n            : this.options.mapEl.extent.topLeft[coord],\n        bR =\n          e instanceof KeyboardEvent\n            ? this.extent.bottomRight[coord]\n            : this.options.mapEl.extent.bottomRight[coord],\n        data = '';\n      switch (coord) {\n        case 'MapML':\n        default:\n          if (coord === 'pcrs') {\n            data = `<map-meta name=\"extent\" content=\"top-left-easting=${Math.round(\n            tL.horizontal\n          )}, top-left-northing=${Math.round(\n            tL.vertical\n          )}, bottom-right-easting=${Math.round(\n            bR.horizontal\n          )}, bottom-right-northing=${Math.round(bR.vertical)}\"></map-meta>`;\n          } else if (coord === 'gcrs') {\n            data = `<map-meta name=\"extent\" content=\"top-left-longitude=${tL.horizontal}, top-left-latitude=${tL.vertical}, bottom-right-longitude=${bR.horizontal}, bottom-right-latitude=${bR.vertical}\"></map-meta>`;\n          } else if (coord === 'tcrs') {\n            data = `<map-meta name=\"extent\" content=\"top-left-x=${\n            tL[0].horizontal\n          }, top-left-y=${tL[0].vertical}, bottom-right-x=${\n            bR[bR.length - 1].horizontal\n          }, bottom-right-y=${bR[bR.length - 1].vertical}\"></map-meta>`;\n          } else if (coord === 'tilematrix') {\n            data = `<map-meta name=\"extent\" content=\"top-left-column=${\n            tL[0].horizontal\n          }, top-left-row=${tL[0].vertical}, bottom-right-column=${\n            bR[bR.length - 1].horizontal\n          }, bottom-right-row=${bR[bR.length - 1].vertical}\"></map-meta>`;\n          } else {\n            console.log('not support');\n          }\n          break;\n      }\n      context._copyData(data);\n    },\n\n    _zoomToLayer: function (e) {\n      let context =\n        e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu;\n      context._layerClicked.layer._layerEl.zoomTo();\n    },\n\n    _copyLayer: function (e) {\n      let context =\n          e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu,\n        layerElem = context._layerClicked.layer._layerEl;\n      context._copyData(layerElem.getOuterHTML());\n    },\n\n    _zoomToMapExtent: function (e) {\n      let context =\n        e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu;\n      context._layerClicked.extent.zoomTo();\n    },\n\n    _copyMapExtent: function (e) {\n      let context =\n          e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu,\n        extentElem = context._layerClicked.extent;\n      context._copyData(extentElem.getOuterHTML());\n    },\n\n    _goForward: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl.forward();\n    },\n\n    _goBack: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl.back();\n    },\n\n    _reload: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl.reload();\n    },\n\n    _toggleFullScreen: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl._toggleFullScreen();\n    },\n\n    _toggleControls: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      if (mapEl.controls) {\n        mapEl.controls = false;\n      } else {\n        mapEl.controls = true;\n      }\n    },\n\n    _copyMapML: function (e) {\n      let context =\n          e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu,\n        mapEl =\n          e instanceof KeyboardEvent\n            ? this._map.options.mapEl\n            : this.options.mapEl;\n      context._copyData(\n        mapEl.outerHTML.replace(\n          /<div class=\"mapml-web-map\">.*?<\\/div>|<style>\\[is=\"web-map\"].*?<\\/style>|<style>mapml-viewer.*?<\\/style>/gm,\n          ''\n        )\n      );\n    },\n\n    // Add support for pasting GeoJSON in the future\n    _paste: function (e) {\n      e instanceof KeyboardEvent ? this._map.contextMenu : this.contextMenu;\n        let mapEl =\n          e instanceof KeyboardEvent\n            ? this._map.options.mapEl\n            : this.options.mapEl;\n      navigator.clipboard.readText().then((layer) => {\n        M._pasteLayer(mapEl, layer);\n      });\n    },\n\n    _viewSource: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl.viewSource();\n    },\n\n    _toggleDebug: function (e) {\n      let mapEl =\n        e instanceof KeyboardEvent ? this._map.options.mapEl : this.options.mapEl;\n      mapEl.toggleDebug();\n    },\n\n    _copyCoords: function (e) {\n      let directory = this.contextMenu ? this.contextMenu : this;\n      directory._showCopySubMenu(e);\n    },\n\n    _copyData: function (data) {\n      const el = document.createElement('textarea');\n      el.value = data;\n      document.body.appendChild(el);\n      el.select();\n      document.execCommand('copy');\n      document.body.removeChild(el);\n    },\n\n    _copyLocation: function (e) {\n      const menu = this.contextMenu;\n      switch (menu.defLocCS.toLowerCase()) {\n        case 'tile':\n          menu._copyTile.call(this, e);\n          break;\n        case 'tilematrix':\n          menu._copyTileMatrix.call(this, e);\n          break;\n        case 'map':\n          menu._copyMap.call(this, e);\n          break;\n        case 'tcrs':\n          menu._copyTCRS.call(this, e);\n          break;\n        case 'pcrs':\n          menu._copyPCRS.call(this, e);\n          break;\n        case 'gcrs':\n        default:\n          menu._copyGCRS.call(this, e);\n          break;\n      }\n    },\n\n    _copyGCRS: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'gcrs');\n      caption.textContent = `Copied ${projection} gcrs location`;\n      h2.textContent = `Copied ${projection} gcrs location`;\n      div.textContent = `${click.latlng.lng.toFixed(\n      6\n    )} ${click.latlng.lat.toFixed(6)}`;\n      coords.textContent = `${click.latlng.lng.toFixed(\n      6\n    )} ${click.latlng.lat.toFixed(6)}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyTCRS: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        point = mapEl._map.project(click.latlng),\n        pt = { x: point.x.toFixed(), y: point.y.toFixed() },\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'tcrs');\n      caption.textContent = `Copied ${projection} tcrs location`;\n      h2.textContent = `Copied ${projection} tcrs location`;\n      div.textContent = `${pt.x} ${pt.y}`;\n      coords.textContent = `${pt.x} ${pt.y}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyTileMatrix: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        point = mapEl._map.project(click.latlng),\n        tileSize = mapEl._map.options.crs.options.crs.tile.bounds.max.x,\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'gcrs');\n      caption.textContent = `Copied ${projection} tilematrix location (not implemented yet)`;\n      h2.textContent = `Copied ${projection} tilematrix location (not implemented yet)`;\n      div.textContent = `${Math.trunc(point.x / tileSize)} ${Math.trunc(\n      point.y / tileSize\n    )}`;\n      coords.textContent = `${click.latlng.lng.toFixed(\n      6\n    )} ${click.latlng.lat.toFixed(6)}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyPCRS: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        point = mapEl._map.project(click.latlng),\n        scale = mapEl._map.options.crs.scale(+mapEl.zoom),\n        pcrs = mapEl._map.options.crs.transformation\n          .untransform(point, scale)\n          .round(),\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'pcrs');\n      caption.textContent = `Copied ${projection} pcrs location`;\n      h2.textContent = `Copied ${projection} pcrs location`;\n      div.textContent = `${pcrs.x} ${pcrs.y}`;\n      coords.textContent = `${pcrs.x} ${pcrs.y}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyTile: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        // the _map.project method returns pixels, while the _map.crs.project\n        // method returns meters, confusingly:\n        // https://leafletjs.com/reference.html#map-project\n        // https://leafletjs.com/reference.html#crs-project\n        point = mapEl._map.project(click.latlng),\n        tileSize = mapEl._map.options.crs.options.crs.tile.bounds.max.x,\n        pointX = point.x % tileSize,\n        pointY = point.y % tileSize,\n        pt = L.point(pointX, pointY).trunc(),\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      if (pt.x < 0) pt.x += tileSize;\n      if (pt.y < 0) pt.y += tileSize;\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'gcrs');\n      caption.textContent = `Copied ${projection} tile location (not implemented yet)`;\n      h2.textContent = `Copied ${projection} tile location (not implemented yet)`;\n      div.textContent = `${pt.x} ${pt.y}`;\n      coords.textContent = `${click.latlng.lng.toFixed(\n      6\n    )} ${click.latlng.lat.toFixed(6)}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyMap: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        mapPt = click.containerPoint.trunc(),\n        projection = mapEl.projection,\n        feature = this.contextMenu.t.content.firstElementChild.cloneNode(true),\n        caption = feature.querySelector('map-featurecaption'),\n        h2 = feature.querySelector('h2'),\n        div = feature.querySelector('div'),\n        geom = feature.querySelector('map-geometry'),\n        coords = feature.querySelector('map-coordinates');\n\n      feature.setAttribute('zoom', mapEl.zoom);\n      geom.setAttribute('cs', 'gcrs');\n      caption.textContent = `Copied ${projection} map location (not implemented yet)`;\n      h2.textContent = `Copied ${projection} map location (not implemented yet)`;\n      div.textContent = `${mapPt.x} ${mapPt.y}`;\n      coords.textContent = `${click.latlng.lng.toFixed(\n      6\n    )} ${click.latlng.lat.toFixed(6)}`;\n      this.contextMenu._copyData(feature.outerHTML);\n    },\n\n    _copyAllCoords: function (e) {\n      let mapEl = this.options.mapEl,\n        click = this.contextMenu._clickEvent,\n        point = mapEl._map.project(click.latlng),\n        tileSize = mapEl._map.options.crs.options.crs.tile.bounds.max.x,\n        pointX = point.x % tileSize,\n        pointY = point.y % tileSize,\n        scale = mapEl._map.options.crs.scale(+mapEl.zoom),\n        pcrs = mapEl._map.options.crs.transformation.untransform(point, scale);\n      let allData = `z:${mapEl.zoom}\\n`;\n      allData += `tile: i:${Math.trunc(pointX)}, j:${Math.trunc(pointY)}\\n`;\n      allData += `tilematrix: column:${Math.trunc(\n      point.x / tileSize\n    )}, row:${Math.trunc(point.y / tileSize)}\\n`;\n      allData += `map: i:${Math.trunc(click.containerPoint.x)}, j:${Math.trunc(\n      click.containerPoint.y\n    )}\\n`;\n      allData += `tcrs: x:${Math.trunc(point.x)}, y:${Math.trunc(point.y)}\\n`;\n      allData += `pcrs: easting:${pcrs.x.toFixed(2)}, northing:${pcrs.y.toFixed(\n      2\n    )}\\n`;\n      allData += `gcrs: lon :${click.latlng.lng.toFixed(\n      6\n    )}, lat:${click.latlng.lat.toFixed(6)}`;\n      this.contextMenu._copyData(allData);\n    },\n\n    _createItem: function (container, options, index) {\n      if (options.spacer) {\n        return this._createSeparator(container, index);\n      }\n\n      var itemCls = 'mapml-contextmenu-item',\n        el = this._insertElementAt('button', itemCls, container, index),\n        callback = this._createEventHandler(\n          el,\n          options.callback,\n          options.context,\n          options.hideOnSelect\n        ),\n        html = '';\n\n      el.innerHTML = html + options.text;\n      el.setAttribute('type', 'button');\n      el.classList.add('mapml-button');\n      if (options.popup) {\n        el.setAttribute('aria-haspopup', 'true');\n        el.setAttribute('aria-expanded', 'false');\n        el.setAttribute('aria-controls', 'mapml-copy-submenu');\n      }\n\n      L.DomEvent.on(el, 'mouseover', this._onItemMouseOver, this)\n        .on(el, 'mouseout', this._onItemMouseOut, this)\n        .on(el, 'mousedown', L.DomEvent.stopPropagation)\n        .on(el, 'click', callback);\n\n      if (L.Browser.touch) {\n        L.DomEvent.on(el, this._touchstart, L.DomEvent.stopPropagation);\n      }\n\n      // Devices without a mouse fire \"mouseover\" on tap, but never mouseout\"\n      if (!L.Browser.pointer) {\n        L.DomEvent.on(el, 'click', this._onItemMouseOut, this);\n      }\n\n      return {\n        id: L.Util.stamp(el),\n        el: el,\n        callback: callback\n      };\n    },\n\n    _createSeparator: function (container, index) {\n      let el = this._insertElementAt(\n        'div',\n        'mapml-contextmenu-separator',\n        container,\n        index\n      );\n\n      return {\n        id: L.Util.stamp(el),\n        el: el\n      };\n    },\n\n    _createEventHandler: function (el, func, context, hideOnSelect) {\n      let parent = this;\n\n      hideOnSelect = hideOnSelect !== undefined ? hideOnSelect : true;\n\n      return function (e) {\n        let map = parent._map,\n          containerPoint = parent._showLocation.containerPoint,\n          layerPoint = map.containerPointToLayerPoint(containerPoint),\n          latlng = map.layerPointToLatLng(layerPoint),\n          relatedTarget = parent._showLocation.relatedTarget,\n          data = {\n            containerPoint: containerPoint,\n            layerPoint: layerPoint,\n            latlng: latlng,\n            relatedTarget: relatedTarget\n          };\n\n        if (hideOnSelect) {\n          parent._hide();\n        }\n\n        if (func) {\n          func.call(context || map, data);\n        }\n\n        parent._map.fire('contextmenu.select', {\n          contextmenu: parent,\n          el: el\n        });\n      };\n    },\n\n    _insertElementAt: function (tagName, className, container, index) {\n      let refEl,\n        el = document.createElement(tagName);\n\n      el.className = className;\n\n      if (index !== undefined) {\n        refEl = container.children[index];\n      }\n\n      if (refEl) {\n        container.insertBefore(el, refEl);\n      } else {\n        container.appendChild(el);\n      }\n\n      return el;\n    },\n\n    _show: function (e) {\n      // don't show a context menu for features\n      if (e.originalEvent.target.closest('.mapml-vector-container')) return;\n      if (this._mapMenuVisible) this._hide();\n      this._clickEvent = e;\n      let elem = e.originalEvent.target;\n      // Opening contextmenu for layercontrol\n      if (elem.closest('fieldset')) {\n        elem = elem.closest('fieldset');\n        // layer layercontrol\n        if (elem.className === 'mapml-layer-item') {\n          elem = elem.querySelector('span');\n          this._layerMenu.removeAttribute('hidden');\n          this._showAtPoint(e.containerPoint, e, this._layerMenu);\n          // map-extent layercontrol\n        } else if (elem.className === 'mapml-layer-extent') {\n          elem = elem.querySelector('span');\n          this._extentLayerMenu.removeAttribute('hidden');\n          this._showAtPoint(e.containerPoint, e, this._extentLayerMenu);\n        }\n        this._layerClicked = elem;\n      } else if (\n        // map contextmenu\n        elem.classList.contains('leaflet-container') ||\n        elem.classList.contains('mapml-debug-extent') ||\n        elem.tagName === 'path'\n      ) {\n        let layerList = this._map.options.mapEl.layers;\n        this._layerClicked = Array.from(layerList).find((el) => el.checked);\n        // the 'hidden' attribute must be removed before any attempt to get the size of container\n        let pt = e.containerPoint;\n        // this is for firefox, which reports the e.containerPoint as x=0 when you\n        // use a keyboard Shift+F10 to display the context menu; this appears\n        // to be because blink returns a PointerEvent of type==='contextmenu',\n        // while gecko returns an object (for e.originalEvent).\n        if (L.Browser.gecko) {\n          const getCenter = function (el) {\n            let w = el.getBoundingClientRect().width;\n            let h = el.getBoundingClientRect().height;\n            return { x: Number.parseInt(w / 2), y: Number.parseInt(h / 2) };\n          };\n          pt = getCenter(this._map.getContainer());\n        }\n        this._container.removeAttribute('hidden');\n        this._showAtPoint(pt, e, this._container);\n        this._updateCS();\n      }\n      // Once contextmenu is opened, focus the first item\n      if (e.originalEvent.button === 0 || e.originalEvent.button === -1) {\n        this._keyboardEvent = true;\n        if (this._layerClicked.className.includes('mapml-layer-item')) {\n          let activeEl = document.activeElement;\n          this._elementInFocus = activeEl.shadowRoot.activeElement;\n          this._layerMenuTabs = 1;\n          this._layerMenu.firstChild.focus();\n          //\n        } else if (this._layerClicked.className.includes('mapml-extent-item')) {\n          let activeEl = document.activeElement;\n          this._elementInFocus = activeEl.shadowRoot.activeElement;\n          this._extentLayerMenuTabs = 1;\n          this._extentLayerMenu.firstChild.focus();\n        } else {\n          this._container.querySelectorAll('button:not([disabled])')[0].focus();\n        }\n      }\n    },\n\n    _showAtPoint: function (pt, data, container) {\n      if (this._items.length) {\n        let event = L.extend(data || {}, { contextmenu: this });\n\n        this._showLocation = {\n          containerPoint: pt\n        };\n\n        if (data && data.relatedTarget) {\n          this._showLocation.relatedTarget = data.relatedTarget;\n        }\n\n        this._setPosition(pt, container);\n\n        if (!this._mapMenuVisible) {\n          container.removeAttribute('hidden');\n          this._mapMenuVisible = true;\n        }\n\n        this._map.fire('contextmenu.show', event);\n      }\n    },\n\n    _hide: function () {\n      if (this._mapMenuVisible) {\n        this._mapMenuVisible = false;\n        this._container.setAttribute('hidden', '');\n        this._copySubMenu.setAttribute('hidden', '');\n        this._layerMenu.setAttribute('hidden', '');\n        this._extentLayerMenu.setAttribute('hidden', '');\n        this._map.fire('contextmenu.hide', { contextmenu: this });\n        setTimeout(() => this._map._container.focus(), 0);\n        this.activeIndex = 0;\n        this.isRunned = false;\n      }\n    },\n\n    _setPosition: function (pt, container) {\n      let mapSize = this._map.getSize(),\n        containerSize = this._getElementSize(container),\n        anchor;\n\n      if (this._map.options.contextmenuAnchor) {\n        anchor = L.point(this._map.options.contextmenuAnchor);\n        pt = pt.add(anchor);\n      }\n\n      container._leaflet_pos = pt;\n\n      if (pt.x + containerSize.x > mapSize.x) {\n        container.style.left = 'auto';\n        container.style.right =\n          Math.min(\n            Math.max(mapSize.x - pt.x, 0),\n            mapSize.x - containerSize.x - 1\n          ) + 'px';\n      } else {\n        container.style.left = Math.max(pt.x, 0) + 'px';\n        container.style.right = 'auto';\n      }\n\n      if (pt.y + containerSize.y > mapSize.y) {\n        container.style.top = 'auto';\n        container.style.bottom =\n          Math.min(\n            Math.max(mapSize.y - pt.y, 0),\n            mapSize.y - containerSize.y - 1\n          ) + 'px';\n      } else {\n        container.style.top = Math.max(pt.y, 0) + 'px';\n        container.style.bottom = 'auto';\n      }\n    },\n\n    _getElementSize: function (el) {\n      let size = this._size;\n\n      if (!size || this._sizeChanged) {\n        size = {};\n\n        el.style.left = '-999999px';\n        el.style.right = 'auto';\n\n        size.x = el.offsetWidth;\n        size.y = el.offsetHeight;\n\n        el.style.left = 'auto';\n\n        this._sizeChanged = false;\n      }\n\n      return size;\n    },\n\n    // once Esc is clicked on the layer/extent contextMenu, change the focus back to the layer control\n    _focusOnLayerControl: function () {\n      this._mapMenuVisible = false;\n      delete this._layerMenuTabs;\n      delete this._extentLayerMenuTabs;\n      this._layerMenu.setAttribute('hidden', '');\n      this._extentLayerMenu.setAttribute('hidden', '');\n      if (this._elementInFocus) {\n        this._elementInFocus.focus();\n      } else {\n        this._layerClicked.parentElement.firstChild.focus();\n      }\n      delete this._elementInFocus;\n    },\n\n    _setActiveItem: function (index) {\n      if (\n        document.activeElement.shadowRoot === null &&\n        this.noActiveEl === true\n      ) {\n        //bug fix when theres no active element\n        this.noActiveEl = false;\n        //setting this._items[9] is just for preventing some diabled index, it will be override by later code.\n        this._items[9].el.el.focus();\n      }\n      if (\n        document.activeElement.shadowRoot.activeElement.innerHTML ===\n        this._items[index].el.el.innerHTML\n      ) {\n        //edge case where pressing shift f10 focuses the first element on contextmenu (if already focused, have to press arrow twice to go down)\n        let next = index + 1;\n        while (this._items[next].el.el.disabled) {\n          next++;\n          if (next >= this._items.length) {\n            next = 0;\n          }\n        }\n        this._setActiveItem(next);\n      } else {\n        if (this.excludedIndices.includes(index)) {\n          // find the next or previous non-excluded item\n          let nextIndex = index + 1;\n          let prevIndex = index - 1;\n          while (\n            this.excludedIndices.includes(nextIndex) ||\n            this._items[nextIndex].el.el.disabled\n          ) {\n            nextIndex++;\n            if (nextIndex >= this._items.length) {\n              nextIndex = 0;\n            }\n          }\n          while (\n            this.excludedIndices.includes(prevIndex) ||\n            this._items[prevIndex].el.el.disabled\n          ) {\n            prevIndex--;\n            if (prevIndex < 0) {\n              prevIndex = this._items.length - 1;\n            }\n          }\n          // set the active item to the next or previous non-excluded item\n          if (this.activeIndex < index) {\n            this._setActiveItem(nextIndex);\n          } else {\n            this._setActiveItem(prevIndex);\n          }\n        } else {\n          // set the focus item\n          this._items[index].el.el.focus();\n          this.activeIndex = index;\n        }\n      }\n    },\n\n    _onKeyDown: function (e) {\n      if (!this._mapMenuVisible || e.key === 'Shift') return;\n\n      if (e.code === 'Enter' || e.code === 'Tab' || e.code.startsWith('Arrow'))\n        e.preventDefault();\n\n      if (e.code === 'ArrowUp' || (e.shiftKey && e.code === 'Tab')) {\n        if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          (document.activeElement.shadowRoot === null || //null happens when the focus is on submenu and when mouse hovers on main menu, submenu disappears\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n              this._copySubMenu.children[this._menuItems.CPYMENUMAP].innerHTML)\n        ) {\n          //\"map\" on submenu\n          this._copySubMenu.children[this._menuItems.CPYMENULOC].focus();\n        } else if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._copySubMenu.children[this._menuItems.CPYMENUEXTENT].innerHTML\n        ) {\n          //\"extent\" on submenu\n          this._copySubMenu.children[this._menuItems.CPYMENUMAP].focus();\n        } else if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._copySubMenu.children[this._menuItems.CPYMENULOC].innerHTML\n        ) {\n          //\"Location\" on submenu\n          this._copySubMenu.children[this._menuItems.CPYMENUEXTENT].focus();\n        } else if (\n          !this._layerMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._layerMenu.children[this._menuItems.LYRZOOMTO].innerHTML\n        ) {\n          //\"zoom to layer\" on layermenu\n          this._layerMenu.children[this._menuItems.LYRCOPY].focus();\n        } else if (!this._layerMenu.hasAttribute('hidden')) {\n          this._layerMenu.children[this._menuItems.LYRZOOMTO].focus();\n        } else if (\n          !this._extentLayerMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._extentLayerMenu.children[this._menuItems.LYRZOOMTO].innerHTML\n        ) {\n          //\"zoom to extent\" on layermenu\n          this._extentLayerMenu.children[this._menuItems.LYRCOPY].focus();\n        } else if (!this._extentLayerMenu.hasAttribute('hidden')) {\n          this._extentLayerMenu.children[this._menuItems.LYRZOOMTO].focus();\n        } else {\n          if (this.activeIndex > 0) {\n            let prevIndex = this.activeIndex - 1;\n            while (this._items[prevIndex].el.el.disabled) {\n              prevIndex--;\n              if (prevIndex < 0) {\n                prevIndex = this._items.length - 1;\n              }\n            }\n            this._setActiveItem(prevIndex);\n          } else {\n            this._setActiveItem(this._items.length - 1);\n          }\n        }\n      } else if (e.code === 'ArrowDown' || e.code === 'Tab') {\n        if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          (document.activeElement.shadowRoot === null ||\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n              this._copySubMenu.children[this._menuItems.CPYMENULOC].innerHTML)\n        ) {\n          this._copySubMenu.children[this._menuItems.CPYMENUMAP].focus();\n        } else if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._copySubMenu.children[this._menuItems.CPYMENUEXTENT].innerHTML\n        ) {\n          this._copySubMenu.children[this._menuItems.CPYMENULOC].focus();\n        } else if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._copySubMenu.children[this._menuItems.CPYMENUMAP].innerHTML\n        ) {\n          this._copySubMenu.children[this._menuItems.CPYMENUEXTENT].focus();\n        } else if (\n          !this._layerMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._layerMenu.children[this._menuItems.LYRZOOMTO].innerHTML\n        ) {\n          this._layerMenu.children[this._menuItems.LYRCOPY].focus();\n        } else if (!this._layerMenu.hasAttribute('hidden')) {\n          this._layerMenu.children[this._menuItems.LYRZOOMTO].focus();\n        } else if (\n          !this._extentLayerMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._extentLayerMenu.children[this._menuItems.LYRZOOMTO].innerHTML\n        ) {\n          this._extentLayerMenu.children[this._menuItems.LYRCOPY].focus();\n        } else if (!this._extentLayerMenu.hasAttribute('hidden')) {\n          this._extentLayerMenu.children[this._menuItems.LYRZOOMTO].focus();\n        } else {\n          if (this.activeIndex < this._items.length - 1) {\n            //edge case at index 0\n            if (\n              !this.isRunned &&\n              this.activeIndex === 0 &&\n              !this._items[this.activeIndex].el.el.disabled\n            ) {\n              this._setActiveItem(0);\n              this.isRunned = true;\n            } else {\n              //edge case over\n              let nextIndex = this.activeIndex + 1;\n              while (this._items[nextIndex].el.el.disabled) {\n                nextIndex++;\n                if (nextIndex >= this._items.length) {\n                  nextIndex = 0;\n                }\n              }\n              this._setActiveItem(nextIndex);\n            }\n          } else {\n            let nextIndex = 0;\n            while (this._items[nextIndex].el.el.disabled) {\n              nextIndex++;\n              if (nextIndex >= this._items.length) {\n                nextIndex = 0;\n              }\n            }\n            this._setActiveItem(nextIndex);\n          }\n        }\n      } else if (e.code === 'ArrowRight') {\n        if (\n          document.activeElement.shadowRoot !== null &&\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._items[this._menuItems.CTXCOPY].el.el.innerHTML && //'copy'\n          this._copySubMenu.hasAttribute('hidden')\n        ) {\n          this._showCopySubMenu();\n          this._copySubMenu.children[0].focus();\n        } else if (\n          document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._items[this._menuItems.CTXCOPY].el.el.innerHTML &&\n          !this._copySubMenu.hasAttribute('hidden')\n        ) {\n          this._copySubMenu.children[0].focus();\n        }\n      } else if (e.code === 'ArrowLeft') {\n        if (\n          !this._copySubMenu.hasAttribute('hidden') &&\n          document.activeElement.shadowRoot !== null\n        ) {\n          if (\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n              this._copySubMenu.children[this._menuItems.CPYMENUMAP].innerHTML ||\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n              this._copySubMenu.children[this._menuItems.CPYMENUEXTENT]\n                .innerHTML ||\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n              this._copySubMenu.children[this._menuItems.CPYMENULOC].innerHTML\n          ) {\n            this._copySubMenu.setAttribute('hidden', '');\n            this._setActiveItem(this._menuItems.CTXCOPY);\n          }\n        }\n      } else if (e.code === 'Escape') {\n        if (this._layerMenuTabs || this._extentLayerMenuTabs) {\n          L.DomEvent.stop(e);\n          this._focusOnLayerControl();\n          return;\n        }\n        if (document.activeElement.shadowRoot === null) {\n          this._hide();\n        } else {\n          if (!this._copySubMenu.hasAttribute('hidden')) {\n            if (\n              document.activeElement.shadowRoot.activeElement.innerHTML ===\n                this._copySubMenu.children[this._menuItems.CPYMENUMAP]\n                  .innerHTML ||\n              document.activeElement.shadowRoot.activeElement.innerHTML ===\n                this._copySubMenu.children[this._menuItems.CPYMENUEXTENT]\n                  .innerHTML ||\n              document.activeElement.shadowRoot.activeElement.innerHTML ===\n                this._copySubMenu.children[this._menuItems.CPYMENULOC].innerHTML\n            ) {\n              this._copySubMenu.setAttribute('hidden', '');\n              this._setActiveItem(this._menuItems.CTXCOPY);\n            }\n          } else {\n            this._hide();\n          }\n        }\n      } else if (\n        e.code !== 'KeyC' &&\n        document.activeElement.shadowRoot.activeElement.innerHTML !==\n          this._items[this._menuItems.CTXCOPY].el.el.innerHTML\n      ) {\n        this._hide();\n      }\n      // using KeyboardEvent.code for its mnemonics and case-independence\n      switch (e.code) {\n        case 'Enter':\n          if (\n            document.activeElement.shadowRoot.activeElement.innerHTML ===\n            this._items[this._menuItems.CTXCOPY].el.el.innerHTML\n          ) {\n            this._copyCoords({\n              latlng: this._map.getCenter()\n            });\n            this._copySubMenu.firstChild.focus();\n          } else {\n            if (\n              this._map._container.parentNode.activeElement.parentNode.classList.contains(\n                'mapml-contextmenu'\n              )\n            )\n              this._map._container.parentNode.activeElement.click();\n          }\n          break;\n        case 'Space':\n          if (\n            this._map._container.parentNode.activeElement.parentNode.classList.contains(\n              'mapml-contextmenu'\n            )\n          )\n            this._map._container.parentNode.activeElement.click();\n          break;\n        case 'KeyC':\n          this._copyCoords({\n            latlng: this._map.getCenter()\n          });\n          this._copySubMenu.firstChild.focus();\n          break;\n        case 'KeyD':\n          this._toggleDebug(e);\n          break;\n        case 'KeyM':\n          this._copyMapML(e);\n          break;\n        case 'KeyL':\n          if (this._layerClicked.className.includes('mapml-layer-item')) {\n            this._copyLayer(e);\n          } else if (this._layerClicked.className.includes('mapml-extent-item')) {\n            this._copyMapExtent(e);\n          }\n          break;\n        case 'KeyF':\n          this._toggleFullScreen(e);\n          break;\n        case 'KeyP':\n          this._paste(e);\n          break;\n        case 'KeyT':\n          this._toggleControls(e);\n          break;\n        case 'KeyV':\n          this._viewSource(e);\n          break;\n        case 'KeyZ':\n          if (this._layerClicked.className.includes('mapml-layer-item')) {\n            this._zoomToLayer(e);\n          } else if (this._layerClicked.className.includes('mapml-extent-item')) {\n            this._zoomToMapExtent(e);\n          }\n          break;\n      }\n    },\n\n    _showCopySubMenu: function (e) {\n      let mapSize = this._map.getSize(),\n        click = this._clickEvent,\n        menu = this._copySubMenu,\n        copyEl = this._items[5].el.el;\n\n      copyEl.setAttribute('aria-expanded', 'true');\n      menu.removeAttribute('hidden');\n\n      const menuWidth = this._container.offsetWidth;\n        this._container.offsetHeight;\n        const submenuWidth = menu.offsetWidth;\n      if (click.containerPoint.x + menuWidth + submenuWidth > mapSize.x) {\n        menu.style.left = 'auto';\n        menu.style.right = menuWidth + 'px';\n      } else {\n        menu.style.left = menuWidth + 'px';\n        menu.style.right = 'auto';\n      }\n\n      menu.style.top = 100 - 22 + 'px';\n      menu.style.bottom = 'auto';\n    },\n\n    _hideCopySubMenu: function (e) {\n      if (\n        !e.relatedTarget ||\n        !e.relatedTarget.parentElement ||\n        e.relatedTarget.parentElement.classList.contains('mapml-submenu') ||\n        e.relatedTarget.classList.contains('mapml-submenu')\n      )\n        return;\n      let menu = this._copySubMenu,\n        copyEl = this._items[4].el.el;\n      copyEl.setAttribute('aria-expanded', 'false');\n      menu.setAttribute('hidden', '');\n      this.noActiveEl = true; //variable to keep track of no focus element on contextmenu, bug fix for arrow key navigation\n    },\n\n    _onItemMouseOver: function (e) {\n      L.DomUtil.addClass(e.target || e.srcElement, 'over');\n      if (e.srcElement.innerText === M.options.locale.cmCopyCoords + ' (C)')\n        this._showCopySubMenu(e);\n    },\n\n    _onItemMouseOut: function (e) {\n      L.DomUtil.removeClass(e.target || e.srcElement, 'over');\n      this._hideCopySubMenu(e);\n    },\n\n    toggleContextMenuItem: function (options, state) {\n      options = options.toUpperCase();\n      if (state === 'disabled') {\n        if (options === 'CONTROLS') {\n          this._items[8].el.el.disabled = true;\n        } else if (options === 'BACK') {\n          this._items[0].el.el.disabled = true;\n        } else if (options === 'FORWARD') {\n          this._items[1].el.el.disabled = true;\n        } else if (options === 'RELOAD') {\n          this._items[2].el.el.disabled = true;\n        }\n      } else if (state === 'enabled') {\n        if (options === 'CONTROLS') {\n          this._items[8].el.el.disabled = false;\n        } else if (options === 'BACK') {\n          this._items[0].el.el.disabled = false;\n        } else if (options === 'FORWARD') {\n          this._items[1].el.el.disabled = false;\n        } else if (options === 'RELOAD') {\n          this._items[2].el.el.disabled = false;\n        }\n      }\n    },\n\n    setViewFullScreenInnerHTML: function (options) {\n      if (options === 'view') {\n        this._map.contextMenu._items[3].el.el.innerHTML =\n          M.options.locale.btnFullScreen + ' (<kbd>F</kbd>)';\n      } else if (options === 'exit') {\n        this._map.contextMenu._items[3].el.el.innerHTML =\n          M.options.locale.btnExitFullScreen + ' (<kbd>F</kbd>)';\n      }\n    }\n  });\n\n  var Util = {\n    // _convertAndFormatPCRS returns the converted CRS and formatted pcrsBounds in gcrs, pcrs, tcrs, and tilematrix. Used for setting extent for the map and layer (map.extent, layer.extent).\n    // _convertAndFormatPCRS: L.Bounds, _map, projection -> {...}\n    _convertAndFormatPCRS: function (pcrsBounds, crs, projection) {\n      if (!pcrsBounds || !crs) return {};\n\n      let tcrsTopLeft = [],\n        tcrsBottomRight = [],\n        tileMatrixTopLeft = [],\n        tileMatrixBottomRight = [],\n        tileSize = crs.options.crs.tile.bounds.max.y;\n\n      for (let i = 0; i < crs.options.resolutions.length; i++) {\n        let scale = crs.scale(i),\n          minConverted = crs.transformation.transform(pcrsBounds.min, scale),\n          maxConverted = crs.transformation.transform(pcrsBounds.max, scale);\n\n        tcrsTopLeft.push({\n          horizontal: minConverted.x,\n          vertical: maxConverted.y\n        });\n        tcrsBottomRight.push({\n          horizontal: maxConverted.x,\n          vertical: minConverted.y\n        });\n\n        //converts the tcrs values from earlier to tilematrix\n        tileMatrixTopLeft.push({\n          horizontal: tcrsTopLeft[i].horizontal / tileSize,\n          vertical: tcrsTopLeft[i].vertical / tileSize\n        });\n        tileMatrixBottomRight.push({\n          horizontal: tcrsBottomRight[i].horizontal / tileSize,\n          vertical: tcrsBottomRight[i].vertical / tileSize\n        });\n      }\n\n      //converts the gcrs, I believe it can take any number values from -inf to +inf\n      let unprojectedMin = crs.unproject(pcrsBounds.min),\n        unprojectedMax = crs.unproject(pcrsBounds.max);\n\n      let gcrs = {\n        topLeft: {\n          horizontal: unprojectedMin.lng,\n          vertical: unprojectedMax.lat\n        },\n        bottomRight: {\n          horizontal: unprojectedMax.lng,\n          vertical: unprojectedMin.lat\n        }\n      };\n\n      //formats known pcrs bounds to correct format\n      let pcrs = {\n        topLeft: {\n          horizontal: pcrsBounds.min.x,\n          vertical: pcrsBounds.max.y\n        },\n        bottomRight: {\n          horizontal: pcrsBounds.max.x,\n          vertical: pcrsBounds.min.y\n        }\n      };\n\n      //formats all extent data\n      let extent = {\n        topLeft: {\n          tcrs: tcrsTopLeft,\n          tilematrix: tileMatrixTopLeft,\n          gcrs: gcrs.topLeft,\n          pcrs: pcrs.topLeft\n        },\n        bottomRight: {\n          tcrs: tcrsBottomRight,\n          tilematrix: tileMatrixBottomRight,\n          gcrs: gcrs.bottomRight,\n          pcrs: pcrs.bottomRight\n        }\n      };\n      if (projection) {\n        extent.projection = projection;\n      }\n      return extent;\n    },\n    // extentToBounds: returns bounds in gcrs, pcrs. Used for setting bounds for the map (map.totalLayerBounds).\n    // extentToBounds: {...}, crs -> L.Bounds / L.LatlngBounds\n    extentToBounds(extent, crs) {\n      switch (crs.toUpperCase()) {\n        case 'PCRS':\n          return L.bounds(\n            L.point(extent.topLeft.pcrs.horizontal, extent.topLeft.pcrs.vertical),\n            L.point(\n              extent.bottomRight.pcrs.horizontal,\n              extent.bottomRight.pcrs.vertical\n            )\n          );\n        case 'GCRS':\n          return L.latLngBounds(\n            L.latLng(\n              extent.topLeft.gcrs.vertical,\n              extent.topLeft.gcrs.horizontal\n            ),\n            L.latLng(\n              extent.bottomRight.gcrs.vertical,\n              extent.bottomRight.gcrs.horizontal\n            )\n          );\n      }\n    },\n\n    // axisToCS returns the CRS when given the axis:\n    // https://maps4html.org/web-map-doc/docs/elements/input/#axis\n    // axisToCS: (Axis String) -> (CRS String)\n    axisToCS: function (axis) {\n      try {\n        switch (axis.toLowerCase()) {\n          case 'row':\n          case 'column':\n            return 'TILEMATRIX';\n          case 'i':\n          case 'j':\n            return ['MAP', 'TILE'];\n          case 'x':\n          case 'y':\n            return 'TCRS';\n          case 'latitude':\n          case 'longitude':\n            return 'GCRS';\n          case 'northing':\n          case 'easting':\n            return 'PCRS';\n          default:\n            return M.FALLBACK_CS;\n        }\n      } catch (e) {\n        return undefined;\n      }\n    },\n\n    // csToAxes takes a given cs and retuns the axes, first horizontal then vertical\n    // https://maps4html.org/web-map-doc/docs/elements/input/#axis\n    // csToAxes: (CRS String) -> [(horizontal axis String), (Vertical axis String)]\n    csToAxes: function (cs) {\n      try {\n        switch (cs.toLowerCase()) {\n          case 'tilematrix':\n            return ['column', 'row'];\n          case 'map':\n          case 'tile':\n            return ['i', 'j'];\n          case 'tcrs':\n            return ['x', 'y'];\n          case 'gcrs':\n            return ['longitude', 'latitude'];\n          case 'pcrs':\n            return ['easting', 'northing'];\n        }\n      } catch (e) {\n        return undefined;\n      }\n    },\n\n    // axisToXY takes horizontal axis and returns 'x', or takes vertical axis and returns 'y'\n    // https://maps4html.org/web-map-doc/docs/elements/input/#axis\n    // axisToXY: (Axis String) -> 'x' or 'y'\n    axisToXY: function (axis) {\n      try {\n        switch (axis.toLowerCase()) {\n          case 'i':\n          case 'column':\n          case 'longitude':\n          case 'x':\n          case 'easting':\n            return 'x';\n          case 'row':\n          case 'j':\n          case 'latitude':\n          case 'y':\n          case 'northing':\n            return 'y';\n\n          default:\n            return undefined;\n        }\n      } catch (e) {\n        return undefined;\n      }\n    },\n\n    // convertPCRSBounds converts pcrsBounds to the given cs Bounds.\n    // convertPCRSBounds: L.Bounds, Int, L.CRS, Str('PCRS'|'TCRS'|'TILEMATRIX'|'GCRS') -> L.Bounds\n    convertPCRSBounds: function (pcrsBounds, zoom, projection, cs) {\n      if (\n        !pcrsBounds ||\n        (!zoom && zoom !== 0) ||\n        !Number.isFinite(+zoom) ||\n        !projection ||\n        !cs\n      )\n        return undefined;\n      projection = typeof projection === 'string' ? M[projection] : projection;\n      switch (cs.toUpperCase()) {\n        case 'PCRS':\n          return pcrsBounds;\n        case 'TCRS':\n        case 'TILEMATRIX':\n          let minPixel = projection.transformation.transform(\n              pcrsBounds.min,\n              projection.scale(+zoom)\n            ),\n            maxPixel = projection.transformation.transform(\n              pcrsBounds.max,\n              projection.scale(+zoom)\n            );\n          if (cs.toUpperCase() === 'TCRS') return L.bounds(minPixel, maxPixel);\n          let tileSize = projection.options.crs.tile.bounds.max.x;\n          return L.bounds(\n            L.point(minPixel.x / tileSize, minPixel.y / tileSize),\n            L.point(maxPixel.x / tileSize, maxPixel.y / tileSize)\n          );\n        case 'GCRS':\n          let minGCRS = projection.unproject(pcrsBounds.min),\n            maxGCRS = projection.unproject(pcrsBounds.max);\n          return L.bounds(\n            L.point(minGCRS.lng, minGCRS.lat),\n            L.point(maxGCRS.lng, maxGCRS.lat)\n          );\n        default:\n          return undefined;\n      }\n    },\n\n    // pointToPCRSPoint takes a point, with a projection and cs and converts it to a pcrs L.point/L.latLng\n    //pointToPCRSPoint: L.Point, Int, L.CRS, Str('PCRS'|'TCRS'|'TILEMATRIX'|'GCRS') -> L.point|L.latLng\n    pointToPCRSPoint: function (point, zoom, projection, cs) {\n      if (\n        !point ||\n        (zoom !== undefined && !Number.isFinite(+zoom)) ||\n        (zoom === undefined &&\n          (cs === 'TILEMATRIX' || cs === 'TCRS' || cs === 'TILE')) ||\n        !cs ||\n        !projection\n      )\n        return undefined;\n      projection = typeof projection === 'string' ? M[projection] : projection;\n      let tileSize = projection.options.crs.tile.bounds.max.x;\n      switch (cs.toUpperCase()) {\n        case 'TILEMATRIX':\n          return M.pixelToPCRSPoint(\n            L.point(point.x * tileSize, point.y * tileSize),\n            zoom,\n            projection\n          );\n        case 'PCRS':\n          return point;\n        case 'TCRS' :\n          return M.pixelToPCRSPoint(point, zoom, projection);\n        case 'GCRS':\n          return projection.project(L.latLng(point.y, point.x));\n        default:\n          return undefined;\n      }\n    },\n\n    // pixelToPCRSPoint takes a pixel L.point, the zoom and projection and returns a L.point in pcrs\n    // pixelToPCRSPoint: L.Point, Int, L.CRS|Str -> L.point\n    pixelToPCRSPoint: function (point, zoom, projection) {\n      if (\n        !point ||\n        (!zoom && zoom !== 0) ||\n        !Number.isFinite(+zoom) ||\n        !projection\n      )\n        return undefined;\n      projection = typeof projection === 'string' ? M[projection] : projection;\n      return projection.transformation.untransform(point, projection.scale(zoom));\n    },\n\n    // boundsToPCRSBounds converts bounds with projection and cs to PCRS bounds\n    // boundsToPCRSBounds: L.bounds, Int, L.CRS|Str, Str('PCRS'|'TCRS'|'TILEMATRIX'|'GCRS') -> L.bounds\n    boundsToPCRSBounds: function (bounds, zoom, projection, cs) {\n      if (\n        !bounds ||\n        !bounds.max ||\n        !bounds.min ||\n        (zoom !== undefined && !Number.isFinite(+zoom)) ||\n        (zoom === undefined &&\n          (cs === 'TILEMATRIX' || cs === 'TCRS' || cs === 'TILE')) ||\n        !projection ||\n        !cs\n      )\n        return undefined;\n      projection = typeof projection === 'string' ? M[projection] : projection;\n      return L.bounds(\n        M.pointToPCRSPoint(bounds.min, zoom, projection, cs),\n        M.pointToPCRSPoint(bounds.max, zoom, projection, cs)\n      );\n    },\n\n    //L.bounds have fixed point positions, where min is always topleft, max is always bottom right, and the values are always sorted by leaflet\n    //important to consider when working with pcrs where the origin is not topleft but rather bottomleft, could lead to confusion\n    pixelToPCRSBounds: function (bounds, zoom, projection) {\n      if (\n        !bounds ||\n        !bounds.max ||\n        !bounds.min ||\n        (!zoom && zoom !== 0) ||\n        !Number.isFinite(+zoom) ||\n        !projection\n      )\n        return undefined;\n      projection = typeof projection === 'string' ? M[projection] : projection;\n      return L.bounds(\n        M.pixelToPCRSPoint(bounds.min, zoom, projection),\n        M.pixelToPCRSPoint(bounds.max, zoom, projection)\n      );\n    },\n\n    //meta content is the content attribute of meta\n    // input \"max=5,min=4\" => [[max,5][min,5]]\n    _metaContentToObject: function (input) {\n      if (!input || input instanceof Object) return {};\n      let content = input.split(/\\s+/).join('');\n      let contentArray = {};\n      let stringSplit = content.split(',');\n\n      for (let i = 0; i < stringSplit.length; i++) {\n        let prop = stringSplit[i].split('=');\n        if (prop.length === 2) contentArray[prop[0]] = prop[1];\n      }\n      if (contentArray !== '' && stringSplit[0].split('=').length === 1)\n        contentArray.content = stringSplit[0];\n      return contentArray;\n    },\n\n    // _coordsToArray returns an array of arrays of coordinate pairs\n    // _coordsToArray: (\"1,2,3,4\") -> [[1,2],[3,4]]\n    _coordsToArray: function (containerPoints) {\n      for (\n        var i = 1, pairs = [], coords = containerPoints.split(',');\n        i < coords.length;\n        i += 2\n      ) {\n        pairs.push([parseInt(coords[i - 1]), parseInt(coords[i])]);\n      }\n      return pairs;\n    },\n\n    // _splitCoordinate splits string coordinates to an array as floating point numbers\n    _splitCoordinate: function (element, index, array) {\n      var a = [];\n      element.split(/\\s+/gim).forEach(M._parseNumber, a);\n      this.push(a);\n    },\n\n    // _parseNumber parses a string as a floating point number, helper function for _splitCoordinate\n    _parseNumber: function (element, index, array) {\n      this.push(parseFloat(element));\n    },\n\n    // _handleLink handles map-a links, when clicked on a map-a link\n    _handleLink: function (link, leafletLayer) {\n      let zoomTo,\n        justPan = false,\n        layer,\n        map = leafletLayer._map,\n        opacity;\n      if (link.type === 'text/html' && link.target !== '_blank') {\n        // all other target values other than blank behave as _top\n        link.target = '_top';\n      } else if (link.type !== 'text/html' && link.url.includes('#')) {\n        let hash = link.url.split('#'),\n          loc = hash[1].split(',');\n        zoomTo = { z: loc[0] || 0, lng: loc[1] || 0, lat: loc[2] || 0 };\n        justPan = !hash[0]; // if the first half of the array is an empty string then the link is just for panning\n        if (['/', '.', '#'].includes(link.url[0])) link.target = '_self';\n      }\n      if (!justPan) {\n        layer = document.createElement('layer-');\n        layer.setAttribute('src', link.url);\n        layer.setAttribute('checked', '');\n        switch (link.target) {\n          case '_blank':\n            if (link.type === 'text/html') {\n              window.open(link.url);\n            } else {\n              postTraversalSetup();\n              map.options.mapEl.appendChild(layer);\n            }\n            break;\n          case '_parent':\n            postTraversalSetup();\n            for (let l of map.options.mapEl.querySelectorAll('layer-'))\n              if (l._layer !== leafletLayer) map.options.mapEl.removeChild(l);\n            map.options.mapEl.appendChild(layer);\n            map.options.mapEl.removeChild(leafletLayer._layerEl);\n            break;\n          case '_top':\n            window.location.href = link.url;\n            break;\n          default:\n            postTraversalSetup();\n            opacity = leafletLayer._layerEl.opacity;\n            leafletLayer._layerEl.insertAdjacentElement('beforebegin', layer);\n            map.options.mapEl.removeChild(leafletLayer._layerEl);\n        }\n      } else if (zoomTo && !link.inPlace && justPan) {\n        leafletLayer._map.options.mapEl.zoomTo(\n          +zoomTo.lat,\n          +zoomTo.lng,\n          +zoomTo.z\n        );\n        if (opacity) layer.opacity = opacity;\n        map.getContainer().focus();\n      }\n\n      function postTraversalSetup() {\n        // when the projection is changed as part of the link traversal process,\n        // it's necessary to set the map viewer's lat, lon and zoom NOW, so that\n        // the promises that are created when the viewer's projection is changed\n        // can use the viewer's lat, lon and zoom properties that were in effect\n        // before the projection change i.e. in the closure for that code\n        // see mapml-viewer / map is=web-map projection attributeChangedCallback\n        // specifically required for use cases like changing projection after\n        // link traversal, e.g. BC link here https://maps4html.org/experiments/linking/features/\n        if (!link.inPlace && zoomTo) updateMapZoomTo(zoomTo);\n        // the layer is newly created, so have to wait until it's fully init'd\n        // before setting properties.\n        layer.whenReady().then(() => {\n          // if the map projection isnt' changed by link traversal, it's necessary\n          // to perform pan/zoom operations after the layer is ready\n          if (!link.inPlace && zoomTo)\n            layer.parentElement.zoomTo(+zoomTo.lat, +zoomTo.lng, +zoomTo.z);\n          else if (!link.inPlace) layer.zoomTo();\n          // not sure if this is necessary\n          if (opacity) layer.opacity = opacity;\n          // this is necessary to display the FeatureIndexOverlay, I believe\n          map.getContainer().focus();\n        });\n      }\n\n      function updateMapZoomTo(zoomTo) {\n        // can't use mapEl.zoomTo(...) here, it's too slow!\n        map.options.mapEl.lat = +zoomTo.lat;\n        map.options.mapEl.lon = +zoomTo.lng;\n        map.options.mapEl.zoom = +zoomTo.z;\n      }\n    },\n    getBoundsFromMeta: function (mapml) {\n      if (!mapml) return null;\n      let cs,\n        pseudo = mapml instanceof ShadowRoot ? ':host' : ':scope',\n        projection =\n          (mapml.querySelector(pseudo + ' > map-meta[name=projection]') &&\n            M._metaContentToObject(\n              mapml\n                .querySelector(pseudo + ' > map-meta[name=projection]')\n                .getAttribute('content')\n            ).content.toUpperCase()) ||\n          M.FALLBACK_PROJECTION;\n      try {\n        let meta =\n          mapml.querySelector(pseudo + ' > map-meta[name=extent]') &&\n          M._metaContentToObject(\n            mapml\n              .querySelector(pseudo + ' > map-meta[name=extent]')\n              .getAttribute('content')\n          );\n\n        let zoom = meta.zoom;\n\n        let metaKeys = Object.keys(meta);\n        for (let i = 0; i < metaKeys.length; i++) {\n          if (!metaKeys[i].includes('zoom')) {\n            cs = M.axisToCS(metaKeys[i].split('-')[2]);\n            break;\n          }\n        }\n        // this could happen if the content didn't match the grammar for map-meta[name=extent]\n        if (cs === undefined) throw new Error('cs undefined when getting bounds');\n\n        // when cs is tilematrix, tcrs or tile, zoom is required.\n        // should throw / return null instead of trying to construct a bounds\n\n        if (\n          zoom === undefined &&\n          (cs === 'TILEMATRIX' || cs === 'TCRS' || cs === 'TILE')\n        )\n          throw new Error(\n            'map-meta[name=extent] zoom= parameter not provided for tcrs,tile or tilematrix bounds'\n          );\n        let axes = M.csToAxes(cs);\n        return M.boundsToPCRSBounds(\n          L.bounds(\n            L.point(+meta[`top-left-${axes[0]}`], +meta[`top-left-${axes[1]}`]),\n            L.point(\n              +meta[`bottom-right-${axes[0]}`],\n              +meta[`bottom-right-${axes[1]}`]\n            )\n          ),\n          zoom,\n          projection,\n          cs\n        );\n      } catch (error) {\n        //if error then by default set the layer to osm and bounds to the entire map view\n        return M.boundsToPCRSBounds(\n          M[projection].options.crs.tilematrix.bounds(0),\n          0,\n          projection,\n          cs\n        );\n      }\n    },\n    /**\n     * TODO Review and improve design logic with Aliyan\n     *\n     * Parses object from <map-meta name=\"zoom\" content=\"...\">\n     * @param {type} mapml\n     * @returns {minZoom, maxZoom, minNativeZoom, maxNativeZoom}\n     */\n    getZoomBoundsFromMeta: function (mapml) {\n      if (!mapml) return null;\n      let pseudo = mapml instanceof ShadowRoot ? ':host' : ':scope';\n\n      let meta = M._metaContentToObject(\n        mapml\n          .querySelector(pseudo + '> map-meta[name=zoom]')\n          .getAttribute('content')\n      );\n      if (meta.min && meta.max && meta.value)\n        return {\n          minZoom: +meta.min,\n          maxZoom: +meta.max,\n          minNativeZoom: +meta.value,\n          maxNativeZoom: +meta.value\n        };\n      else if (meta.min && meta.max)\n        return {\n          minZoom: +meta.min,\n          maxZoom: +meta.max\n        };\n      else if (meta.min)\n        return {\n          minZoom: +meta.min\n        };\n      else if (meta.max)\n        return {\n          maxZoom: +meta.max\n        };\n    },\n    getZoomBounds: function (mapml, nativeZoom) {\n      if (!mapml) return null;\n      let nMin = 100,\n        nMax = 0,\n        features = mapml.querySelectorAll('map-feature'),\n        meta,\n        projection;\n      for (let i = 0; i < features.length; i++) {\n        let lZoom = +features[i].getAttribute('zoom');\n        if (!features[i].getAttribute('zoom')) lZoom = nativeZoom;\n        nMax = Math.max(nMax, lZoom);\n        nMin = Math.min(nMin, lZoom);\n      }\n      try {\n        projection = M._metaContentToObject(\n          mapml.querySelector('map-meta[name=projection]').getAttribute('content')\n        ).content;\n        meta = M._metaContentToObject(\n          mapml.querySelector('map-meta[name=zoom]').getAttribute('content')\n        );\n      } catch (error) {\n        return {\n          minZoom: 0,\n          maxZoom:\n            M[projection || M.FALLBACK_PROJECTION].options.resolutions.length - 1,\n          minNativeZoom: nMin,\n          maxNativeZoom: nMax\n        };\n      }\n      return {\n        minZoom: +meta.min,\n        maxZoom: +meta.max,\n        minNativeZoom: nMin,\n        maxNativeZoom: nMax\n      };\n    },\n    // getNativeVariables: returns an object with the native zoom and CS,\n    //                     based on the map-metas that are available within\n    //                     the layer or the fallback default values.\n    // getNativeVariables: mapml-||layer-||null||[map-feature,...] -> {zoom: _, val: _}\n    // mapml can be a mapml- element, layer- element, null, or an array of map-features\n    getNativeVariables: function (mapml) {\n      let nativeZoom, nativeCS;\n      // when mapml is an array of features provided by the query\n      if (\n        mapml.length &&\n        mapml[0].parentElement.parentElement &&\n        mapml[0].parentElement.parentElement.tagName === 'mapml-'\n      ) {\n        let mapmlEl = mapml[0].parentElement.parentElement;\n        nativeZoom =\n          (mapmlEl.querySelector &&\n            mapmlEl.querySelector('map-meta[name=zoom]') &&\n            +M._metaContentToObject(\n              mapmlEl.querySelector('map-meta[name=zoom]').getAttribute('content')\n            ).value) ||\n          0;\n        nativeCS =\n          (mapmlEl.querySelector &&\n            mapmlEl.querySelector('map-meta[name=cs]') &&\n            M._metaContentToObject(\n              mapmlEl.querySelector('map-meta[name=cs]').getAttribute('content')\n            ).content) ||\n          'GCRS';\n      } else {\n        // when mapml is null or a layer-/mapml- element\n        nativeZoom =\n          (mapml.querySelector &&\n            mapml.querySelector('map-meta[name=zoom]') &&\n            +M._metaContentToObject(\n              mapml.querySelector('map-meta[name=zoom]').getAttribute('content')\n            ).value) ||\n          0;\n        nativeCS =\n          (mapml.querySelector &&\n            mapml.querySelector('map-meta[name=cs]') &&\n            M._metaContentToObject(\n              mapml.querySelector('map-meta[name=cs]').getAttribute('content')\n            ).content) ||\n          'GCRS';\n      }\n      return { zoom: nativeZoom, cs: nativeCS };\n    },\n\n    // _gcrsToTileMatrix returns the [column, row] of the tiles at map center. Used for Announce movement for screen readers\n    // _gcrsToTileMatrix: map/mapml-viewer -> [column, row]\n    _gcrsToTileMatrix: function (mapEl) {\n      let point = mapEl._map.project(mapEl._map.getCenter());\n      let tileSize = mapEl._map.options.crs.options.crs.tile.bounds.max.y;\n      let column = Math.trunc(point.x / tileSize);\n      let row = Math.trunc(point.y / tileSize);\n      return [column, row];\n    },\n\n    // Pastes text to a mapml-viewer/map element(mapEl), text can be a mapml link, geojson, or a layer-\n    //    used for pasting layers through ctrl+v, drag/drop, and pasting through the contextmenu\n    // _pasteLayer: HTMLElement Str -> None\n    // Effects: append a layer- element to mapEl, if it is valid\n    _pasteLayer: function (mapEl, text) {\n      try {\n        new URL(text);\n        // create a new <layer-> child of the <mapml-viewer> element\n        let l =\n          '<layer- src=\"' +\n          text +\n          '\" label=\"' +\n          M.options.locale.dfLayer +\n          '\" checked=\"\"></layer->';\n        mapEl.insertAdjacentHTML('beforeend', l);\n        mapEl.lastElementChild.whenReady().catch(() => {\n          if (mapEl) {\n            // should invoke lifecyle callbacks automatically by removing it from DOM\n            mapEl.removeChild(mapEl.lastChild);\n          }\n          // garbage collect it\n          l = null;\n        });\n      } catch (err) {\n        text = text\n          .replace(/(<!--.*?-->)|(<!--[\\S\\s]+?-->)|(<!--[\\S\\s]*?$)/g, '')\n          .trim();\n        if (text.slice(0, 7) === '<layer-' && text.slice(-9) === '</layer->') {\n          mapEl.insertAdjacentHTML('beforeend', text);\n        } else if (\n          text.slice(0, 12) === '<map-feature' &&\n          text.slice(-14) === '</map-feature>'\n        ) {\n          let layer =\n            `<layer- label=\"${M.options.locale.dfPastedLayer}\" checked>\n                       <map-meta name='projection' content='${mapEl.projection}'></map-meta>` +\n            text +\n            '</layer->';\n          mapEl.insertAdjacentHTML('beforeend', layer);\n        } else {\n          try {\n            mapEl.geojson2mapml(JSON.parse(text));\n          } catch {\n            console.log('Invalid Input!');\n          }\n        }\n      }\n    },\n\n    // Takes GeoJSON Properties to return an HTML table, helper function\n    //    for geojson2mapml\n    // _properties2Table: geojsonPropertiesOBJ -> HTML Table\n    _properties2Table: function (json) {\n      let table = document.createElement('table');\n\n      // Creating a Table Header\n      let thead = table.createTHead();\n      let row = thead.insertRow();\n      let th1 = document.createElement('th');\n      let th2 = document.createElement('th');\n      th1.appendChild(document.createTextNode('Property name'));\n      th2.appendChild(document.createTextNode('Property value'));\n      th1.setAttribute('role', 'columnheader');\n      th2.setAttribute('role', 'columnheader');\n      th1.setAttribute('scope', 'col');\n      th2.setAttribute('scope', 'col');\n      row.appendChild(th1);\n      row.appendChild(th2);\n\n      // Creating table body and populating it from the JSON\n      let tbody = table.createTBody();\n      for (let key in json) {\n        if (json.hasOwnProperty(key)) {\n          let row = tbody.insertRow();\n          let th = document.createElement('th');\n          let td = document.createElement('td');\n          th.appendChild(document.createTextNode(key));\n          td.appendChild(document.createTextNode(json[key]));\n          th.setAttribute('scope', 'row');\n          td.setAttribute('itemprop', key);\n          row.appendChild(th);\n          row.appendChild(td);\n        }\n      }\n      return table;\n    },\n\n    // Takes bbox array and a x,y coordinate to possibly update the extent, returns extent\n    //    for geojson2mapml\n    // _updateExtent: [min x, min y, max x, max y], x, y -> [min x, min y, max x, max y]\n    _updateExtent: function (bboxExtent, x, y) {\n      if (bboxExtent === {}) {\n        return bboxExtent;\n      }\n      bboxExtent[0] = Math.min(x, bboxExtent[0]);\n      bboxExtent[1] = Math.min(y, bboxExtent[1]);\n      bboxExtent[2] = Math.max(x, bboxExtent[2]);\n      bboxExtent[3] = Math.max(y, bboxExtent[3]);\n      return bboxExtent;\n    },\n\n    // Takes a GeoJSON geojson and an options Object which returns a <layer-> Element\n    // The options object can contain the following:\n    //      label            - String, contains the layer name, if included overrides the default label mapping\n    //      projection       - String, contains the projection of the layer (OSMTILE, WGS84, CBMTILE, APSTILE), defaults to   OSMTILE\n    //      caption          - Function | String, function accepts one argument being the feature object which produces the   featurecaption string OR a string that is the name of the property that will be mapped to featurecaption\n    //      properties       - Function | String | HTMLElement, a function which maps the geojson feature to an HTMLElement   or a string that will be parsed as an HTMLElement or an HTMLElement\n    //      geometryFunction - Function, A function you supply that can add classes, hyperlinks and spans to the created  <map-geometry> element, default would be the plain map-geometry element\n    // geojson2mapml: geojson Object <layer-> [min x, min y, max x, max y] -> <layer->\n    geojson2mapml: function (json, options = {}, layer = null, bboxExtent = {}) {\n      let defaults = {\n        label: null,\n        projection: 'OSMTILE',\n        caption: null,\n        properties: null,\n        geometryFunction: null\n      };\n      // assign default values for undefined options\n      options = Object.assign({}, defaults, options);\n\n      // If string json is received\n      if (typeof json === 'string') {\n        json = JSON.parse(json);\n      }\n      let geometryType = [\n        'POINT',\n        'LINESTRING',\n        'POLYGON',\n        'MULTIPOINT',\n        'MULTILINESTRING',\n        'MULTIPOLYGON',\n        'GEOMETRYCOLLECTION'\n      ];\n      let jsonType = json.type.toUpperCase();\n      let out = '';\n      let setExtent = false;\n\n      // HTML parser\n      let parser = new DOMParser();\n\n      // initializing layer\n      if (layer === null) {\n        if (!json.bbox) {\n          setExtent = true;\n        }\n        // creating an empty mapml layer\n        let xmlStringLayer =\n          \"<layer- label='' checked><map-meta name='projection' content='\" +\n          options.projection +\n          \"'></map-meta><map-meta name='cs' content='gcrs'></map-meta></layer->\";\n        layer = parser.parseFromString(xmlStringLayer, 'text/html');\n        //console.log(layer)\n        if (options.label !== null) {\n          layer.querySelector('layer-').setAttribute('label', options.label);\n        } else if (json.name) {\n          layer.querySelector('layer-').setAttribute('label', json.name);\n        } else if (json.title) {\n          layer.querySelector('layer-').setAttribute('label', json.title);\n        } else {\n          layer\n            .querySelector('layer-')\n            .setAttribute('label', M.options.locale.dfLayer);\n        }\n      }\n      let point = '<map-point></map-point>';\n      point = parser.parseFromString(point, 'text/html');\n\n      let multiPoint =\n        '<map-multipoint><map-coordinates></map-coordinates></map-multipoint>';\n      multiPoint = parser.parseFromString(multiPoint, 'text/html');\n\n      let linestring =\n        '<map-linestring><map-coordinates></map-coordinates></map-linestring>';\n      linestring = parser.parseFromString(linestring, 'text/html');\n\n      let multilinestring = '<map-multilinestring></map-multilinestring>';\n      multilinestring = parser.parseFromString(multilinestring, 'text/html');\n\n      let polygon = '<map-polygon></map-polygon>';\n      polygon = parser.parseFromString(polygon, 'text/html');\n\n      let multiPolygon = '<map-multipolygon></map-multipolygon>';\n      multiPolygon = parser.parseFromString(multiPolygon, 'text/html');\n\n      let geometrycollection =\n        '<map-geometrycollection></map-geometrycollection>';\n      geometrycollection = parser.parseFromString(\n        geometrycollection,\n        'text/html'\n      );\n\n      let feature =\n        '<map-feature><map-featurecaption></map-featurecaption><map-geometry></map-geometry><map-properties></map-properties></map-feature>';\n      feature = parser.parseFromString(feature, 'text/html');\n\n      // Template to add coordinates to Geometries\n      let coords = '<map-coordinates></map-coordinates>';\n      coords = parser.parseFromString(coords, 'text/html');\n\n      //console.log(layer);\n      if (jsonType === 'FEATURECOLLECTION') {\n        // Setting bbox if it exists\n        if (json.bbox) {\n          layer\n            .querySelector('layer-')\n            .insertAdjacentHTML(\n              'afterbegin',\n              \"<map-meta name='extent' content='top-left-longitude=\" +\n                json.bbox[0] +\n                ', top-left-latitude=' +\n                json.bbox[1] +\n                ', bottom-right-longitude=' +\n                json.bbox[2] +\n                ',bottom-right-latitude=' +\n                json.bbox[3] +\n                \"'></map-meta>\"\n            );\n        } else {\n          bboxExtent = [\n            Infinity,\n            Infinity,\n            Number.NEGATIVE_INFINITY,\n            Number.NEGATIVE_INFINITY\n          ];\n        }\n\n        let features = json.features;\n        //console.log(\"Features length - \" + features.length);\n        for (let l = 0; l < features.length; l++) {\n          M.geojson2mapml(features[l], options, layer, bboxExtent);\n        }\n      } else if (jsonType === 'FEATURE') {\n        let clone_feature = feature.cloneNode(true);\n        let curr_feature = clone_feature.querySelector('map-feature');\n\n        // Setting bbox if it exists\n        if (json.bbox) {\n          layer\n            .querySelector('layer-')\n            .insertAdjacentHTML(\n              'afterbegin',\n              \"<map-meta name='extent' content='top-left-longitude=\" +\n                json.bbox[0] +\n                ', top-left-latitude=' +\n                json.bbox[1] +\n                ', bottom-right-longitude=' +\n                json.bbox[2] +\n                ',bottom-right-latitude=' +\n                json.bbox[3] +\n                \"'></map-meta>\"\n            );\n        } else if (\n          typeof bboxExtent === 'object' &&\n          bboxExtent.length === undefined\n        ) {\n          bboxExtent = [\n            Infinity,\n            Infinity,\n            Number.NEGATIVE_INFINITY,\n            Number.NEGATIVE_INFINITY\n          ];\n        }\n\n        // Setting featurecaption\n        let featureCaption = layer.querySelector('layer-').getAttribute('label');\n        if (typeof options.caption === 'function') {\n          featureCaption = options.caption(json);\n        } else if (typeof options.caption === 'string') {\n          featureCaption = json.properties[options.caption];\n          // if property does not exist\n          if (featureCaption === undefined) {\n            featureCaption = options.caption;\n          }\n        } else if (json.id) {\n          // when no caption option available try setting id as featurecaption\n          featureCaption = json.id;\n        }\n        curr_feature.querySelector('map-featurecaption').innerHTML =\n          featureCaption;\n\n        // Setting Properties\n        let p;\n        // if properties function is passed\n        if (typeof options.properties === 'function') {\n          p = options.properties(json);\n          // if function output is not an element, ignore the properties.\n          if (!(p instanceof Element)) {\n            p = false;\n            console.error(\n              'options.properties function returns a string instead of an HTMLElement.'\n            );\n          }\n        } else if (typeof options.properties === 'string') {\n          // if properties string is passed\n          curr_feature\n            .querySelector('map-properties')\n            .insertAdjacentHTML('beforeend', options.properties);\n          p = false;\n        } else if (options.properties instanceof HTMLElement) {\n          // if an HTMLElement is passed - NOT TESTED\n          p = options.properties;\n        } else {\n          // If no properties function, string or HTMLElement is passed\n          p = M._properties2Table(json.properties);\n        }\n\n        if (p) {\n          curr_feature.querySelector('map-properties').appendChild(p);\n        }\n\n        // Setting map-geometry\n        let g = M.geojson2mapml(json.geometry, options, layer, bboxExtent);\n        if (typeof options.geometryFunction === 'function') {\n          curr_feature\n            .querySelector('map-geometry')\n            .appendChild(options.geometryFunction(g, json));\n        } else {\n          curr_feature.querySelector('map-geometry').appendChild(g);\n        }\n\n        // Appending feature to layer\n        layer.querySelector('layer-').appendChild(curr_feature);\n      } else if (geometryType.includes(jsonType)) {\n        //console.log(\"Geometry Type - \" + jsonType);\n        switch (jsonType) {\n          case 'POINT':\n            bboxExtent = M._updateExtent(\n              bboxExtent,\n              json.coordinates[0],\n              json.coordinates[1]\n            );\n            out = json.coordinates[0] + ' ' + json.coordinates[1];\n\n            // Create Point element\n            let clone_point = point.cloneNode(true);\n            clone_point = clone_point.querySelector('map-point');\n\n            // Create map-coords to add to the polygon\n            let clone_coords = coords.cloneNode(true);\n            clone_coords = clone_coords.querySelector('map-coordinates');\n\n            clone_coords.innerHTML = out;\n\n            clone_point.appendChild(clone_coords);\n            //console.log(clone_point);\n            return clone_point;\n\n          case 'LINESTRING':\n            let clone_linestring = linestring.cloneNode(true);\n            let linestring_coordindates =\n              clone_linestring.querySelector('map-coordinates');\n\n            out = '';\n\n            for (let x = 0; x < json.coordinates.length; x++) {\n              bboxExtent = M._updateExtent(\n                bboxExtent,\n                json.coordinates[x][0],\n                json.coordinates[x][1]\n              );\n              out =\n                out + json.coordinates[x][0] + ' ' + json.coordinates[x][1] + ' ';\n            }\n\n            linestring_coordindates.innerHTML = out;\n            //console.log(clone_linestring.querySelector('map-linestring'));\n            return clone_linestring.querySelector('map-linestring');\n\n          case 'POLYGON':\n            let clone_polygon = polygon.cloneNode(true);\n            clone_polygon = clone_polygon.querySelector('map-polygon');\n\n            // Going over each coordinates\n            for (let y = 0; y < json.coordinates.length; y++) {\n              let out = '';\n              let clone_coords = coords.cloneNode(true);\n              clone_coords = clone_coords.querySelector('map-coordinates');\n\n              // Going over coordinates for the polygon\n              for (let x = 0; x < json.coordinates[y].length; x++) {\n                bboxExtent = M._updateExtent(\n                  bboxExtent,\n                  json.coordinates[y][x][0],\n                  json.coordinates[y][x][1]\n                );\n                out =\n                  out +\n                  json.coordinates[y][x][0] +\n                  ' ' +\n                  json.coordinates[y][x][1] +\n                  ' ';\n              }\n\n              // Create map-coordinates element and append it to clone_polygon\n              clone_coords.innerHTML = out;\n\n              clone_polygon.appendChild(clone_coords);\n            }\n            //console.log(clone_polygon);\n            return clone_polygon;\n\n          case 'MULTIPOINT':\n            out = '';\n            // Create multipoint element\n            let clone_multipoint = multiPoint.cloneNode(true);\n            clone_multipoint = clone_multipoint.querySelector('map-multipoint');\n\n            for (let i = 0; i < json.coordinates.length; i++) {\n              bboxExtent = M._updateExtent(\n                bboxExtent,\n                json.coordinates[i][0],\n                json.coordinates[i][1]\n              );\n              out =\n                out + json.coordinates[i][0] + ' ' + json.coordinates[i][1] + ' ';\n            }\n            clone_multipoint.querySelector('map-coordinates').innerHTML = out;\n            return clone_multipoint;\n\n          case 'MULTILINESTRING':\n            let clone_multilinestring = multilinestring.cloneNode(true);\n            clone_multilinestring = clone_multilinestring.querySelector(\n              'map-multilinestring'\n            );\n\n            for (let i = 0; i < json.coordinates.length; i++) {\n              let out = '';\n              let clone_coords = coords.cloneNode(true);\n              clone_coords = clone_coords.querySelector('map-coordinates');\n              for (let y = 0; y < json.coordinates[i].length; y++) {\n                bboxExtent = M._updateExtent(\n                  bboxExtent,\n                  json.coordinates[i][y][0],\n                  json.coordinates[i][y][1]\n                );\n                out =\n                  out +\n                  json.coordinates[i][y][0] +\n                  ' ' +\n                  json.coordinates[i][y][1] +\n                  ' ';\n              }\n              clone_coords.innerHTML = out;\n              clone_multilinestring.appendChild(clone_coords);\n            }\n            return clone_multilinestring;\n\n          case 'MULTIPOLYGON':\n            let m = multiPolygon.cloneNode(true);\n            m = m.querySelector('map-multiPolygon');\n\n            // Going over each Polygon\n            for (let i = 0; i < json.coordinates.length; i++) {\n              let clone_polygon = polygon.cloneNode(true);\n              clone_polygon = clone_polygon.querySelector('map-polygon');\n\n              // Going over each coordinates\n              for (let y = 0; y < json.coordinates[i].length; y++) {\n                let out = '';\n                let clone_coords = coords.cloneNode(true);\n                clone_coords = clone_coords.querySelector('map-coordinates');\n\n                // Going over coordinates for the polygon\n                for (let x = 0; x < json.coordinates[i][y].length; x++) {\n                  bboxExtent = M._updateExtent(\n                    bboxExtent,\n                    json.coordinates[i][y][x][0],\n                    json.coordinates[i][y][x][1]\n                  );\n                  out =\n                    out +\n                    json.coordinates[i][y][x][0] +\n                    ' ' +\n                    json.coordinates[i][y][x][1] +\n                    ' ';\n                }\n\n                // Create map-coordinates element and append it to clone_polygon\n                clone_coords.innerHTML = out;\n\n                clone_polygon.appendChild(clone_coords);\n              }\n              m.appendChild(clone_polygon);\n            }\n            return m;\n          case 'GEOMETRYCOLLECTION': // ---------------------------------------------------------------------------\n            let g = geometrycollection.cloneNode(true);\n            g = g.querySelector('map-geometrycollection');\n            //console.log(json.geometries);\n            for (let i = 0; i < json.geometries.length; i++) {\n              let fg = M.geojson2mapml(\n                json.geometries[i],\n                options,\n                layer,\n                bboxExtent\n              );\n              g.appendChild(fg);\n            }\n            return g;\n        }\n      }\n      //Add default bbox\n      if (setExtent) {\n        layer\n          .querySelector('layer-')\n          .insertAdjacentHTML(\n            'afterbegin',\n            \"<map-meta name='extent' content='top-left-longitude=\" +\n              bboxExtent[0] +\n              ', top-left-latitude=' +\n              bboxExtent[1] +\n              ', bottom-right-longitude=' +\n              bboxExtent[2] +\n              ',bottom-right-latitude=' +\n              bboxExtent[3] +\n              \"'></map-meta>\"\n          );\n      }\n      return layer.querySelector('layer-');\n    },\n\n    // Takes an array of length n to return an array of arrays with length 2, helper function\n    //    for mapml2geojson\n    // _breakArray: arr(float) -> arr(arr(float, float))\n    _breakArray: function (arr) {\n      let size = 2;\n      let arrayOfArrays = [];\n      // removing anything other than numbers, ., - (used to remove <map-span> tags)\n      arr = arr.filter((x) => !/[^\\d.-]/g.test(x)).filter((x) => x);\n      for (let i = 0; i < arr.length; i += size) {\n        arrayOfArrays.push(arr.slice(i, i + size).map(Number));\n      }\n      return arrayOfArrays;\n    },\n\n    // Takes an HTML Table to return geojson properties, helper function\n    //    for mapml2geojson\n    // _table2properties: HTML Table -> geojson\n    _table2properties: function (table) {\n      // removing thead, if it exists\n      let head = table.querySelector('thead');\n      if (head !== null) {\n        table.querySelector('thead').remove();\n      }\n      let json = {};\n      table.querySelectorAll('tr').forEach((tr) => {\n        let tableData = tr.querySelectorAll('th, td');\n        json[tableData[0].innerHTML] = tableData[1].innerHTML;\n      });\n      return json;\n    },\n\n    // Converts a geometry element (el) to geojson, helper function\n    //    for mapml2geojson, NOTE - el can not be a map-geometrycollection\n    // _geometry2geojson: (child of <map-geometry>), Proj4, Proj4, Bool -> geojson\n    _geometry2geojson: function (el, source, dest, transform) {\n      // remove map-a, map-span elements if the geometry is wrapped in them\n      while (\n        el.nodeName.toUpperCase() === 'MAP-SPAN' ||\n        el.nodeName.toUpperCase() === 'MAP-A'\n      ) {\n        el = el.firstElementChild;\n      }\n      let elem = el.nodeName;\n      let j = {};\n      let coord;\n\n      switch (elem.toUpperCase()) {\n        case 'MAP-POINT':\n          j.type = 'Point';\n          if (transform) {\n            let pointConv = proj4.transform(\n              source,\n              dest,\n              el\n                .querySelector('map-coordinates')\n                .innerHTML.split(/[<>\\ ]/g)\n                .map(Number)\n            );\n            j.coordinates = [pointConv.x, pointConv.y];\n          } else {\n            j.coordinates = el\n              .querySelector('map-coordinates')\n              .innerHTML.split(/[<>\\ ]/g)\n              .map(Number);\n          }\n          break;\n        case 'MAP-LINESTRING':\n          j.type = 'LineString';\n          coord = el.querySelector('map-coordinates').innerHTML.split(/[<>\\ ]/g);\n          coord = M._breakArray(coord);\n          if (transform) {\n            coord = M._pcrsToGcrs(coord, source, dest);\n          }\n          j.coordinates = coord;\n          break;\n        case 'MAP-POLYGON':\n          j.type = 'Polygon';\n          j.coordinates = [];\n          let x = 0;\n          el.querySelectorAll('map-coordinates').forEach((coord) => {\n            coord = coord.innerHTML.split(/[<>\\ ]/g);\n            coord = M._breakArray(coord);\n            if (transform) {\n              coord = M._pcrsToGcrs(coord, source, dest);\n            }\n            j.coordinates[x] = coord;\n            x++;\n          });\n          break;\n        case 'MAP-MULTIPOINT':\n          j.type = 'MultiPoint';\n          coord = M._breakArray(\n            el.querySelector('map-coordinates').innerHTML.split(/[<>\\ ]/g)\n          );\n          if (transform) {\n            coord = M._pcrsToGcrs(coord, source, dest);\n          }\n          j.coordinates = coord;\n          break;\n        case 'MAP-MULTILINESTRING':\n          j.type = 'MultiLineString';\n          j.coordinates = [];\n          let i = 0;\n          el.querySelectorAll('map-coordinates').forEach((coord) => {\n            coord = coord.innerHTML.split(/[<>\\ ]/g);\n            coord = M._breakArray(coord);\n            if (transform) {\n              coord = M._pcrsToGcrs(coord, source, dest);\n            }\n            j.coordinates[i] = coord;\n            i++;\n          });\n          break;\n        case 'MAP-MULTIPOLYGON':\n          j.type = 'MultiPolygon';\n          j.coordinates = [];\n          let p = 0;\n          el.querySelectorAll('map-polygon').forEach((poly) => {\n            let y = 0;\n            j.coordinates.push([]);\n            poly.querySelectorAll('map-coordinates').forEach((coord) => {\n              coord = coord.innerHTML.split(/[<>\\ ]/g);\n              coord = M._breakArray(coord);\n              if (transform) {\n                coord = M._pcrsToGcrs(coord, source, dest);\n              }\n              j.coordinates[p].push([]);\n              j.coordinates[p][y] = coord;\n              y++;\n            });\n            p++;\n          });\n          break;\n      }\n      return j;\n    },\n\n    // _pcrsToGcrs: arrof([x,y]) Proj4, Proj4 -> arrof[x,y]\n    _pcrsToGcrs: function (arr, source, dest) {\n      let newArr = [];\n      for (let i = 0; i < arr.length; i++) {\n        let conv = proj4.transform(source, dest, arr[i]);\n        conv = [conv.x, conv.y];\n        newArr.push(conv);\n      }\n      return newArr;\n    },\n\n    // Takes an <layer-> element and returns a geojson feature collection object\n    // The options object can contain the following:\n    //      propertyFunction   - function(<map-properties>), A function that maps the features' <map-properties> element to   a GeoJSON \"properties\" member.\n    //      transform          - Bool, Transform coordinates to gcrs values, defaults to True\n    // mapml2geojson: <layer-> Object -> GeoJSON\n    mapml2geojson: function (element, options = {}) {\n      let defaults = {\n        propertyFunction: null,\n        transform: true\n      };\n      // assign default values for undefined options\n      options = Object.assign({}, defaults, options);\n\n      let json = {};\n      json.type = 'FeatureCollection';\n      json.title = element.getAttribute('label');\n      json.features = [];\n\n      // Transforming Coordinates to gcrs if transformation = true and coordinate is not (EPSG:3857 or EPSG:4326)\n      let source = null;\n      let dest = null;\n      if (options.transform) {\n        source = new proj4.Proj(element.parentElement._map.options.crs.code);\n        dest = new proj4.Proj('EPSG:4326');\n        if (\n          element.parentElement._map.options.crs.code === 'EPSG:3857' ||\n          element.parentElement._map.options.crs.code === 'EPSG:4326'\n        ) {\n          options.transform = false;\n        }\n      }\n\n      // Setting all meta settings, if any\n      let metas = element.querySelectorAll('map-meta');\n      metas.forEach((meta) => {\n        let name = meta.getAttribute('name');\n        if (name === 'extent') {\n          let content = meta.getAttribute('content');\n          let arr = content.split(',');\n          let ex = {};\n          for (let i = 0; i < arr.length; i++) {\n            let s = arr[i].split('=');\n            s[0] = s[0].trim(); // removing whitespace\n            s[1] = parseFloat(s[1]);\n            ex[s[0]] = s[1];\n          }\n          json.bbox = [\n            ex['top-left-longitude'],\n            ex['top-left-latitude'],\n            ex['bottom-right-longitude'],\n            ex['bottom-right-latitude']\n          ];\n        }\n      });\n\n      // Iterating over each feature\n      let features = element.querySelectorAll('map-feature');\n      let num = 0;\n\n      // Going over each feature in the layer\n      features.forEach((feature) => {\n        //console.log(feature);\n\n        json.features[num] = { type: 'Feature' };\n        json.features[num].geometry = {};\n        json.features[num].properties = {};\n\n        // setting properties when function presented\n        if (!feature.querySelector('map-properties')) {\n          json.features[num].properties = null;\n        } else if (typeof options.propertyFunction === 'function') {\n          let properties = options.propertyFunction(\n            feature.querySelector('map-properties')\n          );\n          json.features[num].properties = properties;\n        } else if (\n          feature.querySelector('map-properties').querySelector('table') !== null\n        ) {\n          // setting properties when table presented\n          let table = feature\n              .querySelector('map-properties')\n              .querySelector('table')\n              .cloneNode(true),\n            properties = M._table2properties(table);\n          json.features[num].properties = properties;\n        } else {\n          // when no table present, strip any possible html tags to only get text\n          json.features[num].properties = {\n            prop0: feature\n              .querySelector('map-properties')\n              .innerHTML.replace(/(<([^>]+)>)/gi, '')\n          };\n        }\n\n        let geom = feature.querySelector('map-geometry').firstElementChild;\n\n        // remove map-a, map-span elements if the geometry is wrapped in them\n        while (\n          geom.nodeName.toUpperCase() === 'MAP-SPAN' ||\n          geom.nodeName.toUpperCase() === 'MAP-A'\n        ) {\n          geom = geom.firstElementChild;\n        }\n\n        // Adding Geometry\n        if (geom.nodeName.toUpperCase() !== 'MAP-GEOMETRYCOLLECTION') {\n          json.features[num].geometry = M._geometry2geojson(\n            geom,\n            source,\n            dest,\n            options.transform\n          );\n        } else {\n          json.features[num].geometry.type = 'GeometryCollection';\n          json.features[num].geometry.geometries = [];\n\n          let geoms = geom.children;\n          Array.from(geoms).forEach((g) => {\n            // omit all map-span, map-a that may be present in geometry-collection\n            let n = g.nodeName.toUpperCase();\n            if (n === 'MAP-SPAN' || n === 'MAP-A') {\n              g = g.cloneNode(true);\n              [...g.querySelectorAll('map-a, map-span')].forEach((e) =>\n                e.replaceWith(...e.children)\n              );\n              Array.from(g.children).forEach((i) => {\n                i = M._geometry2geojson(i, source, dest, options.transform);\n                json.features[num].geometry.geometries.push(i);\n              });\n            } else {\n              g = M._geometry2geojson(g, source, dest, options.transform);\n              json.features[num].geometry.geometries.push(g);\n            }\n          });\n        }\n        //going to next feature\n        num++;\n      });\n\n      return json;\n    },\n\n    // Takes leaflet bound, leaflet map and min and max zoom limit,\n    // return the maximum zoom level that can show the bound completely\n    // getMaxZoom: L.Bound, L.Map, Number, Number -> Number\n    getMaxZoom: function (bound, map, minZoom, maxZoom) {\n      if (!bound) return;\n\n      let newZoom = map.getZoom(),\n        scale = map.options.crs.scale(newZoom),\n        mapCenterTCRS = map.options.crs.transformation.transform(\n          bound.getCenter(true),\n          scale\n        );\n\n      let mapHalf = map.getSize().divideBy(2),\n        mapTlNew = mapCenterTCRS.subtract(mapHalf).round(),\n        mapBrNew = mapCenterTCRS.add(mapHalf).round();\n\n      let mapTlPCRSNew = M.pixelToPCRSPoint(\n          mapTlNew,\n          newZoom,\n          map.options.projection\n        ),\n        mapBrPCRSNew = M.pixelToPCRSPoint(\n          mapBrNew,\n          newZoom,\n          map.options.projection\n        );\n\n      let mapPCRS = L.bounds(mapTlPCRSNew, mapBrPCRSNew),\n        zOffset = mapPCRS.contains(bound) ? 1 : -1;\n\n      while (\n        (zOffset === -1 && !mapPCRS.contains(bound) && newZoom - 1 >= minZoom) ||\n        (zOffset === 1 && mapPCRS.contains(bound) && newZoom + 1 <= maxZoom)\n      ) {\n        newZoom += zOffset;\n        scale = map.options.crs.scale(newZoom);\n        mapCenterTCRS = map.options.crs.transformation.transform(\n          bound.getCenter(true),\n          scale\n        );\n\n        mapTlNew = mapCenterTCRS.subtract(mapHalf).round();\n        mapBrNew = mapCenterTCRS.add(mapHalf).round();\n        mapTlPCRSNew = M.pixelToPCRSPoint(\n          mapTlNew,\n          newZoom,\n          map.options.projection\n        );\n        mapBrPCRSNew = M.pixelToPCRSPoint(\n          mapBrNew,\n          newZoom,\n          map.options.projection\n        );\n\n        mapPCRS = L.bounds(mapTlPCRSNew, mapBrPCRSNew);\n      }\n\n      if (\n        zOffset === 1 &&\n        newZoom - 1 >= 0 &&\n        !(newZoom === maxZoom && mapPCRS.contains(bound))\n      )\n        newZoom--;\n      return newZoom;\n    },\n    getClosest(node, selector) {\n      if (!node) {\n        return null;\n      }\n      if (node instanceof ShadowRoot) {\n        return M.getClosest(node.host, selector);\n      }\n\n      if (node instanceof HTMLElement) {\n        if (node.matches(selector)) {\n          return node;\n        } else {\n          return M.getClosest(node.parentNode, selector);\n        }\n      }\n\n      return M.getClosest(node.parentNode, selector);\n    }\n  };\n\n  var AttributionButton = L.Control.Attribution.extend({\n    options: {\n      prefix:\n        '<img src=\"https://www.w3.org/community/src/templates/wordpress/StoryTeller/favicon.ico\" style=\"position: relative; top: 5px\" alt=\"W3C Community and Business Groups logo\"> <a href=\"https://www.w3.org/community/maps4html/\">Maps for HTML Community Group</a> | <img src=\"data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTIiIGhlaWdodD0iOCI+PHBhdGggZmlsbD0iIzRDN0JFMSIgZD0iTTAgMGgxMnY0SDB6Ii8+PHBhdGggZmlsbD0iI0ZGRDUwMCIgZD0iTTAgNGgxMnYzSDB6Ii8+PHBhdGggZmlsbD0iI0UwQkMwMCIgZD0iTTAgN2gxMnYxSDB6Ii8+PC9zdmc+\" style=\"padding-right: 0.3em;\" alt=\"Slava Ukraini\"> <a href=\"https://leafletjs.com\" title=\"A JS library for interactive maps\">Leaflet</a> '\n    },\n\n    onAdd: function (map) {\n      map.attributionControl = this;\n      this._container = L.DomUtil.create(\n        'details',\n        'leaflet-control-attribution'\n      );\n      L.DomEvent.disableClickPropagation(this._container);\n\n      for (var i in map._layers) {\n        if (map._layers[i].getAttribution) {\n          this.addAttribution(map._layers[i].getAttribution());\n        }\n      }\n\n      this._update();\n\n      map.on('layeradd', this._addAttribution, this);\n\n      let dialog = document.createElement('dialog');\n      dialog.setAttribute('class', 'shortcuts-dialog');\n      dialog.setAttribute('autofocus', '');\n      dialog.onclick = function (e) {\n        e.stopPropagation();\n      };\n      dialog.innerHTML =\n        `<b>${M.options.locale.kbdShortcuts} </b><button aria-label=\"Close\" onclick='this.parentElement.close()'>X</button>` +\n        `<ul><b>${M.options.locale.kbdMovement}</b><li><kbd>&#8593</kbd> ${M.options.locale.kbdPanUp}</li><li><kbd>&#8595</kbd> ${M.options.locale.kbdPanDown}</li><li><kbd>&#8592</kbd> ${M.options.locale.kbdPanLeft}</li><li><kbd>&#8594</kbd> ${M.options.locale.kbdPanRight}</li><li><kbd>+</kbd> ${M.options.locale.btnZoomIn}</li><li><kbd>-</kbd> ${M.options.locale.btnZoomOut}</li><li><kbd>shift</kbd> + <kbd>&#8592/&#8593/&#8594/&#8595</kbd> 3x ${M.options.locale.kbdPanIncrement}</li><li><kbd>ctrl</kbd> + <kbd>&#8592/&#8593/&#8594/&#8595</kbd> 0.2x ${M.options.locale.kbdPanIncrement}</li><li><kbd>shift</kbd> + <kbd>+/-</kbd> ${M.options.locale.kbdZoom}</li></ul>` +\n        `<ul><b>${M.options.locale.kbdFeature}</b><li><kbd>&#8592/&#8593</kbd> ${M.options.locale.kbdPrevFeature}</li><li><kbd>&#8594/&#8595</kbd> ${M.options.locale.kbdNextFeature}</li></ul>`;\n      map._container.appendChild(dialog);\n\n      return this._container;\n    },\n\n    _update: function () {\n      if (!this._map) {\n        return;\n      }\n\n      var attribs = [];\n\n      for (var i in this._attributions) {\n        if (this._attributions[i]) {\n          attribs.push(i);\n        }\n      }\n\n      var prefixAndAttribs = [];\n\n      if (this.options.prefix) {\n        prefixAndAttribs.push(this.options.prefix);\n      }\n      if (attribs.length) {\n        prefixAndAttribs.push(attribs.join(', '));\n      }\n      this._container.innerHTML =\n        `<summary><svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" height=\"30px\" viewBox=\"0 0 24 24\" width=\"30px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"></path><path d=\"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"></path></svg></summary>` +\n        '<div class=\"mapml-attribution-container\">' +\n        `<button onclick=\"this.closest(\\'.leaflet-container\\').querySelector(\\'.shortcuts-dialog\\').showModal()\" class=\"shortcuts-button mapml-button\">${M.options.locale.kbdShortcuts}</button> | ` +\n        prefixAndAttribs.join(' <span aria-hidden=\"true\">|</span> ') +\n        '</div>';\n      this._container.setAttribute('role', 'group');\n      this._container.setAttribute(\n        'aria-label',\n        `${M.options.locale.btnAttribution}`\n      );\n    }\n  });\n\n  L.Map.mergeOptions({\n    attributionControl: false,\n    toggleableAttributionControl: true\n  });\n\n  L.Map.addInitHook(function () {\n    if (this.options.toggleableAttributionControl) {\n      new AttributionButton().addTo(this);\n    }\n  });\n\n  var attributionButton = function (options) {\n    return new AttributionButton(options);\n  };\n\n  var ReloadButton = L.Control.extend({\n    options: {\n      position: 'topleft'\n    },\n\n    onAdd: function (map) {\n      let container = L.DomUtil.create('div', 'mapml-reload-button leaflet-bar');\n\n      let link = L.DomUtil.create('button', 'mapml-reload-button', container);\n      link.innerHTML = \"<span aria-hidden='true'>&#x021BA</span>\";\n      link.title = M.options.locale.cmReload;\n      link.setAttribute('type', 'button');\n      link.classList.add('mapml-button');\n      link.setAttribute('aria-label', 'Reload');\n\n      L.DomEvent.disableClickPropagation(link);\n      L.DomEvent.on(link, 'click', L.DomEvent.stop);\n      L.DomEvent.on(link, 'click', this._goReload, this);\n\n      this._reloadButton = link;\n\n      this._updateDisabled();\n      map.on('moveend', this._updateDisabled, this);\n\n      return container;\n    },\n\n    onRemove: function (map) {\n      map.off('moveend', this._updateDisabled, this);\n    },\n\n    disable: function () {\n      this._disabled = true;\n      this._updateDisabled();\n      return this;\n    },\n\n    enable: function () {\n      this._disabled = false;\n      this._updateDisabled();\n      return this;\n    },\n\n    _goReload: function (e) {\n      if (!this._disabled && this._map.options.mapEl._history.length > 1) {\n        this._map.options.mapEl.reload();\n      }\n    },\n\n    _updateDisabled: function () {\n      setTimeout(() => {\n        L.DomUtil.removeClass(this._reloadButton, 'leaflet-disabled');\n        this._reloadButton.setAttribute('aria-disabled', 'false');\n\n        if (\n          this._map &&\n          (this._disabled || this._map.options.mapEl._history.length <= 1)\n        ) {\n          L.DomUtil.addClass(this._reloadButton, 'leaflet-disabled');\n          this._reloadButton.setAttribute('aria-disabled', 'true');\n        }\n      }, 0);\n    }\n  });\n\n  var reloadButton = function (options) {\n    return new ReloadButton(options);\n  };\n\n  var ScaleBar = L.Control.Scale.extend({\n    options: {\n      maxWidth: 100,\n      updateWhenIdle: true,\n      position: 'bottomleft'\n    },\n\n    onAdd: function (map) {\n      // create output tag for screenreader to read from\n      let outputScale =\n        \"<output role='status' aria-live='polite' aria-atomic='true' class='mapml-screen-reader-output-scale'></output>\";\n      map._container.insertAdjacentHTML('beforeend', outputScale);\n\n      // initialize _container\n      this._container = L.DomUtil.create('div', 'mapml-control-scale');\n      let scaleControl = L.Control.Scale.prototype.onAdd.call(this, map);\n      this._container.appendChild(scaleControl);\n      this._container.setAttribute('tabindex', 0);\n      this._scaleControl = this;\n\n      // run on load\n      setTimeout(() => {\n        this._updateOutput();\n        this._focusOutput();\n      }, 0);\n\n      // update whenever map is zoomed or dragged\n      map.on('zoomend moveend', this._updateOutput, this);\n\n      // have screenreader read out everytime the map is focused\n      this._map._container.addEventListener('focus', () => this._focusOutput());\n\n      return this._container;\n    },\n\n    onRemove: function (map) {\n      map.off('zoomend moveend', this._updateOutput, this);\n    },\n\n    getContainer: function () {\n      return this._container;\n    },\n\n    _pixelsToDistance: function (px, units) {\n      let dpi = window.devicePixelRatio * 96; // default dpi\n      if (units === 'metric') {\n        return (px / dpi) * 2.54; // inches to cm\n      }\n      return px / dpi;\n    },\n\n    _scaleLength: function (scale) {\n      let scaleLength = scale.getAttribute('style');\n      let finalLength = parseInt(scaleLength.match(/width:\\s*(\\d+)px/)[1]);\n\n      return finalLength;\n    },\n\n    _focusOutput: function () {\n      setTimeout(() => {\n        let outputFocus = this._map._container.querySelector(\n          '.mapml-screen-reader-output-scale'\n        );\n        outputFocus.textContent = '';\n        setTimeout(() => {\n          outputFocus.textContent = this._container.getAttribute('aria-label');\n        }, 100);\n      }, 0);\n    },\n\n    _updateOutput: function () {\n      let output = '';\n      let scaleLine = this._scaleControl\n        .getContainer()\n        .getElementsByClassName('leaflet-control-scale-line')[0];\n\n      if (this.options.metric) {\n        let distance = parseFloat(\n          this._pixelsToDistance(this._scaleLength(scaleLine), 'metric').toFixed(\n            1\n          )\n        );\n        output = `${distance} centimeters to ${scaleLine.textContent.trim()}`;\n        output = output.replace(/(\\d+)\\s*m\\b/g, '$1 meters');\n        output = output.replace(/ km/g, ' kilometers');\n      } else {\n        let distance = parseFloat(\n          this._pixelsToDistance(\n            this._scaleLength(scaleLine),\n            'imperial'\n          ).toFixed(1)\n        );\n        output = `${distance} inches to ${scaleLine.textContent.trim()}`;\n        output = output.replace(/ft/g, 'feet');\n        output = output.replace(/mi/g, 'miles');\n      }\n\n      this._container.setAttribute('aria-label', output);\n      this._map._container.querySelector(\n        '.mapml-screen-reader-output-scale'\n      ).textContent = output;\n    }\n  });\n  var scaleBar = function (options) {\n    return new ScaleBar(options);\n  };\n\n  var FullscreenButton = L.Control.extend({\n    options: {\n      position: 'topleft',\n      title: {\n        false: 'View Fullscreen',\n        true: 'Exit Fullscreen'\n      }\n    },\n\n    onAdd: function (map) {\n      var container = L.DomUtil.create(\n        'div',\n        'leaflet-control-fullscreen leaflet-bar leaflet-control'\n      );\n\n      this.link = L.DomUtil.create(\n        'a',\n        'leaflet-control-fullscreen-button leaflet-bar-part',\n        container\n      );\n      this.link.href = '#';\n      this.link.setAttribute('role', 'button');\n\n      this._map = map;\n      this._map.on('fullscreenchange', this._toggleTitle, this);\n      this._toggleTitle();\n\n      L.DomEvent.on(this.link, 'click', this._click, this);\n\n      return container;\n    },\n\n    onRemove: function (map) {\n      map.off('fullscreenchange', this._toggleTitle, this);\n    },\n\n    _click: function (e) {\n      L.DomEvent.stopPropagation(e);\n      L.DomEvent.preventDefault(e);\n      this._map.toggleFullscreen(this.options);\n    },\n\n    _toggleTitle: function () {\n      this.link.title = this.options.title[this._map.isFullscreen()];\n    }\n  });\n\n  L.Map.include({\n    isFullscreen: function () {\n      return this._isFullscreen || false;\n    },\n\n    toggleFullscreen: function (options) {\n      // the <map> element can't contain a shadow root, so we used a child <div>\n      // <mapml-viewer> can contain a shadow root, so return it directly\n      var mapEl = M.getClosest(this.getContainer(), 'mapml-viewer,[is=web-map]');\n      if (this.isFullscreen()) {\n        if (options && options.pseudoFullscreen) {\n          this._disablePseudoFullscreen(mapEl);\n        } else if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.webkitCancelFullScreen) {\n          document.webkitCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        } else {\n          this._disablePseudoFullscreen(mapEl);\n        }\n      } else {\n        if (options && options.pseudoFullscreen) {\n          this._enablePseudoFullscreen(mapEl);\n        } else if (mapEl.requestFullscreen) {\n          mapEl.requestFullscreen();\n        } else if (mapEl.mozRequestFullScreen) {\n          mapEl.mozRequestFullScreen();\n        } else if (mapEl.webkitRequestFullscreen) {\n          mapEl.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n        } else if (mapEl.msRequestFullscreen) {\n          mapEl.msRequestFullscreen();\n        } else {\n          this._enablePseudoFullscreen(mapEl);\n        }\n      }\n      this.getContainer().focus();\n    },\n\n    _enablePseudoFullscreen: function (container) {\n      L.DomUtil.addClass(container, 'leaflet-pseudo-fullscreen');\n      this._setFullscreen(true);\n      this.fire('fullscreenchange');\n    },\n\n    _disablePseudoFullscreen: function (container) {\n      L.DomUtil.removeClass(container, 'leaflet-pseudo-fullscreen');\n      this._setFullscreen(false);\n      this.fire('fullscreenchange');\n    },\n\n    _setFullscreen: function (fullscreen) {\n      this._isFullscreen = fullscreen;\n      var container = M.getClosest(\n        this.getContainer(),\n        'mapml-viewer,[is=web-map]'\n      );\n      if (fullscreen) {\n        L.DomUtil.addClass(container, 'mapml-fullscreen-on');\n      } else {\n        L.DomUtil.removeClass(container, 'mapml-fullscreen-on');\n      }\n      this.invalidateSize();\n    },\n\n    _onFullscreenChange: function (e) {\n      var fullscreenElement = M.getClosest(this.getContainer(), ':fullscreen'),\n        mapEl = M.getClosest(this.getContainer(), 'mapml-viewer,[is=web-map]');\n      if (fullscreenElement === mapEl && !this._isFullscreen) {\n        this._setFullscreen(true);\n        this.fire('fullscreenchange');\n      } else if (fullscreenElement !== mapEl && this._isFullscreen) {\n        this._setFullscreen(false);\n        this.fire('fullscreenchange');\n      }\n    }\n  });\n\n  L.Map.mergeOptions({\n    fullscreenControl: false\n  });\n\n  L.Map.addInitHook(function () {\n    if (this.options.fullscreenControl) {\n      this.fullscreenControl = new FullscreenButton(\n        this.options.fullscreenControl\n      );\n      this.addControl(this.fullscreenControl);\n    }\n\n    var fullscreenchange;\n\n    if ('onfullscreenchange' in document) {\n      fullscreenchange = 'fullscreenchange';\n    } else if ('onmozfullscreenchange' in document) {\n      fullscreenchange = 'mozfullscreenchange';\n    } else if ('onwebkitfullscreenchange' in document) {\n      fullscreenchange = 'webkitfullscreenchange';\n    } else if ('onmsfullscreenchange' in document) {\n      fullscreenchange = 'MSFullscreenChange';\n    }\n\n    if (fullscreenchange) {\n      var onFullscreenChange = L.bind(this._onFullscreenChange, this);\n\n      this.whenReady(function () {\n        L.DomEvent.on(document, fullscreenchange, onFullscreenChange);\n      });\n\n      this.on('unload', function () {\n        L.DomEvent.off(document, fullscreenchange, onFullscreenChange);\n      });\n    }\n  });\n\n  var fullscreenButton = function (options) {\n    return new FullscreenButton(options);\n  };\n\n  var GeolocationButton = L.Control.extend({\n    options: {\n      position: 'bottomright'\n    },\n\n    onAdd: function (map) {\n      // customize locate control to focus map after start/stop, so that\n      // featureIndexOverlay is correctly displayed\n      L.Control.CustomLocate = L.Control.Locate.extend({\n        start: function () {\n          L.Control.Locate.prototype.start.call(this);\n          map.getContainer().focus();\n        },\n        stop: function () {\n          L.Control.Locate.prototype.stop.call(this);\n          map.getContainer().focus();\n        }\n      });\n      this.locateControl = new L.Control.CustomLocate({\n        showPopup: false,\n        strings: {\n          title: M.options.locale.btnLocTrackOff\n        },\n        position: this.options.position,\n        locateOptions: {\n          maxZoom: 16\n        }\n      }).addTo(map);\n\n      var container = this.locateControl._container;\n      var button = this.locateControl;\n      var observer = new MutationObserver(function (mutations) {\n        if (\n          container.classList.contains('active') &&\n          container.classList.contains('following')\n        ) {\n          container.firstChild.title = M.options.locale.btnLocTrackOn;\n          button._marker.bindTooltip(M.options.locale.btnMyLocTrackOn, {\n            permanent: true\n          });\n        } else if (container.classList.contains('active')) {\n          container.firstChild.title = M.options.locale.btnLocTrackLastKnown;\n          button._marker.bindTooltip(M.options.locale.btnMyLastKnownLocTrackOn);\n        } else {\n          container.firstChild.title = M.options.locale.btnLocTrackOff;\n        }\n      });\n      var observerConfig = { attributes: true, attributeFilter: ['class'] };\n      observer.observe(container, observerConfig);\n\n      return container;\n    },\n\n    stop: function () {\n      return this.locateControl.stop();\n    }\n  });\n\n  var geolocationButton = function (options) {\n    return new GeolocationButton(options);\n  };\n\n  var Crosshair = L.Layer.extend({\n    onAdd: function (map) {\n      // SVG crosshair design from https://github.com/xguaita/Leaflet.MapCenterCoord/blob/master/src/icons/MapCenterCoordIcon1.svg?short_path=81a5c76\n      // Optimized with SVGOMG: https://jakearchibald.github.io/svgomg/\n      let svgInnerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" viewBox=\"0 0 100 100\"><g stroke=\"#fff\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"50.028\" cy=\"50.219\" r=\"3.923\" stroke-width=\"2\" color=\"currentColor\" overflow=\"visible\"/><path stroke-width=\"3\" d=\"M4.973 54.424h31.768a4.204 4.204 0 1 0 0-8.409H4.973A4.203 4.203 0 0 0 .77 50.22a4.203 4.203 0 0 0 4.204 4.205z\" color=\"currentColor\" overflow=\"visible\"/><path stroke-width=\"3\" d=\"M54.232 5.165a4.204 4.204 0 1 0-8.408 0v31.767a4.204 4.204 0 1 0 8.408 0V5.165z\"/><path stroke-width=\"3\" d=\"M99.288 50.22a4.204 4.204 0 0 0-4.204-4.205H63.317a4.204 4.204 0 1 0 0 8.409h31.767a4.205 4.205 0 0 0 4.204-4.205zM45.823 95.274a4.204 4.204 0 1 0 8.409 0V63.506a4.204 4.204 0 1 0-8.409 0v31.768z\" color=\"currentColor\" overflow=\"visible\"/></g></svg>`;\n\n      this._container = L.DomUtil.create(\n        'div',\n        'mapml-crosshair',\n        map._container\n      );\n      this._container.innerHTML = svgInnerHTML;\n      map.isFocused = false;\n      this._isQueryable = false;\n\n      map.on(\n        'layerchange layeradd layerremove overlayremove',\n        this._toggleEvents,\n        this\n      );\n      map.on('popupopen', this._isMapFocused, this);\n      L.DomEvent.on(\n        map._container,\n        'keydown keyup mousedown',\n        this._isMapFocused,\n        this\n      );\n\n      this._addOrRemoveCrosshair();\n    },\n\n    onRemove: function (map) {\n      map.off(\n        'layerchange layeradd layerremove overlayremove',\n        this._toggleEvents\n      );\n      map.off('popupopen', this._isMapFocused);\n      L.DomEvent.off(\n        map._container,\n        'keydown keyup mousedown',\n        this._isMapFocused\n      );\n    },\n\n    _toggleEvents: function () {\n      if (this._hasQueryableLayer()) {\n        this._map.on('viewreset move moveend', this._addOrRemoveCrosshair, this);\n      } else {\n        this._map.off('viewreset move moveend', this._addOrRemoveCrosshair, this);\n      }\n      this._addOrRemoveCrosshair();\n    },\n\n    _addOrRemoveCrosshair: function (e) {\n      if (this._hasQueryableLayer()) {\n        this._container.removeAttribute('hidden');\n      } else {\n        this._container.setAttribute('hidden', '');\n      }\n    },\n\n    _addOrRemoveMapOutline: function (e) {\n      let mapContainer = this._map._container;\n      if (this._map.isFocused && !this._outline) {\n        this._outline = L.DomUtil.create('div', 'mapml-outline', mapContainer);\n      } else if (!this._map.isFocused && this._outline) {\n        L.DomUtil.remove(this._outline);\n        delete this._outline;\n      }\n    },\n\n    _hasQueryableLayer: function () {\n      let layers = this._map.options.mapEl.layers;\n      if (this._map.isFocused) {\n        for (let layer of layers) {\n          if (layer.queryable()) {\n            return true;\n          }\n        }\n      }\n      return false;\n    },\n\n    // TODO: should be merged with the 'mapfocused' event emitted by mapml-viewer and map, not trivial\n    _isMapFocused: function (e) {\n      //set this._map.isFocused = true if arrow buttons are used\n      if (!this._map._container.parentNode.activeElement) {\n        this._map.isFocused = false;\n        return;\n      }\n      let isLeafletContainer =\n        this._map._container.parentNode.activeElement.classList.contains(\n          'leaflet-container'\n        );\n      if (\n        isLeafletContainer &&\n        ['keydown'].includes(e.type) &&\n        e.shiftKey &&\n        e.keyCode === 9\n      ) {\n        this._map.isFocused = false;\n      } else\n        this._map.isFocused =\n          isLeafletContainer && ['keyup', 'keydown'].includes(e.type);\n\n      if (this._map.isFocused) this._map.fire('mapkeyboardfocused');\n      this._addOrRemoveMapOutline();\n      this._addOrRemoveCrosshair();\n    }\n  });\n\n  var crosshair = function (options) {\n    return new Crosshair(options);\n  };\n\n  /**\n   * M.Path is a extension of L.Path that understands mapml feature markup\n   * It converts the markup to the following structure (abstract enough to encompass all feature types) for example:\n   *  this._outlinePath = HTMLElement;\n   *  this._parts = [\n   *    {\n   *      path: HTMLElement,\n   *      rings:[\n   *        {points:[{x:1,y:1}, ...]},\n   *        ...\n   *      ],\n   *      subrings:[\n   *        {points:[{x:2, y:2}, ...], cls:\"Span Class Name\", path: HTMLElement,},\n   *        ...\n   *      ],\n   *      cls:\"className\",\n   *    },\n   *    ...\n   *  ];\n   */\n  var Path = L.Path.extend({\n    /**\n     * Initializes the M.Path\n     * @param {HTMLElement} markup - The markup representation of the feature\n     * @param {Object} options - The options of the feature\n     */\n    initialize: function (markup, options) {\n      this.type = markup.tagName.toUpperCase();\n\n      if (this.type === 'MAP-POINT' || this.type === 'MAP-MULTIPOINT')\n        options.fillOpacity = 1;\n\n      if (options.wrappers.length > 0)\n        options = Object.assign(this._convertWrappers(options.wrappers), options);\n      L.setOptions(this, options);\n\n      this.group = this.options.group;\n      this.options.interactive =\n        this.options.link ||\n        (this.options.properties && this.options.onEachFeature);\n\n      this._parts = [];\n      this._markup = markup;\n      this.options.zoom = markup.zoom ?? this.options.nativeZoom;\n\n      this._convertMarkup();\n\n      if (markup.querySelector('map-span') || markup.querySelector('map-a')) {\n        this._generateOutlinePoints();\n      }\n\n      this.isClosed = this._isClosed();\n    },\n\n    /**\n     * Attaches link handler to the sub parts' paths\n     * @param {SVGElement} elem - The element to add listeners to, either path or g elements\n     * @param {Object} link - The link object that contains the url, type and target data\n     * @param leafletLayer\n     */\n    attachLinkHandler: function (elem, link, leafletLayer) {\n      let dragStart,\n        container = document.createElement('div'),\n        p = document.createElement('p'),\n        hovered = false;\n      container.classList.add('mapml-link-preview');\n      container.appendChild(p);\n      elem.classList.add('map-a');\n      if (link.visited) elem.classList.add('map-a-visited');\n      elem.mousedown = (e) => (dragStart = { x: e.clientX, y: e.clientY });\n      L.DomEvent.on(elem, 'mousedown', elem.mousedown, this);\n      elem.mouseup = (e) => {\n        if (e.button !== 0) return; // don't trigger when button isn't left click\n        let onTop = true,\n          nextLayer = this.options._leafletLayer._layerEl.nextElementSibling;\n        while (nextLayer && onTop) {\n          if (nextLayer.tagName && nextLayer.tagName.toUpperCase() === 'LAYER-')\n            onTop = !nextLayer.queryable();\n          nextLayer = nextLayer.nextElementSibling;\n        }\n        if (onTop && dragStart) {\n          //M._handleLink gets called twice, once in the target phase on the path\n          //element, then in the bubble phase on the g element\n          //Using stopPropagation leaves the mouse in the mousedown state\n          if (e.eventPhase === Event.BUBBLING_PHASE) return;\n          let dist = Math.sqrt(\n            Math.pow(dragStart.x - e.clientX, 2) +\n              Math.pow(dragStart.y - e.clientY, 2)\n          );\n          if (dist <= 5) {\n            link.visited = true;\n            elem.setAttribute('stroke', '#6c00a2');\n            elem.classList.add('map-a-visited');\n            M._handleLink(link, leafletLayer);\n          }\n        }\n      };\n      L.DomEvent.on(elem, 'mouseup', elem.mouseup, this);\n      L.DomEvent.on(\n        elem,\n        'keypress',\n        (e) => {\n          L.DomEvent.stop(e);\n          if (e.keyCode === 13 || e.keyCode === 32) {\n            link.visited = true;\n            elem.setAttribute('stroke', '#6c00a2');\n            elem.classList.add('map-a-visited');\n            M._handleLink(link, leafletLayer);\n          }\n        },\n        this\n      );\n      L.DomEvent.on(\n        elem,\n        'mouseenter keyup',\n        (e) => {\n          if (e.target !== e.currentTarget) return;\n          hovered = true;\n          let resolver = document.createElement('a'),\n            mapWidth = this._map.getContainer().clientWidth;\n          resolver.href = link.url;\n          p.innerHTML = resolver.href;\n\n          this._map.getContainer().appendChild(container);\n\n          while (p.clientWidth > mapWidth / 2) {\n            p.innerHTML =\n              p.innerHTML.substring(0, p.innerHTML.length - 5) + '...';\n          }\n          setTimeout(() => {\n            if (hovered) p.innerHTML = resolver.href;\n          }, 1000);\n        },\n        this\n      );\n      L.DomEvent.on(\n        elem,\n        'mouseout keydown mousedown',\n        (e) => {\n          if (e.target !== e.currentTarget || !container.parentElement) return;\n          hovered = false;\n          this._map.getContainer().removeChild(container);\n        },\n        this\n      );\n      leafletLayer.on('add', addMouseHandler, leafletLayer);\n      function handleMouse(e) {\n        //adds a lot of event handlers\n        if (!container.parentElement) return;\n        hovered = false;\n        this._map.getContainer().removeChild(container);\n      }\n      function addMouseHandler() {\n        L.DomEvent.on(\n          this._map.getContainer(),\n          'mouseout mouseenter click',\n          handleMouse,\n          this\n        );\n      }\n      leafletLayer.on('remove', removeMouseHandler, leafletLayer);\n      function removeMouseHandler() {\n        L.DomEvent.off(this._map.getContainer(), {\n          mouseout: handleMouse,\n          mouseenter: handleMouse,\n          click: handleMouse\n        });\n      }\n    },\n\n    /**\n     * Updates internal structure of the feature to the new map state, the structure can be found in this._parts\n     * @param {L.Map} addedMap - The map that the feature is part of, can be left blank in the case of static features\n     * @param {L.Point} tileOrigin - The tile origin for the feature, if blank then it takes the maps pixel origin in the function\n     * @param {int} zoomingTo - The zoom the map is animating to, if left blank then it takes the map zoom, its provided because in templated tiles zoom is delayed\n     * @private\n     */\n    _project: function (addedMap, tileOrigin = undefined, zoomingTo = undefined) {\n      let map = addedMap || this._map,\n        origin = tileOrigin || map.getPixelOrigin(),\n        zoom = zoomingTo === undefined ? map.getZoom() : zoomingTo;\n      for (let p of this._parts) {\n        p.pixelRings = this._convertRing(p.rings, map, origin, zoom);\n        for (let subP of p.subrings) {\n          subP.pixelSubrings = this._convertRing([subP], map, origin, zoom);\n        }\n      }\n      if (!this._outline) return;\n      this.pixelOutline = [];\n      for (let o of this._outline) {\n        this.pixelOutline = this.pixelOutline.concat(\n          this._convertRing(o, map, origin, zoom)\n        );\n      }\n    },\n\n    /**\n     * Converts the PCRS points to pixel points that can be used to create the SVG\n     * @param {L.Point[][]} r - Is the rings of a feature, either the mainParts, subParts or outline\n     * @param {L.Map} map - The map that the feature is part of\n     * @param {L.Point} origin - The origin used to calculate the pixel points\n     * @param {int} zoom - The current zoom level of the map\n     * @returns {L.Point[][]}\n     * @private\n     */\n    _convertRing: function (r, map, origin, zoom) {\n      // TODO: Implement Ramer-Douglas-Peucer Algo for simplifying points\n      let scale = map.options.crs.scale(zoom),\n        parts = [];\n      for (let sub of r) {\n        let interm = [];\n        for (let p of sub.points) {\n          let conv = map.options.crs.transformation.transform(p, scale);\n          interm.push(L.point(conv.x, conv.y)._subtract(origin).round());\n        }\n        parts.push(interm);\n      }\n      return parts;\n    },\n\n    /**\n     * Updates the features\n     * @private\n     */\n    _update: function () {\n      if (!this._map) return;\n      this._renderer._updateFeature(this);\n    },\n\n    /**\n     * Converts the map-spans, a and divs around a geometry subtype into options for the feature\n     * @param {HTMLElement[]} elems - The current zoom level of the map\n     * @private\n     */\n    _convertWrappers: function (elems) {\n      if (!elems || elems.length === 0) return;\n      let classList = '',\n        output = {};\n      for (let elem of elems) {\n        if (elem.tagName.toUpperCase() !== 'MAP-A' && elem.className) {\n          classList += `${elem.className} `;\n        } else if (!output.link && elem.getAttribute('href')) {\n          let link = {};\n          link.url = elem.getAttribute('href');\n          if (elem.hasAttribute('target'))\n            link.target = elem.getAttribute('target');\n          if (elem.hasAttribute('type')) link.type = elem.getAttribute('type');\n          if (elem.hasAttribute('inplace')) link.inPlace = true;\n          output.link = link;\n        }\n      }\n      output.className = `${classList} ${this.options.className}`.trim();\n      return output;\n    },\n\n    /**\n     * Converts this._markup to the internal structure of features\n     * @private\n     */\n    _convertMarkup: function () {\n      if (!this._markup) return;\n\n      let attr = this._markup.attributes;\n      this.featureAttributes = {};\n      if (\n        this.options.link &&\n        this._markup.parentElement.tagName.toUpperCase() === 'MAP-A' &&\n        this._markup.parentElement.parentElement.tagName.toUpperCase() !==\n          'MAP-GEOMETRY'\n      )\n        this.featureAttributes.tabindex = '0';\n      for (let i = 0; i < attr.length; i++) {\n        this.featureAttributes[attr[i].name] = attr[i].value;\n      }\n\n      let first = true;\n      for (let c of this._markup.querySelectorAll('map-coordinates')) {\n        //loops through the coordinates of the child\n        let ring = [],\n          subRings = [];\n        this._coordinateToArrays(c, ring, subRings, this.options.className); //creates an array of pcrs points for the main ring and the subparts\n        if (!first && this.type === 'MAP-POLYGON') {\n          this._parts[0].rings.push(ring[0]);\n          if (subRings.length > 0)\n            this._parts[0].subrings = this._parts[0].subrings.concat(subRings);\n        } else if (this.type === 'MAP-MULTIPOINT') {\n          for (let point of ring[0].points.concat(subRings)) {\n            this._parts.push({\n              rings: [{ points: [point] }],\n              subrings: [],\n              cls: `${point.cls || ''} ${this.options.className || ''}`.trim()\n            });\n          }\n        } else {\n          this._parts.push({\n            rings: ring,\n            subrings: subRings,\n            cls: `${this.featureAttributes.class || ''} ${\n            this.options.className || ''\n          }`.trim()\n          });\n        }\n        first = false;\n      }\n    },\n\n    /**\n     * Generates the feature outline, subtracting the map-spans to generate those separately\n     * @private\n     */\n    _generateOutlinePoints: function () {\n      if (\n        this.type === 'MAP-MULTIPOINT' ||\n        this.type === 'MAP-POINT' ||\n        this.type === 'MAP-LINESTRING' ||\n        this.type === 'MAP-MULTILINESTRING'\n      )\n        return;\n\n      this._outline = [];\n      for (let coords of this._markup.querySelectorAll('map-coordinates')) {\n        let nodes = coords.childNodes,\n          cur = 0,\n          tempDiv = document.createElement('div');\n          nodes.length;\n        for (let i = 0; i < nodes.length; i++) {\n          if (nodes[i].textContent.trim().length === 0) {\n            nodes[i].remove();\n          }\n        }\n        for (let n of nodes) {\n          let line = [];\n          if (!n.tagName) {\n            //no tagName means it's text content\n            let c = '',\n              ind = (((cur - 1) % nodes.length) + nodes.length) % nodes.length; // this equation turns Javascript's % to how it behaves in C for example\n            if (nodes[ind].tagName) {\n              let prev = nodes[ind].textContent.trim().split(/\\s+/);\n              c += `${prev[prev.length - 2]} ${prev[prev.length - 1]} `;\n            }\n            c += n.textContent;\n            ind = (((cur + 1) % nodes.length) + nodes.length) % nodes.length; // this is equivalent to C/C++'s (cur + 1) % nodes.length\n            if (nodes[ind].tagName) {\n              let next = nodes[ind].textContent.trim().split(/\\s+/);\n              c += ` ${next[0]} ${next[1]} `;\n            }\n            tempDiv.innerHTML = c;\n            this._coordinateToArrays(\n              tempDiv,\n              line,\n              [],\n              true,\n              this.featureAttributes.class || this.options.className\n            );\n            this._outline.push(line);\n          }\n          cur++;\n        }\n      }\n    },\n\n    /**\n     * Converts map-coordinates element to an object representing the parts and subParts\n     * @param {HTMLElement} coords - A single map-coordinates element\n     * @param {Object[]} main - An empty array representing the main parts\n     * @param {Object[]} subParts - An empty array representing the sub parts\n     * @param {boolean} isFirst - A true | false representing if the current HTML element is the parent map-coordinates element or not\n     * @param {string} cls - The class of the coordinate/span\n     * @param parents\n     * @private\n     */\n    _coordinateToArrays: function (\n      coords,\n      main,\n      subParts,\n      isFirst = true,\n      cls = undefined,\n      parents = []\n    ) {\n      for (let span of coords.children) {\n        this._coordinateToArrays(\n          span,\n          main,\n          subParts,\n          false,\n          span.getAttribute('class'),\n          parents.concat([span])\n        );\n      }\n      let noSpan = coords.textContent.replace(/(<([^>]+)>)/gi, ''),\n        pairs = noSpan.trim().match(/(\\S+\\s+\\S+)/gim),\n        local = [],\n        bounds;\n      for (let p of pairs) {\n        let numPair = [];\n        p.split(/\\s+/gim).forEach(M._parseNumber, numPair);\n        let point = M.pointToPCRSPoint(\n          L.point(numPair),\n          this.options.zoom,\n          this.options.projection,\n          this.options.nativeCS\n        );\n        local.push(point);\n        bounds = bounds ? bounds.extend(point) : L.bounds(point, point);\n      }\n      if (this._bounds) {\n        this._bounds.extend(bounds.min);\n        this._bounds.extend(bounds.max);\n      } else {\n        this._bounds = bounds;\n      }\n      if (isFirst) {\n        main.push({ points: local });\n      } else {\n        let attrMap = {},\n          attr = coords.attributes,\n          wrapperAttr = this._convertWrappers(parents);\n        if (wrapperAttr.link) attrMap.tabindex = '0';\n        for (let i = 0; i < attr.length; i++) {\n          if (attr[i].name === 'class') continue;\n          attrMap[attr[i].name] = attr[i].value;\n        }\n        subParts.unshift({\n          points: local,\n          center: bounds.getCenter(),\n          cls: `${cls || ''} ${wrapperAttr.className || ''}`.trim(),\n          attr: attrMap,\n          link: wrapperAttr.link,\n          linkTarget: wrapperAttr.linkTarget,\n          linkType: wrapperAttr.linkType\n        });\n      }\n    },\n\n    /**\n     * Returns if the feature is closed or open, useful when styling\n     * @returns {boolean}\n     * @private\n     */\n    _isClosed: function () {\n      switch (this.type) {\n        case 'MAP-POLYGON':\n        case 'MAP-MULTIPOLYGON':\n        case 'MAP-POINT':\n        case 'MAP-MULTIPOINT':\n          return true;\n        case 'MAP-LINESTRING':\n        case 'MAP-MULTILINESTRING':\n          return false;\n        default:\n          return false;\n      }\n    },\n\n    /**\n     * Returns the center of the entire feature\n     * @returns {L.Point}\n     */\n    getCenter: function () {\n      if (!this._bounds) return null;\n      return this._map.options.crs.unproject(this._bounds.getCenter());\n    },\n\n    getPCRSCenter: function () {\n      return this._bounds.getCenter();\n    }\n  });\n\n  /**\n   *\n   * @param {HTMLElement} markup - The markup of the feature\n   * @param {Object} options - Options of the feature\n   * @returns {M.Path}\n   */\n  var path = function (markup, options) {\n    return new Path(markup, options);\n  };\n\n  /**\n   * Returns a new Feature Renderer\n   * @param {Object} options - Options for the renderer\n   * @returns {*}\n   */\n  var FeatureRenderer = L.SVG.extend({\n    /**\n     * Override method of same name from L.SVG, use the this._container property\n     * to set up the role=\"none presentation\" on featureGroupu container,\n     * per this recommendation:\n     * https://github.com/Maps4HTML/Web-Map-Custom-Element/pull/471#issuecomment-845192246\n     * @private overrides ancestor method so that we have a _container to work with\n     */\n    _initContainer: function () {\n      // call the method we're overriding, per https://leafletjs.com/examples/extending/extending-1-classes.html#methods-of-the-parent-class\n      // note you have to pass 'this' as the first arg\n      L.SVG.prototype._initContainer.call(this);\n      // knowing that the previous method call creates the this._container, we\n      // access it and set the role=\"none presetation\" which suppresses the\n      // announcement of \"Graphic\" on each feature focus.\n      this._container.setAttribute('role', 'none presentation');\n    },\n\n    /**\n     * Creates all the appropriate path elements for a M.Path\n     * @param {M.Path} layer - The M.Path that needs paths generated\n     * @param {boolean} stampLayer - Whether or not a layer should be stamped and stored in the renderer layers\n     * @private\n     */\n    _initPath: function (layer, stampLayer = true) {\n      if (layer._outline) {\n        let outlinePath = L.SVG.create('path');\n        if (layer.options.className)\n          L.DomUtil.addClass(\n            outlinePath,\n            layer.featureAttributes.class || layer.options.className\n          );\n        L.DomUtil.addClass(outlinePath, 'mapml-feature-outline');\n        outlinePath.style.fill = 'none';\n        layer.outlinePath = outlinePath;\n      }\n\n      //creates the main parts and sub parts paths\n      for (let p of layer._parts) {\n        if (p.rings) {\n          this._createPath(\n            p,\n            layer.options.className,\n            layer.featureAttributes['aria-label'],\n            layer.options.interactive,\n            layer.featureAttributes\n          );\n          if (layer.outlinePath) p.path.style.stroke = 'none';\n        }\n        if (p.subrings) {\n          for (let r of p.subrings) {\n            this._createPath(\n              r,\n              layer.options.className,\n              r.attr['aria-label'],\n              r.link !== undefined,\n              r.attr\n            );\n          }\n        }\n        this._updateStyle(layer);\n      }\n      if (stampLayer) {\n        let stamp = L.stamp(layer);\n        this._layers[stamp] = layer;\n      }\n    },\n\n    /**\n     * Creates paths for either mainParts, subParts or outline of a feature\n     * @param {Object} ring - The ring the current path is being generated for\n     * @param {string} title - The accessible aria-label of a path\n     * @param {string} cls - The class of the path\n     * @param {boolean} interactive - The boolean representing whether a feature is interactive or not\n     * @param {Object} attr - Attributes map\n     * @private\n     */\n    _createPath: function (\n      ring,\n      cls,\n      title,\n      interactive = false,\n      attr = undefined\n    ) {\n      let p = L.SVG.create('path');\n      ring.path = p;\n      if (!attr) {\n        if (title) p.setAttribute('aria-label', title);\n      } else {\n        for (let [name, value] of Object.entries(attr)) {\n          if (name === 'id' || name === 'tabindex') continue;\n          p.setAttribute(name, value);\n        }\n      }\n      if (ring.cls || cls) {\n        L.DomUtil.addClass(p, ring.cls || cls);\n      }\n      if (interactive) {\n        L.DomUtil.addClass(p, 'leaflet-interactive');\n      }\n    },\n\n    /**\n     * Adds all the paths needed for a feature\n     * @param {M.Path} layer - The feature that needs it's paths added\n     * @param {HTMLElement} container - The location the paths need to be added to\n     * @param {boolean} interactive - Whether a feature is interactive or not\n     * @private\n     */\n    _addPath: function (layer, container = undefined, interactive = true) {\n      if (!this._rootGroup && !container) {\n        this._initContainer();\n      }\n      let c = container || this._rootGroup,\n        outlineAdded = false;\n      if (interactive) {\n        layer.addInteractiveTarget(layer.group);\n      }\n      for (let p of layer._parts) {\n        if (p.path) layer.group.appendChild(p.path);\n        if (interactive) {\n          if (layer.options.link)\n            layer.attachLinkHandler(\n              p.path,\n              layer.options.link,\n              layer.options._leafletLayer\n            );\n          layer.addInteractiveTarget(p.path);\n        }\n\n        if (!outlineAdded && layer.pixelOutline) {\n          layer.group.appendChild(layer.outlinePath);\n          outlineAdded = true;\n        }\n\n        for (let subP of p.subrings) {\n          if (subP.path) {\n            if (subP.link) {\n              layer.attachLinkHandler(\n                subP.path,\n                subP.link,\n                layer.options._leafletLayer\n              );\n              layer.addInteractiveTarget(subP.path);\n            }\n            layer.group.appendChild(subP.path);\n          }\n        }\n      }\n      c.appendChild(layer.group);\n    },\n\n    /**\n     * Removes all the paths related to a feature\n     * @param {M.Path} layer - The feature who's paths need to be removed\n     * @private\n     */\n    _removePath: function (layer) {\n      for (let p of layer._parts) {\n        if (p.path) {\n          layer.removeInteractiveTarget(p.path);\n          L.DomUtil.remove(p.path);\n        }\n        for (let subP of p.subrings) {\n          if (subP.path) L.DomUtil.remove(subP.path);\n        }\n      }\n      if (layer.outlinePath) L.DomUtil.remove(layer.outlinePath);\n      layer.removeInteractiveTarget(layer.group);\n      L.DomUtil.remove(layer.group);\n      delete this._layers[L.stamp(layer)];\n    },\n\n    /**\n     * Updates the d attribute of all paths of a feature\n     * @param {M.Path} layer - The Feature that needs updating\n     * @private\n     */\n    _updateFeature: function (layer) {\n      if (layer.pixelOutline)\n        this._setPath(\n          layer.outlinePath,\n          this.geometryToPath(layer.pixelOutline, false)\n        );\n      for (let p of layer._parts) {\n        this._setPath(p.path, this.geometryToPath(p.pixelRings, layer.isClosed));\n        for (let subP of p.subrings) {\n          this._setPath(\n            subP.path,\n            this.geometryToPath(subP.pixelSubrings, false)\n          );\n        }\n      }\n    },\n\n    /**\n     * Generates the marker d attribute for a given point\n     * @param {L.Point} p - The point of the marker\n     * @returns {string}\n     * @private\n     */\n    _pointToMarker: function (p) {\n      return `M${p.x} ${p.y} L${p.x - 12.5} ${p.y - 30} C${p.x - 12.5} ${\n      p.y - 50\n    }, ${p.x + 12.5} ${p.y - 50}, ${p.x + 12.5} ${p.y - 30} L${p.x} ${p.y}z`;\n    },\n\n    /**\n     * Updates the styles of all paths of a feature\n     * @param {M.Path} layer - The feature that needs styles updated\n     * @private\n     */\n    _updateStyle: function (layer) {\n      this._updatePathStyle(layer.outlinePath, layer, false, true);\n      for (let p of layer._parts) {\n        if (p.path) {\n          this._updatePathStyle(p.path, layer, true);\n        }\n        for (let subP of p.subrings) {\n          if (subP.path) this._updatePathStyle(subP.path, layer);\n        }\n      }\n    },\n\n    /**\n     * Updates the style of a single path\n     * @param {HTMLElement} path - The path that needs updating\n     * @param {M.Path} layer - The feature layer\n     * @param {boolean} isMain - Whether it's the main parts or not\n     * @param {boolean} isOutline - Whether a path is an outline or not\n     * @private\n     */\n    _updatePathStyle: function (path, layer, isMain = false, isOutline = false) {\n      if (!path || !layer) {\n        return;\n      }\n      let options = layer.options,\n        isClosed = layer.isClosed;\n      if (\n        (options.stroke && (!isClosed || isOutline)) ||\n        (isMain && !layer.outlinePath)\n      ) {\n        path.setAttribute('stroke', options.color);\n        path.setAttribute('stroke-opacity', options.opacity);\n        path.setAttribute('stroke-width', options.weight);\n        path.setAttribute('stroke-linecap', options.lineCap);\n        path.setAttribute('stroke-linejoin', options.lineJoin);\n\n        if (options.dashArray) {\n          path.setAttribute('stroke-dasharray', options.dashArray);\n        } else {\n          path.removeAttribute('stroke-dasharray');\n        }\n\n        if (options.dashOffset) {\n          path.setAttribute('stroke-dashoffset', options.dashOffset);\n        } else {\n          path.removeAttribute('stroke-dashoffset');\n        }\n\n        if (options.link) {\n          path.setAttribute(\n            'stroke',\n            options.link.visited ? '#6c00a2' : '#0000EE'\n          );\n          path.setAttribute('stroke-opacity', '1');\n          path.setAttribute('stroke-width', '1px');\n          path.setAttribute('stroke-dasharray', 'none');\n        }\n      } else {\n        path.setAttribute('stroke', 'none');\n      }\n\n      if (isClosed && !isOutline) {\n        if (!options.fill) {\n          path.setAttribute('fill', options.fillColor || options.color);\n          path.setAttribute('fill-opacity', options.fillOpacity);\n          path.setAttribute('fill-rule', options.fillRule || 'evenodd');\n        } else {\n          path.setAttribute('fill', options.color);\n        }\n      } else {\n        path.setAttribute('fill', 'none');\n      }\n    },\n\n    /**\n     * Sets the d attribute of a path\n     * @param {HTMLElement} path - The path that is being updated\n     * @param {string} def - The new d attribute of the path\n     * @private\n     */\n    _setPath: function (path, def) {\n      path.setAttribute('d', def);\n    },\n\n    /**\n     * Generates the d string of a feature part\n     * @param {L.Point[]} rings - The points making up a given part of a feature\n     * @param {boolean} closed - Whether a feature is closed or not\n     * @returns {string}\n     */\n    geometryToPath: function (rings, closed) {\n      let str = '',\n        i,\n        j,\n        len,\n        len2,\n        points,\n        p;\n\n      for (i = 0, len = rings.length; i < len; i++) {\n        points = rings[i];\n        if (points.length === 1) {\n          return this._pointToMarker(points[0]);\n        }\n        for (j = 0, len2 = points.length; j < len2; j++) {\n          p = points[j];\n          str += (j ? 'L' : 'M') + p.x + ' ' + p.y;\n        }\n        str += closed ? 'z' : '';\n      }\n      return str || 'M0 0';\n    }\n  });\n\n  /**\n   * Returns new M.FeatureRenderer\n   * @param {Object} options - Options for the renderer\n   * @returns {M.FeatureRenderer}\n   */\n  var featureRenderer = function (options) {\n    return new FeatureRenderer(options);\n  };\n\n  var Geometry = L.FeatureGroup.extend({\n    /**\n     * Initialize the feature group\n     * @param {M.Path[]} layers\n     * @param {Object} options\n     */\n    initialize: function (layers, options) {\n      if (options.wrappers && options.wrappers.length > 0)\n        options = Object.assign(\n          M.Path.prototype._convertWrappers(options.wrappers),\n          options\n        );\n\n      L.LayerGroup.prototype.initialize.call(this, layers, options);\n      this._featureEl = this.options.mapmlFeature;\n\n      this.layerBounds = options.layerBounds;\n      this.zoomBounds = options.zoomBounds;\n\n      let firstLayer = layers[Object.keys(layers)[0]];\n      if (layers.length === 1 && firstLayer.options.link)\n        this.options.link = firstLayer.options.link;\n      if (\n        (this.options.onEachFeature && this.options.properties) ||\n        this.options.link\n      ) {\n        L.DomUtil.addClass(this.options.group, 'leaflet-interactive');\n        if (this.options.link) {\n          M.Path.prototype.attachLinkHandler.call(\n            this,\n            this.options.group,\n            this.options.link,\n            this.options._leafletLayer\n          );\n          this.options.group.setAttribute('role', 'link');\n        } else {\n          this.options.group.setAttribute('aria-expanded', 'false');\n          this.options.group.setAttribute('role', 'button');\n          this.options.onEachFeature(this.options.properties, this);\n          this.off('click', this._openPopup);\n        }\n      }\n\n      L.DomEvent.on(this.options.group, 'keyup keydown', this._handleFocus, this);\n      this.options.group.setAttribute('aria-label', this.options.accessibleTitle);\n      if (this.options.featureID)\n        this.options.group.setAttribute('data-fid', this.options.featureID);\n      for (let feature of layers) {\n        feature._groupLayer = this;\n      }\n    },\n\n    onAdd: function (map) {\n      L.LayerGroup.prototype.onAdd.call(this, map);\n      this.updateInteraction();\n    },\n\n    updateInteraction: function () {\n      let map = this._map || this.options._leafletLayer._map;\n      if (this.options.onEachFeature || this.options.link)\n        map.featureIndex.addToIndex(\n          this,\n          this.getPCRSCenter(),\n          this.options.group\n        );\n\n      for (let layerID in this._layers) {\n        let layer = this._layers[layerID];\n        for (let part of layer._parts) {\n          if (layer.featureAttributes && layer.featureAttributes.tabindex)\n            map.featureIndex.addToIndex(layer, layer.getPCRSCenter(), part.path);\n          for (let subPart of part.subrings) {\n            if (subPart.attr && subPart.attr.tabindex)\n              map.featureIndex.addToIndex(layer, subPart.center, subPart.path);\n          }\n        }\n      }\n    },\n\n    /**\n     * Check whether the feature group should be rendered at current map zoom level\n     * @param {Number} zoom - current map zoom\n     * @param {Object} vectorMinZoom - the minimum zoom bound of vector layer\n     * @param {Object} vectorMaxZoom - the maximum zoom bound of vector layer\n     * @returns {Boolean}\n     * @private\n     */\n    _checkRender: function (zoom, vectorMinZoom, vectorMaxZoom) {\n      let minZoom = this._featureEl.min,\n        maxZoom = this._featureEl.max;\n      // if the current map zoom falls below/above the zoom bounds of the vector layer\n      if (zoom > vectorMaxZoom || zoom < vectorMinZoom) return false;\n      // if the current map zoom falls below/above the [min, max] range\n      if (\n        (minZoom !== null && zoom < +minZoom) ||\n        (maxZoom !== null && zoom > +maxZoom)\n      ) {\n        return false;\n      }\n      return true;\n    },\n\n    /**\n     * Handler for focus events\n     * @param {L.DOMEvent} e - Event that occurred\n     * @private\n     */\n    _handleFocus: function (e) {\n      // tab, shift, cr, esc, up, left, down, right,\n      if (\n        [9, 16, 27, 37, 38, 39, 40].includes(e.keyCode) &&\n        e.type === 'keydown'\n      ) {\n        let index = this._map.featureIndex.currentIndex;\n        // Down/right arrow keys replicate tabbing through the feature index\n        // Up/left arrow keys replicate shift-tabbing through the feature index\n        if (e.keyCode === 37 || e.keyCode === 38) {\n          L.DomEvent.stop(e);\n          this._map.featureIndex.inBoundFeatures[index].path.setAttribute(\n            'tabindex',\n            -1\n          );\n          if (index === 0) {\n            this._map.featureIndex.inBoundFeatures[\n              this._map.featureIndex.inBoundFeatures.length - 1\n            ].path.focus();\n            this._map.featureIndex.currentIndex =\n              this._map.featureIndex.inBoundFeatures.length - 1;\n          } else {\n            this._map.featureIndex.inBoundFeatures[index - 1].path.focus();\n            this._map.featureIndex.currentIndex--;\n          }\n        } else if (e.keyCode === 39 || e.keyCode === 40) {\n          L.DomEvent.stop(e);\n          this._map.featureIndex.inBoundFeatures[index].path.setAttribute(\n            'tabindex',\n            -1\n          );\n          if (index === this._map.featureIndex.inBoundFeatures.length - 1) {\n            this._map.featureIndex.inBoundFeatures[0].path.focus();\n            this._map.featureIndex.currentIndex = 0;\n          } else {\n            this._map.featureIndex.inBoundFeatures[index + 1].path.focus();\n            this._map.featureIndex.currentIndex++;\n          }\n        } else if (e.keyCode === 27) {\n          let shadowRoot = this._map.options.mapEl.shadowRoot\n            ? this._map.options.mapEl.shadowRoot\n            : this._map.options.mapEl.querySelector('.mapml-web-map').shadowRoot;\n          if (shadowRoot.activeElement.nodeName !== 'g') return;\n          this._map._container.focus();\n        } else if (e.keyCode === 9) {\n          let obj = this;\n          setTimeout(function () {\n            obj._map.featureIndex.inBoundFeatures[0].path.setAttribute(\n              'tabindex',\n              0\n            );\n          }, 0);\n        }\n        // tab, shift, cr, esc, right, left, up, down,\n        // 1, 2, 3, 4, 5, 6, 7 (featureIndexOverlay available index items\n        // [8, 9] being allocated to next, previous menu items).\n      } else if (\n        ![9, 16, 13, 27, 37, 38, 39, 40, 49, 50, 51, 52, 53, 54, 55].includes(\n          e.keyCode\n        )\n      ) {\n        this._map.featureIndex.currentIndex = 0;\n        this._map.featureIndex.inBoundFeatures[0].path.focus();\n      }\n\n      // 27 added so that the tooltip opens when dismissing popup with 'esc' key\n      if (e.target.tagName.toUpperCase() !== 'G') return;\n      if (\n        [9, 13, 16, 37, 38, 39, 40, 49, 50, 51, 52, 53, 54, 55, 27].includes(\n          e.keyCode\n        ) &&\n        e.type === 'keyup'\n      ) {\n        this.openTooltip();\n      } else if (e.keyCode === 13 || e.keyCode === 32) {\n        this.closeTooltip();\n        if (!this.options.link && this.options.onEachFeature) {\n          L.DomEvent.stop(e);\n          this.openPopup();\n        }\n      } else {\n        this.closeTooltip();\n      }\n    },\n\n    /**\n     * Add a M.Path to the M.Geometry\n     * @param layer\n     */\n    addLayer: function (layer) {\n      if (!layer.options.link && layer.options.interactive) {\n        this.options.onEachFeature(this.options.properties, layer);\n      }\n      L.FeatureGroup.prototype.addLayer.call(this, layer);\n    },\n\n    /**\n     * Focuses the previous function in the sequence on previous button press\n     * @param e\n     * @private\n     */\n    _previousFeature: function (e) {\n      L.DomEvent.stop(e);\n      this._map.featureIndex.currentIndex = Math.max(\n        this._map.featureIndex.currentIndex - 1,\n        0\n      );\n      let prevFocus =\n        this._map.featureIndex.inBoundFeatures[\n          this._map.featureIndex.currentIndex\n        ];\n      prevFocus.path.focus();\n      this._map.closePopup();\n    },\n\n    /**\n     * Focuses next feature in sequence\n     * @param e\n     * @private\n     */\n    _nextFeature: function (e) {\n      L.DomEvent.stop(e);\n      this._map.featureIndex.currentIndex = Math.min(\n        this._map.featureIndex.currentIndex + 1,\n        this._map.featureIndex.inBoundFeatures.length - 1\n      );\n      let nextFocus =\n        this._map.featureIndex.inBoundFeatures[\n          this._map.featureIndex.currentIndex\n        ];\n      nextFocus.path.focus();\n      this._map.closePopup();\n    },\n\n    getPCRSCenter: function () {\n      let bounds;\n      for (let l in this._layers) {\n        let layer = this._layers[l];\n        if (!bounds) {\n          bounds = L.bounds(layer.getPCRSCenter(), layer.getPCRSCenter());\n        } else {\n          bounds.extend(layer.getPCRSCenter());\n        }\n      }\n      return bounds.getCenter();\n    }\n  });\n\n  /**\n   * Returns new M.Geometry\n   * @param {M.Path[]} layers - Layers belonging to feature group\n   * @param {Object} options - Options for the feature group\n   * @returns {M.Geometry}\n   */\n  var geometry = function (layers, options) {\n    return new Geometry(layers, options);\n  };\n\n  var AnnounceMovement = L.Handler.extend({\n    addHooks: function () {\n      this._map.on({\n        layeradd: this.totalBounds,\n        layerremove: this.totalBounds\n      });\n\n      this._map.options.mapEl.addEventListener(\n        'map-moveend',\n        this.announceBounds\n      );\n      this._map.dragging._draggable.addEventListener('dragstart', this.dragged);\n      this._map.options.mapEl.addEventListener(\n        'mapfocused',\n        this.focusAnnouncement\n      );\n    },\n    removeHooks: function () {\n      this._map.off({\n        layeradd: this.totalBounds,\n        layerremove: this.totalBounds\n      });\n\n      this._map.options.mapEl.removeEventListener(\n        'map-moveend',\n        this.announceBounds\n      );\n      this._map.dragging._draggable.removeEventListener(\n        'dragstart',\n        this.dragged\n      );\n      this._map.options.mapEl.removeEventListener(\n        'mapfocused',\n        this.focusAnnouncement\n      );\n    },\n\n    focusAnnouncement: function () {\n      let mapEl = this;\n      setTimeout(function () {\n        let el = mapEl.querySelector('.mapml-web-map')\n          ? mapEl\n              .querySelector('.mapml-web-map')\n              .shadowRoot.querySelector('.leaflet-container')\n          : mapEl.shadowRoot.querySelector('.leaflet-container');\n\n        let mapZoom = mapEl._map.getZoom();\n        let standard = M.options.locale.amZoom + ' ' + mapZoom;\n\n        if (mapZoom === mapEl._map.getMaxZoom()) {\n          standard = M.options.locale.amMaxZoom + ' ' + standard;\n        } else if (mapZoom === mapEl._map._layersMinZoom) {\n          standard = M.options.locale.amMinZoom + ' ' + standard;\n        }\n\n        el.setAttribute('aria-roledescription', 'region ' + standard);\n        setTimeout(function () {\n          el.removeAttribute('aria-roledescription');\n        }, 2000);\n      }, 0);\n    },\n\n    announceBounds: function () {\n      if (this._traversalCall > 0) {\n        return;\n      }\n      let mapZoom = this._map.getZoom();\n      let mapBounds = M.pixelToPCRSBounds(\n        this._map.getPixelBounds(),\n        mapZoom,\n        this._map.options.projection\n      );\n\n      let visible = true;\n      if (this._map.totalLayerBounds) {\n        visible =\n          mapZoom <= this._map.getMaxZoom() &&\n          mapZoom >= this._map.getMinZoom() &&\n          this._map.totalLayerBounds.overlaps(mapBounds);\n      }\n\n      let output = this.querySelector('.mapml-web-map')\n        ? this.querySelector('.mapml-web-map').shadowRoot.querySelector(\n            '.mapml-screen-reader-output'\n          )\n        : this.shadowRoot.querySelector('.mapml-screen-reader-output');\n\n      let standard = M.options.locale.amZoom + ' ' + mapZoom;\n\n      if (!visible) {\n        let outOfBoundsPos = this._history[this._historyIndex];\n        let inBoundsPos = this._history[this._historyIndex - 1];\n        this.back();\n        this._history.pop();\n\n        if (outOfBoundsPos.zoom !== inBoundsPos.zoom) {\n          output.innerText = M.options.locale.amZoomedOut;\n        } else if (this._map.dragging._draggable.wasDragged) {\n          output.innerText = M.options.locale.amDraggedOut;\n        } else if (outOfBoundsPos.x > inBoundsPos.x) {\n          output.innerText = M.options.locale.amEastBound;\n        } else if (outOfBoundsPos.x < inBoundsPos.x) {\n          output.innerText = M.options.locale.amWestBound;\n        } else if (outOfBoundsPos.y < inBoundsPos.y) {\n          output.innerText = M.options.locale.amNorthBound;\n        } else if (outOfBoundsPos.y > inBoundsPos.y) {\n          output.innerText = M.options.locale.amSouthBound;\n        }\n      } else {\n        let prevZoom = this._history[this._historyIndex - 1]\n          ? this._history[this._historyIndex - 1].zoom\n          : this._history[this._historyIndex].zoom;\n        if (mapZoom === this._map.getMaxZoom() && mapZoom !== prevZoom) {\n          output.innerText = M.options.locale.amMaxZoom + ' ' + standard;\n        } else if (mapZoom === this._map._layersMinZoom && mapZoom !== prevZoom) {\n          output.innerText = M.options.locale.amMinZoom + ' ' + standard;\n        } else {\n          output.innerText = standard;\n        }\n      }\n      this._map.dragging._draggable.wasDragged = false;\n    },\n\n    totalBounds: function (e) {\n      // don't bother with non-MapMLLayer layers...\n      if (!e.layer._layerEl) return;\n      let map = this.options.mapEl;\n      map.whenLayersReady().then(() => {\n        let layers = map.querySelectorAll('layer-');\n        let bounds;\n        for (let i = 0; i < layers.length; i++) {\n          // the _layer may no longer exist if this is invoked by layerremove\n          if (layers[i]._layer) {\n            let extent = layers[i].extent;\n            if (bounds && extent) {\n              bounds.extend(M.extentToBounds(extent, 'pcrs'));\n            } else if (extent) {\n              bounds = M.extentToBounds(extent, 'pcrs');\n            }\n          }\n        }\n\n        this.totalLayerBounds = bounds;\n      });\n    },\n\n    dragged: function () {\n      this.wasDragged = true;\n    }\n  });\n\n  var FeatureIndex = L.Handler.extend({\n    initialize: function (map) {\n      L.Handler.prototype.initialize.call(this, map);\n      this.inBoundFeatures = [];\n      this.outBoundFeatures = [];\n      this.currentIndex = 0;\n      this._mapPCRSBounds = M.pixelToPCRSBounds(\n        map.getPixelBounds(),\n        map.getZoom(),\n        map.options.projection\n      );\n    },\n\n    addHooks: function () {\n      this._map.on('mapkeyboardfocused', this._updateMapBounds, this);\n      this._map.on('mapkeyboardfocused', this._sortIndex, this);\n    },\n\n    removeHooks: function () {\n      this._map.off('mapkeyboardfocused', this._updateMapBounds);\n      this._map.off('mapkeyboardfocused', this._sortIndex);\n    },\n\n    /**\n     * Adds a svg element to the index of tabbable features, it also keeps track of the layer it's associated + center\n     * @param layer - the layer object the feature is associated with\n     * @param lc - the layer center\n     * @param path - the svg element that needs to be focused, can be a path or g\n     */\n    addToIndex: function (layer, lc, path) {\n      let mc = this._mapPCRSBounds.getCenter();\n      let dist = Math.sqrt(Math.pow(lc.x - mc.x, 2) + Math.pow(lc.y - mc.y, 2));\n      let index = this._mapPCRSBounds.contains(lc)\n        ? this.inBoundFeatures\n        : this.outBoundFeatures;\n\n      let elem = { path: path, layer: layer, center: lc, dist: dist };\n      path.setAttribute('tabindex', -1);\n\n      index.push(elem);\n\n      // TODO: this insertion loop has potential to be improved slightly\n      for (\n        let i = index.length - 1;\n        i > 0 && index[i].dist < index[i - 1].dist;\n        i--\n      ) {\n        let tmp = index[i];\n        index[i] = index[i - 1];\n        index[i - 1] = tmp;\n      }\n\n      if (this._mapPCRSBounds.contains(lc)) this.inBoundFeatures = index;\n      else this.outBoundFeatures = index;\n    },\n\n    /**\n     * Removes features that are no longer on the map, also moves features to the respective array depending\n     * on whether the feature is in the maps viewport or not\n     */\n    cleanIndex: function () {\n      this.currentIndex = 0;\n      this.inBoundFeatures = this.inBoundFeatures.filter((elem) => {\n        let inbound = this._mapPCRSBounds.contains(elem.center);\n        elem.path.setAttribute('tabindex', -1);\n        if (elem.layer._map && !inbound) {\n          this.outBoundFeatures.push(elem);\n        }\n        return elem.layer._map && inbound;\n      });\n      this.outBoundFeatures = this.outBoundFeatures.filter((elem) => {\n        let inbound = this._mapPCRSBounds.contains(elem.center);\n        elem.path.setAttribute('tabindex', -1);\n        if (elem.layer._map && inbound) {\n          this.inBoundFeatures.push(elem);\n        }\n        return elem.layer._map && !inbound;\n      });\n    },\n\n    /**\n     * Sorts the index of features in the map's viewport based on distance from center\n     * @private\n     */\n    _sortIndex: function () {\n      this.cleanIndex();\n      if (this.inBoundFeatures.length === 0) return;\n\n      let mc = this._mapPCRSBounds.getCenter();\n\n      this.inBoundFeatures.sort(function (a, b) {\n        let ac = a.center;\n        let bc = b.center;\n        a.dist = Math.sqrt(Math.pow(ac.x - mc.x, 2) + Math.pow(ac.y - mc.y, 2));\n        b.dist = Math.sqrt(Math.pow(bc.x - mc.x, 2) + Math.pow(bc.y - mc.y, 2));\n        return a.dist - b.dist;\n      });\n      this.inBoundFeatures[0].path.setAttribute('tabindex', 0);\n    },\n\n    /**\n     * Event handler for 'mapfocused' event to update the map's bounds in terms of PCRS\n     * @param e - the event object\n     * @private\n     */\n    _updateMapBounds: function (e) {\n      // TODO: map's PCRS bounds is used in other parts of the viewer, can be moved out to the map object directly\n      this._mapPCRSBounds = M.pixelToPCRSBounds(\n        this._map.getPixelBounds(),\n        this._map.getZoom(),\n        this._map.options.projection\n      );\n    }\n  });\n\n  var Options = {\n    featureIndexOverlayOption: false,\n    announceMovement: false,\n    announceScale: { metric: true, imperial: false },\n    defaultExtCoor: 'pcrs',\n    defaultLocCoor: 'gcrs',\n    locale: {\n      cmBack: 'Back',\n      cmForward: 'Forward',\n      cmReload: 'Reload',\n      cmToggleControls: 'Toggle Controls',\n      cmCopyCoords: 'Copy',\n      cmCopyMapML: 'Map',\n      cmCopyExtent: 'Extent',\n      cmCopyLocation: 'Location',\n      cmToggleDebug: 'Toggle Debug Mode',\n      cmPasteLayer: 'Paste',\n      cmViewSource: 'View Map Source',\n      lmZoomToLayer: 'Zoom To Layer',\n      lmCopyLayer: 'Copy Layer',\n      lmZoomToExtent: 'Zoom To Sub-layer',\n      lmCopyExtent: 'Copy Sub-layer',\n      lcOpacity: 'Opacity',\n      btnAttribution: 'Map data attribution',\n      btnZoomIn: 'Zoom in',\n      btnZoomOut: 'Zoom out',\n      btnFullScreen: 'View Fullscreen',\n      btnExitFullScreen: 'Exit Fullscreen',\n      btnLocTrackOn: 'Show my location - location tracking on',\n      btnMyLocTrackOn: 'My current location, shown on map',\n      btnLocTrackOff: 'Show my location - location tracking off',\n      btnLocTrackLastKnown: 'Show my location - last known location shown',\n      btnMyLastKnownLocTrackOn: 'My last known location, shown on map',\n      amZoom: 'zoom level',\n      amColumn: 'column',\n      amRow: 'row',\n      amMaxZoom: 'At maximum zoom level, zoom in disabled',\n      amMinZoom: 'At minimum zoom level, zoom out disabled',\n      amZoomedOut: 'Zoomed out of bounds, returning to',\n      amDraggedOut: 'Dragged out of bounds, returning to',\n      amEastBound: 'Reached east bound, panning east disabled',\n      amWestBound: 'Reached west bound, panning west disabled',\n      amNorthBound: 'Reached north bound, panning north disabled',\n      amSouthBound: 'Reached south bound, panning south disabled',\n      kbdShortcuts: 'Keyboard shortcuts',\n      kbdMovement: 'Movement keys',\n      kbdFeature: 'Feature navigation keys',\n      kbdPanUp: 'Pan up',\n      kbdPanDown: 'Pan down',\n      kbdPanLeft: 'Pan left',\n      kbdPanRight: 'Pan right',\n      kbdPanIncrement: 'pan increment',\n      kbdZoom: 'Zoom in/out 3 levels',\n      kbdPrevFeature: 'Previous feature',\n      kbdNextFeature: 'Next feature',\n      dfLayer: 'Layer',\n      dfExtent: 'Sub-layer',\n      popupZoom: 'Zoom to here',\n      dfPastedLayer: 'Pasted layer',\n      fIndexNoFeatures: 'No features found'\n    }\n  };\n\n  L.Map.Keyboard.include({\n    _onKeyDown: function (e) {\n      if (e.altKey || e.metaKey) {\n        return;\n      }\n\n      let zoomIn = {\n        187: 187,\n        107: 107,\n        61: 61,\n        171: 171\n      };\n\n      let zoomOut = {\n        189: 189,\n        109: 109,\n        54: 54,\n        173: 173\n      };\n\n      var key = e.keyCode,\n        map = this._map,\n        offset;\n\n      if (key in this._panKeys) {\n        if (!map._panAnim || !map._panAnim._inProgress) {\n          offset = this._panKeys[key];\n          if (e.shiftKey) {\n            offset = L.point(offset).multiplyBy(3);\n          }\n          if (e.ctrlKey) {\n            offset = L.point(offset).divideBy(5);\n          }\n\n          map.panBy(offset);\n\n          if (map.options.maxBounds) {\n            map.panInsideBounds(map.options.maxBounds);\n          }\n        }\n      } else if (key in this._zoomKeys) {\n        if (\n          (key in zoomIn && map.getMaxZoom() !== map.getZoom()) ||\n          (key in zoomOut && map._layersMinZoom !== map.getZoom())\n        )\n          map.setZoom(map.getZoom() + (e.shiftKey ? 3 : 1) * this._zoomKeys[key]);\n      } else if (\n        key === 27 &&\n        map._popup &&\n        map._popup.options.closeOnEscapeKey\n      ) {\n        map.closePopup();\n      } else {\n        return;\n      }\n\n      L.DomEvent.stop(e);\n    }\n  });\n\n  var FeatureIndexOverlay = L.Layer.extend({\n    onAdd: function (map) {\n      let svgInnerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" viewBox=\"0 0 100 100\"><path fill=\"none\" stroke=\"#000\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"3\" d=\"M0 0h100v100H0z\" color=\"#000\" overflow=\"visible\"/></svg>`;\n\n      this._container = L.DomUtil.create(\n        'div',\n        'mapml-feature-index-box',\n        map._container\n      );\n      this._container.innerHTML = svgInnerHTML;\n\n      this._output = L.DomUtil.create(\n        'output',\n        'mapml-feature-index',\n        map._container\n      );\n      this._output.setAttribute('role', 'status');\n      this._output.setAttribute('aria-live', 'polite');\n      this._output.setAttribute('aria-atomic', 'true');\n      this._body = L.DomUtil.create(\n        'span',\n        'mapml-feature-index-content',\n        this._output\n      );\n      this._body.index = 0;\n      this._output.initialFocus = false;\n      map.on('focus blur popupclose', this._addOrRemoveFeatureIndex, this);\n      map.on('moveend focus templatedfeatureslayeradd', this._checkOverlap, this);\n      map.on('keydown', this._onKeyDown, this);\n      this._addOrRemoveFeatureIndex();\n    },\n\n    _calculateReticleBounds: function () {\n      let bounds = this._map.getPixelBounds();\n      let center = bounds.getCenter();\n      let wRatio =\n        Math.abs(bounds.min.x - bounds.max.x) / this._map.options.mapEl.width;\n      let hRatio =\n        Math.abs(bounds.min.y - bounds.max.y) / this._map.options.mapEl.height;\n\n      let reticleDimension = getComputedStyle(this._container).width.replace(\n        /[^\\d.]/g,\n        ''\n      );\n      if (getComputedStyle(this._container).width.slice(-1) === '%') {\n        reticleDimension =\n          (reticleDimension * this._map.options.mapEl.width) / 100;\n      }\n      let w = (wRatio * reticleDimension) / 2;\n      let h = (hRatio * reticleDimension) / 2;\n      let minPoint = L.point(center.x - w, center.y + h);\n      let maxPoint = L.point(center.x + w, center.y - h);\n      let b = L.bounds(minPoint, maxPoint);\n      return M.pixelToPCRSBounds(\n        b,\n        this._map.getZoom(),\n        this._map.options.projection\n      );\n    },\n\n    _checkOverlap: function (e) {\n      if (e.type === 'focus') this._output.initialFocus = true;\n      if (!this._output.initialFocus) return;\n      if (this._output.popupClosed) {\n        this._output.popupClosed = false;\n        return;\n      }\n\n      this._map.fire('mapkeyboardfocused');\n\n      let featureIndexBounds = this._calculateReticleBounds();\n      let features = this._map.featureIndex.inBoundFeatures;\n      let index = 1;\n      let keys = Object.keys(features);\n      let body = this._body;\n      let noFeaturesMessage = document.createElement('span');\n      noFeaturesMessage.innerHTML = M.options.locale.fIndexNoFeatures;\n\n      body.innerHTML = '';\n      body.index = 0;\n\n      body.allFeatures = [];\n      keys.forEach((i) => {\n        let layer = features[i].layer;\n        let layers = features[i].layer._layers;\n        let bounds = L.bounds();\n\n        if (layers) {\n          let keys = Object.keys(layers);\n          keys.forEach((j) => {\n            if (!bounds)\n              bounds = L.bounds(\n                layer._layers[j]._bounds.min,\n                layer._layers[j]._bounds.max\n              );\n            bounds.extend(layer._layers[j]._bounds.min);\n            bounds.extend(layer._layers[j]._bounds.max);\n          });\n        } else if (layer._bounds) {\n          bounds = L.bounds(layer._bounds.min, layer._bounds.max);\n        }\n\n        if (featureIndexBounds.overlaps(bounds)) {\n          let label = features[i].path.getAttribute('aria-label');\n\n          if (index < 8) {\n            body.appendChild(this._updateOutput(label, index, index));\n          }\n          if (index % 7 === 0 || index === 1) {\n            body.allFeatures.push([]);\n          }\n          body.allFeatures[Math.floor((index - 1) / 7)].push({\n            label,\n            index,\n            layer\n          });\n          if (body.allFeatures[1] && body.allFeatures[1].length === 1) {\n            body.appendChild(this._updateOutput('More results', 0, 9));\n          }\n          index += 1;\n        }\n      });\n      this._addToggleKeys();\n      if (index === 1) {\n        body.appendChild(noFeaturesMessage);\n      }\n    },\n\n    _updateOutput: function (label, index, key) {\n      let span = document.createElement('span');\n      span.setAttribute('data-index', index);\n      //\", \" adds a brief auditory pause when a screen reader is reading through the feature index\n      //also prevents names with numbers + key from being combined when read\n      span.innerHTML = `<kbd>${key}</kbd>` + ' ' + label + '<span>, </span>';\n      return span;\n    },\n\n    _addToggleKeys: function () {\n      let allFeatures = this._body.allFeatures;\n      for (let i = 0; i < allFeatures.length; i++) {\n        if (allFeatures[i].length === 0) return;\n        if (allFeatures[i - 1]) {\n          let label = 'Previous results';\n          allFeatures[i].push({ label });\n        }\n\n        if (allFeatures[i + 1] && allFeatures[i + 1].length > 0) {\n          let label = 'More results';\n          allFeatures[i].push({ label });\n        }\n      }\n    },\n\n    _onKeyDown: function (e) {\n      let body = this._body;\n      let key = e.originalEvent.keyCode;\n      if (key >= 49 && key <= 55) {\n        if (!body.allFeatures[body.index]) return;\n        let feature = body.allFeatures[body.index][key - 49];\n        if (!feature) return;\n        let layer = feature.layer;\n        if (layer) {\n          this._map.featureIndex.currentIndex = feature.index - 1;\n          if (layer._popup) {\n            this._map.closePopup();\n            layer.openPopup();\n          } else layer.options.group.focus();\n        }\n      } else if (key === 56) {\n        this._newContent(body, -1);\n      } else if (key === 57) {\n        this._newContent(body, 1);\n      }\n    },\n\n    _newContent: function (body, direction) {\n      let index = body.firstChild.getAttribute('data-index');\n      let newContent = body.allFeatures[Math.floor((index - 1) / 7 + direction)];\n      if (newContent && newContent.length > 0) {\n        body.innerHTML = '';\n        body.index += direction;\n        for (let i = 0; i < newContent.length; i++) {\n          let feature = newContent[i];\n          let index = feature.index ? feature.index : 0;\n          let key = i + 1;\n          if (feature.label === 'More results') key = 9;\n          if (feature.label === 'Previous results') key = 8;\n          body.appendChild(this._updateOutput(feature.label, index, key));\n        }\n      }\n    },\n\n    _addOrRemoveFeatureIndex: function (e) {\n      //Toggle aria-hidden attribute so screen reader rereads the feature index on focus\n      if (!this._output.initialFocus) {\n        this._output.setAttribute('aria-hidden', 'true');\n      } else if (this._output.hasAttribute('aria-hidden')) {\n        let obj = this;\n        setTimeout(function () {\n          obj._output.removeAttribute('aria-hidden');\n        }, 100);\n      }\n\n      if (e && e.type === 'popupclose') {\n        this._output.setAttribute('aria-hidden', 'true');\n        this._output.popupClosed = true;\n      } else if (e && e.type === 'focus') {\n        this._container.removeAttribute('hidden');\n        this._output.classList.remove('mapml-screen-reader-output');\n        // this is a very subtle branch.  The event that gets handled below is a blur\n        // event, which happens to have the e.target._popup property\n        // when there will be a popup.  Because blur gets handled here, it doesn't\n        // get handled in the next else if block, which would hide both the reticle\n        // and the index menu, and then recursively call this method with no event\n        // argument, which manipulates the aria-hidden attribute on the output\n        // in order to have the screenreader read its contents when the focus returns\n        // to (what exactly???).\n      } else if (e && e.target._popup) {\n        this._container.setAttribute('hidden', '');\n      } else if (e && e.type === 'blur') {\n        this._container.setAttribute('hidden', '');\n        this._output.classList.add('mapml-screen-reader-output');\n        this._output.initialFocus = false;\n        this._addOrRemoveFeatureIndex();\n      } else {\n        // this is the default block, called when no event is passed (recursive call)\n        this._container.setAttribute('hidden', '');\n        this._output.classList.add('mapml-screen-reader-output');\n      }\n    }\n  });\n\n  var featureIndexOverlay = function (options) {\n    return new FeatureIndexOverlay(options);\n  };\n\n  var createLayerControlExtentHTML = function () {\n    var extent = L.DomUtil.create('fieldset', 'mapml-layer-extent'),\n      extentProperties = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-properties',\n        extent\n      ),\n      extentSettings = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-settings',\n        extent\n      ),\n      extentLabel = L.DomUtil.create(\n        'label',\n        'mapml-layer-item-toggle',\n        extentProperties\n      ),\n      input = L.DomUtil.create('input'),\n      svgExtentControlIcon = L.SVG.create('svg'),\n      extentControlPath1 = L.SVG.create('path'),\n      extentControlPath2 = L.SVG.create('path'),\n      extentNameIcon = L.DomUtil.create('span'),\n      extentItemControls = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-controls',\n        extentProperties\n      ),\n      opacityControl = L.DomUtil.create(\n        'details',\n        'mapml-layer-item-details mapml-control-layers',\n        extentSettings\n      ),\n      extentOpacitySummary = L.DomUtil.create('summary', '', opacityControl),\n      mapEl = this.getMapEl(),\n      layerEl = this.getLayerEl(),\n      opacity = L.DomUtil.create('input', '', opacityControl);\n    extentSettings.hidden = true;\n    extent.setAttribute('aria-grabbed', 'false');\n\n    // append the svg paths\n    svgExtentControlIcon.setAttribute('viewBox', '0 0 24 24');\n    svgExtentControlIcon.setAttribute('height', '22');\n    svgExtentControlIcon.setAttribute('width', '22');\n    extentControlPath1.setAttribute('d', 'M0 0h24v24H0z');\n    extentControlPath1.setAttribute('fill', 'none');\n    extentControlPath2.setAttribute(\n      'd',\n      'M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z'\n    );\n    svgExtentControlIcon.appendChild(extentControlPath1);\n    svgExtentControlIcon.appendChild(extentControlPath2);\n\n    let mapSelects = this.querySelectorAll('map-select');\n    if (mapSelects.length) {\n      var frag = document.createDocumentFragment();\n      for (var i = 0; i < mapSelects.length; i++) {\n        frag.appendChild(mapSelects[i].selectdetails);\n      }\n      extentSettings.appendChild(frag);\n    }\n\n    let removeExtentButton = L.DomUtil.create(\n      'button',\n      'mapml-layer-item-remove-control',\n      extentItemControls\n    );\n    removeExtentButton.type = 'button';\n    removeExtentButton.title = 'Remove Sub Layer';\n    removeExtentButton.innerHTML = \"<span aria-hidden='true'>&#10005;</span>\";\n    removeExtentButton.classList.add('mapml-button');\n    removeExtentButton.addEventListener('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.remove();\n    });\n\n    let extentsettingsButton = L.DomUtil.create(\n      'button',\n      'mapml-layer-item-settings-control',\n      extentItemControls\n    );\n    extentsettingsButton.type = 'button';\n    extentsettingsButton.title = 'Extent Settings';\n    extentsettingsButton.setAttribute('aria-expanded', false);\n    extentsettingsButton.classList.add('mapml-button');\n    L.DomEvent.on(\n      extentsettingsButton,\n      'click',\n      (e) => {\n        if (extentSettings.hidden === true) {\n          extentsettingsButton.setAttribute('aria-expanded', true);\n          extentSettings.hidden = false;\n        } else {\n          extentsettingsButton.setAttribute('aria-expanded', false);\n          extentSettings.hidden = true;\n        }\n      },\n      this\n    );\n\n    extentNameIcon.setAttribute('aria-hidden', true);\n    extentLabel.appendChild(input);\n    extentsettingsButton.appendChild(extentNameIcon);\n    extentNameIcon.appendChild(svgExtentControlIcon);\n    extentOpacitySummary.innerText = 'Opacity';\n    extentOpacitySummary.id =\n      'mapml-extent-item-opacity-' + L.stamp(extentOpacitySummary);\n    opacity.setAttribute('type', 'range');\n    opacity.setAttribute('min', '0');\n    opacity.setAttribute('max', '1.0');\n    opacity.setAttribute('step', '0.1');\n    opacity.setAttribute(\n      'aria-labelledby',\n      'mapml-extent-item-opacity-' + L.stamp(extentOpacitySummary)\n    );\n    const changeOpacity = function (e) {\n      if (e && e.target && e.target.value >= 0 && e.target.value <= 1.0) {\n        this._extentLayer.changeOpacity(e.target.value);\n      }\n    };\n    opacity.setAttribute('value', this.opacity);\n    opacity.value = this._extentLayer._container.style.opacity || '1.0';\n    opacity.addEventListener('change', changeOpacity.bind(this));\n\n    var extentItemNameSpan = L.DomUtil.create(\n      'span',\n      'mapml-extent-item-name',\n      extentLabel\n    );\n    input.type = 'checkbox';\n    input.defaultChecked = this.checked;\n    extentItemNameSpan.innerHTML = this.label;\n    const changeCheck = function () {\n      this.checked = !this.checked;\n    };\n    // save for later access by API\n    this._layerControlCheckbox = input;\n    input.addEventListener('change', changeCheck.bind(this));\n    extentItemNameSpan.id =\n      'mapml-extent-item-name-{' + L.stamp(extentItemNameSpan) + '}';\n    extent.setAttribute('aria-labelledby', extentItemNameSpan.id);\n    extentItemNameSpan.extent = this;\n\n    extent.ontouchstart = extent.onmousedown = (downEvent) => {\n      if (\n        (downEvent.target.parentElement.tagName.toLowerCase() === 'label' &&\n          downEvent.target.tagName.toLowerCase() !== 'input') ||\n        downEvent.target.tagName.toLowerCase() === 'label'\n      ) {\n        downEvent.stopPropagation();\n        downEvent =\n          downEvent instanceof TouchEvent ? downEvent.touches[0] : downEvent;\n\n        let control = extent,\n          controls = extent.parentNode,\n          moving = false,\n          yPos = downEvent.clientY,\n          originalPosition = Array.from(\n            extent.parentElement.querySelectorAll('fieldset')\n          ).indexOf(extent);\n\n        document.body.ontouchmove = document.body.onmousemove = (moveEvent) => {\n          moveEvent.preventDefault();\n          moveEvent =\n            moveEvent instanceof TouchEvent ? moveEvent.touches[0] : moveEvent;\n\n          // Fixes flickering by only moving element when there is enough space\n          let offset = moveEvent.clientY - yPos;\n          moving = Math.abs(offset) > 15 || moving;\n          if (\n            (controls && !moving) ||\n            (controls && controls.childElementCount <= 1) ||\n            controls.getBoundingClientRect().top >\n              control.getBoundingClientRect().bottom ||\n            controls.getBoundingClientRect().bottom <\n              control.getBoundingClientRect().top\n          ) {\n            return;\n          }\n\n          controls.classList.add('mapml-draggable');\n          control.style.transform = 'translateY(' + offset + 'px)';\n          control.style.pointerEvents = 'none';\n\n          let x = moveEvent.clientX,\n            y = moveEvent.clientY,\n            root =\n              mapEl.tagName === 'MAPML-VIEWER'\n                ? mapEl.shadowRoot\n                : mapEl.querySelector('.mapml-web-map').shadowRoot,\n            elementAt = root.elementFromPoint(x, y),\n            swapControl =\n              !elementAt || !elementAt.closest('fieldset')\n                ? control\n                : elementAt.closest('fieldset');\n\n          swapControl =\n            Math.abs(offset) <= swapControl.offsetHeight ? control : swapControl;\n\n          control.setAttribute('aria-grabbed', 'true');\n          control.setAttribute('aria-dropeffect', 'move');\n          if (swapControl && controls === swapControl.parentNode) {\n            swapControl =\n              swapControl !== control.nextSibling\n                ? swapControl\n                : swapControl.nextSibling;\n            if (control !== swapControl) {\n              yPos = moveEvent.clientY;\n              control.style.transform = null;\n            }\n            controls.insertBefore(control, swapControl);\n          }\n        };\n\n        document.body.ontouchend = document.body.onmouseup = () => {\n          let newPosition = Array.from(\n            extent.parentElement.querySelectorAll('fieldset')\n          ).indexOf(extent);\n          control.setAttribute('aria-grabbed', 'false');\n          control.removeAttribute('aria-dropeffect');\n          control.style.pointerEvents = null;\n          control.style.transform = null;\n          if (originalPosition !== newPosition) {\n            let controlsElems = controls.children,\n              zIndex = 0;\n            for (let c of controlsElems) {\n              let extentEl = c.querySelector('span').extent;\n\n              extentEl.setAttribute('data-moving', '');\n              const node = layerEl.src ? layerEl.shadowRoot : layerEl;\n              node.append(extentEl);\n              extentEl.removeAttribute('data-moving');\n\n              extentEl.extentZIndex = zIndex;\n              extentEl._extentLayer.setZIndex(zIndex);\n              zIndex++;\n            }\n          }\n          controls.classList.remove('mapml-draggable');\n          document.body.ontouchmove =\n            document.body.onmousemove =\n            document.body.ontouchend =\n            document.body.onmouseup =\n              null;\n        };\n      }\n    };\n    this._extentRootFieldset = extent;\n    this._opacitySlider = opacity;\n    this._opacityControl = opacityControl;\n    this._layerControlLabel = extentLabel;\n    return extent;\n  };\n\n  var createLayerControlHTML = async function () {\n    var fieldset = L.DomUtil.create('fieldset', 'mapml-layer-item'),\n      input = L.DomUtil.create('input'),\n      layerItemName = L.DomUtil.create('span', 'mapml-layer-item-name'),\n      settingsButtonNameIcon = L.DomUtil.create('span'),\n      layerItemProperty = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-properties',\n        fieldset\n      ),\n      layerItemSettings = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-settings',\n        fieldset\n      ),\n      itemToggleLabel = L.DomUtil.create(\n        'label',\n        'mapml-layer-item-toggle',\n        layerItemProperty\n      ),\n      layerItemControls = L.DomUtil.create(\n        'div',\n        'mapml-layer-item-controls',\n        layerItemProperty\n      ),\n      opacityControl = L.DomUtil.create(\n        'details',\n        'mapml-layer-item-opacity mapml-control-layers',\n        layerItemSettings\n      ),\n      opacity = L.DomUtil.create('input'),\n      opacityControlSummary = L.DomUtil.create('summary'),\n      svgSettingsControlIcon = L.SVG.create('svg'),\n      settingsControlPath1 = L.SVG.create('path'),\n      settingsControlPath2 = L.SVG.create('path'),\n      extentsFieldset = L.DomUtil.create(\n        'fieldset',\n        'mapml-layer-grouped-extents'\n      ),\n      mapEl = this.parentNode;\n\n    // append the paths in svg for the remove layer and toggle icons\n    svgSettingsControlIcon.setAttribute('viewBox', '0 0 24 24');\n    svgSettingsControlIcon.setAttribute('height', '22');\n    svgSettingsControlIcon.setAttribute('width', '22');\n    svgSettingsControlIcon.setAttribute('fill', 'currentColor');\n    settingsControlPath1.setAttribute('d', 'M0 0h24v24H0z');\n    settingsControlPath1.setAttribute('fill', 'none');\n    settingsControlPath2.setAttribute(\n      'd',\n      'M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z'\n    );\n    svgSettingsControlIcon.appendChild(settingsControlPath1);\n    svgSettingsControlIcon.appendChild(settingsControlPath2);\n\n    layerItemSettings.hidden = true;\n    settingsButtonNameIcon.setAttribute('aria-hidden', true);\n\n    let removeControlButton = L.DomUtil.create(\n      'button',\n      'mapml-layer-item-remove-control',\n      layerItemControls\n    );\n    removeControlButton.type = 'button';\n    removeControlButton.title = 'Remove Layer';\n    removeControlButton.innerHTML = \"<span aria-hidden='true'>&#10005;</span>\";\n    removeControlButton.classList.add('mapml-button');\n    L.DomEvent.on(removeControlButton, 'click', L.DomEvent.stop);\n    L.DomEvent.on(\n      removeControlButton,\n      'click',\n      (e) => {\n        let fieldset = 0,\n          elem,\n          root;\n        root =\n          mapEl.tagName === 'MAPML-VIEWER'\n            ? mapEl.shadowRoot\n            : mapEl.querySelector('.mapml-web-map').shadowRoot;\n        if (\n          e.target.closest('fieldset').nextElementSibling &&\n          !e.target.closest('fieldset').nextElementSibling.disbaled\n        ) {\n          elem = e.target.closest('fieldset').previousElementSibling;\n          while (elem) {\n            fieldset += 2; // find the next layer menu item\n            elem = elem.previousElementSibling;\n          }\n        } else {\n          // focus on the link\n          elem = 'link';\n        }\n        mapEl.removeChild(\n          e.target.closest('fieldset').querySelector('span').layer._layerEl\n        );\n        elem = elem\n          ? root.querySelector('.leaflet-control-attribution').firstElementChild\n          : (elem = root.querySelectorAll('input')[fieldset]);\n        elem.focus();\n      },\n      this._layer\n    );\n\n    let itemSettingControlButton = L.DomUtil.create(\n      'button',\n      'mapml-layer-item-settings-control',\n      layerItemControls\n    );\n    itemSettingControlButton.type = 'button';\n    itemSettingControlButton.title = 'Layer Settings';\n    itemSettingControlButton.setAttribute('aria-expanded', false);\n    itemSettingControlButton.classList.add('mapml-button');\n    L.DomEvent.on(\n      itemSettingControlButton,\n      'click',\n      (e) => {\n        let layerControl = this._layer._layerEl._layerControl._container;\n        if (!layerControl._isExpanded && e.pointerType === 'touch') {\n          layerControl._isExpanded = true;\n          return;\n        }\n        if (layerItemSettings.hidden === true) {\n          itemSettingControlButton.setAttribute('aria-expanded', true);\n          layerItemSettings.hidden = false;\n        } else {\n          itemSettingControlButton.setAttribute('aria-expanded', false);\n          layerItemSettings.hidden = true;\n        }\n      },\n      this._layer\n    );\n\n    input.defaultChecked = this.checked;\n    input.type = 'checkbox';\n    input.setAttribute('class', 'leaflet-control-layers-selector');\n    layerItemName.layer = this._layer;\n    const changeCheck = function () {\n      this.checked = !this.checked;\n    };\n    input.addEventListener('change', changeCheck.bind(this));\n    if (this._layer._legendUrl) {\n      var legendLink = document.createElement('a');\n      legendLink.text = ' ' + this._layer._title;\n      legendLink.href = this._layer._legendUrl;\n      legendLink.target = '_blank';\n      legendLink.draggable = false;\n      layerItemName.appendChild(legendLink);\n    } else {\n      layerItemName.innerHTML = this._layer._title;\n    }\n    layerItemName.id = 'mapml-layer-item-name-{' + L.stamp(layerItemName) + '}';\n    opacityControlSummary.innerText = 'Opacity';\n    opacityControlSummary.id =\n      'mapml-layer-item-opacity-' + L.stamp(opacityControlSummary);\n    opacityControl.appendChild(opacityControlSummary);\n    opacityControl.appendChild(opacity);\n    opacity.setAttribute('type', 'range');\n    opacity.setAttribute('min', '0');\n    opacity.setAttribute('max', '1.0');\n    opacity.setAttribute('value', this._layer._container.style.opacity || '1.0');\n    opacity.setAttribute('step', '0.1');\n    opacity.setAttribute(\n      'aria-labelledby',\n      'mapml-layer-item-opacity-' + L.stamp(opacityControlSummary)\n    );\n\n    const changeOpacity = function (e) {\n      if (e && e.target && e.target.value >= 0 && e.target.value <= 1.0) {\n        this._layer.changeOpacity(e.target.value);\n      }\n    };\n    opacity.value = this._layer._container.style.opacity || '1.0';\n    opacity.addEventListener('change', changeOpacity.bind(this));\n\n    fieldset.setAttribute('aria-grabbed', 'false');\n    fieldset.setAttribute('aria-labelledby', layerItemName.id);\n\n    fieldset.ontouchstart = fieldset.onmousedown = (downEvent) => {\n      if (\n        (downEvent.target.parentElement.tagName.toLowerCase() === 'label' &&\n          downEvent.target.tagName.toLowerCase() !== 'input') ||\n        downEvent.target.tagName.toLowerCase() === 'label'\n      ) {\n        downEvent =\n          downEvent instanceof TouchEvent ? downEvent.touches[0] : downEvent;\n        let control = fieldset,\n          controls = fieldset.parentNode,\n          moving = false,\n          yPos = downEvent.clientY,\n          originalPosition = Array.from(\n            controls.querySelectorAll('fieldset')\n          ).indexOf(fieldset);\n\n        document.body.ontouchmove = document.body.onmousemove = (moveEvent) => {\n          moveEvent.preventDefault();\n          moveEvent =\n            moveEvent instanceof TouchEvent ? moveEvent.touches[0] : moveEvent;\n\n          // Fixes flickering by only moving element when there is enough space\n          let offset = moveEvent.clientY - yPos;\n          moving = Math.abs(offset) > 15 || moving;\n          if (\n            (controls && !moving) ||\n            (controls && controls.childElementCount <= 1) ||\n            controls.getBoundingClientRect().top >\n              control.getBoundingClientRect().bottom ||\n            controls.getBoundingClientRect().bottom <\n              control.getBoundingClientRect().top\n          ) {\n            return;\n          }\n\n          controls.classList.add('mapml-draggable');\n          control.style.transform = 'translateY(' + offset + 'px)';\n          control.style.pointerEvents = 'none';\n\n          let x = moveEvent.clientX,\n            y = moveEvent.clientY,\n            root =\n              mapEl.tagName === 'MAPML-VIEWER'\n                ? mapEl.shadowRoot\n                : mapEl.querySelector('.mapml-web-map').shadowRoot,\n            elementAt = root.elementFromPoint(x, y),\n            swapControl =\n              !elementAt || !elementAt.closest('fieldset')\n                ? control\n                : elementAt.closest('fieldset');\n\n          swapControl =\n            Math.abs(offset) <= swapControl.offsetHeight ? control : swapControl;\n\n          control.setAttribute('aria-grabbed', 'true');\n          control.setAttribute('aria-dropeffect', 'move');\n          if (swapControl && controls === swapControl.parentNode) {\n            swapControl =\n              swapControl !== control.nextSibling\n                ? swapControl\n                : swapControl.nextSibling;\n            if (control !== swapControl) {\n              yPos = moveEvent.clientY;\n              control.style.transform = null;\n            }\n            controls.insertBefore(control, swapControl);\n          }\n        };\n\n        document.body.ontouchend = document.body.onmouseup = () => {\n          let newPosition = Array.from(\n            controls.querySelectorAll('fieldset')\n          ).indexOf(fieldset);\n          control.setAttribute('aria-grabbed', 'false');\n          control.removeAttribute('aria-dropeffect');\n          control.style.pointerEvents = null;\n          control.style.transform = null;\n          if (originalPosition !== newPosition) {\n            let controlsElems = controls.children,\n              zIndex = 1;\n            // re-order layer elements DOM order\n            for (let c of controlsElems) {\n              let layerEl = c.querySelector('span').layer._layerEl;\n              layerEl.setAttribute('data-moving', '');\n              mapEl.insertAdjacentElement('beforeend', layerEl);\n              layerEl.removeAttribute('data-moving');\n            }\n            // update zIndex of all layer- elements\n            let layers = mapEl.querySelectorAll('layer-');\n            for (let i = 0; i < layers.length; i++) {\n              let layer = layers[i]._layer;\n              if (layer.options.zIndex !== zIndex) {\n                layer.setZIndex(zIndex);\n              }\n              zIndex++;\n            }\n          }\n          controls.classList.remove('mapml-draggable');\n          document.body.ontouchmove =\n            document.body.onmousemove =\n            document.body.onmouseup =\n              null;\n        };\n      }\n    };\n\n    itemToggleLabel.appendChild(input);\n    itemToggleLabel.appendChild(layerItemName);\n    itemSettingControlButton.appendChild(settingsButtonNameIcon);\n    settingsButtonNameIcon.appendChild(svgSettingsControlIcon);\n\n    let mapml = this.src ? this.shadowRoot : this;\n    var styleLinks = mapml.querySelectorAll(\n      'map-link[rel=style],map-link[rel=\"self style\"],map-link[rel=\"style self\"]'\n    );\n    let styles;\n    if (styleLinks) {\n      styles = this.getAlternateStyles(styleLinks);\n      if (styles) {\n        layerItemSettings.appendChild(styles);\n      }\n    }\n\n    this._layerControlCheckbox = input;\n    this._layerControlLabel = itemToggleLabel;\n    this._opacityControl = opacityControl;\n    this._opacitySlider = opacity;\n    this._layerControlHTML = fieldset;\n    this._layerItemSettingsHTML = layerItemSettings;\n    this._propertiesGroupAnatomy = extentsFieldset;\n    this._styles = styles;\n    extentsFieldset.setAttribute('aria-label', 'Sublayers');\n    extentsFieldset.setAttribute('hidden', '');\n    let mapExtents = mapml.querySelectorAll('map-extent:not([hidden])');\n    let mapExtentLayerControls = [];\n    for (let i = 0; i < mapExtents.length; i++) {\n      mapExtentLayerControls.push(mapExtents[i].whenReady());\n      // if any map-extent is not hidden, the parent fieldset should not be hidden\n      extentsFieldset.removeAttribute('hidden');\n    }\n    await Promise.all(mapExtentLayerControls);\n    for (let i = 0; i < mapExtents.length; i++) {\n      extentsFieldset.appendChild(mapExtents[i].getLayerControlHTML());\n    }\n    layerItemSettings.appendChild(extentsFieldset);\n    return this._layerControlHTML;\n  };\n\n  class ZoomInput {\n    constructor(name, min, max, value, step, layer) {\n      this.name = name;\n      this.min = min;\n      this.max = max;\n      this.value = value;\n      this.step = step;\n      this.layer = layer;\n    }\n\n    validateInput() {\n      // name is required\n      if (!this.name) {\n        return false;\n      }\n      // min and max can not be present\n      // fallback would be layer's meta, -> projection min, max\n      // don't need value, map-meta max value, -> fallback is max zoom of projection\n      // don't need step, defaults to 1\n      return true;\n    }\n\n    getValue() {\n      return this.layer._map.options.mapEl.zoom;\n    }\n  }\n\n  class HiddenInput {\n    constructor(name, value) {\n      this.name = name;\n      this.value = value;\n    }\n\n    validateInput() {\n      // name is required\n      // value is required\n      if (!this.name || !this.value) {\n        return false;\n      }\n      return true;\n    }\n\n    getValue() {\n      return this.value;\n    }\n  }\n\n  class WidthInput {\n    constructor(name, layer) {\n      this.name = name;\n      this.layer = layer;\n    }\n\n    validateInput() {\n      // name is required\n      if (!this.name) {\n        return false;\n      }\n      return true;\n    }\n\n    getValue() {\n      return this.layer._map.getSize().x;\n    }\n  }\n\n  class HeightInput {\n    constructor(name, layer) {\n      this.name = name;\n      this.layer = layer;\n    }\n\n    validateInput() {\n      // name is required\n      if (!this.name) {\n        return false;\n      }\n      return true;\n    }\n\n    getValue() {\n      return this.layer._map.getSize().y;\n    }\n  }\n\n  class LocationInput {\n    constructor(name, position, axis, units, min, max, rel, layer) {\n      this.name = name;\n      this.position = position;\n      this.axis = axis;\n      // if unit/cs not present, find it\n      if (!units && axis && !['i', 'j'].includes(axis)) {\n        this.units = M.axisToCS(axis).toLowerCase();\n      } else {\n        this.units = units; // cs\n      }\n      this.min = min;\n      this.max = max;\n      this.rel = rel;\n      this.layer = layer;\n    }\n\n    validateInput() {\n      // name is required\n      // axis is required\n      if (!this.name || !this.axis) {\n        return false;\n      }\n      // cs/units is only required when the axis is i/j. To differentiate between the units/cs\n      if (\n        (this.axis === 'i' || this.axis === 'j') &&\n        !['map', 'tile'].includes(this.units)\n      ) {\n        return false;\n      }\n      // check if axis match the units/cs\n      if (this.units) {\n        let axisCS = M.axisToCS(this.axis);\n        if (\n          typeof axisCS === 'string' &&\n          axisCS.toUpperCase() !== this.units.toUpperCase()\n        ) {\n          return false;\n        }\n      }\n      // position is not required, will default to top-left\n      // min max fallbacks, map-meta -> projection\n      // rel not required, default is image/extent\n      return true;\n    }\n\n    _TCRSToPCRS(coords, zoom) {\n      // TCRS pixel point to Projected CRS point (in meters, presumably)\n      var map = this.layer._map,\n        crs = map.options.crs,\n        loc = crs.transformation.untransform(coords, crs.scale(zoom));\n      return loc;\n    }\n\n    getValue(zoom = undefined, bounds = undefined) {\n      // units = cs\n      //<input name=\"...\" units=\"pcrs\" type=\"location\" position=\"top|bottom-left|right\" axis=\"northing|easting|latitude|longitude\">\n      if (zoom === undefined) zoom = this.layer._map.getZoom();\n      if (bounds === undefined) bounds = this.layer._map.getPixelBounds();\n\n      if (this.units === 'pcrs' || this.units === 'gcrs') {\n        switch (this.axis) {\n          case 'longitude':\n          case 'easting':\n            if (this.position) {\n              if (this.position.match(/.*?-left/i)) {\n                return this._TCRSToPCRS(bounds.min, zoom).x;\n              } else if (this.position.match(/.*?-right/i)) {\n                return this._TCRSToPCRS(bounds.max, zoom).x;\n              }\n            } else {\n              // position is not required, will default to top-left\n              return this._TCRSToPCRS(bounds.min, zoom).x;\n            }\n            break;\n          case 'latitude':\n          case 'northing':\n            if (this.position) {\n              if (this.position.match(/top-.*?/i)) {\n                return this._TCRSToPCRS(bounds.min, zoom).y;\n              } else if (this.position.match(/bottom-.*?/i)) {\n                return this._TCRSToPCRS(bounds.max, zoom).y;\n              }\n            } else {\n              // position is not required, will default to top-left\n              return this._TCRSToPCRS(bounds.min, zoom).y;\n            }\n            break;\n        }\n      } else if (this.units === 'tilematrix') {\n        // Value is retrieved from the createTile method of TemplatedTileLayer, on move end.\n        // Different values for each tile when filling in the map tiles on the map.\n        // Currently storing all x,y,z within one object,\n        // TODO: change return value as needed based on usage by map-input\n        // https://github.com/Leaflet/Leaflet/blob/6994baf25f267db1c8b720c28a61e0700d0aa0e8/src/layer/tile/GridLayer.js#L652\n        const center = this.layer._map.getCenter();\n        const templatedTileLayer = this.layer._extentLayer._templates[0].layer;\n        const pixelBounds = templatedTileLayer._getTiledPixelBounds(center);\n        const tileRange = templatedTileLayer._pxBoundsToTileRange(pixelBounds);\n        let obj = [];\n        for (let j = tileRange.min.y; j <= tileRange.max.y; j++) {\n          for (let i = tileRange.min.x; i <= tileRange.max.x; i++) {\n            const coords = new L.Point(i, j);\n            coords.z = templatedTileLayer._tileZoom;\n            obj.push(coords);\n          }\n        }\n        return obj;\n      } else if (this.units === 'tile' || this.units === 'map') ;\n      return;\n    }\n  }\n\n  class DOMTokenList {\n    /* jshint ignore:start */\n    #element; // create element as a private property\n    #valueSet; // needed to prevent infinite recursive calls to CE setAttribute\n    #attribute; // the name of the attribute that will be a DOMTokenList\n    #domain; // the domain of token values supported by this attribute\n    /* jshint ignore:end */\n    constructor(initialValue, element, attribute, domain) {\n      // create donor/host div to extract DomTokenList from\n      const hostingElement = document.createElement('div');\n      this.domtokenlist = hostingElement.classList;\n\n      // to check if value is being set, protects from infinite recursion\n      // from attributeChangedCallback of mapml-viewer and web-map\n      this.#valueSet = false; // jshint ignore:line\n      this.domtokenlist.value = initialValue ?? '';\n      this.#element = element; // jshint ignore:line\n      this.#attribute = attribute; // jshint ignore:line\n      this.#domain = domain; // jshint ignore:line\n    }\n\n    get valueSet() {\n      return this.#valueSet; // jshint ignore:line\n    }\n\n    get length() {\n      return this.domtokenlist.length;\n    }\n\n    get value() {\n      return this.domtokenlist.value;\n    }\n    set value(val) {\n      if (val === null) {\n        // when attribute is being removed\n        this.domtokenlist.value = '';\n      } else {\n        this.domtokenlist.value = val.toLowerCase();\n        /* jshint ignore:start */\n        this.#valueSet = true;\n        this.#element.setAttribute(this.#attribute, this.domtokenlist.value);\n        this.#valueSet = false;\n        /* jshint ignore:end */\n      }\n    }\n\n    item(index) {\n      return this.domtokenlist.item(index);\n    }\n\n    contains(token) {\n      return this.domtokenlist.contains(token);\n    }\n\n    // Modified default behavior\n    add(token) {\n      this.domtokenlist.add(token);\n      this.#element.setAttribute(this.#attribute, this.domtokenlist.value); // jshint ignore:line\n    }\n\n    // Modified default behavior\n    remove(token) {\n      this.domtokenlist.remove(token);\n      this.#element.setAttribute(this.#attribute, this.domtokenlist.value); // jshint ignore:line\n    }\n\n    // Modified default behavior\n    replace(oldToken, newToken) {\n      this.domtokenlist.replace(oldToken, newToken);\n      this.#element.setAttribute(this.#attribute, this.domtokenlist.value); // jshint ignore:line\n    }\n\n    // Modified default behavior\n    supports(token) {\n      /* jshint ignore:start */\n      if (this.#domain.includes(token)) {\n        return true;\n      } else {\n        return false;\n      }\n      /* jshint ignore:end */\n    }\n\n    // Modified default behavior\n    //https://developer.mozilla.org/en-US/docs/Web/API/DOMTokenList/toggle\n    toggle(token, force) {\n      this.domtokenlist.toggle(token, force);\n      this.#element.setAttribute(this.#attribute, this.domtokenlist.value); // jshint ignore:line\n    }\n\n    entries() {\n      return this.domtokenlist.entries();\n    }\n\n    //https://developer.mozilla.org/en-US/docs/Web/API/DOMTokenList/forEach\n    forEach(callback, thisArg) {\n      this.domtokenlist.forEach(callback, thisArg);\n    }\n\n    //https://developer.mozilla.org/en-US/docs/Web/API/DOMTokenList/keys\n    keys() {\n      return this.domtokenlist.keys();\n    }\n\n    //https://developer.mozilla.org/en-US/docs/Web/API/DOMTokenList/values\n    values() {\n      return this.domtokenlist.values();\n    }\n  }\n\n  /*\n   * Copyright 2015-2016 Canada Centre for Mapping and Earth Observation,\n   * Earth Sciences Sector, Natural Resources Canada.\n   *\n   * License\n   *\n   * By obtaining and/or copying this work, you (the licensee) agree that you have\n   * read, understood, and will comply with the following terms and conditions.\n   *\n   * Permission to copy, modify, and distribute this work, with or without\n   * modification, for any purpose and without fee or royalty is hereby granted,\n   * provided that you include the following on ALL copies of the work or portions\n   * thereof, including modifications:\n   *\n   * The full text of this NOTICE in a location viewable to users of the\n   * redistributed or derivative work.\n   *\n   * Any pre-existing intellectual property disclaimers, notices, or terms and\n   * conditions. If none exist, the W3C Software and Document Short Notice should\n   * be included.\n   *\n   * Notice of any changes or modifications, through a copyright statement on the\n   * new code or document such as \"This software or document includes material\n   * copied from or derived from [title and URI of the W3C document].\n   * Copyright  [YEAR] W3C (MIT, ERCIM, Keio, Beihang).\"\n   *\n   * Disclaimers\n   *\n   * THIS WORK IS PROVIDED \"AS IS,\" AND COPYRIGHT HOLDERS MAKE NO REPRESENTATIONS\n   * OR WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO, WARRANTIES OF\n   * MERCHANTABILITY OR FITNESS FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF THE\n   * SOFTWARE OR DOCUMENT WILL NOT INFRINGE ANY THIRD PARTY PATENTS, COPYRIGHTS,\n   * TRADEMARKS OR OTHER RIGHTS.\n   * COPYRIGHT HOLDERS WILL NOT BE LIABLE FOR ANY DIRECT, INDIRECT, SPECIAL OR\n   * CONSEQUENTIAL DAMAGES ARISING OUT OF ANY USE OF THE SOFTWARE OR DOCUMENT.\n   *\n   * The name and trademarks of copyright holders may NOT be used in advertising or\n   * publicity pertaining to the work without specific, written prior permission.\n   * Title to copyright in this work will at all times remain with copyright holders.\n   */\n\n  /* global L, Node */\n  (function (window, document, undefined$1) {\n    var M = {};\n    window.M = M;\n\n    (function () {\n      M.detectImagePath = function (container) {\n        // this relies on the CSS style leaflet-default-icon-path containing a\n        // relative url() that leads to a valid icon file.  Since that depends on\n        // how all of this stuff is deployed (i.e. custom element or as leaflet-plugin)\n        // also, because we're using 'shady DOM' api, the container must be\n        // a shady dom container, because the custom element tags it with added\n        // style-scope ... and related classes.\n        var el = L.DomUtil.create('div', 'leaflet-default-icon-path', container);\n        var path =\n          L.DomUtil.getStyle(el, 'background-image') ||\n          L.DomUtil.getStyle(el, 'backgroundImage'); // IE8\n\n        container.removeChild(el);\n\n        if (path === null || path.indexOf('url') !== 0) {\n          path = '';\n        } else {\n          path = path\n            .replace(/^url\\([\"']?/, '')\n            .replace(/marker-icon\\.png[\"']?\\)$/, '');\n        }\n\n        return path;\n      };\n      M.mime = 'text/mapml';\n\n      let mapOptions = window.document.head.querySelector('map-options');\n      M.options = Options;\n      if (mapOptions)\n        M.options = Object.assign(M.options, JSON.parse(mapOptions.innerHTML));\n\n      // see https://leafletjs.com/reference-1.5.0.html#crs-l-crs-base\n      // \"new classes can't inherit from (L.CRS), and methods can't be added\n      // to (L.CRS.anything) with the include function\n      // so we'll use the options property as a way to integrate needed\n      // properties and methods...\n      M.WGS84 = new L.Proj.CRS(\n        'EPSG:4326',\n        '+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs ',\n        {\n          origin: [-180, +90],\n          bounds: L.bounds([\n            [-180, -90],\n            [180, 90]\n          ]),\n          resolutions: [\n            0.703125, 0.3515625, 0.17578125, 0.087890625, 0.0439453125,\n            0.02197265625, 0.010986328125, 0.0054931640625, 0.00274658203125,\n            0.001373291015625, 0.0006866455078125, 0.0003433227539062,\n            0.0001716613769531, 0.0000858306884766, 0.0000429153442383,\n            0.0000214576721191, 0.0000107288360596, 0.0000053644180298,\n            0.0000026822090149, 0.0000013411045074, 0.0000006705522537,\n            0.0000003352761269\n          ],\n          crs: {\n            tcrs: {\n              horizontal: {\n                name: 'x',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.WGS84.options.bounds.getSize().x /\n                      M.WGS84.options.resolutions[zoom]\n                  )\n              },\n              vertical: {\n                name: 'y',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.WGS84.options.bounds.getSize().y /\n                      M.WGS84.options.resolutions[zoom]\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [\n                    M.WGS84.options.crs.tcrs.horizontal.min,\n                    M.WGS84.options.crs.tcrs.vertical.min\n                  ],\n                  [\n                    M.WGS84.options.crs.tcrs.horizontal.max(zoom),\n                    M.WGS84.options.crs.tcrs.vertical.max(zoom)\n                  ]\n                )\n            },\n            pcrs: {\n              horizontal: {\n                name: 'longitude',\n                get min() {\n                  return M.WGS84.options.crs.gcrs.horizontal.min;\n                },\n                get max() {\n                  return M.WGS84.options.crs.gcrs.horizontal.max;\n                }\n              },\n              vertical: {\n                name: 'latitude',\n                get min() {\n                  return M.WGS84.options.crs.gcrs.vertical.min;\n                },\n                get max() {\n                  return M.WGS84.options.crs.gcrs.vertical.max;\n                }\n              },\n              get bounds() {\n                return M.WGS84.options.bounds;\n              }\n            },\n            gcrs: {\n              horizontal: {\n                name: 'longitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: -180.0,\n                max: 180.0\n              },\n              vertical: {\n                name: 'latitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: -90.0,\n                max: 90.0\n              },\n              get bounds() {\n                return L.latLngBounds(\n                  [\n                    M.WGS84.options.crs.gcrs.vertical.min,\n                    M.WGS84.options.crs.gcrs.horizontal.min\n                  ],\n                  [\n                    M.WGS84.options.crs.gcrs.vertical.max,\n                    M.WGS84.options.crs.gcrs.horizontal.max\n                  ]\n                );\n              }\n            },\n            map: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: (map) => map.getSize().x\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: (map) => map.getSize().y\n              },\n              bounds: (map) => L.bounds(L.point([0, 0]), map.getSize())\n            },\n            tile: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: 256\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: 256\n              },\n              get bounds() {\n                return L.bounds(\n                  [\n                    M.WGS84.options.crs.tile.horizontal.min,\n                    M.WGS84.options.crs.tile.vertical.min\n                  ],\n                  [\n                    M.WGS84.options.crs.tile.horizontal.max,\n                    M.WGS84.options.crs.tile.vertical.max\n                  ]\n                );\n              }\n            },\n            tilematrix: {\n              horizontal: {\n                name: 'column',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.WGS84.options.crs.tcrs.horizontal.max(zoom) /\n                      M.WGS84.options.crs.tile.bounds.getSize().x\n                  )\n              },\n              vertical: {\n                name: 'row',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.WGS84.options.crs.tcrs.vertical.max(zoom) /\n                      M.WGS84.options.crs.tile.bounds.getSize().y\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [\n                    M.WGS84.options.crs.tilematrix.horizontal.min,\n                    M.WGS84.options.crs.tilematrix.vertical.min\n                  ],\n                  [\n                    M.WGS84.options.crs.tilematrix.horizontal.max(zoom),\n                    M.WGS84.options.crs.tilematrix.vertical.max(zoom)\n                  ]\n                )\n            }\n          }\n        }\n      );\n      M.CBMTILE = new L.Proj.CRS(\n        'EPSG:3978',\n        '+proj=lcc +lat_1=49 +lat_2=77 +lat_0=49 +lon_0=-95 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs',\n        {\n          origin: [-34655800, 39310000],\n          bounds: L.bounds([\n            [-34655800, -39000000],\n            [10000000, 39310000]\n          ]),\n          resolutions: [\n            38364.660062653464, 22489.62831258996, 13229.193125052918,\n            7937.5158750317505, 4630.2175937685215, 2645.8386250105837,\n            1587.5031750063501, 926.0435187537042, 529.1677250021168,\n            317.50063500127004, 185.20870375074085, 111.12522225044451,\n            66.1459656252646, 38.36466006265346, 22.48962831258996,\n            13.229193125052918, 7.9375158750317505, 4.6302175937685215,\n            2.6458386250105836, 1.5875031750063502, 0.92604351875370428,\n            0.52916772500211673, 0.31750063500127002, 0.18520870375074083,\n            0.11112522225044451, 0.066145965625264591\n          ],\n          crs: {\n            tcrs: {\n              horizontal: {\n                name: 'x',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.CBMTILE.options.bounds.getSize().x /\n                      M.CBMTILE.options.resolutions[zoom]\n                  )\n              },\n              vertical: {\n                name: 'y',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.CBMTILE.options.bounds.getSize().y /\n                      M.CBMTILE.options.resolutions[zoom]\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [\n                    M.CBMTILE.options.crs.tcrs.horizontal.min,\n                    M.CBMTILE.options.crs.tcrs.vertical.min\n                  ],\n                  [\n                    M.CBMTILE.options.crs.tcrs.horizontal.max(zoom),\n                    M.CBMTILE.options.crs.tcrs.vertical.max(zoom)\n                  ]\n                )\n            },\n            pcrs: {\n              horizontal: {\n                name: 'easting',\n                get min() {\n                  return M.CBMTILE.options.bounds.min.x;\n                },\n                get max() {\n                  return M.CBMTILE.options.bounds.max.x;\n                }\n              },\n              vertical: {\n                name: 'northing',\n                get min() {\n                  return M.CBMTILE.options.bounds.min.y;\n                },\n                get max() {\n                  return M.CBMTILE.options.bounds.max.y;\n                }\n              },\n              get bounds() {\n                return M.CBMTILE.options.bounds;\n              }\n            },\n            gcrs: {\n              horizontal: {\n                name: 'longitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: -141.01,\n                max: -47.74\n              },\n              vertical: {\n                name: 'latitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: 40.04,\n                max: 86.46\n              },\n              get bounds() {\n                return L.latLngBounds(\n                  [\n                    M.CBMTILE.options.crs.gcrs.vertical.min,\n                    M.CBMTILE.options.crs.gcrs.horizontal.min\n                  ],\n                  [\n                    M.CBMTILE.options.crs.gcrs.vertical.max,\n                    M.CBMTILE.options.crs.gcrs.horizontal.max\n                  ]\n                );\n              }\n            },\n            map: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: (map) => map.getSize().x\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: (map) => map.getSize().y\n              },\n              bounds: (map) => L.bounds(L.point([0, 0]), map.getSize())\n            },\n            tile: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: 256\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: 256\n              },\n              get bounds() {\n                return L.bounds(\n                  [\n                    M.CBMTILE.options.crs.tile.horizontal.min,\n                    M.CBMTILE.options.crs.tile.vertical.min\n                  ],\n                  [\n                    M.CBMTILE.options.crs.tile.horizontal.max,\n                    M.CBMTILE.options.crs.tile.vertical.max\n                  ]\n                );\n              }\n            },\n            tilematrix: {\n              horizontal: {\n                name: 'column',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.CBMTILE.options.crs.tcrs.horizontal.max(zoom) /\n                      M.CBMTILE.options.crs.tile.bounds.getSize().x\n                  )\n              },\n              vertical: {\n                name: 'row',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.CBMTILE.options.crs.tcrs.vertical.max(zoom) /\n                      M.CBMTILE.options.crs.tile.bounds.getSize().y\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [0, 0],\n                  [\n                    M.CBMTILE.options.crs.tilematrix.horizontal.max(zoom),\n                    M.CBMTILE.options.crs.tilematrix.vertical.max(zoom)\n                  ]\n                )\n            }\n          }\n        }\n      );\n      M.APSTILE = new L.Proj.CRS(\n        'EPSG:5936',\n        '+proj=stere +lat_0=90 +lat_ts=50 +lon_0=-150 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m +no_defs',\n        {\n          origin: [-2.8567784109255e7, 3.2567784109255e7],\n          bounds: L.bounds([\n            [-28567784.109254867, -28567784.109254755],\n            [32567784.109255023, 32567784.10925506]\n          ]),\n          resolutions: [\n            238810.813354, 119405.406677, 59702.7033384999, 29851.3516692501,\n            14925.675834625, 7462.83791731252, 3731.41895865639, 1865.70947932806,\n            932.854739664032, 466.427369832148, 233.213684916074,\n            116.606842458037, 58.3034212288862, 29.1517106145754,\n            14.5758553072877, 7.28792765351156, 3.64396382688807,\n            1.82198191331174, 0.910990956788164, 0.45549547826179\n          ],\n          crs: {\n            tcrs: {\n              horizontal: {\n                name: 'x',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.APSTILE.options.bounds.getSize().x /\n                      M.APSTILE.options.resolutions[zoom]\n                  )\n              },\n              vertical: {\n                name: 'y',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.APSTILE.options.bounds.getSize().y /\n                      M.APSTILE.options.resolutions[zoom]\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [\n                    M.APSTILE.options.crs.tcrs.horizontal.min,\n                    M.APSTILE.options.crs.tcrs.vertical.min\n                  ],\n                  [\n                    M.APSTILE.options.crs.tcrs.horizontal.max(zoom),\n                    M.APSTILE.options.crs.tcrs.vertical.max(zoom)\n                  ]\n                )\n            },\n            pcrs: {\n              horizontal: {\n                name: 'easting',\n                get min() {\n                  return M.APSTILE.options.bounds.min.x;\n                },\n                get max() {\n                  return M.APSTILE.options.bounds.max.x;\n                }\n              },\n              vertical: {\n                name: 'northing',\n                get min() {\n                  return M.APSTILE.options.bounds.min.y;\n                },\n                get max() {\n                  return M.APSTILE.options.bounds.max.y;\n                }\n              },\n              get bounds() {\n                return M.APSTILE.options.bounds;\n              }\n            },\n            gcrs: {\n              horizontal: {\n                name: 'longitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: -180.0,\n                max: 180.0\n              },\n              vertical: {\n                name: 'latitude',\n                // set min/max axis values from EPSG registry area of use, retrieved 2019-07-25\n                min: 60.0,\n                max: 90.0\n              },\n              get bounds() {\n                return L.latLngBounds(\n                  [\n                    M.APSTILE.options.crs.gcrs.vertical.min,\n                    M.APSTILE.options.crs.gcrs.horizontal.min\n                  ],\n                  [\n                    M.APSTILE.options.crs.gcrs.vertical.max,\n                    M.APSTILE.options.crs.gcrs.horizontal.max\n                  ]\n                );\n              }\n            },\n            map: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: (map) => map.getSize().x\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: (map) => map.getSize().y\n              },\n              bounds: (map) => L.bounds(L.point([0, 0]), map.getSize())\n            },\n            tile: {\n              horizontal: {\n                name: 'i',\n                min: 0,\n                max: 256\n              },\n              vertical: {\n                name: 'j',\n                min: 0,\n                max: 256\n              },\n              get bounds() {\n                return L.bounds(\n                  [\n                    M.APSTILE.options.crs.tile.horizontal.min,\n                    M.APSTILE.options.crs.tile.vertical.min\n                  ],\n                  [\n                    M.APSTILE.options.crs.tile.horizontal.max,\n                    M.APSTILE.options.crs.tile.vertical.max\n                  ]\n                );\n              }\n            },\n            tilematrix: {\n              horizontal: {\n                name: 'column',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.APSTILE.options.crs.tcrs.horizontal.max(zoom) /\n                      M.APSTILE.options.crs.tile.bounds.getSize().x\n                  )\n              },\n              vertical: {\n                name: 'row',\n                min: 0,\n                max: (zoom) =>\n                  Math.round(\n                    M.APSTILE.options.crs.tcrs.vertical.max(zoom) /\n                      M.APSTILE.options.crs.tile.bounds.getSize().y\n                  )\n              },\n              bounds: (zoom) =>\n                L.bounds(\n                  [0, 0],\n                  [\n                    M.APSTILE.options.crs.tilematrix.horizontal.max(zoom),\n                    M.APSTILE.options.crs.tilematrix.vertical.max(zoom)\n                  ]\n                )\n            }\n          }\n        }\n      );\n      M.OSMTILE = L.CRS.EPSG3857;\n      L.setOptions(M.OSMTILE, {\n        origin: [-20037508.342787, 20037508.342787],\n        bounds: L.bounds([\n          [-20037508.342787, -20037508.342787],\n          [20037508.342787, 20037508.342787]\n        ]),\n        resolutions: [\n          156543.0339, 78271.51695, 39135.758475, 19567.8792375, 9783.93961875,\n          4891.969809375, 2445.9849046875, 1222.9924523438, 611.49622617188,\n          305.74811308594, 152.87405654297, 76.437028271484, 38.218514135742,\n          19.109257067871, 9.5546285339355, 4.7773142669678, 2.3886571334839,\n          1.1943285667419, 0.59716428337097, 0.29858214168549, 0.14929107084274,\n          0.074645535421371, 0.03732276771068573, 0.018661383855342865,\n          0.009330691927671432495\n        ],\n        crs: {\n          tcrs: {\n            horizontal: {\n              name: 'x',\n              min: 0,\n              max: (zoom) =>\n                Math.round(\n                  M.OSMTILE.options.bounds.getSize().x /\n                    M.OSMTILE.options.resolutions[zoom]\n                )\n            },\n            vertical: {\n              name: 'y',\n              min: 0,\n              max: (zoom) =>\n                Math.round(\n                  M.OSMTILE.options.bounds.getSize().y /\n                    M.OSMTILE.options.resolutions[zoom]\n                )\n            },\n            bounds: (zoom) =>\n              L.bounds(\n                [\n                  M.OSMTILE.options.crs.tcrs.horizontal.min,\n                  M.OSMTILE.options.crs.tcrs.vertical.min\n                ],\n                [\n                  M.OSMTILE.options.crs.tcrs.horizontal.max(zoom),\n                  M.OSMTILE.options.crs.tcrs.vertical.max(zoom)\n                ]\n              )\n          },\n          pcrs: {\n            horizontal: {\n              name: 'easting',\n              get min() {\n                return M.OSMTILE.options.bounds.min.x;\n              },\n              get max() {\n                return M.OSMTILE.options.bounds.max.x;\n              }\n            },\n            vertical: {\n              name: 'northing',\n              get min() {\n                return M.OSMTILE.options.bounds.min.y;\n              },\n              get max() {\n                return M.OSMTILE.options.bounds.max.y;\n              }\n            },\n            get bounds() {\n              return M.OSMTILE.options.bounds;\n            }\n          },\n          gcrs: {\n            horizontal: {\n              name: 'longitude',\n              get min() {\n                return M.OSMTILE.unproject(M.OSMTILE.options.bounds.min).lng;\n              },\n              get max() {\n                return M.OSMTILE.unproject(M.OSMTILE.options.bounds.max).lng;\n              }\n            },\n            vertical: {\n              name: 'latitude',\n              get min() {\n                return M.OSMTILE.unproject(M.OSMTILE.options.bounds.min).lat;\n              },\n              get max() {\n                return M.OSMTILE.unproject(M.OSMTILE.options.bounds.max).lat;\n              }\n            },\n            get bounds() {\n              return L.latLngBounds(\n                [\n                  M.OSMTILE.options.crs.gcrs.vertical.min,\n                  M.OSMTILE.options.crs.gcrs.horizontal.min\n                ],\n                [\n                  M.OSMTILE.options.crs.gcrs.vertical.max,\n                  M.OSMTILE.options.crs.gcrs.horizontal.max\n                ]\n              );\n            }\n          },\n          map: {\n            horizontal: {\n              name: 'i',\n              min: 0,\n              max: (map) => map.getSize().x\n            },\n            vertical: {\n              name: 'j',\n              min: 0,\n              max: (map) => map.getSize().y\n            },\n            bounds: (map) => L.bounds(L.point([0, 0]), map.getSize())\n          },\n          tile: {\n            horizontal: {\n              name: 'i',\n              min: 0,\n              max: 256\n            },\n            vertical: {\n              name: 'j',\n              min: 0,\n              max: 256\n            },\n            get bounds() {\n              return L.bounds(\n                [\n                  M.OSMTILE.options.crs.tile.horizontal.min,\n                  M.OSMTILE.options.crs.tile.vertical.min\n                ],\n                [\n                  M.OSMTILE.options.crs.tile.horizontal.max,\n                  M.OSMTILE.options.crs.tile.vertical.max\n                ]\n              );\n            }\n          },\n          tilematrix: {\n            horizontal: {\n              name: 'column',\n              min: 0,\n              max: (zoom) =>\n                Math.round(\n                  M.OSMTILE.options.crs.tcrs.horizontal.max(zoom) /\n                    M.OSMTILE.options.crs.tile.bounds.getSize().x\n                )\n            },\n            vertical: {\n              name: 'row',\n              min: 0,\n              max: (zoom) =>\n                Math.round(\n                  M.OSMTILE.options.crs.tcrs.vertical.max(zoom) /\n                    M.OSMTILE.options.crs.tile.bounds.getSize().y\n                )\n            },\n            bounds: (zoom) =>\n              L.bounds(\n                [0, 0],\n                [\n                  M.OSMTILE.options.crs.tilematrix.horizontal.max(zoom),\n                  M.OSMTILE.options.crs.tilematrix.vertical.max(zoom)\n                ]\n              )\n          }\n        }\n      });\n    })();\n\n    M._handleLink = Util._handleLink;\n    M.convertPCRSBounds = Util.convertPCRSBounds;\n    M.axisToXY = Util.axisToXY;\n    M.csToAxes = Util.csToAxes;\n    M._convertAndFormatPCRS = Util._convertAndFormatPCRS;\n    M.extentToBounds = Util.extentToBounds;\n    M.axisToCS = Util.axisToCS;\n    M._parseNumber = Util._parseNumber;\n    M._splitCoordinate = Util._splitCoordinate;\n    M.boundsToPCRSBounds = Util.boundsToPCRSBounds;\n    M.pixelToPCRSBounds = Util.pixelToPCRSBounds;\n    M._metaContentToObject = Util._metaContentToObject;\n    M._coordsToArray = Util._coordsToArray;\n    M.pointToPCRSPoint = Util.pointToPCRSPoint;\n    M.pixelToPCRSPoint = Util.pixelToPCRSPoint;\n    M._gcrsToTileMatrix = Util._gcrsToTileMatrix;\n    M._pasteLayer = Util._pasteLayer;\n    M._properties2Table = Util._properties2Table;\n    M._updateExtent = Util._updateExtent;\n    M.geojson2mapml = Util.geojson2mapml;\n    M._breakArray = Util._breakArray;\n    M._table2properties = Util._table2properties;\n    M._geometry2geojson = Util._geometry2geojson;\n    M._pcrsToGcrs = Util._pcrsToGcrs;\n    M.mapml2geojson = Util.mapml2geojson;\n    M.getMaxZoom = Util.getMaxZoom;\n    M.getBoundsFromMeta = Util.getBoundsFromMeta;\n    M.getZoomBoundsFromMeta = Util.getZoomBoundsFromMeta;\n    M.getZoomBounds = Util.getZoomBounds;\n    M.getNativeVariables = Util.getNativeVariables;\n    M.getClosest = Util.getClosest;\n\n    M.QueryHandler = QueryHandler;\n    M.ContextMenu = ContextMenu;\n    M.AnnounceMovement = AnnounceMovement;\n    M.FeatureIndex = FeatureIndex;\n\n    // see https://leafletjs.com/examples/extending/extending-3-controls.html#handlers\n    L.Map.addInitHook('addHandler', 'query', M.QueryHandler);\n    L.Map.addInitHook('addHandler', 'contextMenu', M.ContextMenu);\n    L.Map.addInitHook('addHandler', 'announceMovement', M.AnnounceMovement);\n    L.Map.addInitHook('addHandler', 'featureIndex', M.FeatureIndex);\n\n    M.MapMLLayer = MapMLLayer;\n    M.mapMLLayer = mapMLLayer;\n\n    M.ImageLayer = ImageLayer;\n    M.imageLayer = imageLayer;\n\n    M.TemplatedImageLayer = TemplatedImageLayer;\n    M.templatedImageLayer = templatedImageLayer;\n\n    M.TemplatedFeaturesLayer = TemplatedFeaturesLayer;\n    M.templatedFeaturesLayer = templatedFeaturesLayer;\n\n    M.ExtentLayer = ExtentLayer;\n    M.extentLayer = extentLayer;\n\n    M.TemplatedTileLayer = TemplatedTileLayer;\n    M.templatedTileLayer = templatedTileLayer;\n\n    M.FeatureLayer = FeatureLayer;\n    M.featureLayer = featureLayer;\n\n    M.LayerControl = LayerControl;\n    M.layerControl = layerControl;\n\n    M.AttributionButton = AttributionButton;\n    M.attributionButton = attributionButton;\n\n    M.ReloadButton = ReloadButton;\n    M.reloadButton = reloadButton;\n\n    M.ScaleBar = ScaleBar;\n    M.scaleBar = scaleBar;\n\n    M.FullscreenButton = FullscreenButton;\n    M.fullscreenButton = fullscreenButton;\n\n    M.geolocationButton = geolocationButton;\n\n    M.StaticTileLayer = StaticTileLayer;\n    M.staticTileLayer = staticTileLayer;\n\n    M.DebugOverlay = DebugOverlay;\n    M.debugOverlay = debugOverlay;\n\n    M.Crosshair = Crosshair;\n    M.crosshair = crosshair;\n\n    M.FeatureIndexOverlay = FeatureIndexOverlay;\n    M.featureIndexOverlay = featureIndexOverlay;\n\n    M.Path = Path;\n    M.path = path;\n\n    M.FeatureRenderer = FeatureRenderer;\n    M.featureRenderer = featureRenderer;\n\n    M.Geometry = Geometry;\n    M.geometry = geometry;\n\n    // element support\n    M._createLayerControlExtentHTML = createLayerControlExtentHTML;\n    M._createLayerControlHTML = createLayerControlHTML;\n    M.ZoomInput = ZoomInput;\n    M.HiddenInput = HiddenInput;\n    M.WidthInput = WidthInput;\n    M.HeightInput = HeightInput;\n    M.LocationInput = LocationInput;\n\n    // constants\n    M.TILE_SIZE = 256;\n    M.FALLBACK_PROJECTION = 'OSMTILE';\n    M.FALLBACK_CS = 'TILEMATRIX';\n    M.BLANK_TT_TREF = 'mapmltemplatedtileplaceholder';\n\n    M.DOMTokenList = DOMTokenList;\n    M.protomapsL = protomapsL;\n    M.templatedPMTilesLayer = templatedPMTilesLayer;\n    M.TemplatedPMTilesLayer = TemplatedPMTilesLayer;\n  })(window);\n\n})();\n"],"names":["staticTileLayer","options","StaticTileLayer","layerControl","layers","LayerControl","featureLayer","mapml","FeatureLayer","templatedTileLayer","template","TemplatedTileLayer","extentLayer","ExtentLayer","templatedFeaturesLayer","TemplatedFeaturesLayer","templatedImageLayer","TemplatedImageLayer","L","GridLayer","extend","initialize","setOptions","this","zoomBounds","_getZoomBounds","tileContainer","maxZoomBound","_groups","_groupTiles","getElementsByTagName","_bounds","_getLayerBounds","projection","layerBounds","Object","keys","let","key","min","max","onAdd","map","_map","prototype","call","_handleMoveEnd","getEvents","events","_parentOnMoveEnd","moveend","move","isVisible","mapZoom","getZoom","zoomLevel","maxNativeZoom","minNativeZoom","maxZoom","minZoom","overlaps","M","pixelToPCRSBounds","getPixelBounds","e","_isValidTile","coords","_tileCoordsToKey","createTile","tileGroup","tileElem","document","createElement","tileSize","getTileSize","setAttribute","x","y","z","i","length","tile","width","height","alt","src","appendChild","tileGroups","crs","bounds","sCoords","split","pixelCoords","point","pixelBounds","zoom","container","meta","_metaContentToObject","_leafletLayer","_layerEl","querySelector","getAttribute","tiles","nativeZoom","value","lZoom","Math","tileMap","row","col","tileCode","push","Control","Layers","autoZIndex","sortLayers","sortFunction","layerA","layerB","zIndex","overlays","_layerControlInputs","_layers","_lastZIndex","_handlingClick","_addLayer","_initLayout","DomEvent","on","_container","_focusFirstLayer","_preventDefaultContextMenu","_update","_showControls","onRemove","off","addOrUpdateOverlay","layer","name","alreadyThere","addOverlay","removeAttribute","removeLayer","_checkDisabledLayers","elem","className","children","setTimeout","focus","DomUtil","empty","_baseLayersList","_overlaysList","baseLayersPresent","overlaysPresent","obj","baseLayersCount","sort","a","b","_addItem","overlay","hideSingleBase","style","display","_separator","layercontrols","_layerControlHTML","input","layerId","stamp","collapse","includes","contextMenu","_extentLayerMenu","hidden","_layerMenu","target","tagName","relatedTarget","parentElement","removeClass","originalEvent","pointerType","_isExpanded","latlng","mouseEventToLatLng","containerPoint","mouseEventToContainerPoint","preventDefault","fire","FeatureGroup","query","create","pane","addClass","renderer","_queryFeatures","features","_features","_staticFeature","mapEl","withinZoom","_validateRendering","showPaginationFeature","addLayer","layerToAdd","featureZoom","mapmlFeature","addRendering","featureToAdd","remove","featureIndex","cleanIndex","featureToRemove","_leaflet_id","_removeFromFeaturesList","id","removeRendering","feature","splice","zoomend","_handleZoomEnd","_linkEl","shadowRoot","replaceChildren","clearLayers","addFeature","popup","_navigationBar","innerText","_totalFeatureCount","_content","srcdoc","innerHTML","currFeature","once","_removeCSS","hasLayer","k","geometry","renderable","_checkRender","placeholder","defaultOptions","group","parentNode","replaceWith","insertAdjacentElement","_setZoomTransform","center","clampZoom","scale","getZoomScale","translate","multiplyBy","subtract","_getNewPixelOrigin","round","any3d","setTransform","setPosition","createGeometry","fallbackCS","tileZoom","assign","filter","classList","title","properties","add","insertAdjacentHTML","cs","extentToBounds","extent","_geometryToLayer","color","hasAttribute","resetStyle","onEachFeature","bindTooltip","interactive","sticky","toUpperCase","_groupEl","Util","_setLayerStyle","setStyle","eachLayer","toDelete","querySelectorAll","removeChild","vectorOptions","svgGroup","SVG","copyOptions","_featureEl","geo","path","nativeCS","featureID","wrappers","_getGeometryParents","groupOptions","accessibleTitle","collections","subType","elems","concat","TileLayer","tms","_setUpTileTemplateVars","linkEl","extentBounds","_template","_initContainer","child","getMapEl","mapBounds","_updateZIndex","dispatchEvent","CustomEvent","detail","appendTile","type","startsWith","_url","BLANK_TT_TREF","_fetchTile","_mapmlTileReady","getPane","url","getTileUrl","fetch","redirect","then","response","status","Promise","resolve","console","log","reject","text","DOMParser","parseFromString","_createFeatures","catch","_parseStylesheetAsHTML","base","Element","URL","href","styleElm","ss","stylesheets","nodeName","linkElm","copyAttributes","textContent","s","source","Array","from","attributes","forEach","attribute","nodeValue","markup","svg","g","xOffset","yOffset","tileFeatures","fallback","getNativeVariables","FeatureRenderer","_initPath","_project","_addPath","_updateFeature","toString","tilematrix","contains","v","zoomInput","_getZoomForUrl","pcrs","easting","left","_tileMatrixToPCRSPosition","right","northing","top","bottom","indexOf","infinite","invertedY","_globalTileRange","r","detectRetina","Browser","retina","pos","nwPoint","scaleBy","sePoint","centrePoint","floor","nw","transformation","untransform","se","cen","result","Point","east","north","inputs","values","units","axis","position","select","toLowerCase","horizontal","resolutions","isNaN","Number","parseFloat","vertical","match","parsedselect","htmlselect","pcrs2tilematrix","c","transform","divideBy","bind","initialValue","boundsToPCRSBounds","axisToCS","pcrsBounds","zmin","zmax","_clampZoom","clamp","step","LayerGroup","_extentEl","extentEl","changeOpacity","opacity","zoomstart","_onZoomStart","closePopup","getContainer","parentLayer","_layer","redraw","setZIndex","undefined","_previousFeature","_count","_nextFeature","_source","_opacity","_opacitySlider","appendStyleLink","mapLink","link","positionAndNode","_getStylePositionAndNode","node","lastChild","appendStyleElement","mapStyle","styleElement","Layer","_setUpFeaturesTemplateVars","_onMoveEnd","addTo","featureRenderer","bindPopup","autoClose","minWidth","parent","history","_history","current","previous","steppedZoom","headers","parser","context","_pullFeatureFeed","scaleBounds","getCenter","_getfeaturesUrl","Headers","Accept","limit","frag","createDocumentFragment","elements","featuresReady","whenReady","allSettled","_updateTabIndex","error","layerNum","_path","childElementCount","getSize","_TCRSToPCRS","featuresVarNames","_setUpExtentTemplateVars","_clearLayer","_onAdd","containerImages","_addImage","loc","overlayToRemove","_imageOverlay","getImageUrl","size","imageLayer","_step","_overlayToRemove","_scaleImage","_image","_pixelOrigins","getPixelOrigin","pixelOrigin","extentVarNames","guard","low","high","clone","p","_add","sub","_sub","multByPoint","_multByPoint","divByPoint","_divByPoint","mult","_mult","div","_div","rotate","_rotate","rotateAround","_rotateAround","matMult","m","_matMult","unit","_unit","perp","_perp","_round","mag","sqrt","equals","other","dist","distSqr","dx","dy","angle","atan2","angleTo","angleWith","angleWithSep","cos","sin","constructor","convert","isArray","Error","ColorError","super","ColorError$1","parseToRgba","trim","normalizedColor","namedColorRegex","test","normalizedColorName","compressedColorMap","str","hash","charCodeAt","nameToHex","reducedHexMatch","reducedHexRegex","exec","arr","slice","parseInt","hexMatch","hexRegex","rgbaMatch","rgbaRegex","hslaMatch","hslaRegex","h","l","hslToRgb","colorToInt","replace","reduce","acc","next","substring","hex","prefix","amount","join","RegExp","roundColor","hue","saturation","lightness","huePrime","chroma","abs","secondComponent","red","green","blue","lightnessModification","finalRed","finalGreen","finalBlue","mix","color1","color2","weight","normalize","n","index","r1","g1","b1","a1","r2","g2","b2","a2","alphaDelta","normalizedWeight","weight2","weight1","alpha","toFixed","VectorTileFeature","pbf","end","_pbf","_geometry","_keys","_values","readFields","readFeature","loadGeometry","cmdLen","readVarint","lines","line","cmd","readSVarint","bbox","x1","Infinity","x2","y1","y2","toGeoJSON","pow","x0","y0","vtCoords","projectPoint","PI","atan","exp","projectLine","points","coordinates","polygon","rings","len","polygons","ccw","area","ring","sum","j","p1","p2","signedArea","classifyRings","tag","readTag","types","VectorTileLayer","version","readLayer","readString","readFloat","readDouble","readVarint64","readBoolean","readValueMessage","VectorTile","readTile","SHIFT_LEFT_32","SHIFT_RIGHT_32","utf8TextDecoder","TextDecoder","Pbf","buf","Uint8Array","ArrayBuffer","isView","dataView","DataView","buffer","readField","val","startPos","skip","readMessage","readFixed32","getUint32","readSFixed32","getInt32","readFixed64","readSFixed64","getFloat32","getFloat64","isSigned","toNum$1","readVarintRemainder$1","num","Boolean","decode","subarray","b0","bytesPerSequence","b3","String","fromCharCode","readUtf8","readBytes","readPackedVarint","readPackedEnd","readPackedSVarint","readPackedBoolean","readPackedFloat","readPackedDouble","readPackedFixed32","readPackedSFixed32","readPackedFixed64","readPackedSFixed64","writeTag","writeVarint","realloc","set","finish","writeFixed32","setInt32","writeSFixed32","writeFixed64","writeSFixed64","writeBigVarintLow","lsb","writeBigVarintHigh","writeBigVarint","writeSVarint","writeBoolean","writeString","lead","writeUtf8","makeRoomForExtraLength","writeFloat","setFloat32","writeDouble","setFloat64","writeBytes","writeRawMessage","fn","writeMessage","writePackedVarint","writePackedSVarint","writePackedBoolean","writePackedFloat","writePackedDouble","writePackedFixed32","writePackedSFixed32","writePackedFixed64","writePackedSFixed64","writeBytesField","writeFixed32Field","writeSFixed32Field","writeFixed64Field","writeSFixed64Field","writeVarintField","writeSVarintField","writeStringField","writeFloatField","writeDoubleField","writeBooleanField","extraLen","LN2","freb","eb","start","u16","i32","__pow$1","__async$1","__this","__arguments","generator","fulfilled","rejected","throw","done","apply","u8","Uint16Array","Int32Array","fleb","fdeb","clim","_a","fl","fd","rev","hMap","cd","mb","le","co","rvb","sv","r_1","flt","fdt","inflt","dat","st","dict","sl","dl","f","noBuf","noSt","cbuf","l2","bl","nbuf","final","bt","lm","dm","d","lbt","dbt","tbts","bits","shft","t","err","flrm","fdrm","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","bits16","dsym","shift2","dend","slc","gzs","flg","zs","gzl","zls","o","ec","ind","msg","nt","code","captureStackTrace","et","decompressSync","data","opts","out","dictionary","td","stream","shift","unshift","getUint24","view","getUint16","getUint8","getUint48","queryTile","offsetLen","queryView","offset","isDir","byteLength","cmp","tz","tx","ty","compare","entrySort","parseEntry","dataview","zRaw","sortDir","entries","createDirectory","entry","v2_default","getHeader","resp","getBytes","jsonSize","rootEntries","dec","jsonMetadata","JSON","parse","tileCompression","compression","minzoom","maxzoom","centerLon","centerLat","centerZoom","minLon","minLat","maxLon","maxLat","specVersion","rootDirectoryOffset","rootDirectoryLength","jsonMetadataOffset","jsonMetadataLength","leafDirectoryOffset","leafDirectoryLength","tileDataOffset","tileDataLength","numAddressedTiles","numTileEntries","numTileContents","clustered","internalCompression","tileType","etag","getZxy","header","cache","signal","rootDir","getArrayBuffer","tileData","leafcoords","numEntries","leafLevel","levelDiff","trunc","deriveLeaf","leafdirEntry","queryLeafdir","leafDir","tileEntry","toNum","readVarintRemainder","tzValues","defaultDecompress","globalThis","DecompressionStream","Response","body","pipeThrough","arrayBuffer","FetchSource","customHeaders","mustReload","getKey","setHeaders","passedSignal","controller","AbortController","requestHeaders","contentRange","get","actualLength","substr","range","newEtag","EtagMismatch","contentLength","abort","cacheControl","expires","getUint64","wh","wl","deserializeIndex","lastId","tileId","runLength","getHeaderAndRoot","decompress","warn","detectVersion","bytes","bytesToHeader","rootDirData","dirKey","SharedPromiseCache","maxCacheEntries","prefetch","Map","invalidations","counter","cacheKey","cacheValue","lastUsed","res","prune","getDirectory","directory","has","minUsed","minKey","delete","invalidate","PMTiles","getZxyAttempt","ry","xy","rx","zxyToTileId","dO","dL","depth","findTile","getMetadataAttempt","decompressed","getMetadata","quickselect","quickselectStep","newLeft","newRight","sd","swap","defaultCompare","tmp","RBush","maxEntries","_maxEntries","_minEntries","ceil","clear","all","_all","search","intersects","toBBox","nodesToSearch","childBBox","leaf","pop","collides","load","insert","_build","tmpNode","_splitRoot","_insert","item","createNode","equalsFn","indexes","goingUp","items","findItem","_condense","compareMinX","minX","compareMinY","minY","toJSON","fromJSON","N","calcBBox","N2","N1","multiSelect","right2","right3","_chooseSubtree","level","minArea","minEnlargement","targetNode","bboxArea","enlargement","maxX","maxY","isNode","insertPath","_split","_adjustParentBBoxes","_chooseSplitAxis","splitIndex","_chooseSplitIndex","newNode","minOverlap","bbox1","distBBox","bbox2","overlap","compareNodeMinX","compareNodeMinY","_allDistMargin","leftBBox","rightBBox","margin","bboxMargin","siblings","destNode","stack","mid","__defProp","defineProperty","__pow","__name","configurable","__async","step2","_StringAttr","defaultValue","perFeature","StringAttr","_NumberAttr","NumberAttr","_TextAttr","labelProps","textTransform","retval","property","hasOwnProperty","props","wordsArray","capsArray","word","TextAttr","_FontAttr","_b","font","family","fontFamily","fontSize","fontWeight","fontStyle","FontAttr","_ArrayAttr","ArrayAttr","linelabel","pts","maxAngleDelta","targetLen","chunks","abmag","bcmag","abx","aby","bcx","bcy","iStart","dStart","beginIndex","beginDistance","endIndex","endDistance","acos","simpleLabel","mls","minimum","repeatDistance","cellSize","candidates","ls","segment","normalized","lineCells","spacing","factor","linebreak","maxUnits","spaceBefore","lastIndexOf","spaceAfter","first","after","GeomType","GeomType2","toIndex","loadGeomAndBbox","geom","parseTile","loaded","numVertices","part","geomType","_PmtilesSource","shouldCancelZooms","zoomaborts","za","PmtilesSource","_ZxySource","ZxySource","R","MAX_LATITUDE","MAXCOORD","project","constrainedLat","sqr","dist2","w","distToSegmentSquared","isInRing","inside","xi","yi","xj","yj","isCcw","pointInPolygon","isInCurrentExterior","pointMinDistToPoints","pointMinDistToLines","_TileCache","inflight","idx","used","performance","now","ifentry","ifentry2","queryFeatures","lng","lat","brushSize","projected","onZoom","tileX","tileY","layerName","layerArr","TileCache","Justify","Justify2","TextPlacements","TextPlacements2","createPattern","canvas","ctx","getContext","_PolygonSymbolizer","pattern","fill","stroke","doStroke","before","patten","globalAlpha","fillStyle","strokeStyle","lineWidth","draw","drawPath","beginPath","poly","pt","moveTo","lineTo","PolygonSymbolizer","getStopIndex","stops","interpolate","computeInterpolationFactor","difference","progress","output0","linear","_LineSymbolizer","dash","dashColor","dashWidth","lineCap","lineJoin","strokePath","save","setLineDash","restore","LineSymbolizer","_IconSymbolizer","sheet","dpr","window","devicePixelRatio","place","layout","anchor","bboxes","drawImage","IconSymbolizer","_CircleSymbolizer","radius","arc","CircleSymbolizer","_ShieldSymbolizer","background","padding","scratch","metrics","measureText","ascent","actualBoundingBoxAscent","descent","actualBoundingBoxDescent","fillRect","fillText","ShieldSymbolizer","_FlexSymbolizer","list","labels","label","draws","newGeom","mergeBbox","FlexSymbolizer","_GroupSymbolizer","GroupSymbolizer","_CenteredSymbolizer","symbolizer","placed","firstLabel","justify","CenteredSymbolizer","_Padding","Padding","_TextSymbolizer","lineHeight","letterSpacing","maxLineCodeUnits","maxLineChars","longestLine","longestLineLen","extra","textStrokeWidth","startX","xPos","letter","strokeText","TextSymbolizer","_CenteredTextSymbolizer","centered","CenteredTextSymbolizer","_OffsetSymbolizer","offsetX","offsetY","placements","ddValues","_c","fb","offsetXvalue","offsetYvalue","justifyValue","ddOffsetX","ddOffsetY","ddJustify","ddPlacements","getBbox","origin","placeLabelInPoint","bboxCollides","order","placement","xAxisOffset","computeXaxisOffset","yAxisOffset","computeYaxisOffset","computeJustify","labelWidth","labelHalfWidth","labelHalfHeight","labelBottom","labelCenterHeight","fixedJustify","OffsetSymbolizer","_OffsetTextSymbolizer","OffsetTextSymbolizer","LineLabelPlacement","LineLabelPlacement2","_LineLabelSymbolizer","maxLabelCodeUnits","maxLabelChars","fbbox","overzoom","labelCandidates","candidate","cells","heightPlacement","deduplicationKey","deduplicationDistance","LineLabelSymbolizer","getString","getNumber","paintRules","dataLayer","earth","park_a","park_b","kind","hospital","industrial","school","beach","zoo","wood_a","wood_b","scrub_a","scrub_b","glacier","sand","aerodrome","water","runway","pier","pedestrian","buildings","major","boundaries","minAdminLevel","railway","labelRules","nametags","roads_label_minor","roads_label_minor_halo","roads_label_major","roads_label_major_halo","ocean_label","state_label","state_label_halo","country_label","city_label","popRank","city_circle","city_circle_stroke","city_label_halo","themes","light","military","tunnel_other_casing","tunnel_minor_casing","tunnel_link_casing","tunnel_medium_casing","tunnel_major_casing","tunnel_highway_casing","tunnel_other","tunnel_minor","tunnel_link","tunnel_medium","tunnel_major","tunnel_highway","transit_pier","minor_service_casing","minor_casing","link_casing","medium_casing","major_casing_late","highway_casing_late","minor_service","minor_a","minor_b","medium","major_casing_early","highway_casing_early","highway","waterway_label","bridges_other_casing","bridges_minor_casing","bridges_link_casing","bridges_medium_casing","bridges_major_casing","bridges_highway_casing","bridges_other","bridges_minor","bridges_link","bridges_medium","bridges_major","bridges_highway","peak_label","subplace_label","subplace_label_halo","dark","white","grayscale","black","transformGeom","arr2","loop","coord","wrap","dim","_View","tileCache","maxDataLevel","dataTilesForBounds","displayZoom","fractional","needed","dataTile","basetileSize","dataZoom","mintileX","mintileY","maxtileX","maxtileY","dataTileForDisplayTile","displayTile","tt","getDisplayTile","roundedZoom","View","sourcesToViews","sourceToViews","maxDataZoom","pathname","endsWith","sources","covering","tileWidth","minx","miny","maxx","maxy","leveldiff","log2","wrappedX","_Index","maxLabeledTiles","tree","hasPrefix","tileKey","searchBbox","Set","indexedLabel","searchLabel","labelCollides","deduplicationCollides","testBbox","collision","makeEntry","newSet","wrapsLeft","wrapsRight","newBboxes","duplicateLabel","entry2","pruneOrNoop","keyAdded","added","maxKey","maxDist","keysForDs","existingKey","existing","pruneKey","keyToRemove","indexedLabels","entriesToDelete","removeLabel","labelToRemove","Index","_Labeler","labelRules2","callback","preparedTilemap","preparedTiles","keysAdding","preparedTile","tilesInvalidated","rule","visible","dsName","dataSource","feats","transformed","labelAdded","conflict","findInvalidatedTiles","allAdded","Labeler","_Labelers","labelers","labeler","getIndex","Labelers","paint","labelData","rules","clip","debug","miterLimit","po","ps","rect","fbox","strokeRect","R2","MAX_LATITUDE2","MAXCOORD2","project2","unproject","instancedProject","instancedUnproject","degreesLng","cssPixels","_Static","theme","backgroundColor","views","drawContext","normalizedCenter","promises","promise","tileResponses","reason","tileResponse","paintRules2","elapsed","drawCanvas","_0","_1","_2","arguments","clientWidth","clientHeight","lang","drawContextBounds","topLeft","bottomRight","deltaDegrees","drawCanvasBounds","_3","Static","timer","duration","reflect","leafletLayer","_LeafletLayer","options2","noWrap","attribution","lastRequestedZ","tasks","onTilesInvalidated","rerenderTile","tileDelay","renderTile","element","layoutTime","_getTiledPixelBounds","tileRange","_pxBoundsToTileRange","tileCenter","priority","distanceTo","clearRect","paintingTime","xray","ypos","unwrappedK","_tiles","wrappedCoord","_wrapCoords","_keyToTileCoords","el","queryTileFeaturesDebug","featuresBySourceName","sourceName","clearLayout","rerenderTiles","showTile","_removeTile","removed","LeafletLayer","Font","ff","FontFace","fonts","mkimg","img","Image","onload","onerror","_Sheet","mapping","missingBox","icons","missingImg","btoa","boxes","serializer","XMLSerializer","svg64","serializeToString","packresult","maxWidth","box","last","spaces","space","potpack","templatedPMTilesLayer","TemplatedPMTilesLayer","location","ImageLayer","mapMLLayer","MapMLLayer","debugOverlay","DebugOverlay","protomapsL","freeze","__proto__","Sheet","pmtilesOptions","import","pmtilesRules","module","PAINT_RULES","LABEL_RULES","_pmtilesLayer","ImageOverlay","_location","_size","_angle","viewreset","_reset","_zoomAnimated","zoomanim","_animateZoom","_onImageLoad","_initImage","addInteractiveTarget","removeInteractiveTarget","Date","_updateOpacity","image","nextFrame","fade","setOpacity","cancelAnimFrame","_fadeFrame","requestAnimFrame","layerEl","_href","_mapmlTileContainer","_initialize","getHref","titleIsReadOnly","_titleIsReadOnly","setName","newName","_title","getName","_staticTileLayer","_attachSkipButtons","_calculateBounds","projectionBounds","getBoundsFromMeta","getZoomBoundsFromMeta","mapExtents","zoomMax","zoomMin","mapExtentLayer","_extentLayer","getAttribution","getBase","baseURI","native","licenseLink","licenseTitle","licenseUrl","attText","legendLink","_legendUrl","attributionControl","addAttribution","parseLicenseAndLegend","newTiles","importNode","processTiles","_mapmlvectors","_toggleControls","getQueryTemplates","queryLinks","templates","getBounds","_templateVars","content","getElementsByClassName","_eventParents","attachZoomLink","mapExtent","mapFocusButton","stop","_sortIndex","previousButton","featureCount","totalFeatures","nextButton","controlFocusButton","currentIndex","inBoundFeatures","_controlContainer","divider","focusFeature","focusEvent","composedPath","isTab","keyCode","shiftPressed","shiftKey","focusMap","stopPropagation","_popupClosed","featureEl","_groupLayer","tL","gcrs","bR","latLngBounds","latLng","zoomLink","getZoomToZoom","locale","popupZoom","onclick","onkeydown","MouseEvent","zoomTo","insertBefore","featureIndexOverlayOption","removeHandlers","removeEvent","mapSize","_panel","debugPanel","_grid","debugGrid","_panes","mapPane","_vectors","debugVectors","toolPane","DebugPanel","_infoContainer","_debugContainer","infoContainer","_tileCoord","_tileMatrixCoord","_mapCoord","_tcrsCoord","_pcrsCoord","_gcrsCoord","_updateCoords","_visible","pointI","pointJ","DebugGrid","outline","DebugVectors","_mapLayerUpdate","_centerVector","circle","pointToLatLng","_addBounds","colors","boundsArray","boundsTestTag","getLayerEl","boundsRect","projectedExtent","fillOpacity","totalBounds","totalLayerBounds","totalBoundsArray","ProjectedExtent","Path","_locations","locations","_rings","_subtract","_parts","_renderer","_updatePoly","QueryHandler","Handler","addHooks","_queryTopLayer","_queryTopLayerAtMapCenter","removeHooks","_getTopQueryableLayer","queryable","event","isFocused","layerPoint","latLngToLayerPoint","latLngToContainerPoint","_mapmlFeatures","_query","tcrs2pcrs","tcrs2gcrs","popupOptions","autoPan","maxHeight","tcrsClickLoc","latLngToPoint","tileMatrixClickLoc","tileBounds","Bounds","pcrsClick","fetches","tilei","tilej","mapi","mapj","pixelleft","pixeltop","pixelright","pixelbottom","column","longitude","latitude","mapbottom","mapleft","maptop","mapright","tilebottom","tileleft","tiletop","tileright","contenttype","queryMetas","mapmldoc","geometrylessFeatures","firstElementChild","cloneNode","featureDocument","featureCollection","html","featureDoc","append","message","fetchFeatures","results","openPopup","_popup","displayFeaturesPopup","ContextMenu","_touchstart","msPointer","pointer","activeIndex","excludedIndices","isRunned","_menuItems","CTXBACK","CTXFWD","CTXRELOAD","CTXFULLSCR","CTXSPACER1","CTXCOPY","CTXPASTE","CTXSPACER2","CTXCNTRLS","CTXDEBUG","CTXVWSRC","_items","cmBack","_goBack","cmForward","_goForward","cmReload","_reload","btnFullScreen","_toggleFullScreen","spacer","cmCopyCoords","_copyCoords","hideOnSelect","submenu","cmCopyMapML","_copyMapML","cmCopyExtent","_copyExtent","cmCopyLocation","_copyLocation","cmPasteLayer","_paste","cmToggleControls","cmToggleDebug","_toggleDebug","cmViewSource","_viewSource","defExtCS","defaultExtCoor","defLocCS","defaultLocCoor","LYRZOOMTO","LYRCOPY","_layerItems","lmZoomToLayer","_zoomToLayer","lmCopyLayer","_copyLayer","_extentLayerItems","lmZoomToExtent","_zoomToMapExtent","lmCopyExtent","_copyMapExtent","_mapMenuVisible","_keyboardEvent","_createItem","_copySubMenu","_clickEvent","CPYMENUMAP","CPYMENUEXTENT","CPYMENULOC","_hide","_onKeyDown","touch","contextmenu","_show","mousedown","_updateCS","KeyboardEvent","_copyData","_layerClicked","layerElem","getOuterHTML","extentElem","forward","back","reload","controls","outerHTML","navigator","clipboard","readText","_pasteLayer","viewSource","toggleDebug","_showCopySubMenu","execCommand","menu","_copyTile","_copyTileMatrix","_copyMap","_copyTCRS","_copyPCRS","_copyGCRS","click","caption","h2","pointX","pointY","mapPt","_copyAllCoords","allData","_createSeparator","_insertElementAt","_createEventHandler","_onItemMouseOver","_onItemMouseOut","func","_showLocation","containerPointToLayerPoint","layerPointToLatLng","refEl","closest","_showAtPoint","layerList","find","checked","gecko","getBoundingClientRect","activeEl","button","activeElement","_elementInFocus","_layerMenuTabs","firstChild","_extentLayerMenuTabs","_setPosition","containerSize","_getElementSize","contextmenuAnchor","_leaflet_pos","_sizeChanged","offsetWidth","offsetHeight","_focusOnLayerControl","_setActiveItem","noActiveEl","disabled","nextIndex","prevIndex","copyEl","menuWidth","submenuWidth","_hideCopySubMenu","srcElement","toggleContextMenuItem","state","setViewFullScreenInnerHTML","btnExitFullScreen","tcrsTopLeft","tcrsBottomRight","tileMatrixTopLeft","tileMatrixBottomRight","minConverted","maxConverted","unprojectedMin","unprojectedMax","tcrs","FALLBACK_CS","isFinite","minPixel","maxPixel","minGCRS","maxGCRS","pixelToPCRSPoint","pointToPCRSPoint","contentArray","stringSplit","prop","containerPoints","pairs","array","_parseNumber","justPan","inPlace","open","postTraversalSetup","lon","pseudo","ShadowRoot","FALLBACK_PROJECTION","metaKeys","axes","csToAxes","nMin","nMax","mapmlEl","dfLayer","lastElementChild","dfPastedLayer","geojson2mapml","json","table","thead","createTHead","insertRow","th1","th2","createTextNode","tbody","createTBody","th","bboxExtent","geometryFunction","jsonType","setExtent","xmlStringLayer","multiPoint","linestring","multilinestring","multiPolygon","geometrycollection","NEGATIVE_INFINITY","clone_feature","curr_feature","featureCaption","HTMLElement","_properties2Table","_updateExtent","clone_point","clone_coords","clone_linestring","linestring_coordindates","clone_polygon","clone_multipoint","clone_multilinestring","geometries","fg","arrayOfArrays","tableData","tr","dest","pointConv","proj4","_breakArray","_pcrsToGcrs","newArr","conv","propertyFunction","Proj","metas","ex","_table2properties","prop0","_geometry2geojson","geoms","bound","newZoom","mapCenterTCRS","mapHalf","mapTlNew","mapBrNew","mapTlPCRSNew","mapBrPCRSNew","mapPCRS","zOffset","selector","getClosest","host","matches","AttributionButton","Attribution","disableClickPropagation","_addAttribution","dialog","kbdShortcuts","kbdMovement","kbdPanUp","kbdPanDown","kbdPanLeft","kbdPanRight","btnZoomIn","btnZoomOut","kbdPanIncrement","kbdZoom","kbdFeature","kbdPrevFeature","kbdNextFeature","attribs","_attributions","prefixAndAttribs","btnAttribution","mergeOptions","toggleableAttributionControl","addInitHook","attributionButton","reloadButton","ReloadButton","scaleBar","ScaleBar","_goReload","_reloadButton","_updateDisabled","disable","_disabled","enable","Scale","updateWhenIdle","scaleControl","_scaleControl","_updateOutput","_focusOutput","addEventListener","_pixelsToDistance","px","dpi","_scaleLength","scaleLength","outputFocus","output","scaleLine","distance","metric","FullscreenButton","false","true","_toggleTitle","_click","toggleFullscreen","isFullscreen","include","_isFullscreen","pseudoFullscreen","_disablePseudoFullscreen","exitFullscreen","mozCancelFullScreen","webkitCancelFullScreen","msExitFullscreen","_enablePseudoFullscreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","ALLOW_KEYBOARD_INPUT","msRequestFullscreen","_setFullscreen","fullscreen","invalidateSize","_onFullscreenChange","fullscreenElement","fullscreenControl","fullscreenchange","onFullscreenChange","addControl","fullscreenButton","geolocationButton","GeolocationButton","crosshair","Crosshair","Geometry","CustomLocate","Locate","locateControl","showPopup","strings","btnLocTrackOff","locateOptions","MutationObserver","mutations","btnLocTrackOn","_marker","btnMyLocTrackOn","permanent","btnLocTrackLastKnown","btnMyLastKnownLocTrackOn","observe","attributeFilter","_isQueryable","_toggleEvents","_isMapFocused","_addOrRemoveCrosshair","_hasQueryableLayer","_addOrRemoveMapOutline","mapContainer","_outline","isLeafletContainer","_convertWrappers","_markup","_convertMarkup","_generateOutlinePoints","isClosed","_isClosed","attachLinkHandler","dragStart","hovered","handleMouse","visited","clientX","clientY","mouseup","onTop","nextLayer","nextElementSibling","eventPhase","Event","BUBBLING_PHASE","_handleLink","currentTarget","resolver","mapWidth","mouseout","mouseenter","addedMap","tileOrigin","zoomingTo","pixelRings","_convertRing","subP","subrings","pixelSubrings","pixelOutline","parts","interm","attr","featureAttributes","tabindex","subRings","_coordinateToArrays","cls","class","nodes","childNodes","cur","tempDiv","prev","main","subParts","isFirst","parents","span","noSpan","local","numPair","attrMap","wrapperAttr","linkTarget","linkType","getPCRSCenter","stampLayer","outlinePath","_createPath","_updateStyle","_rootGroup","outlineAdded","_removePath","_setPath","geometryToPath","_pointToMarker","_updatePathStyle","isMain","isOutline","dashArray","dashOffset","fillColor","fillRule","def","closed","len2","firstLayer","_openPopup","_handleFocus","updateInteraction","layerID","addToIndex","subPart","vectorMinZoom","vectorMaxZoom","openTooltip","closeTooltip","prevFocus","nextFocus","AnnounceMovement","layeradd","layerremove","announceBounds","dragging","_draggable","dragged","focusAnnouncement","removeEventListener","standard","amZoom","getMaxZoom","amMaxZoom","_layersMinZoom","amMinZoom","_traversalCall","getMinZoom","outOfBoundsPos","prevZoom","_historyIndex","inBoundsPos","amZoomedOut","wasDragged","amDraggedOut","amEastBound","amWestBound","amNorthBound","amSouthBound","whenLayersReady","FeatureIndex","outBoundFeatures","_mapPCRSBounds","_updateMapBounds","lc","mc","inbound","ac","bc","Options","announceMovement","announceScale","imperial","lcOpacity","amColumn","amRow","dfExtent","fIndexNoFeatures","Keyboard","altKey","metaKey","_panKeys","_panAnim","_inProgress","ctrlKey","panBy","maxBounds","panInsideBounds","_zoomKeys","187","107","61","171","189","109","54","173","setZoom","closeOnEscapeKey","featureIndexOverlay","FeatureIndexOverlay","createLayerControlExtentHTML","extentProperties","extentSettings","extentLabel","svgExtentControlIcon","extentControlPath1","extentControlPath2","extentNameIcon","extentItemControls","opacityControl","extentOpacitySummary","mapSelects","selectdetails","removeExtentButton","extentsettingsButton","extentItemNameSpan","defaultChecked","_layerControlCheckbox","ontouchstart","onmousedown","downEvent","TouchEvent","touches","control","moving","yPos","originalPosition","ontouchmove","onmousemove","moveEvent","pointerEvents","root","elementAt","elementFromPoint","swapControl","nextSibling","ontouchend","onmouseup","newPosition","controlsElems","extentZIndex","_extentRootFieldset","_opacityControl","_layerControlLabel","async","createLayerControlHTML","fieldset","layerItemName","settingsButtonNameIcon","layerItemProperty","layerItemSettings","itemToggleLabel","layerItemControls","opacityControlSummary","svgSettingsControlIcon","settingsControlPath1","settingsControlPath2","extentsFieldset","removeControlButton","disbaled","previousElementSibling","itemSettingControlButton","_layerControl","draggable","styleLinks","styles","getAlternateStyles","_layerItemSettingsHTML","_propertiesGroupAnatomy","_styles","mapExtentLayerControls","getLayerControlHTML","_output","_body","initialFocus","_addOrRemoveFeatureIndex","_checkOverlap","_calculateReticleBounds","wRatio","hRatio","reticleDimension","getComputedStyle","minPoint","maxPoint","popupClosed","featureIndexBounds","noFeaturesMessage","allFeatures","_addToggleKeys","_newContent","direction","newContent","ZoomInput","validateInput","getValue","HiddenInput","WidthInput","HeightInput","LocationInput","rel","axisCS","_templates","_tileZoom","DOMTokenList","#element","#valueSet","#attribute","#domain","domain","hostingElement","domtokenlist","valueSet","token","oldToken","newToken","supports","toggle","force","thisArg","detectImagePath","getStyle","mime","mapOptions","head","WGS84","CRS","CBMTILE","APSTILE","OSMTILE","EPSG3857","convertPCRSBounds","axisToXY","_convertAndFormatPCRS","_splitCoordinate","_coordsToArray","_gcrsToTileMatrix","mapml2geojson","getZoomBounds","_createLayerControlExtentHTML","_createLayerControlHTML","TILE_SIZE"],"mappings":"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"}