<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Change projection at z=9</title>
    <script type="module" src="../../../dist/mapml.js"></script>
    <link rel="stylesheet" href="../../../global.css">
    <script type="module" integrity="sha384-Hh7lchQhB8Rn/lnaYqaKSHmioep+t46mHHjRYMuyRh84SxzXpchwiclPLwfqYmg3" src="../projections/EPSG3573.js"></script>
    <script type="module" integrity="sha384-sJ2DMK3n8DI2JspezocxWO5u7i0lL+tsd/79Pq3keSIyj0VsG/HlhysalkQH2Mqe" src="../projections/ATLAS_POLAR_MAP.js"></script>
  </head>
  <body>
    <map is="web-map" projection="CBMTILE" zoom="8" lat="48.840422" lon="-101.219978" controls>
      <map-layer label="ASDI" media="(map-projection: EPSG3573) and (0 <= map-zoom <= 3)" src="../asdi-changeProjection.mapml" checked ></map-layer>
      <map-layer label="Atlas of Canada"  media="(map-projection: ATLAS_POLAR_MAP) and (4 <= map-zoom <= 5)"  src="../atlas-changeProjection.mapml" checked ></map-layer>
      <map-layer label="CBMT" media="(map-projection: CBMTILE) and (6 <= map-zoom <= 8)" src="../cbmt-changeProjection.mapml" checked ></map-layer>
      <map-layer label="OSM" media="(map-projection: OSMTILE) and (9 <= map-zoom <= 18)" src="../osm-changeProjection.mapml" checked ></map-layer>
    </map>
    <script>
      let map = document.querySelector('map');
      map.addEventListener('zoomend', (e) => {
        let m = e.target;
        if (m.zoom >= 0 && m.zoom <= 3) {
          m.projection = "EPSG3573";
        } else if (m.zoom >= 4 && m.zoom <= 5) {
          m.projection = "ATLAS_POLAR_MAP";
        } else if (m.zoom >= 6 && m.zoom <= 8) {
          m.projection = "CBMTILE";
        } else {
          m.projection = "OSMTILE";
        }
      });
    </script>
  </body>
</html>
